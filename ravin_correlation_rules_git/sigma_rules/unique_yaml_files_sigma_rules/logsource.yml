- category: application
  product: django
- category: application
  definition: 'Requirements: application error logs must be collected (with LOG_LEVEL=ERROR
    and above)'
  product: jvm
- category: application
  definition: 'Requirements: application error logs must be collected (with LOG_LEVEL=ERROR
    and above)'
  product: nodejs
- category: application
  product: python
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:1ff70682-0a51-30e8-076d-740be8cee98b"'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes,
    enable DRSR UUID (e3514235-4b06-11d1-ab04-00c04fc2dcd2) for "dangerous" opcodes
    (not 0,1 or 12) only from trusted IPs (DCs)'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:df1941c5-fe89-4e79-bf10-463657acf44d or c681d488-d850-11d0-8c52-00c04fd90f7e'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:82273fdc-e32a-18c3-3f78-827929dc23ea and uuid:f6beaff7-1e19-4fbb-9f8f-b89e2018337c"'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:86d35949-83c9-4044-b424-db363231fd0c"'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:12345678-1234-abcd-ef00-0123456789ab or 76f03f96-cdfd-44fc-a22c-64950a001209
    or ae33069b-a2a8-46ee-a235-ddfd339be281 or 0b6edbfa-4a24-4fc6-8a23-942b1eca65d1'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:367abb81-9844-35f1-ad32-98f038001003'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:338cd001-2244-31f1-aaaa-900038001003"'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:4b324fc8-1670-01d3-1278-5a47bf6ee188'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:378e52b0-c0a9-11cf-822d-00aa0051e40f"'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:6bffd098-a112-3610-9833-46c3f87e345a opnum:2'
  product: rpc_firewall
- category: application
  definition: 'Requirements: install and apply the RPC Firewall to all processes with
    "audit:true action:block uuid:4b324fc8-1670-01d3-1278-5a47bf6ee188 opnum:12'
  product: rpc_firewall
- category: application
  product: ruby_on_rails
- category: application
  product: spring
- category: application
  definition: 'Requirements: application error logs must be collected (with LOG_LEVEL=ERROR
    and above)'
  product: spring
- category: application
  definition: 'Requirements: application error logs must be collected (with LOG_LEVEL
    ERROR and above)'
  product: sql
- category: application
  definition: 'Requirements: application error logs must be collected (with LOG_LEVEL=ERROR
    and above)'
  product: velocity
- category: antivirus
- category: database
  definition: 'Requirements: Must be able to log the SQL queries'
- product: aws
  service: cloudtrail
- product: azure
  service: azureactivity
- product: azure
  service: auditlogs
- product: azure
  service: signinlogs
- product: azure
  service: activitylogs
- product: gcp
  service: gcp.audit
- definition: 'Requirements: The audit log streaming feature must be enabled to be
    able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming'
  product: github
  service: audit
- product: google_workspace
  service: google_workspace.admin
- product: m365
  service: threat_management
- product: m365
  service: threat_detection
- product: m365
  service: exchange
- definition: Requires the 'eDiscovery search or exported' alert to be enabled
  product: m365
  service: threat_management
- product: okta
  service: okta
- product: onelogin
  service: onelogin.events
- product: qualys
- service: netflow
- product: linux
  service: auditd
- definition: Configure these rules https://github.com/Neo23x0/auditd/blob/e181243a7c708e9d579557d6f80e0ed3d3483b89/audit.rules#L182-L183
  product: linux
  service: auditd
- product: linux
- definition: /var/log/secure on REHL systems or /var/log/auth.log on debian like
    Systems needs to be collected in order for this detection to work
  product: linux
- product: linux
  service: auth
- product: linux
  service: clamav
- product: linux
  service: cron
- product: linux
  service: guacamole
- product: linux
  service: sshd
- product: linux
  service: sudo
- product: linux
  service: syslog
- product: linux
  service: vsftpd
- category: file_event
  product: linux
- category: network_connection
  product: linux
- category: process_creation
  product: linux
- category: file_event
  product: macos
- category: process_creation
  product: macos
- product: cisco
  service: aaa
- definition: 'Requirements: cisco bgp logs need to be enabled and ingested'
  product: cisco
  service: bgp
- definition: 'Requirements: cisco ldp logs need to be enabled and ingested'
  product: cisco
  service: ldp
- category: dns
- category: firewall
- definition: 'Requirements: huawei bgp logs need to be enabled and ingested'
  product: huawei
  service: bgp
- definition: 'Requirements: juniper bgp logs need to be enabled and ingested'
  product: juniper
  service: bgp
- product: zeek
  service: dce_rpc
- product: zeek
  service: smb_files
- product: zeek
  service: x509
- product: zeek
  service: dns
- product: zeek
  service: http
- definition: Enable the builtin Zeek script that logs all HTTP header names by adding
    "@load policy/protocols/http/header-names" to your local.zeek config file. The
    script can be seen here for reference https://github.com/zeek/zeek/blob/d957f883df242ef159cfd846884e673addeea7a5/scripts/policy/protocols/http/header-names.zeek
  product: zeek
  service: http
- product: zeek
  service: rdp
- product: zeek
  service: kerberos
- definition: 'Requirements: Must be able to collect the error.log file'
  service: apache
- service: nginx
- category: proxy
- category: webserver
- product: windows
- product: windows
  service: application
- definition: MSSQL audit policy must be enabled in order to receive this event in
    the application log
  product: windows
  service: application
- definition: MSSQL audit policy to monitor for 'sp_procoption' must be enabled in
    order to receive this event in the application log
  product: windows
  service: application
- definition: MSSQL audit policy to monitor for 'xp_cmdshell' must be enabled in order
    to receive this event in the application log (Follow this tutorial https://dba.stackexchange.com/questions/103183/is-there-any-way-to-monitor-execution-of-xp-cmdshell-in-sql-server-2012)
  product: windows
  service: application
- product: windows
  service: applocker
- product: windows
  service: appmodel-runtime
- product: windows
  service: appxdeployment-server
- product: windows
  service: appxpackaging-om
- product: windows
  service: bits-client
- definition: 'Requirements: The CAPI2 Operational log needs to be enabled'
  product: windows
  service: capi2
- product: windows
  service: certificateservicesclient-lifecycle-system
- product: windows
  service: codeintegrity-operational
- product: windows
  service: diagnosis-scripted
- definition: 'Requirements: Microsoft-Windows-DNS Client Events/Operational Event
    Log must be enabled/collected in order to receive the events.'
  product: windows
  service: dns-client
- product: windows
  service: dns-server
- definition: 'Requirements: Microsoft-Windows-DNS-Server/Analytical ({EB79061A-A566-4698-9119-3ED2807060E7})
    Event Log must be collected in order to receive the events.'
  product: windows
  service: dns-server-analytic
- definition: Requires enabling and collection of the Microsoft-Windows-DriverFrameworks-UserMode/Operational
    eventlog
  product: windows
  service: driver-framework
- product: windows
  service: firewall-as
- definition: 'Requirements: Microsoft-Windows-LDAP-Client/Debug ETW logging'
  product: windows
  service: ldap_debug
- definition: 'Requirements: Microsoft-Windows-LSA/Operational ({199FE037-2B82-40A9-82AC-E1D46C792B99})
    Event Log must be collected in order to receive the events.'
  product: windows
  service: lsa-server
- product: windows
  service: msexchange-management
- definition: Requires events from Microsoft-Windows-NTLM/Operational
  product: windows
  service: ntlm
- product: windows
  service: openssh
- product: windows
  service: security
- definition: The "Audit Directory Service Changes" logging policy must be configured
    in order to receive events. Audit events are generated only for objects with configured
    system access control lists (SACLs). Audit events are generated only for objects
    with configured system access control lists (SACLs) and only when accessed in
    a manner that matches their SACL settings. This policy covers the following events
    ids - 5136, 5137, 5138, 5139, 5141. Note that the default policy does not cover
    User objects. For that a custom AuditRule need to be setup (See https://github.com/OTRF/Set-AuditRule)
  product: windows
  service: security
- definition: 'Requirements: enable Object Access SAM on your Domain Controllers'
  product: windows
  service: security
- definition: Certificate services loaded a template would trigger event ID 4898 and
    certificate Services template was updated would trigger event ID 4899. A risk
    permission seems to be coming if template contain specific flag.
  product: windows
  service: security
- definition: Certificate services loaded a template would trigger event ID 4898 and
    certificate Services template was updated would trigger event ID 4899. A risk
    permission seems to be coming if template contain specific flag with risky EKU.
  product: windows
  service: security
- definition: The advanced audit policy setting "Object Access > Audit File Share"
    must be configured for Success/Failure
  product: windows
  service: security
- definition: Requires the "Read all properties" permission on the user object to
    be audited for the "Everyone" principal
  product: windows
  service: security
- definition: 'Requirements: Audit Policy : Policy Change > Audit Authorization Policy
    Change, Group Policy : Computer Configuration\Windows Settings\Security Settings\Advanced
    Audit Policy Configuration\Audit Policies\Policy Change\Audit Authorization Policy
    Change'
  product: windows
  service: security
- definition: 'Requirements: Audit Policy : Account Management > Audit User Account
    Management, Group Policy : Computer Configuration\Windows Settings\Security Settings\Advanced
    Audit Policy Configuration\Audit Policies\Account Management\Audit User Account
    Management, DS Access > Audit Directory Service Changes, Group Policy : Computer
    Configuration\Windows Settings\Security Settings\Advanced Audit Policy Configuration\Audit
    Policies\DS Access\Audit Directory Service Changes'
  product: windows
  service: security
- definition: 'Requirements: Audit Policy : Account Management > Audit User Account
    Management, Group Policy : Computer Configuration\Windows Settings\Security Settings\Advanced
    Audit Policy Configuration\Audit Policies\Account Management\Audit User Account
    Management'
  product: windows
  service: security
- definition: The advanced audit policy setting "Object Access > Audit Detailed File
    Share" must be configured for Success/Failure
  product: windows
  service: security
- definition: The 'System Security Extension' audit subcategory need to be enabled
    to log the EID 4697
  product: windows
  service: security
- definition: 'Requirements: Audit Policy : Security Settings/Local Policies/Audit
    Policy, Registry System Access Control (SACL): Auditing/User'
  product: windows
  service: security
- definition: dfd8c0f4-e6ad-4e07-b91b-f2fca0ddef64
  product: windows
  service: security
- definition: The advanced audit policy setting "Object Access > Audit Removable Storage"
    must be configured for Success/Failure
  product: windows
  service: security
- definition: 'Requirements: Audit Policy : Object Access > Audit Registry (Success)'
  product: windows
  service: security
- definition: The advanced audit policy setting "Object Access > Detailed File Share"
    must be configured for Success/Failure
  product: windows
  service: security
- definition: The advanced audit policy setting "Account Logon > Kerberos Authentication
    Service" must be configured for Success/Failure
  product: windows
  service: security
- definition: 'Requirements: The Advanced Audit Policy setting Object Access > Audit
    Other Object Access Events has to be configured to allow this detection. We also
    recommend extracting the Command field from the embedded XML in the event data.'
  product: windows
  service: security
- definition: The volume of Event ID 4661 is high on Domain Controllers and therefore
    "Audit SAM" and "Audit Kernel Object" advanced audit policy settings are not configured
    in the recommendations for server systems
  product: windows
  service: security
- definition: The Advanced Audit Policy setting Object Access > Audit Other Object
    Access Events has to be configured to allow this detection. We also recommend
    extracting the Command field from the embedded XML in the event data.
  product: windows
  service: security
- definition: 'Requirements: Audit Policy : System > Audit Security State Change,
    Group Policy : Computer Configuration\Windows Settings\Security Settings\Advanced
    Audit Policy Configuration\Audit Policies\System\Audit Security State Change'
  product: windows
  service: security
- definition: 'Requirements: Identifiable administrators usernames (pattern or special
    parts_of_payam_rules_unique character. ex: "Admin-*"), internal policy mandating use only as secondary
    account'
  product: windows
  service: security
- definition: The successful use of PtH for lateral movement between workstations
    would trigger event ID 4624
  product: windows
  service: security
- product: windows
  service: security-mitigations
- product: windows
  service: microsoft-servicebus-client
- product: windows
  service: shell-core
- product: windows
  service: smbclient-security
- product: windows
  service: system
- definition: The source of this type of event is Kernel-General
  product: windows
  service: system
- definition: Other error are in Microsoft-Windows-WindowsUpdateClient/Operational
  product: windows
  service: system
- definition: 'Requirements: The "Microsoft-Windows-TaskScheduler/Operational" is
    disabled by default and needs to be enabled in order for this detection to trigger'
  product: windows
  service: taskscheduler
- product: windows
  service: terminalservices-localsessionmanager
- definition: 'Requirements:Enabled Block credential stealing from the Windows local
    security authority subsystem (lsass.exe) from Attack Surface Reduction (GUID:
    9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2)'
  product: windows
  service: windefend
- product: windows
  service: windefend
- definition: 'Requirements:Enabled Block process creations originating from PSExec
    and WMI commands from Attack Surface Reduction (GUID: d1e49aac-8f56-4280-b9ba-993a6d77406c)'
  product: windows
  service: windefend
- definition: WMI Namespaces Auditing and SACL should be configured, EventID 5861
    and 5859 detection requires Windows 10, 2012 and higher
  product: windows
  service: wmi
- category: create_remote_thread
  product: windows
- category: create_stream_hash
  definition: 'Requirements: Sysmon or equivalent configured with Imphash logging'
  product: windows
- category: create_stream_hash
  product: windows
- category: create_stream_hash
  definition: Requirements Sysmon config with Imphash logging activated
  product: windows
- category: dns_query
  product: windows
- category: driver_load
  product: windows
- category: file_access
  definition: 'Requirements: Microsoft-Windows-Kernel-File ETW provider'
  product: windows
- category: file_change
  product: windows
- category: file_delete
  product: windows
- category: file_event
  product: windows
- category: file_event
  definition: 'Requirements: The ".evtx" extension should be monitored via a Sysmon
    configuration. Example: <TargetFilename condition="end with">.evtx<TargetFilename>'
  product: windows
- category: file_event
  definition: 'Requirements: UsageLogs folder must be monitored by the sysmon configuration'
  product: windows
- category: file_event
  definition: 'Requirements: The "ParentImage" field is not available by default on
    EID 11 of Sysmon logs. To be able to use this rule to the full extent you need
    to enrich the log with additional ParentImage data'
  product: windows
- category: file_event
  definition: 'Requirements: The "ParentImage" field is not available by default on
    EID 11 of Sysmon logs. To be able to use this rule to the full extent you need
    to enriche the log with additional ParentImage data'
  product: windows
- category: file_rename
  definition: 'Requirements: Microsoft-Windows-Kernel-File Provider with at least
    the KERNEL_FILE_KEYWORD_RENAME_SETLINK_PATH keyword'
  product: windows
- category: image_load
  product: windows
- category: network_connection
  product: windows
- category: network_connection
  definition: Use the following config to generate the necessary Event ID 3 Network
    Connection events
  product: windows
- category: pipe_created
  definition: Note that you have to configure logging for Named Pipe Events in Sysmon
    config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon
    configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth
    verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config,
    https://github.com/olafhartong/sysmon-modular. How to test detection? You can
    check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575
  product: windows
- category: pipe_created
  definition: Note that you have to configure logging for Named Pipe Events in Sysmon
    config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon
    configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth
    verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config,
    https://github.com/olafhartong/sysmon-modular. How to test detection? You can
    always use Cobalt Strike, but also you can check powershell script from this site
    https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575
  product: windows
- category: pipe_created
  definition: Note that you have to configure logging for Named Pipe Events in Sysmon
    config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon
    configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth
    verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config,
    https://github.com/olafhartong/sysmon-modular You can also use other repo, e.g.
    https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular.
    How to test detection? You can always use Cobalt Strike, but also you can check
    powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575
  product: windows
- category: ps_classic_start
  definition: fields have to be extract from event
  product: windows
- definition: fields have to be extract from event
  product: windows
  service: powershell-classic
- category: ps_classic_provider_start
  definition: fields have to be extracted from the event
  product: windows
- category: ps_module
  definition: 0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
  product: windows
- category: ps_script
  definition: Script Block Logging must be enable
  product: windows
- category: ps_script
  definition: 'Requirements: Script Block Logging must be enabled'
  product: windows
- category: ps_script
  definition: 'Requirements: Script Block Logging must be enable'
  product: windows
- category: ps_script
  product: windows
- category: ps_script
  definition: bade5735-5ab0-4aa7-a642-a11be0e40872
  product: windows
- category: process_access
  product: windows
- category: process_access
  definition: 'Use the following config to generate the necessary Event ID 10 Process
    Access events: <ProcessAccess onmatch="include"><CallTrace condition="contains">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess
    onmatch="exclude"><CallTrace condition="excludes">UNKNOWN</CallTrace></ProcessAccess>'
  product: windows
- category: process_creation
  product: windows
- category: process_creation
  definition: Since options '-d' and '-p' were removed in Windows 10 this rule is
    relevant only for Windows before 10. And as Windows 7 doesn't log command line
    in 4688 by default, to detect this attack you need Sysmon 1 configured or KB3004375
    installed for command-line auditing (https://support.microsoft.com/en-au/help/3004375/microsoft-security-advisory-update-to-improve-windows-command-line-aud)
  product: windows
- category: process_creation
  definition: 'Requirements: ParentUser field needs sysmon >= 13.30'
  product: windows
- category: raw_access_thread
  product: windows
- category: registry_add
  product: windows
- category: registry_delete
  product: windows
- category: registry_event
  product: windows
- category: registry_set
  product: windows
- category: registry_set
  definition: 'Requirements: Sysmon config that monitors \Keyboard Layout\Preload
    subkey of the HKLU hives - see https://github.com/SwiftOnSecurity/sysmon-config/pull/92/files'
  product: windows
- category: registry_set
  definition: 'Requirements: Sysmon config that monitors \SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\AppCompatFlags\TelemetryController subkey of the HKLM hives'
  product: windows
- product: windows
  service: sysmon
- category: sysmon_error
  product: windows
- category: sysmon_status
  product: windows
- category: file_block
  product: windows
- category: process_tampering
  product: windows
- category: wmi_event
  product: windows
- definition: 'Requirements: Audit Policy : Audit Other Object Access Events > Success'
  product: windows
  service: security
- category: webserver
  definition: Make sure that your Netscaler appliance logs all kinds of attacks (test
    with http://your-citrix-gw.net/robots.txt). The directory traversal with ../ might
    not be needed on certain cloud instances or for authenticated users, so we also
    check for direct paths. All scripts in portal/scripts are exploitable except logout.pl.
- category: process_creation
  definition: The 'System Security Extension' audit subcategory need to be enabled
    to log the EID 4697
  product: windows
- product: windows
  service: printservice-admin
- product: windows
  service: printservice-operational
- category: webserver
  definition: Must be collect log from \ManageEngine\ADSelfService Plus\logs
- definition: 'Requirements: SACLs must be enabled for "Query Value" on the registry
    keys used in this rule'
  product: windows
  service: security
- product: windows
  service: smbclient-connectivity
- definition: The successful use of PtH for lateral movement between workstations
    would trigger event ID 4624, a failed logon attempt would trigger an event ID
    4625
  product: windows
  service: security
