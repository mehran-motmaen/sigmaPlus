- condition: keywords
  keywords:
  - SuspiciousOperation
  - DisallowedHost
  - DisallowedModelAdminLookup
  - DisallowedModelAdminToField
  - DisallowedRedirect
  - InvalidSessionKey
  - RequestDataTooBig
  - SuspiciousFileOperation
  - SuspiciousMultipartForm
  - SuspiciousSession
  - TooManyFieldsSent
  - PermissionDenied
- condition: keywords
  keywords:
  - com.sun.jndi.ldap.
  - org.apache.logging.log4j.core.net.JndiManager
- condition: keywords_local_file_read
  keywords_local_file_read:
    '|all':
    - FileNotFoundException
    - /../../..
- condition: keywords
  keywords:
  - org.apache.commons.ognl.OgnlException
  - ExpressionSyntaxException
- condition: keywords
  keywords:
  - Cannot run program
  - java.lang.ProcessImpl
  - java.lang.ProcessBuilder
- condition: keywords
  keywords:
  - SAXParseException
  - DOMException
- condition: keywords
  keywords:
  - node:child_process
- condition: keywords
  keywords:
  - DataError
  - IntegrityError
  - ProgrammingError
  - OperationalError
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 1ff70682-0a51-30e8-076d-740be8cee98b
    OpNum:
    - 0
    - 1
- condition: selection and not filter
  filter:
    OpNum:
    - 0
    - 1
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 1ff70682-0a51-30e8-076d-740be8cee98b
- condition: selection and not filter
  filter:
    OpNum:
    - 0
    - 1
    - 12
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: e3514235-4b06-11d1-ab04-00c04fc2dcd2
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid:
    - df1941c5-fe89-4e79-bf10-463657acf44d
    - c681d488-d850-11d0-8c52-00c04fd90f7e
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid:
    - 82273fdc-e32a-18c3-3f78-827929dc23ea
    - f6beaff7-1e19-4fbb-9f8f-b89e2018337c
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 86d35949-83c9-4044-b424-db363231fd0c
    OpNum:
    - 1
    - 3
    - 4
    - 10
    - 11
    - 12
    - 13
    - 14
    - 15
- condition: selection and not filter
  filter:
    OpNum:
    - 1
    - 3
    - 4
    - 10
    - 11
    - 12
    - 13
    - 14
    - 15
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 86d35949-83c9-4044-b424-db363231fd0c
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid:
    - 12345678-1234-abcd-ef00-0123456789ab
    - 76f03f96-cdfd-44fc-a22c-64950a001209
    - 0b6edbfa-4a24-4fc6-8a23-942b1eca65d1
    - ae33069b-a2a8-46ee-a235-ddfd339be281
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid:
    - 4d9f4ab8-7d1c-11cf-861e-0020af6e7c57
    - 99fcfec4-5260-101b-bbcb-00aa0021347a
    - 000001a0-0000-0000-c000-000000000046
    - 00000131-0000-0000-c000-000000000046
    - 00000143-0000-0000-c000-000000000046
    - 00000000-0000-0000-c000-000000000046
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 338cd001-2244-31f1-aaaa-900038001003
    OpNum:
    - 6
    - 7
    - 8
    - 13
    - 18
    - 19
    - 21
    - 22
    - 23
    - 35
- condition: selection and not filter
  filter:
    OpNum:
    - 6
    - 7
    - 8
    - 13
    - 18
    - 19
    - 21
    - 22
    - 23
    - 35
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 338cd001-2244-31f1-aaaa-900038001003
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 4b324fc8-1670-01d3-1278-5a47bf6ee188
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 367abb81-9844-35f1-ad32-98f038001003
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 378e52b0-c0a9-11cf-822d-00aa0051e40f
    OpNum:
    - 0
    - 1
- condition: selection and not filter
  filter:
    OpNum:
    - 0
    - 1
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 378e52b0-c0a9-11cf-822d-00aa0051e40f
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 6bffd098-a112-3610-9833-46c3f87e345a
    OpNum: 2
- condition: selection
  selection:
    EventID: 3
    EventLog: RPCFW
    InterfaceUuid: 4b324fc8-1670-01d3-1278-5a47bf6ee188
    OpNum: 12
- condition: keywords
  keywords:
  - ActionController::InvalidAuthenticityToken
  - ActionController::InvalidCrossOriginRequest
  - ActionController::MethodNotAllowed
  - ActionController::BadRequest
  - ActionController::ParameterMissing
- condition: keywords
  keywords:
  - AccessDeniedException
  - CsrfException
  - InvalidCsrfTokenException
  - MissingCsrfTokenException
  - CookieTheftException
  - InvalidCookieException
  - RequestRejectedException
- condition: keywords
  keywords:
  - org.springframework.expression.ExpressionException
- condition: keywords
  keywords:
  - quoted string not properly terminated
  - You have an error in your SQL syntax
  - Unclosed quotation mark
  - 'near "*": syntax error'
  - SELECTs to the left and right of UNION do not have the same number of result columns
- condition: keywords
  keywords:
  - ParseErrorException
  - VelocityException
  - TemplateInitException
- condition: selection
  selection:
    Signature|contains:
    - MeteTool
    - MPreter
    - Meterpreter
    - Metasploit
    - PowerSploit
    - CobaltStrike
    - BruteR
    - Brutel
    - Swrort
    - Rozena
    - Backdoor.Cobalt
    - CobaltStr
    - COBEACON
    - Cometer
    - Razy
    - IISExchgSpawnCMD
    - Exploit.Script.CVE
    - Seatbelt
    - Sbelt
    - Sliver
- condition: selection
  selection:
  - Signature|startswith:
    - HTOOL
    - HKTL
    - SecurityTool
    - Adfind
    - ATK/
    - Exploit.Script.CVE
    - PWS.
    - PWSX
  - Signature|contains:
    - Hacktool
    - ATK/
    - Potato
    - Rozena
    - Sbelt
    - Seatbelt
    - SecurityTool
    - SharpDump
    - Sliver
    - Splinter
    - Swrort
    - Impacket
    - Koadic
    - Lazagne
    - Metasploit
    - Meterpreter
    - MeteTool
    - Mimikatz
    - Mpreter
    - Nighthawk
    - PentestPowerShell
    - PowerSploit
    - PowerSSH
    - PshlSpy
    - PSWTool
    - PWCrack
    - Brutel
    - BruteR
    - Cobalt
    - COBEACON
    - Cometer
    - DumpCreds
    - FastReverseProxy
    - PWDump
- condition: selection
  selection:
  - Signature|startswith: PWS
  - Signature|contains:
    - DumpCreds
    - Mimikatz
    - PWCrack
    - HTool/WCE
    - PSWTool
    - PWDump
    - SecurityTool
    - PShlSpy
    - Rubeus
    - Kekeo
    - LsassDump
    - Outflank
    - DumpLsass
    - SharpDump
    - PWSX
    - PWS.
- condition: selection and not keywords
  keywords:
  - File submitted to Symantec
  selection:
    Filename|contains: C:\Windows\System32\spool\drivers\x64\
- condition: selection
  selection:
    Signature|contains:
    - Ransom
    - Cryptor
    - Crypter
    - CRYPTES
    - GandCrab
    - BlackWorm
    - Phobos
    - Destructor
    - Filecoder
    - GrandCrab
    - Krypt
    - Locker
    - Ryuk
    - Ryzerlo
    - Tescrypt
    - TeslaCrypt
- condition: 1 of selection_*
  selection_ext:
    Filename|endswith:
    - .asax
    - .ashx
    - .asmx
    - .asp
    - .aspx
    - .bat
    - .cfm
    - .cgi
    - .chm
    - .cmd
    - .dat
    - .ear
    - .gif
    - .hta
    - .jpeg
    - .jpg
    - .jsp
    - .jspx
    - .lnk
    - .php
    - .pl
    - .png
    - .ps1
    - .psm1
    - .py
    - .pyc
    - .rb
    - .scf
    - .sct
    - .sh
    - .svg
    - .txt
    - .vbe
    - .vbs
    - .war
    - .wsf
    - .wsh
    - .xml
  selection_path:
    Filename|contains:
    - C:\Windows\
    - C:\Temp\
    - C:\PerfLogs\
    - C:\Users\Public\
    - C:\Users\Default\
    - \Client\
    - \tsclient\
    - \inetpub\
    - /www/
    - apache
    - tomcat
    - nginx
    - weblogic
- condition: selection
  selection:
  - Signature|startswith:
    - PHP.
    - JSP.
    - ASP.
    - Perl.
    - VBS/Uxor
    - IIS/BackDoor
    - JAVA/Backdoor
    - Troj/ASP
    - Troj/PHP
    - Troj/JSP
  - Signature|contains:
    - Webshell
    - Chopper
    - SinoChoper
    - ASPXSpy
    - Aspdoor
    - filebrowser
    - PHP_
    - JSP_
    - ASP_
    - 'PHP:'
    - 'JSP:'
    - 'ASP:'
    - 'Perl:'
    - PHP/
    - JSP/
    - ASP/
    - Perl/
    - PHPShell
    - Trojan.PHP
    - Trojan.ASP
    - Trojan.JSP
    - Trojan.VBS
    - PHP/Agent
    - ASP/Agent
    - JSP/Agent
    - VBS/Agent
    - Backdoor/PHP
    - Backdoor/JSP
    - Backdoor/ASP
    - Backdoor/VBS
    - Backdoor/Java
    - PHP.Agent
    - ASP.Agent
    - JSP.Agent
    - VBS.Agent
    - Backdoor.PHP
    - Backdoor.JSP
    - Backdoor.ASP
    - Backdoor.VBS
    - Backdoor.Java
    - PShlSpy
    - C99shell
- condition: keywords
  keywords:
  - drop
  - truncate
  - dump
  - select \*
- condition: selection
  selection:
    eventName|startswith: UpdateFunctionConfiguration
    eventSource: lambda.amazonaws.com
- condition: selection_source
  selection_source:
    eventName:
    - StopLogging
    - UpdateTrail
    - DeleteTrail
    eventSource: cloudtrail.amazonaws.com
- condition: selection_source
  selection_source:
    eventName:
    - DeleteDeliveryChannel
    - StopConfigurationRecorder
    eventSource: config.amazonaws.com
- condition: selection
  selection:
    eventName: DeleteIdentity
    eventSource: ses.amazonaws.com
- condition: selection
  selection:
    eventName: DisableEbsEncryptionByDefault
    eventSource: ec2.amazonaws.com
- condition: selection_source
  selection_source:
    eventName: ModifyInstanceAttribute
    eventSource: ec2.amazonaws.com
    requestParameters.attribute: userData
- condition: selection and not 1 of filter*
  filter1:
    errorMessage|contains: '*'
  filter2:
    errorCode|contains: '*'
  filter3:
    responseElements|contains: Failure
  selection:
    eventName: CreateInstanceExportTask
    eventSource: ec2.amazonaws.com
- condition: selection
  selection:
    eventName:
    - DescribeTaskDefinition
    - RegisterTaskDefinition
    - RunTask
    eventSource: ecs.amazonaws.com
    requestParameters.containerDefinitions.command|contains: $AWS_CONTAINER_CREDENTIALS_RELATIVE_URI
- condition: selection
  selection:
    eventName: DeleteFileSystem
    eventSource: elasticfilesystem.amazonaws.com
- condition: selection
  selection:
    eventName: DeleteMountTarget
    eventSource: elasticfilesystem.amazonaws.com
- condition: selection
  selection:
    eventName:
    - CreateCluster
    - DeleteCluster
    eventSource: eks.amazonaws.com
- condition: selection
  selection:
    eventName: CreateCacheSecurityGroup
    eventSource: elasticache.amazonaws.com
- condition: selection
  selection:
    eventName:
    - DeleteCacheSecurityGroup
    - AuthorizeCacheSecurityGroupIngress
    - RevokeCacheSecurityGroupIngress
    - AuthorizeCacheSecurityGroupEgress
    - RevokeCacheSecurityGroupEgress
    eventSource: elasticache.amazonaws.com
- condition: selection and not filter
  filter:
    type: AssumedRole
  selection:
    eventName: ListBuckets
    eventSource: s3.amazonaws.com
- condition: selection_source
  selection_source:
    eventName: CreateIPSet
    eventSource: guardduty.amazonaws.com
- condition: selection_source and not filter
  filter:
    userIdentity.arn|contains: responseElements.accessKey.userName
  selection_source:
    eventName: CreateAccessKey
    eventSource: iam.amazonaws.com
- condition: selection
  selection:
    eventName:
    - GetLoginProfile
    - CreateLoginProfile
    eventSource: iam.amazonaws.com
    userAgent|contains: S3 Browser
- condition: selection
  selection:
    eventName:
    - CreateUser
    - CreateAccessKey
    eventSource: iam.amazonaws.com
    userAgent|contains: S3 Browser
- condition: selection
  selection:
    eventName:
    - CreateDevEndpoint
    - DeleteDevEndpoint
    - UpdateDevEndpoint
    eventSource: glue.amazonaws.com
- condition: selection_source
  selection_source:
    eventName: ModifyDBInstance
    eventSource: rds.amazonaws.com
    responseElements.pendingModifiedValues.masterUserPassword|contains: '*'
- condition: selection_source
  selection_source:
    eventName: RestoreDBInstanceFromDBSnapshot
    eventSource: rds.amazonaws.com
    responseElements.publiclyAccessible: 'true'
- condition: selection_usertype and not selection_eventtype
  selection_eventtype:
    eventType: AwsServiceEvent
  selection_usertype:
    userIdentity.type: Root
- condition: selection
  selection:
    eventName: DisableDomainTransferLock
    eventSource: route53.amazonaws.com
- condition: selection
  selection:
    eventName: TransferDomainToAnotherAwsAccount
    eventSource: route53.amazonaws.com
- condition: selection
  selection:
    eventName:
    - PutBucketLogging
    - PutBucketWebsite
    - PutEncryptionConfiguration
    - PutLifecycleConfiguration
    - PutReplicationConfiguration
    - ReplicateObject
    - RestoreObject
    eventSource: s3.amazonaws.com
- condition: selection
  selection:
    eventName:
    - BatchUpdateFindings
    - DeleteInsight
    - UpdateFindings
    - UpdateInsight
    eventSource: securityhub.amazonaws.com
- condition: selection_source
  selection_source:
    eventName: ModifySnapshotAttribute
    eventSource: ec2.amazonaws.com
- condition: selection
  selection:
    userIdentity.sessionContext.sessionIssuer.type: Role
    userIdentity.type: AssumedRole
- condition: selection
  selection:
    eventName: GetSessionToken
    eventSource: sts.amazonaws.com
    userIdentity.type: IAMUser
- condition: 1 of selection_*
  selection_iam:
    eventName: UpdateSAMLProvider
    eventSource: iam.amazonaws.com
  selection_sts:
    eventName: AssumeRoleWithSAML
    eventSource: sts.amazonaws.com
- condition: selection_source and not filter
  filter:
    userIdentity.arn|contains: requestParameters.userName
  selection_source:
    eventName: UpdateLoginProfile
    eventSource: iam.amazonaws.com
- condition: selection
  selection:
    CategoryValue: Administrative
    OperationNameValue: Microsoft.ADHybridHealthService/services/servicemembers/action
    ResourceId|contains: AdFederationService
    ResourceProviderValue: Microsoft.ADHybridHealthService
- condition: selection
  selection:
    CategoryValue: Administrative
    OperationNameValue: Microsoft.ADHybridHealthService/services/delete
    ResourceId|contains: AdFederationService
    ResourceProviderValue: Microsoft.ADHybridHealthService
- condition: selection
  selection:
    properties.message: Delete conditional access policy
- condition: keywords
  keywords:
  - Update conditional access policy
- condition: selection
  selection:
    properties.message: Add conditional access policy
- condition: selection
  selection:
    ResultType: 50053
- condition: selection
  selection:
    Status: Success
    properties.message:
    - Add user
    - Delete user
- condition: selection and not filter
  filter:
    Location|contains: <Countries you DO operate out of e,g GB, use OR for multiple>
  selection:
    Status: Success
- condition: selection
  selection:
    Count: <10%
    Status: failure
- condition: selection
  selection:
    Count: <10%
    Status: Success
- condition: selection
  selection:
    AppId: Insert Application ID use OR for multiple
    AuthenticationRequirement: singleFactorAuthentication
    Status: Success
- condition: selection
  selection:
    ResultType: 0
    userAgent|contains: azurehound
- condition: selection
  selection:
    Category: KeyManagement
    OperationName: Read BitLocker key
- condition: selection and not filter_mfa
  filter_mfa:
    AuthenticationRequirement: multiFactorAuthentication
  selection:
    ResourceDisplayName: Device Registration Service
    conditionalAccessStatus: success
- condition: selection
  selection:
    ActivityDisplayName: Set device registration policies
    Category: Policy
- condition: not selection and not selection1
  selection:
    Status: Success
  selection1:
    Location|contains: <Countries you DO operate out of e,g GB, use OR for multiple>
- condition: selection and not filter
  filter:
    InitiatedBy|contains: <approved guest inviter use OR for multiple>
  selection:
    Category: UserManagement
    OperationName: Invite external user
- condition: selection
  selection:
    AuthenticationRequirement: singleFactorAuthentication
    Status: Success
- condition: selection
  selection:
    AuthenticationRequirement: singleFactorAuthentication
    DeviceDetail.trusttype: ''
    RiskState: atRisk
    Status: Success
- condition: selection
  selection:
    DeviceDetail.isCompliant: 'false'
- condition: selection
  selection:
    AuthenticationRequirement: singleFactorAuthentication
    DeviceDetail.deviceId: ''
    NetworkLocationDetails: '[]'
    ResultType: 0
- condition: selection
  selection:
    Status: Success
    userAgent|contains:
    - BAV2ROPC
    - CBAinPROD
    - CBAinTAR
- condition: selection
  selection:
    Category: RoleManagement
    OperationName|contains|all:
    - Add
    - member to role
    TargetResources|contains:
    - 7698a772-787b-4ac8-901f-60d6b08affd2
    - 62e90394-69f5-4237-9190-012177145e10
- condition: selection
  selection:
    ModifiedProperties{}.NewValue|endswith:
    - Admins
    - Administrator
    Operation: Add member to role.
    Workload: AzureActiveDirectory
- condition: selection
  selection:
    properties.message:
    - Delete application
    - Hard Delete application
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/APPLICATIONGATEWAYS/WRITE
    - MICROSOFT.NETWORK/APPLICATIONGATEWAYS/DELETE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/APPLICATIONSECURITYGROUPS/WRITE
    - MICROSOFT.NETWORK/APPLICATIONSECURITYGROUPS/DELETE
- condition: selection
  selection:
    properties.message:
    - Update Application
    - Update Service principal
- condition: selection
  selection:
    properties.message:
    - Update Application-Certificates and secrets management
    - Update Service principal/Update Application
- condition: selection
  selection:
    properties.message: Update application - Certificates and secrets management
- condition: selection
  selection:
    properties.message: Add delegated permission grant
- condition: selection
  selection:
    properties.message: Device Code
- condition: selection
  selection:
    ConsentContext.IsAdminConsent: 'false'
- condition: selection
  selection:
    failure_status_reason: Microsoft.online.Security.userConsentBlockedForRiskyAppsExceptions
- condition: selection
  selection:
    properties.message: Add owner to application
- condition: selection
  selection:
    properties.message:
    - Add delegated permission grant
    - Add app role assignment to service principal
- condition: selection
  selection:
    properties.message: Add app role assignment to service principal
- condition: selection
  selection:
    properties.message:
    - Add member to role
    - Add eligible member to role
    - Add scoped member to role
- condition: selection
  selection:
    properties.message: ROPC
- condition: selection
  selection:
    properties.message: Update Application Sucess- Property Name AppAddress
- condition: selection
  selection:
    ResultDescription: Failure
    ResultType: 50057
- condition: selection
  selection:
    Category: UserManagement
    LoggedByService: Authentication Methods
    OperationName: User registered security info
- condition: selection
  selection:
    ResultType: 53003
    Resultdescription: Blocked by Conditional Access
- condition: selection
  selection:
    operationName:
    - MICROSOFT.CONTAINERREGISTRY/REGISTRIES/WRITE
    - MICROSOFT.CONTAINERREGISTRY/REGISTRIES/DELETE
- condition: keywords
  keywords:
  - Microsoft.Compute/virtualMachines/write
  - Microsoft.Resources/deployments/write
- condition: selection
  selection:
    properties.message:
    - Device no longer compliant
    - Device no longer managed
- condition: selection
  selection:
    properties.message:
    - Delete device
    - Delete device configuration
    - Update device
    - Update device configuration
- condition: selection
  selection:
    operationName|endswith:
    - /WRITE
    - /DELETE
    operationName|startswith: MICROSOFT.NETWORK/DNSZONES
- condition: selection
  selection:
    ActivityDisplayName: Set federation settings on domain
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/AZUREFIREWALLS/WRITE
    - MICROSOFT.NETWORK/AZUREFIREWALLS/DELETE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/AZUREFIREWALLS/APPLICATIONRULECOLLECTIONS/WRITE
    - MICROSOFT.NETWORK/AZUREFIREWALLS/APPLICATIONRULECOLLECTIONS/DELETE
    - MICROSOFT.NETWORK/AZUREFIREWALLS/NATRULECOLLECTIONS/WRITE
    - MICROSOFT.NETWORK/AZUREFIREWALLS/NATRULECOLLECTIONS/DELETE
    - MICROSOFT.NETWORK/AZUREFIREWALLS/NETWORKRULECOLLECTIONS/WRITE
    - MICROSOFT.NETWORK/AZUREFIREWALLS/NETWORKRULECOLLECTIONS/DELETE
- condition: keywords
  keywords:
  - Microsoft.Authorization/roleAssignments/write
- condition: selection
  selection:
    properties.message: Add member from group
- condition: selection
  selection:
    properties.message: Remove member from group
- condition: selection
  selection:
    Status: failure
    properties.message: Invite external user
- condition: selection
  selection:
    Category: UserManagement
    OperationName: Update user
    properties.message: '"displayName":"UserType","oldValue":"[\"Guest\"]","newValue":"[\"Member\"]"'
- condition: selection
  selection:
    operationName:
    - MICROSOFT.KEYVAULT/VAULTS/KEYS/UPDATE/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/KEYS/CREATE
    - MICROSOFT.KEYVAULT/VAULTS/KEYS/CREATE/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/KEYS/IMPORT/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/KEYS/RECOVER/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/KEYS/RESTORE/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/KEYS/DELETE
    - MICROSOFT.KEYVAULT/VAULTS/KEYS/BACKUP/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/KEYS/PURGE/ACTION
- condition: selection
  selection:
    operationName:
    - MICROSOFT.KEYVAULT/VAULTS/WRITE
    - MICROSOFT.KEYVAULT/VAULTS/DELETE
    - MICROSOFT.KEYVAULT/VAULTS/DEPLOY/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/ACCESSPOLICIES/WRITE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.KEYVAULT/VAULTS/SECRETS/WRITE
    - MICROSOFT.KEYVAULT/VAULTS/SECRETS/DELETE
    - MICROSOFT.KEYVAULT/VAULTS/SECRETS/BACKUP/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/SECRETS/PURGE/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/SECRETS/UPDATE/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/SECRETS/RECOVER/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/SECRETS/RESTORE/ACTION
    - MICROSOFT.KEYVAULT/VAULTS/SECRETS/SETSECRET/ACTION
- condition: selection
  selection:
    operationName|endswith:
    - /MUTATINGWEBHOOKCONFIGURATIONS/WRITE
    - /VALIDATINGWEBHOOKCONFIGURATIONS/WRITE
    operationName|startswith:
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/ADMISSIONREGISTRATION.K8S.IO
    - MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/ADMISSIONREGISTRATION.K8S.IO
- condition: selection
  selection:
    operationName:
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/DELETE
- condition: selection
  selection:
    operationName|endswith:
    - /CRONJOBS/WRITE
    - /JOBS/WRITE
    operationName|startswith:
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/BATCH
    - MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/BATCH
- condition: selection
  selection:
    operationName: MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/EVENTS.K8S.IO/EVENTS/DELETE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/NETWORKING.K8S.IO/NETWORKPOLICIES/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/NETWORKING.K8S.IO/NETWORKPOLICIES/DELETE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/EXTENSIONS/NETWORKPOLICIES/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/EXTENSIONS/NETWORKPOLICIES/DELETE
- condition: selection
  selection:
    operationName: MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/PODS/DELETE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/CLUSTERROLEBINDINGS/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/CLUSTERROLEBINDINGS/DELETE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/ROLEBINDINGS/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/ROLEBINDINGS/DELETE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/ROLES/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/ROLES/DELETE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/ROLES/BIND/ACTION
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/ROLES/ESCALATE/ACTION
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/CLUSTERROLES/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/CLUSTERROLES/DELETE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/CLUSTERROLES/BIND/ACTION
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/RBAC.AUTHORIZATION.K8S.IO/CLUSTERROLES/ESCALATE/ACTION
- condition: selection
  selection:
    operationName:
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/CONFIGMAPS/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/CONFIGMAPS/DELETE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/SECRETS/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/SECRETS/DELETE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/SERVICEACCOUNTS/WRITE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/SERVICEACCOUNTS/DELETE
    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/SERVICEACCOUNTS/IMPERSONATE/ACTION
- condition: selection
  selection:
    ActivityDetails: Sign-ins
    ClientApp:
    - Other client
    - IMAP
    - POP3
    - MAPI
    - SMTP
    - Exchange ActiveSync
    - Exchange Web Services
    Username: UPN
- condition: selection
  selection:
    ResultDescription: User account is disabled. The account has been disabled by
      an administrator.
    ResultType: 50057
- condition: selection
  selection:
    AuthenticationRequirement: multiFactorAuthentication
    Status|contains: MFA Denied
- condition: selection
  selection:
    eventName: Disable Strong Authentication.
    eventSource: AzureActiveDirectory
    status: success
- condition: 1 of selection_*
  selection_500121:
    ResultDescription|contains: Authentication failed during strong authentication
      request
    ResultType: 500121
  selection_50074:
    ResultDescription|contains: Strong Auth required
    ResultType: 50074
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/FIREWALLPOLICIES/WRITE
    - MICROSOFT.NETWORK/FIREWALLPOLICIES/JOIN/ACTION
    - MICROSOFT.NETWORK/FIREWALLPOLICIES/CERTIFICATES/ACTION
    - MICROSOFT.NETWORK/FIREWALLPOLICIES/DELETE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/FIREWALLPOLICIES/RULECOLLECTIONGROUPS/WRITE
    - MICROSOFT.NETWORK/FIREWALLPOLICIES/RULECOLLECTIONGROUPS/DELETE
    - MICROSOFT.NETWORK/FIREWALLPOLICIES/RULEGROUPS/WRITE
    - MICROSOFT.NETWORK/FIREWALLPOLICIES/RULEGROUPS/DELETE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/P2SVPNGATEWAYS/WRITE
    - MICROSOFT.NETWORK/P2SVPNGATEWAYS/DELETE
    - MICROSOFT.NETWORK/P2SVPNGATEWAYS/RESET/ACTION
    - MICROSOFT.NETWORK/P2SVPNGATEWAYS/GENERATEVPNPROFILE/ACTION
    - MICROSOFT.NETWORK/P2SVPNGATEWAYS/DISCONNECTP2SVPNCONNECTIONS/ACTION
    - MICROSOFT.NETWORK/P2SVPNGATEWAYS/PROVIDERS/MICROSOFT.INSIGHTS/DIAGNOSTICSETTINGS/WRITE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/WRITE
    - MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/DELETE
    - MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/SECURITYRULES/WRITE
    - MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/SECURITYRULES/DELETE
    - MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/JOIN/ACTION
    - MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/PROVIDERS/MICROSOFT.INSIGHTS/DIAGNOSTICSETTINGS/WRITE
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/NETWORKINTERFACES/TAPCONFIGURATIONS/WRITE
    - MICROSOFT.NETWORK/NETWORKINTERFACES/TAPCONFIGURATIONS/DELETE
    - MICROSOFT.NETWORK/NETWORKINTERFACES/WRITE
    - MICROSOFT.NETWORK/NETWORKINTERFACES/JOIN/ACTION
    - MICROSOFT.NETWORK/NETWORKINTERFACES/DELETE
    - MICROSOFT.NETWORK/NETWORKVIRTUALAPPLIANCES/DELETE
    - MICROSOFT.NETWORK/NETWORKVIRTUALAPPLIANCES/WRITE
    - MICROSOFT.NETWORK/VIRTUALHUBS/DELETE
    - MICROSOFT.NETWORK/VIRTUALHUBS/WRITE
    - MICROSOFT.NETWORK/VIRTUALROUTERS/WRITE
    - MICROSOFT.NETWORK/VIRTUALROUTERS/DELETE
- condition: selection
  selection:
    operationName: MICROSOFT.PORTAL/CONSOLES/WRITE
- condition: selection
  selection:
    properties.message:
    - Remove owner from service principal
    - Remove owner from application
- condition: selection
  selection:
    properties.message: Request Approved/Denied
- condition: selection
  selection:
    properties.message: Disable PIM Alert
- condition: selection
  selection:
    properties.message: Update role setting in PIM
- condition: selection
  selection:
    properties.message:
    - Add eligible member (permanent)
    - Add eligible member (eligible)
- condition: selection
  selection:
    properties.message:
    - Remove eligible member (permanent)
    - Remove eligible member (eligible)
- condition: selection
  selection:
    Status: Success
    properties.message|contains|all:
    - Add user
    - Add member to role
- condition: keywords
  keywords:
  - Microsoft.DocumentDB/databaseAccounts/listKeys/action
  - Microsoft.Maps/accounts/listKeys/action
  - Microsoft.Media/mediaservices/listKeys/action
  - Microsoft.CognitiveServices/accounts/listKeys/action
  - Microsoft.Storage/storageAccounts/listKeys/action
  - Microsoft.Compute/snapshots/write
  - Microsoft.Network/networkSecurityGroups/write
- condition: selection
  selection:
    properties.message: Add service principal
- condition: selection
  selection:
    properties.message: Remove service principal
- condition: selection
  selection:
    operationName: MICROSOFT.AUTHORIZATION/ELEVATEACCESS/ACTION
- condition: selection
  selection:
    Category: Administrative
    OperationName: Assigns the caller to user access admin
- condition: selection
  selection:
    operationName: MICROSOFT.SECURITY/ALERTSSUPPRESSIONRULES/WRITE
- condition: selection
  selection:
    Status: Admin registered temporary access pass method for user
    properties.message: Admin registered security info
- condition: 1 of selection_*
  selection_50097:
    ResultDescription: Device authentication is required
    ResultType: 50097
  selection_50155:
    ResultDescription: DeviceAuthenticationFailed
    ResultType: 50155
  selection_50158:
    ResultDescription: ExternalSecurityChallenge - External security challenge was
      not satisfied
    ResultType: 50158
- condition: selection and not filter
  filter:
    ResourceTenantId|contains: HomeTenantID
  selection:
    HomeTenantId: HomeTenantID
    Status: Success
- condition: selection
  selection:
    ResultType: 53003
- condition: selection and filter
  filter:
    ActivityType|contains: Password reset
    Target|contains: UPN
  selection:
    Category: UserManagement
    Initiatedby: UPN
    Status: Success
- condition: selection
  selection:
    operationName|endswith:
    - /WRITE
    - /DELETE
    operationName|startswith:
    - MICROSOFT.NETWORK/VIRTUALNETWORKGATEWAYS/
    - MICROSOFT.NETWORK/VIRTUALNETWORKS/
- condition: selection
  selection:
    operationName:
    - MICROSOFT.NETWORK/VPNGATEWAYS/VPNCONNECTIONS/WRITE
    - MICROSOFT.NETWORK/VPNGATEWAYS/VPNCONNECTIONS/DELETE
- condition: selection
  selection:
    gcp.audit.method_name:
    - storage.buckets.list
    - storage.buckets.listChannels
- condition: selection
  selection:
    gcp.audit.method_name:
    - storage.buckets.delete
    - storage.buckets.insert
    - storage.buckets.update
    - storage.buckets.patch
- condition: selection
  selection:
    gcp.audit.method_name: projects.content.reidentify
- condition: selection
  selection:
    gcp.audit.method_name:
    - Dns.ManagedZones.Delete
    - Dns.ManagedZones.Update
    - Dns.ManagedZones.Patch
- condition: selection
  selection:
    gcp.audit.method_name:
    - v*.Compute.Firewalls.Delete
    - v*.Compute.Firewalls.Patch
    - v*.Compute.Firewalls.Update
    - v*.Compute.Firewalls.Insert
- condition: selection
  selection:
    gcp.audit.method_name:
    - v*.Compute.PacketMirrorings.Get
    - v*.Compute.PacketMirrorings.Delete
    - v*.Compute.PacketMirrorings.Insert
    - v*.Compute.PacketMirrorings.Patch
    - v*.Compute.PacketMirrorings.List
    - v*.Compute.PacketMirrorings.aggregatedList
- condition: selection
  selection:
    gcp.audit.method_name|contains:
    - .mutatingwebhookconfigurations.
    - .validatingwebhookconfigurations.
    gcp.audit.method_name|endswith:
    - create
    - patch
    - replace
    gcp.audit.method_name|startswith: admissionregistration.k8s.io.v
- condition: selection
  selection:
    gcp.audit.method_name:
    - io.k8s.api.batch.v*.Job
    - io.k8s.api.batch.v*.CronJob
- condition: selection
  selection:
    gcp.audit.method_name:
    - io.k8s.authorization.rbac.v*.clusterrolebindings.create
    - io.k8s.authorization.rbac.v*.rolebindings.create
    - io.k8s.authorization.rbac.v*.clusterrolebindings.patch
    - io.k8s.authorization.rbac.v*.rolebindings.patch
    - io.k8s.authorization.rbac.v*.clusterrolebindings.update
    - io.k8s.authorization.rbac.v*.rolebindings.update
    - io.k8s.authorization.rbac.v*.clusterrolebindings.delete
    - io.k8s.authorization.rbac.v*.rolebindings.delete
- condition: selection
  selection:
    gcp.audit.method_name:
    - io.k8s.core.v*.secrets.create
    - io.k8s.core.v*.secrets.update
    - io.k8s.core.v*.secrets.patch
    - io.k8s.core.v*.secrets.delete
- condition: selection
  selection:
    gcp.audit.method_name|endswith:
    - .serviceAccounts.disable
    - .serviceAccounts.delete
- condition: selection
  selection:
    gcp.audit.method_name|endswith:
    - .serviceAccounts.patch
    - .serviceAccounts.create
    - .serviceAccounts.update
    - .serviceAccounts.enable
    - .serviceAccounts.undelete
- condition: selection
  selection:
    gcp.audit.method_name:
    - cloudsql.instances.create
    - cloudsql.instances.delete
    - cloudsql.users.update
    - cloudsql.users.delete
- condition: selection
  selection:
    gcp.audit.method_name:
    - compute.vpnTunnels.insert
    - compute.vpnTunnels.delete
- condition: selection
  selection:
    action:
    - codespaces.delete
    - environment.delete
    - project.delete
    - repo.destroy
- condition: selection
  selection:
    action:
    - dependabot_alerts.disable
    - dependabot_alerts_new_repos.disable
    - dependabot_security_updates.disable
    - dependabot_security_updates_new_repos.disable
    - repository_vulnerability_alerts.disable
- condition: selection
  selection:
    action:
    - org.disable_oauth_app_restrictions
    - org.disable_two_factor_requirement
    - repo.advanced_security_disabled
    - org.advanced_security_policy_selected_member_disabled
- condition: selection
  selection:
    action:
    - org.add_member
    - org.invite_member
- condition: selection
  selection:
    action:
    - org.create_actions_secret
    - environment.create_actions_secret
    - codespaces.create_an_org_secret
    - repo.create_actions_secret
- condition: selection
  selection:
    action:
    - project.update_user_permission
    - org.remove_outside_collaborator
- condition: selection
  selection:
    action:
    - org.remove_self_hosted_runner
    - org.runner_group_created
    - org.runner_group_removed
    - org.runner_group_updated
    - org.runner_group_runners_added
    - org.runner_group_runner_removed
    - org.runner_group_runners_updated
    - repo.register_self_hosted_runner
    - repo.remove_self_hosted_runner
- condition: selection
  selection:
    eventName:
    - REMOVE_APPLICATION
    - REMOVE_APPLICATION_FROM_WHITELIST
    eventService: admin.googleapis.com
- condition: selection
  selection:
    eventName: AUTHORIZE_API_CLIENT_ACCESS
    eventService: admin.googleapis.com
- condition: all of selection*
  selection_base:
    eventName:
    - ENFORCE_STRONG_AUTHENTICATION
    - ALLOW_STRONG_AUTHENTICATION
    eventService: admin.googleapis.com
  selection_eventValue:
    new_value: 'false'
- condition: selection
  selection:
    eventName:
    - DELETE_ROLE
    - RENAME_ROLE
    - UPDATE_ROLE
    eventService: admin.googleapis.com
- condition: selection
  selection:
    eventName: REMOVE_PRIVILEGE
    eventService: admin.googleapis.com
- condition: selection
  selection:
    eventName:
    - GRANT_DELEGATED_ADMIN_PRIVILEGES
    - GRANT_ADMIN_PRIVILEGE
    eventService: admin.googleapis.com
- condition: selection
  selection:
    eventName: Activity performed by terminated user
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: Activity from anonymous IP addresses
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: Activity from infrequent country
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: Data exfiltration to unsanctioned apps
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: Activity from suspicious IP addresses
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: Impossible travel activity
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: Log on from a risky IP address
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: Add-FederatedDomain
    eventSource: Exchange
    status: success
- condition: selection
  selection:
    eventName: Potential ransomware activity
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: eDiscovery search started or exported
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    Payload|contains|all:
    - New-ComplianceSearchAction
    - Export
    - pst
    eventSource: SecurityComplianceCenter
- condition: selection
  selection:
    eventName: Suspicious inbox forwarding
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: Suspicious OAuth app file download activities
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: Unusual volume of file deletion
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventName: User restricted from sending email
    eventSource: SecurityComplianceCenter
    status: success
- condition: selection
  selection:
    eventtype:
    - group.privilege.grant
    - user.account.privilege.grant
- condition: selection
  selection:
    eventtype: iam.resourceset.bindings.add
- condition: selection
  selection:
    eventtype: system.api_token.create
- condition: selection
  selection:
    eventtype: system.api_token.revoke
- condition: selection
  selection:
    eventtype:
    - application.lifecycle.update
    - application.lifecycle.delete
- condition: selection
  selection:
    eventtype:
    - application.policy.sign_on.update
    - application.policy.sign_on.rule.delete
- condition: selection
  selection:
    eventtype: user.authentication.auth_via_mfa
    outcome.reason: FastPass declined phishing attempt
    outcome.result: FAILURE
- condition: selection
  selection:
    eventtype:
    - user.mfa.factor.deactivate
    - user.mfa.factor.reset_all
- condition: selection
  selection:
    eventtype:
    - zone.deactivate
    - zone.delete
- condition: selection and not filter_main
  filter_main:
    actor_alternateid|re: (^0oa.*|[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,10})
  selection:
    legacyeventtype: core.user_auth.login_failed
- condition: selection
  selection:
    eventtype:
    - policy.lifecycle.update
    - policy.lifecycle.delete
- condition: selection
  selection:
    eventtype:
    - policy.rule.update
    - policy.rule.delete
- condition: selection
  selection:
    eventtype: security.threat.detected
- condition: selection
  selection:
    displaymessage: User attempted unauthorized access to app
- condition: selection
  selection:
    displaymessage: Max sign in attempts exceeded
- condition: selection
  selection:
    event_type_id: 3
- condition: 1 of selection*
  selection1:
    event_type_id: 532
  selection2:
    event_type_id: 553
  selection3:
    event_type_id: 551
- condition: selection
  selection:
    host.scan.vuln:
    - 10693
    - 11507
    - 11633
    - 11804
    - 11821
    - 11847
    - 11867
    - 11931
    - 11935
    - 11950
    - 12541
    - 12558
    - 12559
    - 12560
    - 12562
    - 12563
    - 12565
    - 12587
    - 12590
    - 12599
    - 12702
    - 12705
    - 12706
    - 12907
    - 12928
    - 12929
    - 13053
    - 13178
    - 13200
    - 13218
    - 13241
    - 13253
    - 13274
    - 13296
    - 13301
    - 13327
    - 13373
    - 13374
    - 13409
    - 13530
    - 13532
    - 20065
    - 20073
    - 20081
    - 27202
    - 27358
    - 38702
    - 38719
    - 42045
    - 42417
    - 43029
    - 43220
    - 43221
    - 43222
    - 43223
    - 43225
    - 43246
    - 43431
    - 43484
    - 86857
    - 87098
    - 87106
- condition: selection
  selection:
    event.category: Security Policy
    host.scan.vuln_name|contains: Firewall Product Not Detected
- condition: selection
  selection:
    destination.port:
    - 8080
    - 21
    - 80
    - 23
    - 50000
    - 1521
    - 27017
    - 1433
    - 11211
    - 3306
    - 15672
    - 5900
    - 5901
    - 5902
    - 5903
    - 5904
- condition: selection
  selection:
    a0: arecord
    a1: -vv
    a2: -fdat
    type: EXECVE
- condition: selection
  selection:
    name:
    - /etc/audit/*
    - /etc/libaudit.conf
    - /etc/audisp/*
    type: PATH
- condition: selection_execve and (keywords_truncate or (keywords_dd and not keywords_filter))
  keywords_dd:
    '|all':
    - dd
    - if=
  keywords_filter:
  - of=
  keywords_truncate:
    '|all':
    - truncate
    - -s
  selection_execve:
    type: EXECVE
- condition: selection
  selection:
    name:
    - /var/run/haldrund.pid
    - /var/run/xinetd.lock
    - /var/run/kdevrund.pid
    type: PATH
- cmd:
    a0|endswith: iptables
    a1: -t
    a2: nat
    type: EXECVE
  condition: cmd and keywords
  keywords:
  - --to-ports 42
  - --to-ports 43
- condition: selection
  selection:
    a0: getcap
    a1: -r
    a2: /
    type: EXECVE
- condition: execve and touch and selection2
  execve:
    type: EXECVE
  selection2:
  - -t
  - -acmr
  - -d
  - -r
  touch:
  - touch
- condition: selection
  selection:
    a0|contains: chattr
    a1|contains: -i
    type: EXECVE
- condition: selection
  selection:
    a0: xclip
    a1:
    - -selection
    - -sel
    a2:
    - clipboard
    - clip
    a3: -o
    type: EXECVE
- condition: selection
  selection:
    a0: xclip
    a1:
    - -selection
    - -sel
    a2:
    - clipboard
    - clip
    a3: -t
    a4|startswith: image/
    a5: -o
    type: EXECVE
- cmd1:
    a1|startswith: --cpu-priority
  cmd2:
    a2|startswith: --cpu-priority
  cmd3:
    a3|startswith: --cpu-priority
  cmd4:
    a4|startswith: --cpu-priority
  cmd5:
    a5|startswith: --cpu-priority
  cmd6:
    a6|startswith: --cpu-priority
  cmd7:
    a7|startswith: --cpu-priority
  condition: 1 of cmd*
- condition: 1 of selection_*
  selection_add_user_record_type:
    type: ADD_USER
  selection_syscall_record_type:
    exe|endswith: /useradd
    type: SYSCALL
- condition: 1 of selection*
  selection1:
    a0: zip
    type: execve
  selection2:
    a0: gzip
    a1: -f
    type: execve
  selection3:
    a0: tar
    a1|contains: -c
    type: execve
- condition: selection
  selection:
    a0: wget
    a1|startswith: --post-file=
    type: EXECVE
- condition: selection
  selection:
    a0|contains: dd
    a1|contains:
    - if=/dev/null
    - if=/dev/zero
    type: EXECVE
- condition: selection
  selection:
    type: SERVICE_STOP
    unit:
    - firewalld
    - iptables
    - ufw
- condition: selection
  selection:
    a0|contains:
    - chmod
    - chown
    type: EXECVE
- condition: selection and keywords
  keywords:
    '|all':
    - grep
    - password
  selection:
    type: EXECVE
- condition: selection and not filter
  filter:
    name|contains:
    - /.cache/
    - /.config/
    - /.pyenv/
    - /.rustup/toolchains
  selection:
    name|contains: /.
    type: PATH
- arguments:
  - a1|contains: /.
  - a1|startswith: .
  - a2|contains: /.
  - a2|startswith: .
  commands:
    a0:
    - mkdir
    - touch
    - vim
    - nano
    - vi
    type: EXECVE
  condition: commands and arguments
- a1:
    a1|endswith:
    - .jpg
    - .png
  a2:
    a2|endswith: .zip
  commands:
    a0: cat
    type: EXECVE
  condition: commands and a1 and a2
- condition: 1 of selection_*
  selection_path_events:
    name:
    - /etc/pam.d/system-auth
    - /etc/pam.d/password-auth
    type: PATH
  selection_tty_events:
    type:
    - TTY
    - USER_TTY
- condition: selection
  selection:
    name: /etc/ld.so.preload
    type: PATH
- condition: selection
  selection:
    comm: insmod
    exe: /usr/bin/kmod
    type: SYSCALL
- condition: selection
  selection:
    name:
    - /etc/syslog.conf
    - /etc/rsyslog.conf
    - /etc/syslog-ng/syslog-ng.conf
    type: PATH
- condition: selection
  selection:
    a0: cp
    a1: -i
    a2: /bin/sh
    a3|endswith: /crond
    type: execve
- condition: 1 of selection*
  selection1:
    a0: iptables
    a1|contains: DROP
    type: EXECVE
  selection2:
    a0: firewall-cmd
    a1|contains: remove
    type: EXECVE
  selection3:
    a0: ufw
    a1|contains: delete
    type: EXECVE
- condition: selection
  selection:
    exe|endswith:
    - /telnet
    - /nmap
    - /netcat
    - /nc
    key: network_connect_4
    type: SYSCALL
- condition: 1 of selection_*
  selection_1:
    a0: tcpdump
    a1: -c
    a3|contains: -i
    type: execve
  selection_2:
    a0: tshark
    a1: -c
    a3: -i
    type: execve
- condition: selection
  selection:
    comm: sh
    cwd: /var/opt/microsoft/scx/tmp
    syscall: execve
    type: SYSCALL
    uid: 0
- condition: 1 of selection_*
  selection_chage:
    a0: chage
    a1:
    - --list
    - -l
    type: EXECVE
  selection_files:
    name:
    - /etc/pam.d/common-password
    - /etc/security/pwquality.conf
    - /etc/pam.d/system-auth
    - /etc/login.defs
    type: PATH
  selection_passwd:
    a0: passwd
    a1:
    - -S
    - --status
    type: EXECVE
- condition: selection
  selection:
    a0|contains: systemctl
    a1|contains:
    - daemon-reload
    - start
    type: EXECVE
- condition: import and (import_window_root or import_no_window_root)
  import:
    a0: import
    type: EXECVE
  import_no_window_root:
    a1|endswith:
    - .png
    - .jpg
    - .jpeg
  import_window_root:
    a1: -window
    a2: root
    a3|endswith:
    - .png
    - .jpg
    - .jpeg
- condition: selection and 1 of xwd_*
  selection:
    a0: xwd
    type: EXECVE
  xwd_no_root_window:
    a1: -out
    a2|endswith: .xwd
  xwd_root_window:
    a1: -root
    a2: -out
    a3|endswith: .xwd
- condition: selection
  selection:
    comm: split
    type: SYSCALL
- condition: selection
  selection:
    a0: steghide
    a1: embed
    a2:
    - -cf
    - -ef
    a4:
    - -cf
    - -ef
    type: EXECVE
- condition: selection
  selection:
    a0: steghide
    a1: extract
    a2: -sf
    a3|endswith:
    - .jpg
    - .png
    type: EXECVE
- condition: selection
  selection:
    key: susp_activity
- cmd1:
    a0: chmod
    a1: 777
    type: EXECVE
  cmd2:
    a0: chmod
    a1: u+s
    type: EXECVE
  cmd3:
    a0: cp
    a1: /bin/ksh
    type: EXECVE
  cmd4:
    a0: cp
    a1: /bin/sh
    type: EXECVE
  condition: 1 of cmd*
- condition: selection
  selection:
    exe|startswith:
    - /tmp/
    - /var/www/
    - /home/*/public_html/
    - /usr/local/apache2/
    - /usr/local/httpd/
    - /var/apache/
    - /srv/www/
    - /home/httpd/html/
    - /srv/http/
    - /usr/share/nginx/html/
    - /var/lib/pgsql/data/
    - /usr/local/mysql/data/
    - /var/lib/mysql/
    - /var/vsftpd/
    - /etc/bind/
    - /var/named/
    type: SYSCALL
- condition: execve and history
  execve:
    type: EXECVE
  history:
  - .bash_history
  - .zsh_history
  - .zhistory
  - .history
  - .sh_history
  - fish_history
- condition: path and 1 of name_*
  name_1:
    name|startswith:
    - /usr/lib/systemd/system/
    - /etc/systemd/system/
  name_2:
    name|contains: /.config/systemd/user/
  path:
    nametype: CREATE
    type: PATH
- condition: 1 of selection_*
  selection_1:
    name:
    - /etc/lsb-release
    - /etc/redhat-release
    - /etc/issue
    type: PATH
  selection_2:
    a0:
    - uname
    - uptime
    - lsmod
    - hostname
    - env
    type: EXECVE
  selection_3:
    a0: grep
    a1|contains:
    - vbox
    - vm
    - xen
    - virtio
    - hv
    type: EXECVE
  selection_4:
    a0: kmod
    a1: list
    type: EXECVE
- condition: selection
  selection:
    name:
    - /sys/class/dmi/id/bios_version
    - /sys/class/dmi/id/product_name
    - /sys/class/dmi/id/chassis_vendor
    - /proc/scsi/scsi
    - /proc/ide/hd0/model
    - /proc/version
    - /etc/*version
    - /etc/*release
    - /etc/issue
    type: PATH
- condition: execve and (shutdowncmd or (init and initselection))
  execve:
    type: EXECVE
  init:
  - init
  - telinit
  initselection:
  - 0
  - 6
  shutdowncmd:
  - shutdown
  - reboot
  - halt
  - poweroff
- condition: selection
  selection:
    name:
    - /etc/shells
    - /etc/profile
    - /etc/profile.d/*
    - /etc/bash.bashrc
    - /etc/bashrc
    - /etc/zsh/zprofile
    - /etc/zsh/zshrc
    - /etc/zsh/zlogin
    - /etc/zsh/zlogout
    - /etc/csh.cshrc
    - /etc/csh.login
    - /root/.bashrc
    - /root/.bash_profile
    - /root/.profile
    - /root/.zshrc
    - /root/.zprofile
    - /home/*/.bashrc
    - /home/*/.zshrc
    - /home/*/.bash_profile
    - /home/*/.zprofile
    - /home/*/.profile
    - /home/*/.bash_login
    - /home/*/.bash_logout
    - /home/*/.zlogin
    - /home/*/.zlogout
    type: PATH
- a1:
    a1|endswith:
    - .jpg
    - .png
  commands:
    a0: unzip
    type: EXECVE
  condition: commands and a1
- condition: selection
  selection:
    a0:
    - users
    - w
    - who
    type: EXECVE
- condition: selection
  selection:
    key: detect_execve_www
    syscall: execve
    type: SYSCALL
- condition: keywords
  keywords:
  - 'chown root*chmod 4777 '
  - cp /bin/sh .;chown
  - chmod 4777 /tmp/.scsi/dev/bin/gsh
  - chown root:root /tmp/.scsi/dev/bin/
  - chown root:root x;
  - /bin/telnet locip locport < /dev/console | /bin/sh
  - /tmp/ratload
  - 'ewok -t '
  - 'xspy -display '
  - cat > /dev/tcp/127.0.0.1/80 <<END
  - rm -f /current/tmp/ftshell.latest
  - 'ghost_* -v '
  - ' --wipe > /dev/null'
  - ping -c 2 *; grep * /proc/net/arp >/tmp/gx
  - iptables * OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;
  - '> /var/log/audit/audit.log; rm -f .'
  - cp /var/log/audit/audit.log .tmp
  - sh >/dev/tcp/* <&1 2>&1
  - ncat -vv -l -p * <
  - nc -vv -l -p * <
  - < /dev/console | uudecode && uncompress
  - sendmail -osendmail;chmod +x sendmail
  - /usr/bin/wget -O /tmp/a http* && chmod 755 /tmp/cron
  - chmod 666 /var/run/utmp~
  - chmod 700 nscd crond
  - cp /etc/shadow /tmp/.
  - </dev/console |uudecode > /dev/null 2>&1 && uncompress
  - chmod 700 jp&&netstat -an|grep
  - uudecode > /dev/null 2>&1 && uncompress -f * && chmod 755
  - chmod 700 crond
  - wget http*; chmod +x /tmp/sendmail
  - chmod 700 fp sendmail pt
  - chmod 755 /usr/vmsys/bin/pipe
  - chmod -R 755 /usr/vmsys
  - chmod 755 $opbin/*tunnel
  - chmod 700 sendmail
  - chmod 0700 sendmail
  - /usr/bin/wget http*sendmail;chmod +x sendmail;
  - '&& telnet * 2>&1 </dev/console'
- condition: keywords
  keywords:
  - attempt to execute code on stack by
  - FTP LOGIN FROM .* 0bin0sh
  - 'rpc.statd[\d+]: gethostbyname error for'
  - AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
- condition: selection and not falsepositives
  falsepositives:
  - /syslog.
  selection:
  - rm /var/log/syslog
  - rm -r /var/log/syslog
  - rm -f /var/log/syslog
  - rm -rf /var/log/syslog
  - mv /var/log/syslog
  - ' >/var/log/syslog'
  - ' > /var/log/syslog'
- condition: tools and filter
  filter:
  - '@'
  - ':'
  tools:
  - 'scp '
  - 'rsync '
  - 'sftp '
- condition: keywords
  keywords:
  - /etc/ld.so.preload
- condition: keywords
  keywords:
    '|all':
    - networkd-dispatcher
    - Error handling notification for interface
    - ../../
- condition: selection
  selection:
  - bpf_probe_write_user
- condition: all of selection_*
  selection_new_user:
  - new user
  selection_uids_gids:
  - GID=0
  - UID=0
  - GID=10
  - GID=27
- condition: keywords
  keywords:
  - (){:;};
  - () {:;};
  - () { :;};
  - () { :; };
- condition: keywords
  keywords:
  - rm *bash_history
  - echo "" > *bash_history
  - cat /dev/null > *bash_history
  - cat /dev/zero > *bash_history
  - ln -sf /dev/null *bash_history
  - ln -sf /dev/zero *bash_history
  - truncate -s0 *bash_history
  - export HISTFILESIZE=0
  - history -c
  - history -w
  - shred *bash_history
  - empty_bash_history
  - chattr +i *bash_history
- condition: keywords
  keywords:
  - wget * - http* | perl
  - wget * - http* | sh
  - wget * - http* | bash
  - python -m SimpleHTTPServer
  - -m http.server
  - import pty; pty.spawn*
  - socat exec:*
  - socat -O /tmp/*
  - socat tcp-connect*
  - '*echo binary >>*'
  - '*wget *; chmod +x*'
  - '*wget *; chmod 777 *'
  - '*cd /tmp || cd /var/run || cd /mnt*'
  - '*stop;service iptables stop;*'
  - '*stop;SuSEfirewall2 stop;*'
  - chmod 777 2020*
  - '*>>/etc/rc.local'
  - '*base64 -d /tmp/*'
  - '* | base64 -d *'
  - '*/chmod u+s *'
  - '*chmod +s /tmp/*'
  - '*chmod u+s /tmp/*'
  - '* /tmp/haxhax*'
  - '* /tmp/ns_sploit*'
  - nc -l -p *
  - cp /bin/ksh *
  - cp /bin/sh *
  - '* /tmp/*.b64 *'
  - '*/tmp/ysocereal.jar*'
  - '*/tmp/x *'
  - '*; chmod +x /tmp/*'
  - '*;chmod +x /tmp/*'
- condition: keywords
  keywords:
  - entered promiscuous mode
  - Deactivating service
  - Oversized packet received from
  - imuxsock begins to drop messages
- condition: keywords
  keywords:
  - BEGIN {s = "/inet/tcp/0/
  - bash -i >& /dev/tcp/
  - bash -i >& /dev/udp/
  - sh -i >$ /dev/udp/
  - sh -i >$ /dev/tcp/
  - '&& while read line 0<&5; do'
  - /bin/bash -c exec 5<>/dev/tcp/
  - /bin/bash -c exec 5<>/dev/udp/
  - 'nc -e /bin/sh '
  - /bin/sh | nc
  - 'rm -f backpipe; mknod /tmp/backpipe p && nc '
  - ;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i))))
  - ;STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;
  - /bin/sh -i <&3 >&3 2>&3
  - uname -a; w; id; /bin/bash -i
  - $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length);
    $stream.Flush()};
  - ;os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);os.putenv('HISTFILE','/dev/null');
  - .to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)
  - ;while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print
  - 'socat exec:''bash -li'',pty,stderr,setsid,sigint,sane tcp:'
  - rm -f /tmp/p; mknod /tmp/p p &&
  - ' | /bin/bash | telnet '
  - ',echo=0,raw tcp-listen:'
  - 'nc -lvvp '
  - xterm -display 1
- condition: all of selection*
  selection1:
  - echo "*" > * && chmod +x *
  selection2:
  - mv * "* "
- condition: keywords
  keywords:
  - cat </dev/tcp/
  - exec 3<>/dev/tcp/
  - echo >/dev/tcp/
  - bash -i >& /dev/tcp/
  - sh -i >& /dev/udp/
  - 0<&196;exec 196<>/dev/tcp/
  - exec 5<>/dev/tcp/
  - (sh)0>/dev/tcp/
  - bash -c 'bash -i >& /dev/tcp/
  - echo -e '#!/bin/bash\nbash -i >& /dev/tcp/
- condition: all of selection*
  selection1:
  - bash -c /bin/bash
  selection2:
  - '&/dev/tcp/'
- condition: keywords
  keywords:
  - ln -s -f /etc/passwd
  - ln -s /etc/passwd
- condition: keywords
  keywords:
    '|all':
    - pkexec
    - The value for environment variable XAUTHORITY contains suscipious content
    - '[USER=root] [TTY=/dev/pts/0]'
- condition: keywords
  keywords:
  - Trojan*FOUND
  - VirTool*FOUND
  - Webshell*FOUND
  - Rootkit*FOUND
  - Htran*FOUND
- condition: keywords
  keywords:
  - REPLACE
- condition: selection
  selection:
  - (2 users now present)
- condition: keywords
  keywords:
  - 'error: buffer_get_ret: trying to get more bytes 1907 than in buffer 308 [preauth]'
- condition: keywords
  keywords:
  - unexpected internal error
  - unknown or unsupported key type
  - invalid certificate signing key
  - invalid elliptic curve value
  - incorrect signature
  - error in libcrypto
  - unexpected bytes remain after decoding
  - 'fatal: buffer_get_string: bad string'
  - 'Local: crc32 compensation attack'
  - bad client public DH value
  - Corrupted MAC on input
- condition: selection_user
  selection_user:
    USER:
    - '#-*'
    - '#*4294967295'
- condition: keywords
  keywords:
  - stopping iptables
  - stopping ip6tables
  - stopping firewalld
  - stopping cbdaemon
  - stopping falcon-sensor
- condition: keywords
  keywords:
  - ' dropping source port zero packet from '
  - ' denied AXFR from '
  - ' exiting (due to fatal error)'
- condition: keywords
  keywords:
  - 'Connection refused: too many sessions for this address.'
  - 'Connection refused: tcp_wrappers denial.'
  - Bad HTTP verb.
  - port and pasv both active
  - pasv and port both active
  - Transfer done (but failed to open directory).
  - Could not set file modification time.
  - 'bug: pid active in ptrace_sandbox_free'
  - PTRACE_SETOPTIONS failure
  - 'weird status:'
  - couldn't handle sandbox event
  - syscall * out of bounds
  - 'syscall not permitted:'
  - 'syscall validate failed:'
  - Input line too long.
  - poor buffer accounting in str_netfd_alloc
  - vsf_sysutil_read_loop
- condition: selection
  selection:
    TargetFilename|endswith: /etc/doas.conf
- condition: 1 of selection*
  selection1:
    TargetFilename|startswith:
    - /etc/cron.d/
    - /etc/cron.daily/
    - /etc/cron.hourly/
    - /etc/cron.monthly/
    - /etc/cron.weekly/
    - /var/spool/cron/crontabs/
  selection2:
    TargetFilename|contains:
    - /etc/cron.allow
    - /etc/cron.deny
    - /etc/crontab
- condition: selection
  selection:
    TargetFilename|startswith: /etc/sudoers.d/
- condition: selection
  selection:
    TargetFilename|contains: /etc/profile.d/
    TargetFilename|endswith:
    - .csh
    - .sh
- condition: selection
  selection:
    TargetFilename: /tmp/rootlog
- condition: selection
  selection:
    TargetFilename|endswith: ebpfbackdoor
- condition: selection
  selection:
    Image|endswith: /wget
    TargetFilename|startswith:
    - /tmp/
    - /var/tmp/
- condition: selection and not filter
  filter:
    DestinationIp:
    - 127.0.0.1
    - 0.0.0.0
  selection:
    Image|endswith: /bin/bash
- condition: selection
  selection:
    DestinationHostname:
    - pool.minexmr.com
    - fr.minexmr.com
    - de.minexmr.com
    - sg.minexmr.com
    - ca.minexmr.com
    - us-west.minexmr.com
    - pool.supportxmr.com
    - mine.c3pool.com
    - xmr-eu1.nanopool.org
    - xmr-eu2.nanopool.org
    - xmr-us-east1.nanopool.org
    - xmr-us-west1.nanopool.org
    - xmr-asia1.nanopool.org
    - xmr-jp1.nanopool.org
    - xmr-au1.nanopool.org
    - xmr.2miners.com
    - xmr.hashcity.org
    - xmr.f2pool.com
    - xmrpool.eu
    - pool.hashvault.pro
    - moneroocean.stream
    - monerocean.stream
- condition: selection
  selection:
    DestinationHostname|contains:
    - tunnel.us.ngrok.com
    - tunnel.eu.ngrok.com
    - tunnel.ap.ngrok.com
    - tunnel.au.ngrok.com
    - tunnel.sa.ngrok.com
    - tunnel.jp.ngrok.com
    - tunnel.in.ngrok.com
- condition: selection
  selection:
    Image|endswith:
    - /at
    - /atd
- condition: selection
  selection:
    CommandLine|contains: -d
    Image|endswith: /base64
- condition: all of selection_*
  selection_base64:
    CommandLine|contains: 'base64 '
  selection_exec:
  - CommandLine|contains:
    - '| bash '
    - '| sh '
    - '|bash '
    - '|sh '
  - CommandLine|endswith:
    - ' |sh'
    - '| bash'
    - '| sh'
    - '|bash'
- condition: selection
  selection:
    CommandLine|contains:
    - IyEvYmluL2Jhc2
    - IyEvYmluL2Rhc2
    - IyEvYmluL3pza
    - IyEvYmluL2Zpc2
    - IyEvYmluL3No
- condition: selection
  selection:
    CommandLine|contains: ' -i '
    Image|endswith: /bash
- condition: selection
  selection:
    CommandLine|contains: --unsafe
    Image|endswith: bpftrace
- condition: selection
  selection:
    CommandLine|contains:
    - /myprobe/enable
    - /myretprobe/enable
    CommandLine|contains|all:
    - echo 1 >
    - /sys/kernel/debug/tracing/events/kprobes/
- condition: selection
  selection:
    CommandLine|contains:
    - ' /r '
    - ' -r '
    Image|endswith: /getcap
- condition: selection
  selection:
    CommandLine|contains: ' /etc/sudoers'
    Image|endswith:
    - /cat
    - grep
    - /head
    - /tail
    - /more
- condition: selection
  selection:
    CommandLine|contains: ' -i '
    Image|endswith: /chattr
- condition: selection
  selection:
    CommandLine|contains:
    - /var/log
    - /var/spool/mail
    Image|endswith:
    - /rm
    - /shred
    - /unlink
- condition: selection
  selection:
    CommandLine|contains:
    - rm /var/log/syslog
    - rm -r /var/log/syslog
    - rm -f /var/log/syslog
    - rm -rf /var/log/syslog
    - unlink /var/log/syslog
    - unlink -r /var/log/syslog
    - unlink -f /var/log/syslog
    - unlink -rf /var/log/syslog
    - mv /var/log/syslog
    - ' >/var/log/syslog'
    - ' > /var/log/syslog'
- condition: selection
  selection:
    CommandLine|contains|all:
    - -sel
    - clip
    - -o
    Image|contains: xclip
- condition: all of selection_*
  selection_file:
    CommandLine|contains:
    - passwd
    - shadow
  selection_img:
    Image|endswith: /cp
  selection_path:
    CommandLine|contains: /tmp/
- condition: selection
  selection:
    CommandLine|contains: ' -l'
    Image|endswith: /crontab
- condition: selection
  selection:
    CommandLine|contains: ' -r'
    Image|endswith: crontab
- condition: selection
  selection:
    CommandLine|contains:
    - ' --cpu-priority='
    - --donate-level=0
    - ' -o pool.'
    - ' --nicehash'
    - ' --algo=rx/0 '
    - stratum+tcp://
    - stratum+udp://
    - sh -c /sbin/modprobe msr allow_writes=on
    - LS1kb25hdGUtbGV2ZWw9
    - 0tZG9uYXRlLWxldmVsP
    - tLWRvbmF0ZS1sZXZlbD
    - c3RyYXR1bSt0Y3A6Ly
    - N0cmF0dW0rdGNwOi8v
    - zdHJhdHVtK3RjcDovL
    - c3RyYXR1bSt1ZHA6Ly
    - N0cmF0dW0rdWRwOi8v
    - zdHJhdHVtK3VkcDovL
- condition: selection
  selection:
    Image|endswith: /curl
- condition: selection
  selection:
    CommandLine|contains:
    - /bin/sh
    - bash
    - dash
    - ksh
    - zsh
    - csh
    - fish
    - curl
    - wget
    - python
    ParentImage|endswith: /java
    ParentImage|startswith: /opt/atlassian/confluence/
- condition: selection
  selection:
    CommandLine|contains:
    - id -Gn `
    - id -Gn '
    ParentImage|endswith: \bash
- condition: all of selection*
  selection1:
    Image:
    - /bin/dd
    - /usr/bin/dd
  selection2:
    CommandLine|contains: of=
  selection3:
    CommandLine|contains:
    - if=/dev/zero
    - if=/dev/null
- condition: 1 of selection_*
  selection_init:
    CommandLine|contains|all:
    - -ufw-init
    - force-stop
  selection_ufw:
    CommandLine|contains|all:
    - ufw
    - disable
- condition: selection
  selection:
    Image|endswith: /doas
- condition: 1 of select*
  select_file_with_asterisk:
    CommandLine|re: (.){200,}
    Image|endswith: /file
  select_find_execution:
    Image|endswith: /find
  select_recursive_ls:
    CommandLine|contains: -R
    Image|endswith: /ls
  select_tree_execution:
    Image|endswith: /tree
- condition: selection
  selection:
    Image|endswith:
    - /rm
    - /shred
    - /unlink
- condition: all of selection_*
  selection_architecture:
    CommandLine|endswith:
    - aarch64
    - arm
    - i386
    - i686
    - mips
    - x86_64
  selection_process:
    Image|endswith: /grep
- condition: selection
  selection:
    Image|endswith: /groupdel
- condition: selection
  selection:
    CommandLine|contains: APT::Update::Pre-Invoke::=
    Image|endswith:
    - /apt
    - /apt-get
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - :!/
    - ':py '
    - ':lua '
    - /bin/sh
    - /bin/bash
    - /bin/dash
    - /bin/zsh
    - /bin/fish
  selection_img:
    CommandLine|contains:
    - ' -c '
    - ' --cmd'
    Image|endswith:
    - /vim
    - /rvim
    - /vimdiff
- condition: selection
  selection:
  - Image|endswith:
    - /sqlmap
    - /teamserver
    - /aircrack-ng
    - /john
    - /setoolkit
    - /wpscan
    - /hydra
    - /nikto
    - /ebpfkit
    - /bpfdos
    - /exechijack
    - /pidhide
    - /writeblocker
  - Image|contains: /linpeas
- condition: selection
  selection:
    Image|endswith:
    - /update-ca-certificates
    - /update-ca-trust
- condition: 1 of selection_tool_* and selection_keyword
  selection_keyword:
    CommandLine|contains:
    - nmap
    - ' nc'
    - netcat
    - wireshark
    - tshark
    - openconnect
    - proxychains
  selection_tool_apt:
    CommandLine|contains: install
    Image|endswith:
    - /apt
    - /apt-get
  selection_tool_dpkg:
    CommandLine|contains:
    - --install
    - -i
    Image|endswith: /dpkg
  selection_tool_rpm:
    CommandLine|contains: -i
    Image|endswith: /rpm
  selection_tool_yum:
    CommandLine|contains:
    - localinstall
    - install
    Image|endswith: /yum
- condition: all of selection_*
  selection_img:
    Image|endswith:
    - /iptables
    - /xtables-legacy-multi
    - /iptables-legacy-multi
    - /ip6tables
    - /ip6tables-legacy-multi
  selection_params:
    CommandLine|contains:
    - -F
    - -Z
    - -X
  selection_ufw:
    CommandLine|contains:
    - ufw-logging-deny
    - ufw-logging-allow
    - ufw6-logging-deny
    - ufw6-logging-allow
- condition: selection
  selection:
    Image|endswith:
    - /kill
    - /pkill
    - /killall
- condition: 1 of selection*
  selection_1:
    Image|endswith: /lastlog
  selection_2:
    CommandLine|contains: '''x:0:'''
  selection_3:
    CommandLine|contains:
    - /etc/passwd
    - /etc/shadow
    - /etc/sudoers
    Image|endswith:
    - /cat
    - /head
    - /tail
    - /more
  selection_4:
    Image|endswith: /id
  selection_5:
    CommandLine|contains: -u
    Image|endswith: /lsof
- condition: 1 of selection*
  selection_1:
    Image|endswith: /groups
  selection_2:
    CommandLine|contains: /etc/group
    Image|endswith:
    - /cat
    - /head
    - /tail
    - /more
- condition: selection
  selection:
    CommandLine|contains:
    - apached
    - frpc
    - sshd.sh
    - zone.arm
    Image|endswith: /grep
- condition: selection
  selection:
    Image|endswith: /mkfifo
- condition: selection
  selection:
    CommandLine|contains: ' /tmp/'
    Image|endswith: /mkfifo
- condition: selection
  selection:
    CommandLine|contains|all:
    - hidepid=2
    - ' -o '
    Image|endswith: /mount
- condition: all of selection_*
  selection_flags:
    CommandLine|contains:
    - ' -c '
    - ' -e '
  selection_nc:
    Image|endswith:
    - /nc
    - /ncat
  selection_shell:
    CommandLine|contains:
    - ' ash'
    - ' bash'
    - ' bsh'
    - ' csh'
    - ' ksh'
    - ' pdksh'
    - ' sh'
    - ' tcsh'
    - /bin/ash
    - /bin/bash
    - /bin/bsh
    - /bin/csh
    - /bin/ksh
    - /bin/pdksh
    - /bin/sh
    - /bin/tcsh
    - /bin/zsh
    - $IFSash
    - $IFSbash
    - $IFSbsh
    - $IFScsh
    - $IFSksh
    - $IFSpdksh
    - $IFSsh
    - $IFStcsh
    - $IFSzsh
- condition: (netcat and not netcat_listen_flag) or network_scanning_tools
  netcat:
    Image|endswith:
    - /nc
    - /netcat
  netcat_listen_flag:
    CommandLine|contains: l
  network_scanning_tools:
    Image|endswith:
    - /telnet
    - /nmap
- condition: selection
  selection:
    Image|endswith: /nohup
- condition: selection
  selection:
    CommandLine|contains: /tmp/
    Image|endswith: /nohup
- condition: selection
  selection:
    CommandLine|contains: /etc/opt/microsoft/scx/conf/tmpdir/scx
    CurrentDirectory: /var/opt/microsoft/scx/tmp
    LogonId: 0
    User: root
- condition: selection
  selection:
    CommandLine|contains: /bin/sh
    CurrentDirectory: /var/opt/microsoft/scx/tmp
    LogonId: 0
    User: root
- condition: all of selection_*
  selection_content:
  - CommandLine|contains|all:
    - fdopen(
    - ::Socket::INET
  - CommandLine|contains|all:
    - Socket
    - connect
    - open
    - exec
  selection_img:
    CommandLine|contains: ' -e '
    Image|endswith: /perl
- condition: selection
  selection:
    CommandLine|contains:
    - ash
    - bash
    - bsh
    - csh
    - ksh
    - pdksh
    - sh
    - tcsh
    - zsh
    CommandLine|contains|all:
    - ' -r '
    - fsockopen
    Image|contains: /php
- condition: selection
  selection:
    Image|endswith:
    - /ps
    - /top
- condition: selection
  selection:
    CommandLine|contains:
    - http_proxy=
    - https_proxy=
- condition: selection_img and 1 of selection_cli_*
  selection_cli_1:
    CommandLine|contains|all:
    - import pty
    - .spawn(
  selection_cli_2:
    CommandLine|contains: from pty import spawn
  selection_img:
  - Image|endswith:
    - /python
    - /python2
    - /python3
  - Image|contains:
    - /python2.
    - /python3.
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' -c '
    - import
    - pty
    - spawn(
    - .connect
    Image|contains: python
- condition: 1 of selection*
  selection_1:
    CommandLine|contains: -a
    Image|endswith: /arp
  selection_2:
    CommandLine|contains:
    - ' 10.'
    - ' 192.168.'
    - ' 172.16.'
    - ' 172.17.'
    - ' 172.18.'
    - ' 172.19.'
    - ' 172.20.'
    - ' 172.21.'
    - ' 172.22.'
    - ' 172.23.'
    - ' 172.24.'
    - ' 172.25.'
    - ' 172.26.'
    - ' 172.27.'
    - ' 172.28.'
    - ' 172.29.'
    - ' 172.30.'
    - ' 172.31.'
    - ' 127.'
    - ' 169.254.'
    Image|endswith: /ping
- condition: 1 of selection_*
  selection_apt:
    CommandLine|contains:
    - remove
    - purge
    Image|endswith:
    - /apt
    - /apt-get
  selection_dpkg:
    CommandLine|contains:
    - '--remove '
    - ' -r '
    Image|endswith: /dpkg
  selection_rpm:
    CommandLine|contains: ' -e '
    Image|endswith: /rpm
  selection_yum:
    CommandLine|contains:
    - erase
    - remove
    Image|endswith: /yum
- condition: selection
  selection:
    CommandLine|contains:
    - ' ash'
    - ' bash'
    - ' bsh'
    - ' csh'
    - ' ksh'
    - ' pdksh'
    - ' sh'
    - ' tcsh'
    CommandLine|contains|all:
    - ' -e'
    - rsocket
    - TCPSocket
    Image|contains: ruby
- condition: selection
  selection:
    CommandLine|contains: /tmp/
    Image|endswith: crontab
- condition: selection
  selection:
    CommandLine|contains:
    - nessusd
    - td-agent
    - packetbeat
    - filebeat
    - auditbeat
    - osqueryd
    - cbagentd
    - falcond
    Image|endswith:
    - /grep
    - /egrep
- condition: 1 of selection*
  selection_carbonblack_1:
    CommandLine|contains|all:
    - cbdaemon
    - stop
    Image|endswith: /service
  selection_carbonblack_2:
    CommandLine|contains|all:
    - cbdaemon
    - 'off'
    Image|endswith: /chkconfig
  selection_carbonblack_3:
    CommandLine|contains|all:
    - cbdaemon
    - stop
    Image|endswith: /systemctl
  selection_carbonblack_4:
    CommandLine|contains|all:
    - cbdaemon
    - disable
    Image|endswith: /systemctl
  selection_crowdstrike_1:
    CommandLine|contains|all:
    - stop
    - falcon-sensor
    Image|endswith: /systemctl
  selection_crowdstrike_2:
    CommandLine|contains|all:
    - disable
    - falcon-sensor
    Image|endswith: /systemctl
  selection_firewall_1:
    CommandLine|contains|all:
    - firewalld
    - stop
    Image|endswith: /systemctl
  selection_firewall_2:
    CommandLine|contains|all:
    - firewalld
    - disable
    Image|endswith: /systemctl
  selection_iptables_1:
    CommandLine|contains|all:
    - iptables
    - stop
    Image|endswith: /service
  selection_iptables_2:
    CommandLine|contains|all:
    - ip6tables
    - stop
    Image|endswith: /service
  selection_iptables_3:
    CommandLine|contains|all:
    - iptables
    - stop
    Image|endswith: /chkconfig
  selection_iptables_4:
    CommandLine|contains|all:
    - ip6tables
    - stop
    Image|endswith: /chkconfig
  selection_selinux:
    CommandLine|contains: '0'
    Image|endswith: /setenforce
- condition: selection
  selection:
    CommandLine|contains:
    - stop
    - disable
    Image|endswith:
    - /service
    - /systemctl
    - /chkconfig
- condition: all of selection_*
  selection_perm:
    CommandLine|contains:
    - ' chmod u+s'
    - ' chmod g+s'
  selection_root:
    CommandLine|contains: chown root
- condition: selection
  selection:
    CommandLine|contains: ' -u#'
- condition: selection
  selection:
    CommandLine|contains:
    - /tmp/
    - /.Library/
    - /etc/
    - /opt/
    Image|endswith: /chmod
- condition: all of selection_* and not 1 of filter_optional_*
  filter_optional_localhost:
    CommandLine|contains:
    - ://localhost
    - ://127.0.0.1
  selection_cli:
  - CommandLine|contains:
    - ' --form'
    - ' --upload-file '
    - ' --data '
    - ' --data-'
  - CommandLine|re: \s-[FTd]\s
  selection_img:
    Image|endswith: /curl
- condition: selection
  selection:
    CommandLine|contains:
    - ' -A '
    - ' --user-agent '
    Image|endswith: /curl
- condition: selection
  selection:
    Image|startswith: /tmp/
- condition: selection
  selection:
    CommandLine|contains:
    - -perm -4000
    - -perm -2000
    - -perm 0777
    - -perm -222
    - -perm -o w
    - -perm -o x
    - -perm -u=s
    - -perm -g=s
    Image|endswith: /find
- condition: all of selection_*
  selection_img:
    CommandLine|contains: ' clone '
    Image|endswith: /git
  selection_keyword:
    CommandLine|contains:
    - exploit
    - Vulns
    - vulnerability
    - RCE
    - RemoteCodeExecution
    - Invoke-
    - CVE-
    - poc-
    - ProofOfConcept
    - proxyshell
    - log4shell
    - eternalblue
    - eternal-blue
    - MS17-
- condition: all of selection*
  selection:
    Image|endswith:
    - /rm
    - /unlink
    - /shred
  selection_history:
  - CommandLine|contains:
    - /.bash_history
    - /.zsh_history
  - CommandLine|endswith:
    - _history
    - .history
    - zhistory
- condition: all of selection*
  selection:
    Image|endswith:
    - /cat
    - /head
    - /tail
    - /more
  selection_history:
  - CommandLine|contains:
    - /.bash_history
    - /.zsh_history
  - CommandLine|endswith:
    - _history
    - .history
    - zhistory
- anomaly1:
    CommandLine|contains:
    - '-c import '
    - base64
    - pty.spawn
  anomaly2:
    Image|endswith:
    - whoami
    - iptables
    - /ncat
    - /nc
    - /netcat
  condition: selection and 1 of anomaly*
  selection:
    ParentCommandLine: bash -i
- condition: selection
  selection:
    CommandLine|contains:
    - /bin/sh
    - bash
    - dash
    - ksh
    - zsh
    - csh
    - fish
    - curl
    - wget
    - python
    ParentImage|endswith: /java
- condition: all of selection*
  selection:
    CommandLine|startswith:
    - 'sh -c '
    - 'bash -c '
  selection_exec:
  - CommandLine|contains:
    - '| bash '
    - '| sh '
    - '|bash '
    - '|sh '
  - CommandLine|endswith:
    - '| bash'
    - '| sh'
    - '|bash'
    - ' |sh'
- condition: selection
  selection:
    CommandLine|contains:
    - ' -name .htpasswd'
    - ' -perm -4000 '
- condition: 1 of selection_img_* and selection_paths
  selection_img_1:
    CommandLine|contains: '>'
    Image|endswith:
    - /cat
    - /echo
    - /grep
    - /head
    - /more
    - /tail
  selection_img_2:
    Image|endswith:
    - /emacs
    - /nano
    - /sed
    - /vi
    - /vim
  selection_paths:
    CommandLine|contains:
    - /bin/login
    - /bin/passwd
    - /boot/
    - /etc/*.conf
    - /etc/cron.
    - /etc/crontab
    - /etc/hosts
    - /etc/init.d
    - /etc/sudoers
    - /opt/bin/
    - /sbin
    - /usr/bin/
    - /usr/local/bin/
- condition: selection
  selection:
    Image|endswith:
    - /bash
    - /csh
    - /dash
    - /fish
    - /ksh
    - /sh
    - /zsh
    ParentImage|startswith: /tmp/
- condition: all of selection_*
  selection_flag:
    CommandLine|contains: ' -c '
  selection_img:
    Image|endswith:
    - /bash
    - /csh
    - /dash
    - /fish
    - /ksh
    - /sh
    - /zsh
  selection_paths:
    CommandLine|contains: /tmp/
- condition: selection
  selection:
    Image|endswith:
    - /uname
    - /hostname
    - /uptime
    - /lspci
    - /dmidecode
    - /lscpu
    - /lsmod
- condition: selection and not 1 of filter_*
  filter_landscape_sysinfo:
    Image|endswith: /who
    ParentCommandLine|contains: /usr/bin/landscape-sysinfo
  selection:
    Image|endswith:
    - /who
    - /w
    - /last
    - /lsof
    - /netstat
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains: /etc/resolv.conf
  selection_img:
    Image|endswith:
    - /firewall-cmd
    - /ufw
    - /iptables
    - /netstat
    - /ss
    - /ip
    - /ifconfig
    - /systemd-resolve
    - /route
- condition: selection
  selection:
    CommandLine|contains: ' -t '
    CommandLine|endswith: .service
    Image|endswith: /touch
- condition: selection
  selection:
    CommandLine|contains: execve_hijack
    Image|endswith: /sudo
- condition: selection
  selection:
    CommandLine|contains:
    - ' qdisc '
    - ' filter '
    CommandLine|contains|all:
    - ' tc '
    - ' enp0s3 '
    Image|endswith: /sudo
- condition: selection
  selection:
    Image|endswith: /userdel
- condition: selection
  selection:
    CommandLine|contains:
    - -aG root
    - -aG sudoers
    Image|endswith: /usermod
- condition: 1 of selection_* and sub_processes
  selection_general:
    ParentImage|endswith:
    - /httpd
    - /lighttpd
    - /nginx
    - /apache2
    - /node
    - /caddy
  selection_tomcat:
    ParentCommandLine|contains|all:
    - /bin/java
    - tomcat
  selection_websphere:
    ParentCommandLine|contains|all:
    - /bin/java
    - websphere
  sub_processes:
    Image|endswith:
    - /whoami
    - /ifconfig
    - /ip
    - /bin/uname
    - /bin/cat
    - /bin/crontab
    - /hostname
    - /iptables
    - /netstat
    - /pwd
    - /route
- condition: all of selection_*
  selection_img:
    Image|endswith: /wget
  selection_output:
  - CommandLine|re: \s-O\s
  - CommandLine|contains: --output-files
  selection_path:
    CommandLine|contains: /tmp/
- condition: selection
  selection:
    CommandLine|contains: -display
    CommandLine|endswith: :1
    Image|contains: xterm
- condition: 1 of selection_*
  selection_1:
    TargetFilename|contains: /etc/emond.d/rules/
    TargetFilename|endswith: .plist
  selection_2:
    TargetFilename|contains: /private/var/db/emondClients/
- condition: selection
  selection:
  - TargetFilename|contains: /Library/StartupItems/
  - TargetFilename|endswith: .plist
- condition: 1 of selection_*
  selection_dscl:
    CommandLine|contains|all:
    - ' -append '
    - ' /Groups/admin '
    - ' GroupMembership '
    Image|endswith: /dscl
  selection_sysadminctl:
    CommandLine|contains|all:
    - ' -addUser '
    - ' -admin '
    Image|endswith: /sysadminctl
- condition: selection
  selection:
    CommandLine|contains:
    - ' -e '
    - .scpt
    - .js
    Image|endswith: /osascript
- condition: selection
  selection:
    CommandLine|contains: -d
    Image: /usr/bin/base64
- condition: 1 of selection_*
  selection_dd:
    CommandLine|contains:
    - if=/dev/zero
    - if=/dev/random
    - if=/dev/urandom
    Image|endswith: /dd
  selection_truncate:
    CommandLine|contains: -s +
    Image|endswith: /truncate
- condition: selection
  selection:
    CommandLine|contains:
    - -t
    - -acmr
    - -d
    - -r
    Image|endswith: /touch
- condition: selection1 and 1 of selection_cli*
  selection1:
    Image|endswith:
    - /rm
    - /unlink
    - /shred
  selection_cli_1:
    CommandLine|contains: /var/log
  selection_cli_2:
    CommandLine|contains|all:
    - /Users/
    - /Library/Logs/
- condition: selection
  selection:
    CommandLine|contains|all:
    - osascript
    - ' -e '
    - clipboard
- condition: 1 of selection_*
  selection_dscl:
    CommandLine|contains: create
    Image|endswith: /dscl
  selection_sysadminctl:
    CommandLine|contains: addUser
    Image|endswith: /sysadminctl
- condition: dscl_create and id_below_500 or dscl_create and (ishidden_option_declaration
    and ishidden_option_confirmation)
  dscl_create:
    CommandLine|contains: create
    Image|endswith: /dscl
  id_below_500:
    CommandLine|contains: UniqueID
    CommandLine|re: ([0-9]|[1-9][0-9]|[1-4][0-9]{2})
  ishidden_option_confirmation:
    CommandLine|contains:
    - 'true'
    - 'yes'
    - '1'
  ishidden_option_declaration:
    CommandLine|contains: IsHidden
- condition: 1 of selection*
  selection1:
    CommandLine|contains:
    - find-certificate
    - ' export '
    Image: /usr/bin/security
  selection2:
    CommandLine|contains:
    - ' dump-keychain '
    - ' login-keychain '
- condition: (launchctl_unload and security_plists) or disable_gatekeeper
  disable_gatekeeper:
    CommandLine|contains: disable
    Image: /usr/sbin/spctl
  launchctl_unload:
    CommandLine|contains: unload
    Image: /bin/launchctl
  security_plists:
    CommandLine|contains:
    - com.objective-see.lulu.plist
    - com.objective-see.blockblock.plist
    - com.google.santad.plist
    - com.carbonblack.defense.daemon.plist
    - com.carbonblack.daemon.plist
    - at.obdev.littlesnitchd.plist
    - com.tenablesecurity.nessusagent.plist
    - com.opendns.osx.RoamingClientConfigUpdater.plist
    - com.crowdstrike.falcond.plist
    - com.crowdstrike.userdaemon.plist
    - osquery
    - filebeat
    - auditbeat
    - packetbeat
    - td-agent
- condition: 1 of select*
  select_file_with_asterisk:
    CommandLine|re: (.){200,}
    Image: /usr/bin/file
  select_find_execution:
    Image: /usr/bin/find
  select_mdfind_execution:
    Image: /usr/bin/mdfind
  select_recursive_ls:
    CommandLine|contains: -R
    Image: /bin/ls
  select_tree_execution|endswith:
    Image: /tree
- condition: 1 of selection*
  selection1:
    CommandLine|contains: password
    Image|endswith: /grep
  selection2:
    CommandLine|contains: laZagne
- condition: all of selection*
  selection1:
    Image: /usr/sbin/osascript
  selection2:
    CommandLine|contains|all:
    - -e
    - display
    - dialog
    - answer
  selection3:
    CommandLine|contains:
    - admin
    - administrator
    - authenticate
    - authentication
    - credentials
    - pass
    - password
    - unlock
- condition: selection_installer
  selection_installer:
    CommandLine|contains:
    - preinstall
    - postinstall
    Image|endswith:
    - /sh
    - /bash
    - /dash
    - /python
    - /ruby
    - /perl
    - /php
    - /javascript
    - /osascript
    - /tclsh
    - /curl
    - /wget
    ParentImage|endswith:
    - /package_script_service
    - /installer
- condition: all of selection_*
  selection_js:
  - CommandLine|contains|all:
    - ' -l '
    - JavaScript
  - CommandLine|contains: .js
  selection_main:
    CommandLine|contains|all:
    - osascript
    - ' -e '
    - eval
    - NSData.dataWithContentsOfURL
- condition: 1 of selection*
  selection_1:
    CommandLine|contains|all:
    - list
    - /users
    Image|endswith: /dscl
  selection_2:
    CommandLine|contains|all:
    - -q
    - user
    Image|endswith: /dscacheutil
  selection_3:
    CommandLine|contains: '''x:0:'''
  selection_4:
    CommandLine|contains:
    - /etc/passwd
    - /etc/sudoers
    Image|endswith: /cat
  selection_5:
    Image|endswith: /id
  selection_6:
    CommandLine|contains: -u
    Image|endswith: /lsof
- condition: 1 of selection*
  selection_1:
    CommandLine|contains|all:
    - -q
    - group
    Image|endswith: /dscacheutil
  selection_2:
    CommandLine|contains: /etc/group
    Image|endswith: /cat
  selection_3:
    CommandLine|contains|all:
    - -list
    - /groups
    Image|endswith: /dscl
- condition: (selection_1 and not filter) or selection_2
  filter:
    CommandLine|contains: l
  selection_1:
    Image|endswith:
    - /nc
    - /netcat
  selection_2:
    Image|endswith:
    - /nmap
    - /telnet
- condition: selection
  selection:
    Image|endswith:
    - /tcpdump
    - /tshark
- condition: selection
  selection:
    Image|endswith:
    - /bash
    - /curl
    - /dash
    - /fish
    - /osacompile
    - /osascript
    - /sh
    - /zsh
    - /python
    - /python3
    - /wget
    ParentImage|contains:
    - Microsoft Word
    - Microsoft Excel
    - Microsoft PowerPoint
    - Microsoft OneNote
- condition: selection
  selection:
    CommandLine|contains|all:
    - osacompile
    - ' -x '
    - ' -e '
- condition: selection
  selection:
    CommandLine|contains|all:
    - /Volumes/
    - enc
    - -base64
    - ' -d '
    Image|endswith: /openssl
- condition: selection
  selection:
    CommandLine|contains:
    - LaunchAgents
    - LaunchDaemons
    CommandLine|contains|all:
    - RunAtLoad
    - 'true'
    Image|endswith: /PlistBuddy
- condition: selection
  selection:
    CommandLine|contains: /tmp/
    Image|endswith: /crontab
- condition: selection
  selection:
    Image: /usr/sbin/screencapture
- condition: image and 1 of selection_cli_*
  image:
    Image: /usr/bin/grep
  selection_cli_1:
    CommandLine|contains:
    - nessusd
    - santad
    - CbDefense
    - falcond
    - td-agent
    - packetbeat
    - filebeat
    - auditbeat
    - osqueryd
    - BlockBlock
    - LuLu
  selection_cli_2:
    CommandLine|contains|all:
    - Little
    - Snitch
- condition: 1 of selection*
  selection1:
    CommandLine|endswith: ' '
  selection2:
    Image|endswith: ' '
- condition: selection
  selection:
    Image|endswith: /split
- condition: selection
  selection:
    CommandLine|contains: osacompile
    ParentImage|endswith:
    - /applet
    - /osascript
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_chrome:
    CommandLine|contains:
    - /Volumes/Google Chrome/Google Chrome.app/Contents/Frameworks/*/Resources/install.sh
    - /Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/*/Resources/keystone_promote_preflight.sh
    - /Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/*/Resources/keystone_promote_postflight.sh
    ParentImage|contains:
    - Google Chrome Helper
    - Google Chrome
  filter_main_chromerecovery:
    CommandLine|contains|all:
    - /Users/
    - /Library/Application Support/Google/Chrome/recovery/
    - /ChromeRecovery
    ParentImage|contains:
    - Google Chrome Helper
    - Google Chrome
  filter_main_generic:
    CommandLine|contains: --defaults-torrc
  filter_main_ms_autoupdate:
    CommandLine|contains: /Library/Application Support/Microsoft/MAU*/Microsoft AutoUpdate.app/Contents/MacOS/msupdate
  filter_main_ms_edge:
    CommandLine|contains:
    - IOPlatformExpertDevice
    - hw.model
    ParentImage|contains: Microsoft Edge
  filter_optional_empty:
    CommandLine: ''
  filter_optional_null:
    CommandLine: null
  selection:
    Image|endswith:
    - /bash
    - /curl
    - /dash
    - /ksh
    - /osascript
    - /perl
    - /php
    - /pwsh
    - /python
    - /sh
    - /tcsh
    - /wget
    - /zsh
    ParentImage|contains:
    - com.apple.WebKit.WebContent
    - firefox
    - Google Chrome Helper
    - Google Chrome
    - Microsoft Edge
    - Opera
    - Safari
    - Tor Browser
- condition: all of selection_*
  selection_img:
  - Image|endswith:
    - /curl
    - /bash
    - /sh
    - /zsh
    - /dash
    - /fish
    - /osascript
    - /mktemp
    - /chmod
    - /php
    - /nohup
    - /openssl
    - /plutil
    - /PlistBuddy
    - /xattr
    - /sqlite
    - /funzip
    - /popen
  - Image|contains:
    - python
    - perl
  selection_parent:
    ParentImage|endswith: /Script Editor
- condition: selection
  selection:
    CommandLine|contains:
    - .bash_history
    - .zsh_history
    - .zhistory
    - .history
    - .sh_history
    - fish_history
- condition: selection1
  selection1:
    CommandLine|contains:
    - setpasswd
    - full
    - delete
    - check
    Image: /usr/sbin/firmwarepasswd
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' -guestAccount'
    - ' on'
    Image|endswith: /sysadminctl
- condition: selection
  selection:
    Image|endswith:
    - /who
    - /w
    - /last
    - /lsof
    - /netstat
- condition: 1 of selection*
  selection1:
    Image|endswith:
    - /netstat
    - /ifconfig
    - /socketfilterfw
    - /networksetup
    - /arp
  selection2:
    CommandLine|contains|all:
    - read
    - /Library/Preferences/com.apple.alf
    Image: /usr/bin/defaults
- condition: selection
  selection:
    Image|endswith:
    - /shutdown
    - /reboot
    - /halt
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains|all:
    - '=$(curl '
    - eval
    Image|endswith: /sh
  selection_2:
    CommandLine|contains: _intermediate_agent_
    Image|endswith: /curl
- condition: selection
  selection:
    CommandLine|contains|all:
    - -r
    - com.apple.quarantine
    Image|endswith: /xattr
- condition: all of selection_1_* or 1 of selection_other_*
  selection_1_curl:
    CommandLine|contains:
    - /sys/log.php
    - /sys/prepod.php
    - /sys/bin/Pods
    Image|endswith: /curl
    ParentImage|endswith: /bash
  selection_1_https:
    CommandLine|contains: https://
  selection_other_1:
    CommandLine|contains|all:
    - /Users/
    - /Library/Group Containers/
    Image|endswith: /osacompile
    ParentImage|endswith: /bash
  selection_other_2:
    CommandLine|contains|all:
    - LSUIElement
    - /Users/
    - /Library/Group Containers/
    Image|endswith: /plutil
    ParentImage|endswith: /bash
  selection_other_3:
    CommandLine|contains|all:
    - -r
    - /Users/
    - /Library/Group Containers/
    Image|endswith: /zip
- condition: keywords
  keywords:
  - clear logging
  - clear archive
- condition: keywords
  keywords:
  - show running-config
  - show startup-config
  - show archive config
  - more
- condition: keywords
  keywords:
  - crypto pki export
  - crypto pki import
  - crypto pki trustpoint
- condition: keywords
  keywords:
  - no logging
  - no aaa new-model
- condition: keywords
  keywords:
  - dir
  - show processes
  - show arp
  - show cdp
  - show version
  - show ip route
  - show ip interface
  - show ip sockets
  - show users
  - show ssh
  - show clock
- condition: keywords
  keywords:
  - shutdown
  - config-register 0x2100
  - config-register 0x2142
- condition: keywords
  keywords:
  - erase
  - delete
  - format
- condition: keywords
  keywords:
  - show history
  - show history all
  - show logging
- condition: keywords
  keywords:
  - username
  - aaa
- condition: keywords
  keywords:
  - ip http server
  - ip https server
  - kron policy-list
  - kron occurrence
  - policy-list
  - access-list
  - ip access-group
  - archive maximum
- condition: keywords
  keywords:
  - tftp
  - rcp
  - puts
  - copy
  - configure replace
  - archive tar
- condition: keywords
  keywords:
  - monitor capture point
  - set span
  - set rspan
- condition: keywords_bgp_cisco
  keywords_bgp_cisco:
    '|all':
    - :179
    - IP-TCP-3-BADAUTH
- condition: selection_protocol and selection_keywords
  selection_keywords:
  - SOCKET_TCP_PACKET_MD5_AUTHEN_FAIL
  - TCPMD5AuthenFail
  selection_protocol:
  - LDP
- condition: selection
  selection:
    query|contains:
    - .interact.sh
    - .oast.pro
    - .oast.live
    - .oast.site
    - .oast.online
    - .oast.fun
    - .oast.me
    - .burpcollaborator.net
    - .oastify.com
    - .canarytokens.com
    - .requestbin.net
    - .dnslog.cn
- condition: 1 of selection*
  selection1:
    query|startswith:
    - aaa.stage.
    - post.1
  selection2:
    query|contains: .stage.123456.
- condition: selection
  selection:
    query|contains:
    - pool.minexmr.com
    - fr.minexmr.com
    - de.minexmr.com
    - sg.minexmr.com
    - ca.minexmr.com
    - us-west.minexmr.com
    - pool.supportxmr.com
    - mine.c3pool.com
    - xmr-eu1.nanopool.org
    - xmr-eu2.nanopool.org
    - xmr-us-east1.nanopool.org
    - xmr-us-west1.nanopool.org
    - xmr-asia1.nanopool.org
    - xmr-jp1.nanopool.org
    - xmr-au1.nanopool.org
    - xmr.2miners.com
    - xmr.hashcity.org
    - xmr.f2pool.com
    - xmrpool.eu
    - pool.hashvault.pro
- condition: selection
  selection:
    query|contains: ==.
- condition: selection
  selection:
    query: api.telegram.org
- condition: selection
  selection:
    answer|contains:
    - IEX
    - Invoke-Expression
    - cmd.exe
    record_type: TXT
- condition: selection
  selection:
    query:
    - ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.testing
    - ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.test
    - ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.com
    - ayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf.com
    - iuqssfsodp9ifjaposdfjhgosurijfaewrwergwea.com
- condition: 1 of select*
  select_incoming:
    src_ip:
    - 69.42.98.86
    - 89.185.234.145
  select_outgoing:
    dst_ip:
    - 69.42.98.86
    - 89.185.234.145
- condition: selection and 1 of selection_allow*
  selection:
    dst_port:
    - 8080
    - 21
    - 80
    - 23
    - 50000
    - 1521
    - 27017
    - 3306
    - 1433
    - 11211
    - 15672
    - 5900
    - 5901
    - 5902
    - 5903
    - 5904
  selection_allow1:
    action:
    - forward
    - accept
    - 2
  selection_allow2:
    blocked: 'false'
- condition: keywords_bgp_huawei
  keywords_bgp_huawei:
    '|all':
    - :179
    - BGP_AUTH_FAILED
- condition: keywords_bgp_juniper
  keywords_bgp_juniper:
    '|all':
    - :179
    - missing MD5 digest
- condition: 1 of op*
  op1:
    endpoint: JobAdd
    operation: atsvc
  op10:
    endpoint: svcctl
    operation: StartServiceW
  op2:
    endpoint: ITaskSchedulerService
    operation: SchRpcEnableTask
  op3:
    endpoint: ITaskSchedulerService
    operation: SchRpcRegisterTask
  op4:
    endpoint: ITaskSchedulerService
    operation: SchRpcRun
  op5:
    endpoint: IWbemServices
    operation: ExecMethod
  op6:
    endpoint: IWbemServices
    operation: ExecMethodAsync
  op7:
    endpoint: svcctl
    operation: CreateServiceA
  op8:
    endpoint: svcctl
    operation: CreateServiceW
  op9:
    endpoint: svcctl
    operation: StartServiceA
- condition: 1 of op*
  op1:
    endpoint: spoolss
    operation: RpcAddMonitor
  op2:
    endpoint: spoolss
    operation: RpcAddPrintProcessor
  op3:
    endpoint: IRemoteWinspool
    operation: RpcAsyncAddMonitor
  op4:
    endpoint: IRemoteWinspool
    operation: RpcAsyncAddPrintProcessor
  op5:
    endpoint: ISecLogon
    operation: SeclCreateProcessWithLogonW
  op6:
    endpoint: ISecLogon
    operation: SeclCreateProcessWithLogonExW
- condition: selection
  selection:
    operation|startswith: efs
- condition: selection
  selection:
    operation:
    - RpcAsyncInstallPrinterDriverFromPackage
    - RpcAsyncAddPrintProcessor
    - RpcAddPrintProcessor
    - RpcAddPrinterDriverEx
    - RpcAddPrinterDriver
    - RpcAsyncAddPrinterDriver
- condition: selection
  selection:
    name: spoolss
    path|endswith: IPC$
- condition: selection
  selection:
    certificate.serial: 8BB00EE
- condition: selection and not 1 of exclude_*
  exclude_answers:
    answers:
    - 127.0.0.1
    - 0.0.0.0
  exclude_rejected:
    rejected: 'true'
  selection:
    query|endswith:
    - monerohash.com
    - do-dear.com
    - xmrminerpro.com
    - secumine.net
    - xmrpool.com
    - minexmr.org
    - hashanywhere.com
    - xmrget.com
    - mininglottery.eu
    - minergate.com
    - moriaxmr.com
    - multipooler.com
    - moneropools.com
    - xmrpool.eu
    - coolmining.club
    - supportxmr.com
    - minexmr.com
    - hashvault.pro
    - xmrpool.net
    - crypto-pool.fr
    - xmr.pt
    - miner.rocks
    - walpool.com
    - herominers.com
    - gntl.co.uk
    - semipool.com
    - coinfoundry.org
    - cryptoknight.cc
    - fairhash.org
    - baikalmine.com
    - tubepool.xyz
    - fairpool.xyz
    - asiapool.io
    - coinpoolit.webhop.me
    - nanopool.org
    - moneropool.com
    - miner.center
    - prohash.net
    - poolto.be
    - cryptoescrow.eu
    - monerominers.net
    - cryptonotepool.org
    - extrmepool.org
    - webcoin.me
    - kippo.eu
    - hashinvest.ws
    - monero.farm
    - linux-repository-updates.com
    - 1gh.com
    - dwarfpool.com
    - hash-to-coins.com
    - pool-proxy.com
    - hashfor.cash
    - fairpool.cloud
    - litecoinpool.org
    - mineshaft.ml
    - abcxyz.stream
    - moneropool.ru
    - cryptonotepool.org.uk
    - extremepool.org
    - extremehash.com
    - hashinvest.net
    - unipool.pro
    - crypto-pools.org
    - monero.net
    - backup-pool.com
    - mooo.com
    - freeyy.me
    - cryptonight.net
    - shscrypto.net
- condition: selection
  selection:
    query|contains|all:
    - seed
    - .nkn.org
- condition: not z_flag_unset and most_probable_valid_domain and not (exclude_tlds
    or exclude_query_types or exclude_responses or exclude_netbios)
  exclude_netbios:
    id.resp_p:
    - 137
    - 138
    - 139
  exclude_query_types:
    qtype_name:
    - ns
    - mx
  exclude_responses:
    answers|endswith: \\x00
  exclude_tlds:
    query|endswith:
    - .arpa
    - .local
    - .ultradns.net
    - .twtrdns.net
    - .azuredns-prd.info
    - .azure-dns.com
    - .azuredns-ff.info
    - .azuredns-ff.org
    - .azuregov-dns.org
  most_probable_valid_domain:
    query|contains: .
  z_flag_unset:
    Z: 0
- condition: selection
  selection:
    query:
    - tor2web.org
    - tor2web.com
    - torlink.co
    - onion.to
    - onion.ink
    - onion.cab
    - onion.nu
    - onion.link
    - onion.it
    - onion.city
    - onion.direct
    - onion.top
    - onion.casa
    - onion.plus
    - onion.rip
    - onion.dog
    - tor2web.fi
    - tor2web.blutmagie.de
    - onion.sh
    - onion.lu
    - onion.pet
    - t2w.pw
    - tor2web.ae.org
    - tor2web.io
    - tor2web.xyz
    - onion.lt
    - s1.tor-gateways.de
    - s2.tor-gateways.de
    - s3.tor-gateways.de
    - s4.tor-gateways.de
    - s5.tor-gateways.de
    - hiddenservice.net
- condition: selection_webdav and selection_executable
  selection_executable:
  - resp_mime_types|contains: dosexec
  - c-uri|endswith: .exe
  selection_webdav:
  - c-useragent|contains: WebDAV
  - c-uri|contains: webdav
- auth_header:
    client_header_names|contains: AUTHORIZATION
  condition: selection and not auth_header and not too_small_http_client_body
  selection:
    method: POST
    status_code: 200
    uri: /wsman
  too_small_http_client_body:
    request_body_len: 0
- condition: selection and not filter
  filter:
    id.resp_h:
    - 192.168.0.0/16
    - 172.16.0.0/12
    - 10.0.0.0/8
  selection:
    method: PUT
    user_agent|contains: WebDAV
- condition: not selection
  selection:
    id.orig_h|startswith:
    - 192.168.
    - '10.'
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - fd
    - 2620:83:800f
- condition: selection
  selection:
    name: atsvc
    path: \\\*\IPC$
- condition: selection
  selection:
    name|contains: SYSTEM32\
    name|endswith: .tmp
    path|contains|all:
    - \
    - ADMIN$
- condition: selection and not 1 of filter_*
  filter_keywords:
  - samr
  - lsarpc
  - winreg
  - netlogon
  - srvsvc
  - protected_storage
  - wkssvc
  - browser
  - netdfs
  - svcctl
  - spoolss
  - ntsvcs
  - LSM_API_service
  - HydraLsPipe
  - TermSrv_API_service
  - MsFteWds
  selection:
    path: \\\\\*\\IPC$
- condition: selection and not filter
  filter:
    name|startswith: PSEXESVC
  selection:
    name|endswith:
    - -stdin
    - -stdout
    - -stderr
    path|contains|all:
    - \\
    - \IPC$
- condition: selection
  selection:
    name|endswith:
    - .pst
    - .ost
    - .msg
    - .nst
    - .oab
    - .edb
    - .nsf
    - .bak
    - .dmp
    - .kirbi
    - \groups.xml
    - .rdp
- condition: selection
  selection:
    name:
    - \mimidrv
    - \lsass
    - \windows\minidump\
    - \hiberfil
    - \sqldmpr
    - \sam
    - \ntds.dit
    - \security
- computer_acct:
    service|startswith: $
  condition: selection and not computer_acct
  selection:
    cipher: rc4-hmac
    request_type: TGS
- condition: keywords
  keywords:
  - exit signal Segmentation Fault
- condition: keywords
  keywords:
  - '__pthread_tpp_change_priority: Assertion `new_prio == -1 || (new_prio >= fifo_min_prio
    && new_prio <= fifo_max_prio)'
- condition: keywords
  keywords:
  - exited on signal 6 (core dumped)
- condition: selection
  selection:
    c-uri-query|contains|all:
    - lng=
    - ver=
    - beta=
    - type=
    - rmode=
    - product=
    c-uri|contains: /checkupdate.php
- condition: selection
  selection:
    c-useragent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like
      Gecko) Chrome/36.0.1985.143 Safari/537.36
    cs-host: api.dropbox.com
- condition: selection
  selection:
    c-uri|contains: momyshark\?key=
- condition: selection
  selection:
    c-uri|contains: /asp.asp\?ui=
- condition: 1 of selection*
  selection1:
    c-uri: /s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books
    c-useragent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko
    cs-cookie|endswith: =csm-hit=s-24KU11BB82RZSYGJ3BDK|1419899012996
    cs-host: www.amazon.com
    cs-method: GET
  selection2:
    c-uri: /N4215/adj/amzn.us.sr.aps
    c-useragent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko
    cs-host: www.amazon.com
    cs-method: POST
- condition: 1 of selection*
  selection1:
    c-useragent:
    - Mozilla/4.0 (compatible; MSIE 6.0;Windows NT 5.1)
    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2;
      .NET CLR 3.0.30729; .NET4.0C; .NET4.0E )
    - Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 5.2) Java/1.5.0_08
  selection2:
    c-useragent|endswith: ; MANM; MANM)
- condition: selection
  selection:
    c-uri|contains: /oscp/
    cs-host: ocsp.verisign.com
- condition: selection and not filter
  filter:
    c-uri|contains: ://onedrive.live.com/
    c-uri|startswith: http
  selection:
    c-uri|endswith: \?manifest=wac
    cs-host: onedrive.live.com
    cs-method: GET
- condition: selection
  selection:
    c-useragent|startswith: Microsoft-WebDAV-MiniRedir/
    cs-method: GET
- condition: selection
  selection:
    c-uri-extension:
    - exe
    - vbs
    - bat
    - rar
    - ps1
    - files
    - docm
    - xls
    - xlsm
    - pptm
    - rtf
    - hta
    - dll
    - ws
    - wsf
    - sct
    - zip
    cs-host|endswith:
    - .hopto.org
    - .no-ip.org
    - .no-ip.info
    - .no-ip.biz
    - .no-ip.com
    - .noip.com
    - .ddns.name
    - .myftp.org
    - .myftp.biz
    - .serveblog.net
    - .servebeer.com
    - .servemp3.com
    - .serveftp.com
    - .servequake.com
    - .servehalflife.com
    - .servehttp.com
    - .servegame.com
    - .servepics.com
    - .myvnc.com
    - .ignorelist.com
    - .jkub.com
    - .dlinkddns.com
    - .jumpingcrab.com
    - .ddns.info
    - .mooo.com
    - .dns-dns.com
    - .strangled.net
    - .adultdns.net
    - .craftx.biz
    - .ddns01.com
    - .dns53.biz
    - .dnsapi.info
    - .dnsd.info
    - .dnsdynamic.com
    - .dnsdynamic.net
    - .dnsget.org
    - .fe100.net
    - .flashserv.net
    - .ftp21.net
    - .http01.com
    - .http80.info
    - .https443.com
    - .imap01.com
    - .kadm5.com
    - .mysq1.net
    - .ns360.info
    - .ntdll.net
    - .ole32.com
    - .proxy8080.com
    - .sql01.com
    - .ssh01.com
    - .ssh22.net
    - .tempors.com
    - .tftpd.net
    - .ttl60.com
    - .ttl60.org
    - .user32.com
    - .voip01.com
    - .wow64.net
    - .x64.me
    - .xns01.com
    - .dyndns.org
    - .dyndns.info
    - .dyndns.tv
    - .dyndns-at-home.com
    - .dnsomatic.com
    - .zapto.org
    - .webhop.net
    - .25u.com
    - .slyip.net
- condition: selection
  selection:
    c-uri-extension:
    - exe
    - vbs
    - bat
    - rar
    - ps1
    - files
    - docm
    - xls
    - xlsm
    - pptm
    - rtf
    - hta
    - dll
    - ws
    - wsf
    - sct
    - zip
    cs-host|endswith:
    - .country
    - .stream
    - .gdn
    - .mom
    - .xin
    - .kim
    - .men
    - .loan
    - .download
    - .racing
    - .online
    - .science
    - .ren
    - .gb
    - .win
    - .top
    - .review
    - .vip
    - .party
    - .tech
    - .xyz
    - .date
    - .faith
    - .zip
    - .cricket
    - .space
    - .info
    - .vn
    - .cm
    - .am
    - .cc
    - .asia
    - .ws
    - .tk
    - .biz
    - .su
    - .st
    - .ro
    - .ge
    - .ms
    - .pk
    - .nu
    - .me
    - .ph
    - .to
    - .tt
    - .name
    - .tv
    - .kz
    - .tc
    - .mobi
    - .study
    - .click
    - .link
    - .trade
    - .accountant
    - .cf
    - .gq
    - .ml
    - .ga
    - .pw
- condition: selection and not filter
  filter:
    cs-host|endswith:
    - .com
    - .org
    - .net
    - .edu
    - .gov
    - .uk
    - .ca
    - .de
    - .jp
    - .fr
    - .au
    - .us
    - .ch
    - .it
    - .nl
    - .se
    - .no
    - .es
  selection:
    c-uri-extension:
    - exe
    - vbs
    - bat
    - rar
    - ps1
    - files
    - docm
    - xls
    - xlsm
    - pptm
    - rtf
    - hta
    - dll
    - ws
    - wsf
    - sct
    - zip
- condition: selection
  selection:
    c-useragent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko
    cs-method: POST
    cs-uri:
    - /admin/get.php
    - /news.php
    - /login/process.php
- condition: selection
  selection:
    c-useragent: ''
- condition: selection and not filter
  filter:
    c-useragent:
    - ClientInfo
    - Microsoft WinRM Client
    - Exchange BackEnd Probes
  selection:
    c-uri|contains:
    - '@'
    - '%40'
    c-uri|contains|all:
    - /owa/
    - /powershell
    cs-method: POST
    sc-status: 200
- condition: selection
  selection:
    c-uri|contains|all:
    - /owa/mastermailbox
    - /powershell
    c-useragent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
      like Gecko) Chrome/105.0.5195.54 Safari/537.36
    cs-method: POST
    sc-status: 200
- condition: selection
  selection:
    c-uri|contains: /list/suc\?name=
- condition: selection
  selection:
    c-uri|endswith: .class
- condition: selection
  selection:
    c-useragent|contains: ' WindowsPowerShell/'
- condition: selection
  selection:
    c-uri|contains: /pwndrop/
- condition: selection
  selection:
    c-uri|contains:
    - .paste.ee/r/
    - .pastebin.com/raw/
    - .hastebin.com/raw/
    - .ghostbin.co/paste/*/raw/
    - pastetext.net/
    - pastebin.pl/
    - paste.ee/
- condition: selection and not filter
  filter:
    cs-host|endswith: .adobe.com
  selection:
  - c-uri|contains: /flash_install.php
  - c-uri|endswith: /install_flash_player.exe
- condition: selection
  selection:
    cs-uri|re: (?i)(ipfs\.io/|ipfs\.io\s).+\..+@.+\.[a-z]+
- condition: selection and not filter
  filter:
    c-useragent|contains:
    - Telegram
    - Bot
  selection:
    cs-host: api.telegram.org
- condition: selection
  selection:
    c-uri|contains: /index/index.php\?h=
- condition: selection
  selection:
    c-useragent:
    - SJZJ (compatible; MSIE 6.0; Win32)
    - Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0
    - 'User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0;
      SLCC'
    - Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)
    - webclient
    - Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200
    - Mozilla/4.0 (compatible; MSI 6.0;
    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0
    - Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/
    - Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2
    - Mozilla/4.0
    - Netscape
    - Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7
    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Firefox/3.6.13
      GTB7.1
    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2;
      .NETCLR 2.0.50727)
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)
    - Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)
    - Mozilla/4.0 (compatible; MSIE 8.0; Win32)
    - Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1
    - Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)
    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET
      CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; InfoPath.1)
    - Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko
    - Mozilla v5.1 *
    - MSIE 8.0
    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; SLCC2; .NET CLR 2.0.50727;
      .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E;
      InfoPath.2)
    - Mozilla/4.0 (compatible; RMS)
    - Mozilla/4.0 (compatible; MSIE 6.0; DynGate)
    - O/9.27 (W; U; Z)
    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0;  Trident/5.0*
    - Mozilla/5.0 (Windows NT 9; *
    - hots scot
    - Mozilla/5.0 (compatible; MSIE 10.0; Windows NT)
    - Mozilla/5.0 (Windows NT 6.1; WOW64) Chrome/28.0.1500.95 Safari/537.36
    - Mozilla/5.0 (Windows NT 6.2; Win32; rv:47.0)
    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1;
    - Mozilla/5.0 (X11; Linux i686; rv:22.0) Firefox/22.0
    - Mozilla/5.0 Chrome/72.0.3626.109 Safari/537.36
    - Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:FTS_06) Gecko/22.36.35.06 Firefox/2.0
    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)
      Chrome/102.0.5005.63 Safari/537.36 Edg/100.0.1185.39
    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2;
      .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; InfoPath.3; .NET4.0C;
      .NET4.0E)
- condition: selection
  selection:
    c-useragent|startswith:
    - Q2hyb21l
    - QXBwbGVXZWJLaX
    - RGFsdmlr
    - TW96aWxsY
- condition: selection
  selection:
    c-useragent|startswith: Microsoft BITS/
    cs-host|endswith:
    - '1'
    - '2'
    - '3'
    - '4'
    - '5'
    - '6'
    - '7'
    - '8'
    - '9'
- condition: selection and not falsepositives
  falsepositives:
    cs-host|endswith:
    - .com
    - .net
    - .org
    - .scdn.co
    - .sfx.ms
  selection:
    c-useragent|startswith: Microsoft BITS/
- condition: selection
  selection:
    c-useragent|startswith:
    - 'XMRig '
    - ccminer
- condition: selection
  selection:
    c-useragent:
    - Internet Explorer *
    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)
    - Mozilla/4.0 (compatible; Metasploit RSPEC)
    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)
    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)
    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/4.0; SIMBAR={7DB0F6DE-8DE7-4841-9084-28FA914B0F2E};
      SLCC1; .N
    - Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like
      Gecko) Chrome/4.0.221.6 Safari/525.13
    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MAAU)
    - Mozilla/5.0
    - Mozilla/4.0 (compatible; SPIPE/1.0
    - Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0
    - Sametime Community Agent
    - X-FORWARDED-FOR
    - DotDotPwn v2.1
    - SIPDROID
    - Mozilla/5.0 (Windows NT 10.0; Win32; x32; rv:60.0)
    - Mozilla/6.0 (X11; Linux x86_64; rv:24.0) Gecko/20140205     Firefox/27.0 Iceweasel/25.3.0
    - '*wordpress hash grabber*'
    - '*exploit*'
- condition: selection
  selection:
    c-useragent|contains:
    - (hydra)
    - ' arachni/'
    - ' BFAC '
    - ' brutus '
    - ' cgichk '
    - core-project/1.0
    - ' crimscanner/'
    - datacha0s
    - dirbuster
    - domino hunter
    - dotdotpwn
    - FHScan Core
    - floodgate
    - get-minimal
    - gootkit auto-rooter scanner
    - grendel-scan
    - ' inspath '
    - internet ninja
    - jaascois
    - ' zmeu '
    - masscan
    - ' metis '
    - morfeus fucking scanner
    - n-stealth
    - nsauditor
    - pmafind
    - security scan
    - springenwerk
    - teh forest lobster
    - toata dragostea
    - ' vega/'
    - voideye
    - webshag
    - webvulnscan
    - ' whcc/'
    - ' Havij'
    - absinthe
    - bsqlbf
    - mysqloit
    - pangolin
    - sql power injector
    - sqlmap
    - sqlninja
    - uil2pn
    - ruler
    - Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2
      (.NET CLR 3.5.30729)
- condition: selection
  selection:
    c-useragent:
    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Chrome /53.0
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)
    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)
    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR  1.1.4322)
    - HttpBrowser/1.0
    - '*<|>*'
    - nsis_inetc (mozilla)
    - Wget/1.9+cvs-stable (Red Hat modified)
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)
    - '*zeroup*'
    - Mozilla/5.0 (Windows NT 5.1 ; v.*
    - '* adlib/*'
    - '* tiny'
    - '* BGroom *'
    - '* changhuatong'
    - '* CholTBAgent'
    - Mozilla/5.0 WinInet
    - RookIE/1.0
    - M
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)
    - Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)
    - backdoorbot
    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1
      (.NET CLR 3.5.30731)
    - Opera/8.81 (Windows NT 6.0; U; en)
    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1
      (.NET CLR 3.5.30729)
    - Opera
    - Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)
    - Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)
    - MSIE
    - '*(Charon; Inferno)'
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)
    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)
    - Mozilla/4.0(compatible; MSIE 6.0; Windows NT 5.1)
    - Mozilla/5.0 (Windows NT 10.0; Win64; x64)
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; Win64; x64)
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Win64; x64)
    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2; WOW64; Trident/7.0; .NET4.0C;
      .NET4.0E; InfoPath.3)
    - Mozilla/5.0 (Windows NT 6.1)
    - AppleWebkit/587.38 (KHTML, like Gecko)
    - Chrome/91.0.4472.77
    - Safari/537.36
    - Edge/91.0.864.37
    - Firefox/89.0
    - Gecko/20100101
    - '* pxyscand*'
    - '* asd'
    - '* mdms'
    - sample
    - nocase
    - Moxilla
    - Win32 *
    - '*Microsoft Internet Explorer*'
    - agent *
    - AutoIt
    - IczelionDownLoad
    - Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 10.0; .NET4.0C; .NET4.0E; Tablet
      PC 2.0)
    - record
    - mozzzzzzzzzzz
    - Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0
    - Havana/0.1
    - antSword/v2.1
    - rqwrwqrqwrqw
    - qwrqrwrqwrqwr
    - rc2.0/client
    - TakeMyPainBack
    - xxx
    - '20112211'
    - '23591'
    - '901785252112'
    - '1235125521512'
    - '125122112551'
    - B1D3N_RIM_MY_ASS
    - AYAYAYAY1337
    - iMightJustPayMySelfForAFeature
    - ForAFeature
    - Ares_ldr_v_*
    - Microsoft Internet Explorer
    - CLCTR
    - uploader
    - agent
    - License
    - vb wininet
    - Client
    - Lilith-Bot/3.0
    - svc/1.0
    - WSHRAT
    - ZeroStresser Botnet/1.5
    - OK
    - Project1sqlite
    - Project1
- condition: selection
  selection:
    c-useragent|startswith: rclone/v
- condition: 1 of selection* and not falsepositives
  falsepositives:
  - c-useragent: Mozilla/3.0 * Acrobat *
  - cs-host|endswith:
    - .acrobat.com
    - .adobe.com
    - .adobe.io
  selection1:
    c-useragent|startswith:
    - user-agent
    - 'Mozilla/3.0 '
    - 'Mozilla/2.0 '
    - 'Mozilla/1.0 '
    - 'Mozilla '
    - ' Mozilla/'
    - Mozila/
    - Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol
  selection2:
    c-useragent|contains:
    - ' (compatible;MSIE '
    - '.0;Windows NT '
    - loader
  selection3:
    c-useragent:
    - _
    - CertUtil URL Agent
    - Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0)
    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0
    - HTTPS
    - Erbium-UA-4ce7c27cb4be9d32e333bf032c88235a
    - x
    - xxx
- condition: selection
  selection:
    c-useragent|endswith: '='
- b64encoding:
    c-uri|contains:
    - _2f
    - _2b
  condition: b64encoding and urlpatterns
  urlpatterns:
    c-uri|contains|all:
    - .avi
    - /images/
- condition: selection
  selection:
    c-uri|contains|all:
    - /
    - .php\?l=
    c-uri|endswith: .cab
    sc-status: 200
- condition: selection
  selection:
    cs-method:
    - GET
    - OPTIONS
    cs-uri-query|contains: ~1
    cs-uri-query|endswith: a.aspx
    sc-status:
    - 200
    - 301
- condition: keywords
  keywords:
  - '%24%7B%28%23a%3D%40'
  - ${(#a=@
  - '%24%7B%40java'
  - ${@java
  - u0022java
  - '%2F%24%7B%23'
  - /${#
  - new+java.
  - getRuntime().exec(
  - getRuntime%28%29.exec%28
- condition: keywords
  keywords:
  - /Basic/Command/Base64/
  - /Basic/ReverseShell/
  - /Basic/TomcatMemshell
  - /Basic/JettyMemshell
  - /Basic/WeblogicMemshell
  - /Basic/JBossMemshell
  - /Basic/WebsphereMemshell
  - /Basic/SpringMemshell
  - /Deserialization/URLDNS/
  - /Deserialization/CommonsCollections1/Dnslog/
  - /Deserialization/CommonsCollections2/Command/Base64/
  - /Deserialization/CommonsBeanutils1/ReverseShell/
  - /Deserialization/Jre8u20/TomcatMemshell
  - /TomcatBypass/Dnslog/
  - /TomcatBypass/Command/
  - /TomcatBypass/ReverseShell/
  - /TomcatBypass/TomcatMemshell
  - /TomcatBypass/SpringMemshell
  - /GroovyBypass/Command/
  - /WebsphereBypass/Upload/
- condition: selection
  selection:
    cs-uri-query|contains:
    - ../../../../../etc/passwd
    - ../../../../windows/
    - ../../../../../lib/password
- condition: keywords
  keywords:
  - .git/
- condition: select_method and keywords and not 1 of filter*
  filter:
    sc-status: 404
  keywords:
  - '=select '
  - =select%20
  - =select(
  - UNION SELECT
  - UNION%20SELECT
  - UNION ALL SELECT
  - UNION%20ALL%20SELECT
  - CONCAT(0x
  - 'order by '
  - order%20by%20
  - information_schema.tables
  - group_concat(
  - table_schema
  - select%28sleep%2810%29
  - '@@version'
  - '''1''=''1'
  - '%271%27%3D%271'
  - SELECTCHAR(
  - 'select * '
  - select%20*%20
  - or 1=1#
  - or%201=1#
  select_method:
    cs-method: GET
- condition: select_method and keywords and not filter
  filter:
    sc-status: 404
  keywords:
  - ={{
  - =%7B%7B
  - =${
  - =$%7B
  - =<%=
  - =%3C%25=
  - =@(
  - freemarker.template.utility.Execute
  - .getClass().forName('javax.script.ScriptEngineManager')
  - T(org.apache.commons.io.IOUtils)
  select_method:
    cs-method: GET
- condition: selection
  selection:
    cs-user-agent|contains:
    - Wfuzz/
    - WPScan v
    - Recon-ng/v
    - GIS - AppSec Team - Project Vision
- condition: selection
  selection:
    cs-uri-query|contains:
    - =C:/Users
    - =C:/Program%20Files
    - =C:/Windows
    - =C%3A%5CUsers
    - =C%3A%5CProgram%20Files
    - =C%3A%5CWindows
- condition: selection and filter
  filter:
    cs-method: POST
    cs-referer: null
    cs-user-agent: null
  selection:
    cs-uri-query|contains:
    - cmd=read
    - connect&target
    - cmd=connect
    - cmd=disconnect
    - cmd=forward
- condition: all of selection_*
  selection_keywords:
  - =whoami
  - =net%20user
  - =net+user
  - =net%2Buser
  - =cmd%20/c%
  - =cmd+/c+
  - =cmd%2B/c%
  - =cmd%20/r%
  - =cmd+/r+
  - =cmd%2B/r%
  - =cmd%20/k%
  - =cmd+/k+
  - =cmd%2B/k%
  - =powershell%
  - =powershell+
  - =tasklist%
  - =tasklist+
  - =wmic%
  - =wmic+
  - =ssh%
  - =ssh+
  - =python%
  - =python+
  - =python3%
  - =python3+
  - =ipconfig
  - =wget%
  - =wget+
  - =curl%
  - =curl+
  - =certutil
  - =copy%20%5C%5C
  - =dsquery%
  - =dsquery+
  - =nltest%
  - =nltest+
  selection_method:
    cs-method: GET
- condition: select_method and keywords and not filter
  filter:
    sc-status: 404
  keywords:
  - =<script>
  - =%3Cscript%3E
  - =%253Cscript%253E
  - '<iframe '
  - '%3Ciframe '
  - '<svg '
  - '%3Csvg '
  - files.cookie
  - files.domain
  - ' onerror='
  - ' onresize='
  - ' onload="'
  - onmouseover=
  - ${alert
  - javascript:alert
  - javascript%3Aalert
  select_method:
    cs-method: GET
- condition: keywords and not filter
  filter:
    EventID: 15
  keywords:
  - dpapi::masterkey
  - eo.oe.kiwi
  - event::clear
  - event::drop
  - gentilkiwi.com
  - kerberos::golden
  - kerberos::ptc
  - kerberos::ptt
  - kerberos::tgt
  - Kiwi Legit Printer
  - 'lsadump::'
  - mimidrv.sys
  - \mimilib.dll
  - misc::printnightmare
  - misc::shadowcopies
  - misc::skeleton
  - privilege::backup
  - privilege::debug
  - privilege::driver
  - 'sekurlsa::'
- condition: selection
  selection:
    Data|contains|all:
    - MsMpEng.exe
    - mpengine.dll
    EventID: 1000
    Provider_Name: Application Error
- condition: selection
  selection:
    AppName: lsass.exe
    EventID: 1000
    ExceptionCode: c0000001
    Provider_Name: Application Error
- condition: selection
  selection:
    Data|contains: ntds.dit
    EventID:
    - 216
    - 325
    - 326
    - 327
    Provider_Name: ESENT
- condition: all of selection_*
  selection_paths:
    Data|contains:
    - \Users\Public\
    - \Perflogs\
    - \Temp\
    - \Appdata\
    - \Desktop\
    - \Downloads\
    - C:\ntds.dit
  selection_root:
    Data|contains: ntds.dit
    EventID: 325
    Provider_Name: ESENT
- condition: selection
  selection:
    EventID: 1
    Provider_Name:
    - Microsoft-Windows-Audit-CVE
    - Audit-CVE
- condition: selection
  selection:
    EventID: 524
    Provider_Name: Microsoft-Windows-Backup
- condition: selection
  selection:
    EventID:
    - 865
    - 866
    - 867
    - 868
    - 882
    Provider_Name: Microsoft-Windows-SoftwareRestrictionPolicies
- condition: all of selection*
  selection1:
    EventID: 4
    Level: Error
    Provider_Name: MSExchange Control Panel
  selection2:
  - '&__VIEWSTATE='
- condition: selection
  selection:
    EventID:
    - 11724
    - 1034
    Provider_Name: MsiInstaller
- condition: selection and not 1 of filter_*
  filter_updhealthtools:
    Data|contains: C:\Windows\TEMP\UpdHealthTools.msi
  filter_winget:
    Data|contains: \AppData\Local\Temp\WinGet\
  selection:
    Data|contains:
    - \Users\Public\
    - \PerfLogs\
    - \Desktop\
    - C:\Windows\TEMP\
    - \\\\
    EventID:
    - 1040
    - 1042
    Provider_Name: MsiInstaller
- condition: selection
  selection:
    Data|contains: ://
    EventID:
    - 1040
    - 1042
    Provider_Name: MsiInstaller
- condition: selection
  selection:
    EventID: 1033
    Message|contains: AteraAgent
    Provider_Name: MsiInstaller
- condition: selection
  selection:
    Data|contains: test pkg
    EventID: 1033
    Provider_Name: MsiInstaller
- condition: selection
  selection:
    EventID: 2027
    Level: 2
    Provider_Name: MSMQ
- condition: selection
  selection:
    Data|contains|all:
    - object_name:sysadmin
    - 'statement:alter server role [sysadmin] add member '
    EventID: 33205
    Provider_Name: MSSQLSERVER
- condition: selection
  selection:
    Data|contains:
    - statement:ALTER SERVER AUDIT
    - statement:DROP SERVER AUDIT
    EventID: 33205
    Provider_Name: MSSQLSERVER
- condition: selection
  selection:
    EventID: 8128
    Message|contains: maggie
    Provider_Name: MSSQLSERVER
- condition: selection
  selection:
    Data|contains|all:
    - object_name:sp_procoption
    - statement:EXEC
    EventID: 33205
    Provider_Name: MSSQLSERVER
- condition: selection
  selection:
    Data|contains|all:
    - object_name:xp_cmdshell
    - statement:EXEC
    EventID: 33205
    Provider_Name: MSSQLSERVER
- condition: selection
  selection:
    Data|contains: xp_cmdshell
    EventID: 15457
    Provider_Name: MSSQLSERVER
- condition: keywords and not 1 of filter_optional_*
  filter_optional_generic:
  - Keygen
  - Crack
  - anti_ransomware_service.exe
  - cyber-protect-service.exe
  filter_optional_information:
    Level: 4
  filter_optional_restartmanager:
    Provider_Name: Microsoft-Windows-RestartManager
  keywords:
  - Adfind
  - ASP/BackDoor
  - ATK/
  - Backdoor.ASP
  - Backdoor.Cobalt
  - Backdoor.JSP
  - Backdoor.PHP
  - Blackworm
  - Brutel
  - BruteR
  - Chopper
  - Cobalt
  - COBEACON
  - Cometer
  - CRYPTES
  - Cryptor
  - Destructor
  - DumpCreds
  - Exploit.Script.CVE
  - Filecoder
  - FastReverseProxy
  - GrandCrab
  - HackTool
  - HKTL.
  - HKTL/
  - 'HKTL:'
  - HTool
  - Impacket
  - IISExchgSpawnCMD
  - JSP/BackDoor
  - Keylogger
  - Koadic
  - Krypt
  - Lazagne
  - Locker
  - Metasploit
  - Meterpreter
  - MeteTool
  - Mimikatz
  - Mpreter
  - Nighthawk
  - Packed.Generic.347
  - PentestPowerShell
  - Phobos
  - PHP/BackDoor
  - Potato
  - PowerSploit
  - PowerSSH
  - PshlSpy
  - PSWTool
  - PWCrack
  - PWDump
  - Ransom
  - Rozena
  - Ryzerlo
  - Sbelt
  - Seatbelt
  - SecurityTool
  - SharpDump
  - Sliver
  - Splinter
  - Swrort
  - Tescrypt
  - TeslaCrypt
  - Valyria
  - Webshell
- condition: selection
  selection:
    Data|contains|all:
    - MsMpEng.exe
    - mpengine.dll
    EventID: 1001
    Provider_Name: Windows Error Reporting
- condition: selection
  selection:
    EventID:
    - 8004
    - 8007
    - 8022
    - 8025
- condition: selection
  selection:
    EventID: 201
    ImageName:
    - procdump.exe
    - psloglist.exe
    - psexec.exe
    - livekd.exe
    - ADExplorer.exe
- condition: selection
  selection:
    EventID: 412
- condition: selection
  selection:
    EventID:
    - 400
    - 401
    PackageFullName|contains: 3669e262-ec02-4e9d-bcb4-3d008b4afac9
- condition: selection
  selection:
    EventID:
    - 441
    - 442
    - 453
    - 454
- condition: selection
  selection:
    ErrorCode: '0x80073cff'
    EventID: 401
- condition: selection
  selection:
    EventID: 854
    Path|contains:
    - transfer.sh
    - raw.githubusercontent.com
    - gist.githubusercontent.com
    - pastebin.com
    - cdn.discordapp.com/attachments/
    - mediafire.com
    - mega.nz
    - ddns.net
    - .paste.ee
    - .hastebin.com
    - .ghostbin.co/
    - ufile.io
    - storage.googleapis.com
    - anonfiles.com
    - send.exploit.in
    - privatlab.net
    - privatlab.com
    - sendspace.com
    - pastetext.net
    - pastebin.pl
    - paste.ee
- condition: selection
  selection:
    EventID: 854
    Path|contains:
    - C:\Users\Public\
    - /users/public/
    - C:\PerfLogs\
    - C:/perflogs/
    - \Desktop\
    - /desktop/
    - \Downloads\
    - /Downloads/
    - C:\Windows\Temp\
    - C:/Windows/Temp/
    - \AppdData\Local\Temp\
    - /AppdData/Local/Temp/
- condition: selection and not 1 of filter_*
  filter_generic:
    Path|contains:
    - C:\Program Files\WindowsApps\
    - C:\Program Files (x86)\
    - C:\Windows\SystemApps\
    - C:\Windows\PrintDialog\
    - C:\Windows\ImmersiveControlPanel\
    - x-windowsupdate://
    - file:///C:/Program%20Files
  filter_specific:
    Path|contains:
    - https://statics.teams.cdn.office.net/
    - microsoft.com
  selection:
    EventID: 854
- condition: selection
  selection:
    EventID: 157
    subjectName: CN=Foresee Consulting Inc., O=Foresee Consulting Inc., L=North York,
      S=Ontario, C=CA, SERIALNUMBER=1004913-1, OID.1.3.6.1.4.1.311.60.2.1.3=CA, OID.2.5.4.15=Private
      Organization
- condition: selection
  selection:
    EventID: 3
    processPath|endswith: \bitsadmin.exe
- condition: selection
  selection:
    EventID: 3
    processPath|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: selection and not 1 of filter_optional_*
  filter_optional_generic:
    LocalName|contains: \AppData\
    RemoteName|contains: .com
  selection:
    EventID: 16403
    LocalName|endswith:
    - .bat
    - .dll
    - .exe
    - .hta
    - .ps1
    - .psd1
    - .sh
    - .vbe
    - .vbs
- condition: selection
  selection:
    EventID: 16403
    RemoteName|contains:
    - .ghostbin.co/
    - .hastebin.com
    - .paste.ee
    - anonfiles.com
    - cdn.discordapp.com/attachments/
    - ddns.net
    - gist.githubusercontent.com
    - mediafire.com
    - mega.nz
    - paste.ee
    - pastebin.com
    - pastebin.pl
    - pastetext.net
    - privatlab.com
    - privatlab.net
    - raw.githubusercontent.com
    - send.exploit.in
    - sendspace.com
    - storage.googleapis.com
    - transfer.sh
    - ufile.io
- condition: selection and not 1 of filter_optional_*
  filter_optional_local_networks:
    RemoteName|contains:
    - ://10.
    - ://192.168.
    - ://172.16.
    - ://172.17.
    - ://172.18.
    - ://172.19.
    - ://172.20.
    - ://172.21.
    - ://172.22.
    - ://172.23.
    - ://172.24.
    - ://172.25.
    - ://172.26.
    - ://172.27.
    - ://172.28.
    - ://172.29.
    - ://172.30.
    - ://172.31.
    - ://127.
    - ://169.254.
  filter_optional_seven_zip:
    RemoteName|contains:
    - https://7-
    - http://7-
  selection:
    EventID: 16403
    RemoteName|contains:
    - http://1
    - http://2
    - http://3
    - http://4
    - http://5
    - http://6
    - http://7
    - http://8
    - http://9
    - https://1
    - https://2
    - https://3
    - https://4
    - https://5
    - https://6
    - https://7
    - https://8
    - https://9
- condition: selection and not 1 of filter_main_*
  filter_main_generic:
    RemoteName|contains:
    - .azureedge.net/
    - .com/
    - .sfx.ms/
    - download.mozilla.org/
  selection:
    EventID: 16403
- condition: selection
  selection:
    EventID: 16403
    LocalName|contains:
    - \Desktop\
    - C:\Users\Public\
    - C:\PerfLogs\
- condition: selection
  selection:
    EventID: 70
- condition: selection
  selection:
    EventID: 1007
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_gac:
    FileNameBuffer|contains: \Windows\assembly\GAC\
    ProcessNameBuffer|contains: \Windows\Microsoft.NET\
    ProcessNameBuffer|endswith: \mscorsvw.exe
    RequestedPolicy: 8
    ValidatedPolicy:
    - 1
    - 2
  filter_optional_av_generic:
    FileNameBuffer|contains: \Windows\System32\DriverStore\FileRepository\
    FileNameBuffer|endswith: \igd10iumd64.dll
    RequestedPolicy: 7
    ValidatedPolicy: 1
  filter_optional_avast:
    FileNameBuffer|endswith:
    - \Program Files\Avast Software\Avast\aswAMSI.dll
    - \Program Files (x86)\Avast Software\Avast\aswAMSI.dll
    RequestedPolicy:
    - 8
    - 12
    ValidatedPolicy: 1
  filter_optional_bonjour:
    FileNameBuffer|endswith: \Program Files\Bonjour\mdnsNSP.dll
    ProcessNameBuffer|endswith:
    - \Windows\System32\svchost.exe
    - \Windows\System32\SIHClient.exe
    RequestedPolicy:
    - 8
    - 12
    ValidatedPolicy: 1
  filter_optional_dtrace:
    FileNameBuffer|endswith: \Program Files\DTrace\dtrace.dll
    ProcessNameBuffer|endswith: \Windows\System32\svchost.exe
    RequestedPolicy: 12
    ValidatedPolicy: 1
  filter_optional_electron_based_app:
    FileNameBuffer|endswith: \Windows\System32\nvspcap64.dll
    ProcessNameBuffer|endswith:
    - \AppData\Local\Keybase\Gui\Keybase.exe
    - \Microsoft\Teams\stage\Teams.exe
    RequestedPolicy: 8
    ValidatedPolicy: 1
  filter_optional_firefox:
    FileNameBuffer|endswith:
    - \Mozilla Firefox\mozavcodec.dll
    - \Mozilla Firefox\mozavutil.dll
    ProcessNameBuffer|endswith: \Mozilla Firefox\firefox.exe
    RequestedPolicy: 8
  filter_optional_google_drive:
    FileNameBuffer|contains: \Program Files\Google\Drive File Stream\
    FileNameBuffer|endswith: \crashpad_handler.exe
    ProcessNameBuffer|endswith: \Windows\ImmersiveControlPanel\SystemSettings.exe
    RequestedPolicy: 8
    ValidatedPolicy: 1
  filter_optional_msoffice:
    FileNameBuffer|contains: \Microsoft Office\root\vfs\ProgramFilesCommonX64\Microsoft
      Shared\OFFICE
    FileNameBuffer|endswith: \MSOXMLMF.DLL
    RequestedPolicy: 7
    ValidatedPolicy: 1
  filter_optional_slack:
    FileNameBuffer|endswith: \Windows\System32\nvspcap64.dll
    ProcessNameBuffer|contains: \AppData\Local\slack\app-
    ProcessNameBuffer|endswith: \slack.exe
    RequestedPolicy: 8
    ValidatedPolicy: 1
  filter_optional_trend_micro:
    FileNameBuffer|endswith: \Trend Micro\Client Server Security Agent\perficrcperfmonmgr.dll
    RequestedPolicy: 8
    ValidatedPolicy: 1
  selection:
    EventID:
    - 3033
    - 3034
- condition: selection
  selection:
    EventID: 3104
- condition: selection
  selection:
    EventID: 3077
- condition: selection
  selection:
    EventID: 3023
- condition: selection
  selection:
    EventID:
    - 3021
    - 3022
- condition: selection
  selection:
    EventID: 3036
- condition: selection
  selection:
    EventID:
    - 3032
    - 3035
- condition: selection
  selection:
    EventID: 3001
- condition: selection
  selection:
    EventID: 3037
- condition: selection and not 1 of filter_optional_*
  filter_optional_vmware:
    FileNameBuffer:
    - system32\drivers\vsock.sys
    - System32\drivers\vmci.sys
  selection:
    EventID:
    - 3082
    - 3083
- condition: selection
  selection:
    EventID: 101
    PackagePath|contains: \\\\
- condition: selection
  selection:
    EventID: 3008
    QueryName|contains: .anonfiles.com
- condition: selection
  selection:
    EventID: 3008
    QueryName|contains: userstorage.mega.co.nz
- condition: selection
  selection:
    EventID: 3008
    QueryName|contains: .onion
- condition: selection
  selection:
    EventID: 3008
    QueryName|contains: ufile.io
- condition: selection_eid and 1 of selection_query_*
  selection_eid:
    EventID: 3008
  selection_query_1:
    QueryName|startswith:
    - aaa.stage.
    - post.1
  selection_query_2:
    QueryName|contains: .stage.123456.
- condition: selection
  selection:
    EventID: 6004
- condition: selection
  selection:
    EventID:
    - 150
    - 770
    - 771
- condition: selection
  selection:
    EventID: 257
    QNAME:
    - asyspy256.ddns.net
    - hotkillmail9sddcc.ddns.net
    - rosaf112.ddns.net
    - cvdfhjh1231.myftp.biz
    - sz2016rose.ddns.net
    - dffwescwer4325.myftp.biz
    - cvdfhjh1231.ddns.net
- condition: selection
  selection:
    EventID:
    - 2003
    - 2100
    - 2102
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_block:
    Action: 2
  filter_main_installations:
  - ApplicationPath|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  - ModifyingApplication: C:\Windows\System32\oobe\Setup.exe
  - ModifyingApplication|startswith: C:\Windows\WinSxS\
  - ModifyingApplication:
    - C:\Windows\SysWOW64\msiexec.exe
    - C:\Windows\System32\svchost.exe
    - C:\Windows\System32\dllhost.exe
    - C:\Program Files\Windows Defender\MsMpEng.exe
  filter_optional_msmpeng:
    ModifyingApplication|endswith: \MsMpEng.exe
    ModifyingApplication|startswith: C:\ProgramData\Microsoft\Windows Defender\Platform\
  selection:
    EventID:
    - 2004
    - 2071
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_block:
    Action: 2
  filter_optional_keybase:
    ApplicationPath|endswith: \AppData\Local\Keybase\keybase.exe
  filter_optional_messenger:
    ApplicationPath|endswith: \AppData\Local\Programs\Messenger\Messenger.exe
  filter_optional_opera:
    ApplicationPath|contains: \AppData\Local\Programs\Opera\
    ApplicationPath|endswith: \opera.exe
    ApplicationPath|startswith: C:\Users\
  filter_optional_teams:
    ApplicationPath|endswith: \AppData\local\microsoft\teams\current\teams.exe
  selection:
    ApplicationPath|contains:
    - \AppData\
    - \Temp\
    EventID:
    - 2004
    - 2071
- condition: selection and not 1 of filter_main_*
  filter_main_generic:
    ModifyingApplication|startswith:
    - C:\Program Files (x86)\
    - C:\Program Files\
  selection:
    EventID:
    - 2005
    - 2073
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic:
    ModifyingApplication|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_main_svchost:
    ModifyingApplication: C:\Windows\System32\svchost.exe
  filter_optional_msmpeng:
    ModifyingApplication|endswith: \MsMpEng.exe
    ModifyingApplication|startswith: C:\ProgramData\Microsoft\Windows Defender\Platform\
  selection:
    EventID:
    - 2033
    - 2059
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_empty:
    ModifyingApplication: ''
  filter_main_generic:
    ModifyingApplication|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_main_null:
    ModifyingApplication: null
  filter_main_svchost:
    ModifyingApplication: C:\Windows\System32\svchost.exe
  filter_optional_msmpeng:
    ModifyingApplication|endswith: \MsMpEng.exe
    ModifyingApplication|startswith: C:\ProgramData\Microsoft\Windows Defender\Platform\
  selection:
    EventID:
    - 2006
    - 2052
- condition: selection
  selection:
    EventID: 2009
- condition: selection
  selection:
    EventID:
    - 2032
    - 2060
- condition: selection
  selection:
    EventID:
    - 2002
    - 2083
    - 2003
    - 2082
    - 2008
- condition: (generic_search and not narrow_down_filter) or suspicious_flag
  generic_search:
    EventID: 30
    SearchFilter|contains:
    - (groupType:1.2.840.113556.1.4.803:=2147483648)
    - (groupType:1.2.840.113556.1.4.803:=2147483656)
    - (groupType:1.2.840.113556.1.4.803:=2147483652)
    - (groupType:1.2.840.113556.1.4.803:=2147483650)
    - (sAMAccountType=805306369)
    - (sAMAccountType=805306368)
    - (sAMAccountType=536870913)
    - (sAMAccountType=536870912)
    - (sAMAccountType=268435457)
    - (sAMAccountType=268435456)
    - (objectCategory=groupPolicyContainer)
    - (objectCategory=organizationalUnit)
    - (objectCategory=Computer)
    - (objectCategory=nTDSDSA)
    - (objectCategory=server)
    - (objectCategory=domain)
    - (objectCategory=person)
    - (objectCategory=group)
    - (objectCategory=user)
    - (objectClass=trustedDomain)
    - (objectClass=computer)
    - (objectClass=server)
    - (objectClass=group)
    - (objectClass=user)
    - (primaryGroupID=521)
    - (primaryGroupID=516)
    - (primaryGroupID=515)
    - (primaryGroupID=512)
    - Domain Admins
    - objectGUID=\*
    - (schemaIDGUID=\*)
  narrow_down_filter:
    EventID: 30
    SearchFilter|contains:
    - (domainSid=*)
    - (objectSid=*)
  suspicious_flag:
    EventID: 30
    SearchFilter|contains:
    - (userAccountControl:1.2.840.113556.1.4.803:=4194304)
    - (userAccountControl:1.2.840.113556.1.4.803:=2097152)
    - '!(userAccountControl:1.2.840.113556.1.4.803:=1048574)'
    - (userAccountControl:1.2.840.113556.1.4.803:=524288)
    - (userAccountControl:1.2.840.113556.1.4.803:=65536)
    - (userAccountControl:1.2.840.113556.1.4.803:=8192)
    - (userAccountControl:1.2.840.113556.1.4.803:=544)
    - '!(UserAccountControl:1.2.840.113556.1.4.803:=2)'
    - msDS-AllowedToActOnBehalfOfOtherIdentity
    - msDS-AllowedToDelegateTo
    - msDS-GroupManagedServiceAccount
    - (accountExpires=9223372036854775807)
    - (accountExpires=0)
    - (adminCount=1)
    - ms-MCS-AdmPwd
- condition: selection and not filter_admin
  filter_admin:
    TargetUserSid|endswith:
    - '-500'
    - '-518'
    - '-519'
  selection:
    EventID: 300
    SidList|contains:
    - S-1-5-32-544
    - -500}
    - -518}
    - -519}
    TargetUserSid|startswith: S-1-5-21-
- condition: selection
  selection:
    Data|contains:
    - 'Cmdlet failed. Cmdlet Get-App, '
    - 'Task Get-App throwing unhandled exception: System.InvalidCastException:'
    EventID:
    - 6
    - 8
- condition: keywords_cmdlet and keywords_params
  keywords_cmdlet:
    '|all':
    - OabVirtualDirectory
    - ' -ExternalUrl '
  keywords_params:
  - eval(request
  - http://f/<script
  - '"unsafe"};'
  - function Page_Load()
- condition: keywords_export_command and keywords_export_params
  keywords_export_command:
    '|all':
    - New-ExchangeCertificate
    - ' -GenerateRequest'
    - ' -BinaryEncoded'
    - ' -RequestFile'
  keywords_export_params:
  - \\\\localhost\\C$
  - \\\\127.0.0.1\\C$
  - C:\\inetpub
  - .aspx
- condition: (export_command and export_params) or role_assignment
  export_command:
    '|all':
    - New-MailboxExportRequest
    - ' -Mailbox '
  export_params:
  - -FilePath "\\\\
  - .aspx
  role_assignment:
    '|all':
    - New-ManagementRoleAssignment
    - ' -Role "Mailbox Import Export"'
    - ' -User '
- condition: keywords
  keywords:
    '|all':
    - Remove-MailboxExportRequest
    - ' -Identity '
    - ' -Confirm "False"'
- condition: keywords
  keywords:
    '|all':
    - Set-OabVirtualDirectory
    - ExternalUrl
    - Page_Load
    - script
- condition: selection
  selection:
  - Install-TransportAgent
- condition: selection
  selection:
    Data|contains: Install-TransportAgent
    EventID: 6
- condition: selection
  selection:
    EventID: 8002
    ProcessName|contains: '*'
- condition: selection and devicename
  devicename:
    WorkstationName:
    - Rdesktop
    - Remmina
    - Freerdp
    - Windows7
    - Windows8
    - Windows2012
    - Windows2016
    - Windows2019
  selection:
    EventID: 8004
- condition: selection
  selection:
    EventID: 8001
    TargetName|startswith: TERMSRV
- condition: selection
  selection:
    EventID: 4
    payload|startswith: 'Server listening on '
    process: sshd
- condition: selection and not filter
  filter:
    ProcessName|contains:
    - Microsoft.Identity.Health.Adfs.DiagnosticsAgent.exe
    - Microsoft.Identity.Health.Adfs.InsightsService.exe
    - Microsoft.Identity.Health.Adfs.MonitoringAgent.Startup.exe
    - Microsoft.Identity.Health.Adfs.PshSurrogate.exe
    - Microsoft.Identity.Health.Common.Clients.ResourceMonitor.exe
  selection:
    EventID:
    - 4656
    - 4663
    ObjectName: \REGISTRY\MACHINE\SOFTWARE\Microsoft\Microsoft Online\Reporting\MonitoringAgent
    ObjectType: Key
- condition: selection and not filter
  filter:
    ProcessName|contains:
    - Microsoft.Identity.Health.Adfs.DiagnosticsAgent.exe
    - Microsoft.Identity.Health.Adfs.InsightsService.exe
    - Microsoft.Identity.Health.Adfs.MonitoringAgent.Startup.exe
    - Microsoft.Identity.Health.Adfs.PshSurrogate.exe
    - Microsoft.Identity.Health.Common.Clients.ResourceMonitor.exe
  selection:
    EventID:
    - 4656
    - 4663
    ObjectName: \REGISTRY\MACHINE\SOFTWARE\Microsoft\ADHealthAgent
    ObjectType: Key
- condition: selection and not 1 of filter*
  filter1:
    ObjectClass:
    - dnsNode
    - dnsZoneScope
    - dnsZone
  selection:
    AttributeLDAPDisplayName: ntSecurityDescriptor
    AttributeValue|contains:
    - 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2
    - 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2
    - 89e95b76-444d-4c62-991a-0facbeda640c
    EventID: 5136
- condition: selection and selection_object and not filter
  filter:
    SubjectUserName|endswith: $
  selection:
    EventID: 4661
    ObjectType:
    - SAM_USER
    - SAM_GROUP
  selection_object:
  - ObjectName|endswith:
    - '-512'
    - '-502'
    - '-500'
    - '-505'
    - '-519'
    - '-520'
    - '-544'
    - '-551'
    - '-555'
  - ObjectName|contains: admin
- condition: selection1 or selection2
  selection1:
    EventID: 4898
    TemplateContent|contains: CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT
  selection2:
    EventID: 4899
    NewTemplateContent|contains: CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT
- condition: (selection10 and selection11) or (selection20 and selection21)
  selection10:
    EventID: 4898
    TemplateContent|contains:
    - 1.3.6.1.5.5.7.3.2
    - 1.3.6.1.5.2.3.4
    - 1.3.6.1.4.1.311.20.2.2
    - 2.5.29.37.0
  selection11:
    TemplateContent|contains: CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT
  selection20:
    EventID: 4899
    NewTemplateContent|contains:
    - 1.3.6.1.5.5.7.3.2
    - 1.3.6.1.5.2.3.4
    - 1.3.6.1.4.1.311.20.2.2
    - 2.5.29.37.0
  selection21:
    NewTemplateContent|contains: CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT
- condition: selection
  selection:
    EventID:
    - 4741
    - 4743
- condition: selection and not filter
  filter:
    SubjectUserSid: S-1-5-18
  selection:
    EventID:
    - 4672
    - 4964
- condition: selection and not filter
  filter:
    SubjectUserName|endswith: $
  selection:
    EventID: 5140
    ShareName: Admin$
- condition: selection
  selection:
    AccessMask: '0x40000'
    EventID: 4662
    ObjectServer: DS
    ObjectType:
    - 19195a5b-6da0-11d0-afd3-00c04fd930c9
    - domainDNS
- condition: selection and not filter
  filter:
  - SubjectUserName|endswith: $
  - SubjectUserName|startswith: MSOL_
  selection:
    AccessMask: '0x100'
    EventID: 4662
    Properties|contains:
    - 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2
    - 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2
    - 89e95b76-444d-4c62-991a-0facbeda640c
- condition: selection and not filter
  filter:
  - SubjectUserName|endswith: $
  - SubjectUserName|startswith: MSOL_
  selection:
    EventID: 4662
    ObjectType|contains: bf967aba-0de6-11d0-a285-00aa003049e2
- condition: all of selection*
  selection_base:
    EventID: 4704
  selection_keywords:
    PrivilegeList|contains: SeEnableDelegationPrivilege
- condition: (selection1 and not filter_null) or 1 of selection_5136_*
  filter_null:
  - AllowedToDelegateTo: '-'
  - AllowedToDelegateTo: null
  selection1:
    EventID: 4738
  selection_5136_1:
    AttributeLDAPDisplayName: msDS-AllowedToDelegateTo
    EventID: 5136
  selection_5136_2:
    AttributeLDAPDisplayName: servicePrincipalName
    EventID: 5136
    ObjectClass: user
  selection_5136_3:
    AttributeLDAPDisplayName: msDS-AllowedToActOnBehalfOfOtherIdentity
    EventID: 5136
- condition: selection and ((newuac_des and not olduac_des) or (newuac_preauth and
    not olduac_preauth) or (newuac_encrypted and not olduac_encrypted))
  newuac_des:
    NewUacValue|endswith:
    - 8???
    - 9???
    - A???
    - B???
    - C???
    - D???
    - E???
    - F???
  newuac_encrypted:
    NewUacValue|endswith:
    - 8??
    - 9??
    - A??
    - B??
    - C??
    - D??
    - E??
    - F??
  newuac_preauth:
    NewUacValue|endswith:
    - 1????
    - 3????
    - 5????
    - 7????
    - 9????
    - B????
    - D????
    - F????
  olduac_des:
    OldUacValue|endswith:
    - 8???
    - 9???
    - A???
    - B???
    - C???
    - D???
    - E???
    - F???
  olduac_encrypted:
    OldUacValue|endswith:
    - 8??
    - 9??
    - A??
    - B??
    - C??
    - D??
    - E??
    - F??
  olduac_preauth:
    OldUacValue|endswith:
    - 1????
    - 3????
    - 5????
    - 7????
    - 9????
    - B????
    - D????
    - F????
  selection:
    EventID: 4738
- condition: (1 of selection*)
  selection1:
    EventID: 4776
    Workstation: RULER
  selection2:
    EventID:
    - 4624
    - 4625
    WorkstationName: RULER
- condition: selection
  selection:
    Accesses|contains: WriteData
    EventID: 5145
    RelativeTargetName: atsvc
    ShareName: \\\\\*\\IPC$
- condition: selection
  selection:
    EventID:
    - 4657
    - 4656
    - 4663
    ObjectName|contains:
    - \SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone\NonPackaged
    - \SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam\NonPackaged
- condition: event_id and 1 of selection*
  event_id:
    EventID: 4697
  selection1:
    ServiceFileName|contains|all:
    - ADMIN$
    - .exe
  selection2:
    ServiceFileName|contains|all:
    - '%COMSPEC%'
    - start
    - powershell
  selection3:
    ServiceFileName|contains: powershell -nop -w hidden -encodedcommand
  selection4:
    ServiceFileName|base64offset|contains: 'IEX (New-Object Net.Webclient).DownloadString(''http://127.0.0.1:'
- condition: selection
  selection:
    EventID: 5145
    RelativeTargetName: spoolss
    ShareName: \\\\\*\\IPC$
- condition: selection and not filter
  filter:
    SubjectUserName|endswith: $
  selection:
    EventID: 5145
    RelativeTargetName|endswith: \Internet Explorer\iertutil.dll
- condition: selection and not 1 of filter*
  filter1:
    SubjectDomainName: Window Manager
  filter2:
    SubjectUserName|startswith:
    - NT AUT
    - MSOL_
  filter3:
    SubjectUserName|endswith: $
  selection:
    AccessMask: '0x100'
    EventID: 4662
    Properties|contains:
    - Replicating Directory Changes All
    - 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2
    - 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2
    - 9923a32a-3607-11d2-b9be-0000f87a36b2
    - 89e95b76-444d-4c62-991a-0facbeda640c
- condition: selection
  selection:
    EventID:
    - 4657
    - 4656
    - 4660
    - 4663
    ObjectName|contains: \Microsoft\Windows Defender\Exclusions\
- condition: selection
  selection:
    EventID: 6423
- condition: selection and not filter_main_guid
  filter_main_guid:
    SubcategoryGuid:
    - '{0CCE9215-69AE-11D9-BED3-505054503030}'
    - '{0CCE922B-69AE-11D9-BED3-505054503030}'
    - '{0CCE9240-69AE-11D9-BED3-505054503030}'
    - '{0CCE9210-69AE-11D9-BED3-505054503030}'
    - '{0CCE9211-69AE-11D9-BED3-505054503030}'
    - '{0CCE9212-69AE-11D9-BED3-505054503030}'
    - '{0CCE921B-69AE-11D9-BED3-505054503030}'
    - '{0CCE922F-69AE-11D9-BED3-505054503030}'
    - '{0CCE9230-69AE-11D9-BED3-505054503030}'
    - '{0CCE9235-69AE-11D9-BED3-505054503030}'
    - '{0CCE9236-69AE-11D9-BED3-505054503030}'
    - '{0CCE9237-69AE-11D9-BED3-505054503030}'
    - '{0CCE923F-69AE-11D9-BED3-505054503030}'
    - '{0CCE9242-69AE-11D9-BED3-505054503030}'
    - '{0CCE9217-69AE-11D9-BED3-505054503030}'
  selection:
    AuditPolicyChanges|contains:
    - '%%8448'
    - '%%8450'
    EventID: 4719
- condition: 1 of selection_*
  selection_state_success_and_failure:
    AuditPolicyChanges|contains:
    - '%%8448'
    - '%%8450'
    EventID: 4719
    SubcategoryGuid:
    - '{0CCE9215-69AE-11D9-BED3-505054503030}'
    - '{0CCE922B-69AE-11D9-BED3-505054503030}'
    - '{0CCE9240-69AE-11D9-BED3-505054503030}'
    - '{0CCE9210-69AE-11D9-BED3-505054503030}'
    - '{0CCE9211-69AE-11D9-BED3-505054503030}'
    - '{0CCE9212-69AE-11D9-BED3-505054503030}'
    - '{0CCE921B-69AE-11D9-BED3-505054503030}'
    - '{0CCE922F-69AE-11D9-BED3-505054503030}'
    - '{0CCE9230-69AE-11D9-BED3-505054503030}'
    - '{0CCE9235-69AE-11D9-BED3-505054503030}'
    - '{0CCE9236-69AE-11D9-BED3-505054503030}'
    - '{0CCE9237-69AE-11D9-BED3-505054503030}'
    - '{0CCE923F-69AE-11D9-BED3-505054503030}'
    - '{0CCE9242-69AE-11D9-BED3-505054503030}'
  selection_state_success_only:
    AuditPolicyChanges|contains: '%%8448'
    EventID: 4719
    SubcategoryGuid: '{0CCE9217-69AE-11D9-BED3-505054503030}'
- condition: 1 of selection_*
  selection_complus:
    EventID: 4657
    NewValue: 0
    ObjectName|contains: \Environment
    ObjectValueName:
    - COMPlus_ETWEnabled
    - COMPlus_ETWFlags
  selection_etw_enabled:
    EventID: 4657
    NewValue: 0
    ObjectName|endswith: \SOFTWARE\Microsoft\.NETFramework
    ObjectValueName: ETWEnabled
- condition: selection
  selection:
    AccessMask: '0x2'
    EventID: 4662
    ObjectName|contains: BCKUPKEY
    ObjectType: SecretObject
- condition: selection
  selection:
    EventID: 4692
- condition: selection
  selection:
    EventID: 1102
    Provider_Name: Microsoft-Windows-Eventlog
- condition: selection or selection2
  selection:
    ClassName: DiskDrive
    EventID: 6416
  selection2:
    DeviceDescription: USB Mass Storage Device
- condition: selection
  selection:
    Accesses|contains:
    - WriteData
    - '%%4417'
    EventID: 5145
    RelativeTargetName|endswith: ScheduledTasks.xml
    ShareName: \\\\\*\\SYSVOL
- condition: selection
  selection:
    EventID: 4720
    TargetUserName|endswith: $
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains: HybridConnectionManager
    ServiceName: HybridConnectionManager
- condition: selection1
  selection1:
    EventID: 5145
    RelativeTargetName|contains:
    - RemCom_stdin
    - RemCom_stdout
    - RemCom_stderr
    ShareName: \\\\\*\\IPC$
- condition: selection
  selection:
    EventID: 5145
    RelativeTargetName|contains|all:
    - SYSTEM32\
    - .tmp
    ShareName: \\\\\*\\ADMIN$
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains|all:
    - cmd
    - '&&'
    - 'clipboard]::'
- condition: all of selection_*
  selection_eid:
    EventID: 4697
  selection_servicefilename:
  - ServiceFileName|re: \$PSHome\[\s*\d{1,3}\s*\]\s*\+\s*\$PSHome\[
  - ServiceFileName|re: \$ShellId\[\s*\d{1,3}\s*\]\s*\+\s*\$ShellId\[
  - ServiceFileName|re: \$env:Public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:Public\[
  - ServiceFileName|re: \$env:ComSpec\[(\s*\d{1,3}\s*,){2}
  - ServiceFileName|re: \\*mdr\*\W\s*\)\.Name
  - ServiceFileName|re: \$VerbosePreference\.ToString\(
  - ServiceFileName|re: \String\]\s*\$VerbosePreference
- condition: all of selection*
  selection:
    EventID: 4697
    ServiceFileName|contains|all:
    - cmd
    - powershell
  selection2:
    ServiceFileName|contains:
    - ${input}
    - noexit
  selection3:
    ServiceFileName|contains:
    - ' /c '
    - ' /r '
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains:
    - /c
    - /r
    ServiceFileName|contains|all:
    - cmd
    - '"set'
    - -f
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains:
    - system.io.compression.deflatestream
    - system.io.streamreader
    ServiceFileName|contains|all:
    - new-object
    - text.encoding]::ascii
    - readtoend
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains|all:
    - rundll32.exe
    - shell32.dll
    - shellexec_rundll
    - powershell
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains:
    - environment
    - invoke
    - ${input)
    ServiceFileName|contains|all:
    - set
    - '&&'
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains: (Clipboard|i
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains|all:
    - mshta
    - vbscript:createobject
    - .run
    - window.close
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains:
    - value
    - invoke
    - comspec
    - iex
    ServiceFileName|contains|all:
    - '&&'
    - rundll32
    - shell32.dll
    - shellexec_rundll
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains:
    - '{0}'
    - '{1}'
    - '{2}'
    - '{3}'
    - '{4}'
    - '{5}'
    ServiceFileName|contains|all:
    - '&&set'
    - cmd
    - /c
    - -f
- condition: selection and not filter
  filter:
    ObjectName: \Device\CdRom0\setup.exe
  selection:
    EventID: 4663
    ObjectName|startswith: \Device\CdRom
    ObjectServer: Security
    ObjectType: File
- condition: selection1 and not false_positives
  false_positives:
    RelativeTargetName:
    - atsvc
    - samr
    - lsarpc
    - lsass
    - winreg
    - netlogon
    - srvsvc
    - protected_storage
    - wkssvc
    - browser
    - netdfs
    - svcctl
    - spoolss
    - ntsvcs
    - LSM_API_service
    - HydraLsPipe
    - TermSrv_API_service
    - MsFteWds
    - sql\query
    - eventlog
  selection1:
    EventID: 5145
    ShareName: \\\\\*\\IPC$
- condition: selection and not 1 of filter*
  filter1:
    SubjectUserName|endswith: $
  filter2:
    ProcessName|startswith: C:\Program Files
  filter3:
    AccessMask: '0x1410'
    ProcessName: C:\Windows\System32\wbem\WmiPrvSE.exe
  filter_games:
    ProcessName|contains: \SteamLibrary\steamapps\
  selection:
    AccessMask:
    - '0x40'
    - '0x1400'
    - '0x100000'
    - '0x1410'
    - '0x1010'
    - '0x1438'
    - '0x143a'
    - '0x1418'
    - '0x1f0fff'
    - '0x1f1fff'
    - '0x1f2fff'
    - '0x1f3fff'
    - 40
    - 1400
    - 1000
    - 100000
    - 1410
    - 1010
    - 1438
    - 143a
    - 1418
    - 1f0fff
    - 1f1fff
    - 1f2fff
    - 1f3fff
    EventID:
    - 4663
    - 4656
    ObjectName|endswith: \lsass.exe
    ObjectType: Process
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains:
    - fgexec
    - dumpsvc
    - cachedump
    - mimidrv
    - gsecdump
    - servpw
    - pwdump
- condition: selection and 1 of malsvc_*
  malsvc_apt29:
    ServiceName: javamtsup
  selection:
    EventID: 4697
- condition: selection
  selection:
    EventID:
    - 4656
    - 4658
    - 4660
    - 4663
    ObjectName|endswith: \wceaux.dll
- condition: 1 of selection*
  selection1:
    AuthenticationPackageName: NTLM
    EventID:
    - 4625
    - 4624
    LogonType: 3
    WorkstationName|re: ^[A-Za-z0-9]{16}$
  selection2:
    EventID: 4776
    ProcessName: null
    Workstation|re: ^[A-Za-z0-9]{16}$
- condition: selection and not filter
  filter:
    ServiceName: PSEXESVC
  selection:
    EventID: 4697
    ServiceFileName|re: ^%systemroot%\\[a-zA-Z]{8}\.exe$
    ServiceName|re: (^[a-zA-Z]{4}$)|(^[a-zA-Z]{8}$)|(^[a-zA-Z]{16}$)
    ServiceStartType: 3
    ServiceType: '0x10'
- condition: selection_id and selection
  selection:
  - ServiceFileName|contains|all:
    - cmd
    - /c
    - echo
    - \pipe\
  - ServiceFileName|contains|all:
    - '%COMSPEC%'
    - /c
    - echo
    - \pipe\
  - ServiceFileName|contains|all:
    - cmd.exe
    - /c
    - echo
    - \pipe\
  - ServiceFileName|contains|all:
    - rundll32
    - .dll,a
    - '/p:'
  selection_id:
    EventID: 4697
- condition: selection
  selection:
    EventID: 4657
    ObjectName|contains|all:
    - \REGISTRY\MACHINE\SYSTEM
    - ControlSet
    - \Control\Lsa
    ObjectValueName:
    - LmCompatibilityLevel
    - NtlmMinClientSec
    - RestrictSendingNTLMTraffic
- condition: selection
  selection:
    AccessList|contains:
    - WriteData
    - DELETE
    - WriteDAC
    - AppendData
    - AddSubdirectory
    EventID: 5145
    ObjectType: File
    RelativeTargetName|endswith: \desktop.ini
- condition: 1 of selection*
  selection1:
    EventID: 4720
    SamAccountName|contains: $
  selection2:
    EventID: 4781
    NewTargetUserName|contains: $
- condition: selection
  selection:
    EventID: 4825
- condition: selection
  selection:
    AccessList|contains: '%%5392'
    EventID: 4661
    ObjectServer: Security Account Manager
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains:
    - pcap
    - npcap
    - npf
    - nm3
    - ndiscap
    - nmnt
    - windivert
    - USBPcap
    - pktmon
- condition: selection
  selection:
    EventID: 5145
    RelativeTargetName: lsarpc
    ShareName|endswith: \IPC$
    ShareName|startswith: \\\\
    SubjectUserName: ANONYMOUS LOGON
- condition: selection and not 1 of filter_*
  filter_local:
    IpAddress: ::1
  filter_thumbprint:
    CertThumbprint: ''
  selection:
    CertThumbprint|contains: '*'
    EventID: 4768
    TargetUserName|endswith: $
- condition: 1 of selection*
  selection1:
    EventID: 4742
    ServicePrincipalNames|contains: GC/
  selection2:
    AttributeLDAPDisplayName: servicePrincipalName
    AttributeValue|startswith: GC/
    EventID: 5136
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains:
    - powershell
    - pwsh
- condition: selection
  selection:
    EventID: 5145
    RelativeTargetName: protected_storage
    ShareName|contains: IPC
- condition: selection and ( sourceRDP or destinationRDP ) and not 1 of filter*
  destinationRDP:
    DestPort: 3389
    SourceAddress:
    - 127.*
    - ::1
  filter_app_container:
    FilterOrigin: AppContainer Loopback
  filter_thor:
    Application|endswith:
    - \thor.exe
    - \thor64.exe
  selection:
    EventID: 5156
  sourceRDP:
    DestAddress:
    - 127.*
    - ::1
    SourcePort: 3389
- condition: selection
  selection:
    EventID: 4611
    LogonProcessName: User32LogonProcesss
- condition: selection
  selection:
    DestPort:
    - 5985
    - 5986
    EventID: 5156
    LayerRTID: 44
- condition: selection
  selection:
    EventID: 4649
- condition: selection
  selection:
    EventID: 4656
    ObjectName|endswith: \SAM
    ObjectType: Key
- condition: selection and not 1 of filter_*
  filter_main_firefox:
    TaskName|contains: '\Mozilla\Firefox Default Browser Agent '
  filter_main_generic:
    TaskName: \Microsoft\Windows\RemovalTools\MRT_ERROR_HB
  selection:
    EventID: 4699
- condition: selection and not filter
  filter:
    SubjectLogonId: '0x3e4'
  selection:
    AccessMask: '0xf003f'
    EventID: 4656
    ObjectName: ServicesActive
    ObjectType: SC_MANAGER OBJECT
- condition: selection and not filter
  filter:
    ProcessName|endswith: :\Windows\System32\services.exe
    SubjectLogonId: '0x3e4'
  selection:
    EventID: 4674
    ObjectName: servicesactive
    ObjectType: SC_MANAGER OBJECT
    PrivilegeList: SeTakeOwnershipPrivilege
- condition: all of selection*
  selection:
    EventID: 4697
  selection_pid:
  - ClientProcessId: 0
  - ParentProcessId: 0
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains:
    - AmmyyAdmin
    - Atera
    - BASupportExpressSrvcUpdater
    - BASupportExpressStandaloneService
    - chromoting
    - GoToAssist
    - GoToMyPC
    - jumpcloud
    - LMIGuardianSvc
    - LogMeIn
    - monblanking
    - Parsec
    - RManService
    - RPCPerformanceService
    - RPCService
    - SplashtopRemoteService
    - SSUService
    - TeamViewer
    - TightVNC
    - vncserver
    - Zoho
- condition: selection and not filter
  filter:
    SubjectUserName|endswith: $
  selection:
    AccessMask: '0x2'
    EventID: 5145
    ShareName|endswith: C$
- condition: selection
  selection:
    EventID: 4706
- condition: selection1 or (selection2 and not selection3 and not filter_null)
  filter_null:
    SidHistory: null
  selection1:
    EventID:
    - 4765
    - 4766
  selection2:
    EventID: 4738
  selection3:
    SidHistory:
    - '-'
    - '%%1793'
- condition: selection
  selection:
    EventID:
    - 5038
    - 6281
- condition: 1 of selection*
  selection1:
    SamAccountName|endswith: $
    SamAccountName|startswith: SAMTHEADMIN-
  selection2:
    TargetUserName|endswith: $
    TargetUserName|startswith: SAMTHEADMIN-
- condition: selection
  selection:
    EventID: 4794
- condition: 1 of selection_*
  selection_1102:
    EventID: 1102
    Provider_Name: Microsoft-Windows-Eventlog
  selection_517:
    EventID: 517
    Provider_Name: Security
- condition: selection and not filter
  filter:
    SubjectUserSid: S-1-0-0
  selection:
    EventID:
    - 4625
    - 4776
    Status:
    - '0xC0000072'
    - '0xC000006F'
    - '0xC0000070'
    - '0xC0000413'
    - '0xC000018C'
    - '0xC000015B'
- condition: selection
  selection:
    EventID:
    - 675
    - 4768
    - 4769
    - 4771
    FailureCode:
    - '0x9'
    - '0xA'
    - '0xB'
    - '0xF'
    - '0x10'
    - '0x11'
    - '0x13'
    - '0x14'
    - '0x1A'
    - '0x1F'
    - '0x21'
    - '0x22'
    - '0x23'
    - '0x24'
    - '0x26'
    - '0x27'
    - '0x28'
    - '0x29'
    - '0x2C'
    - '0x2D'
    - '0x2E'
    - '0x2F'
    - '0x31'
    - '0x32'
    - '0x3E'
    - '0x3F'
    - '0x40'
    - '0x41'
    - '0x43'
    - '0x44'
- condition: selection
  selection:
    AttributeLDAPDisplayName:
    - primaryInternationalISDNNumber
    - otherFacsimileTelephoneNumber
    - primaryTelexNumber
    AttributeValue|contains: '*'
    EventID: 5136
- condition: selection
  selection:
    EventID: 4720
    SamAccountName|contains|all:
    - ANONYMOUS
    - LOGON
- condition: selection and not 1 of filter*
  filter1:
    TargetServerName: localhost
  filter2:
    SubjectUserName|endswith: $
    TargetUserName|endswith: $
  selection:
    EventID: 4648
    ProcessName|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \winrs.exe
    - \wmic.exe
    - \net.exe
    - \net1.exe
    - \reg.exe
- condition: selection
  selection:
    AccessMask: '0x705'
    EventID: 4656
    ObjectType: SAM_DOMAIN
    ProcessName|endswith: \lsass.exe
- condition: 1 of selection_* and not 1 of filter_*
  filter_aurora:
    AccessList|contains: '%%4484'
    ProcessName|endswith: \aurora-agent-64.exe
    ProcessName|startswith: C:\Windows\Temp\asgard2-agent-sc\aurora\
  filter_avira:
    AccessList|contains: '%%4484'
    ProcessName|contains: \AppData\Local\Temp\is-
    ProcessName|endswith: \avira_system_speedup.tmp
    ProcessName|startswith: C:\Users\
  filter_exact:
    ProcessName:
    - C:\Windows\System32\taskhostw.exe
    - C:\Windows\System32\msiexec.exe
    - C:\Windows\CCM\CcmExec.exe
  filter_generic:
    ProcessName|startswith: C:\Program Files
  filter_scenarioengine:
    AccessList|contains: '%%4484'
    ProcessName|endswith: \x64\SCENARIOENGINE.EXE
  filter_specific:
    ProcessName|endswith:
    - \wmiprvse.exe
    - \taskmgr.exe
    - \procexp64.exe
    - \procexp.exe
    - \lsm.exe
    - \csrss.exe
    - \wininit.exe
    - \vmtoolsd.exe
    - \minionhost.exe
    - \VsTskMgr.exe
    - \thor.exe
    - \thor64.exe
    - \MicrosoftEdgeUpdate.exe
    - \GamingServices.exe
    - \svchost.exe
    - \MsMpEng.exe
    - \MRT.exe
    - RtkAudUService64
    ProcessName|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWow64\
    - C:\Windows\SysNative\
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\Windows\Temp\asgard2-agent\
    - C:\ProgramData\Microsoft\Windows Defender\Platform\
  filter_sysmon:
    AccessList|contains: '%%4484'
    ProcessName: C:\Windows\Sysmon64.exe
  selection_1:
    AccessMask|contains:
    - '0x40'
    - '0x1400'
    - '0x100000'
    - '0x1410'
    - '0x1010'
    - '0x1438'
    - '0x143a'
    - '0x1418'
    - '0x1f0fff'
    - '0x1f1fff'
    - '0x1f2fff'
    - '0x1f3fff'
    EventID: 4656
    ObjectName|endswith: \lsass.exe
  selection_2:
    AccessList|contains:
    - '4484'
    - '4416'
    EventID: 4663
    ObjectName|endswith: \lsass.exe
- condition: selection
  selection:
    AccessMask: '0x2d'
    EventID: 4661
    ObjectName|endswith:
    - '-500'
    - '-512'
    ObjectName|startswith: S-1-5-21-
    ObjectType:
    - SAM_USER
    - SAM_GROUP
- condition: selection and not filter
  filter:
    TargetName|contains: \Temporary Internet Files\Content.Outlook
  selection:
    EventID: 5379
    TargetName|contains: Microsoft_Windows_Shell_ZipFolder:filename
- condition: selection and selection_filename
  selection:
    EventID: 5379
    TargetName|contains: Microsoft_Windows_Shell_ZipFolder:filename
  selection_filename:
    TargetName|contains:
    - invoice
    - new order
    - rechnung
    - factura
    - delivery
    - purchase
    - order
    - payment
- condition: selection
  selection:
    EventID: 5379
    TargetName|contains|all:
    - Microsoft_Windows_Shell_ZipFolder:filename
    - \Temporary Internet Files\Content.Outlook
- condition: selection and not 1 of filter_*
  filter_exact:
    Application:
    - C:\Windows\System32\lsass.exe
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  selection:
    DestPort: 88
    EventID: 5156
- condition: selection
  selection:
    AttributeLDAPDisplayName: msDS-KeyCredentialLink
    EventID: 5136
- condition: selection1 and not filter
  filter:
    RelativeTargetName|startswith: PSEXESVC
  selection1:
    EventID: 5145
    RelativeTargetName|endswith:
    - -stdin
    - -stdout
    - -stderr
    ShareName: \\\\\*\\IPC$
- condition: selection
  selection:
    EventID: 5145
    RelativeTargetName|endswith:
    - .pst
    - .ost
    - .msg
    - .nst
    - .oab
    - .edb
    - .nsf
    - .bak
    - .dmp
    - .kirbi
    - \groups.xml
    - .rdp
- condition: selection and not reduction
  reduction:
    ServiceName|endswith: $
  selection:
    EventID: 4769
    TicketEncryptionType: '0x17'
    TicketOptions: '0x40810000'
- condition: all of selection_*
  selection_commands:
    TaskContent|contains:
    - regsvr32
    - rundll32
    - cmd.exe</Command>
    - cmd</Command>
    - '<Arguments>/c '
    - '<Arguments>/k '
    - '<Arguments>/r '
    - powershell
    - pwsh
    - mshta
    - wscript
    - cscript
    - certutil
    - bitsadmin
    - bash.exe
    - 'bash '
    - scrcons
    - 'wmic '
    - wmic.exe
    - forfiles
    - scriptrunner
    - hh.exe
  selection_eid:
    EventID: 4698
  selection_paths:
    TaskContent|contains:
    - \AppData\Local\Temp\
    - \AppData\Roaming\
    - \Users\Public\
    - \WINDOWS\Temp\
    - C:\Temp\
    - \Desktop\
    - \Downloads\
    - \Temporary Internet
    - C:\ProgramData\
    - C:\Perflogs\
- condition: selection and not 1 of filter_*
  filter_sys_username:
    EventID: 4699
    SubjectUserName|endswith: $
    TaskName|contains: \Windows\Windows Defender\
  selection:
    EventID:
    - 4699
    - 4701
    TaskName|contains:
    - \Windows\SystemRestore\SR
    - \Windows\Windows Defender\
    - \Windows\BitLocker
    - \Windows\WindowsBackup\
    - \Windows\WindowsUpdate\
    - \Windows\UpdateOrchestrator\Schedule
    - \Windows\ExploitGuard
- condition: all of selection_*
  selection_commands:
    TaskContentNew|contains:
    - regsvr32
    - rundll32
    - cmd.exe</Command>
    - cmd</Command>
    - '<Arguments>/c '
    - '<Arguments>/k '
    - '<Arguments>/r '
    - powershell
    - pwsh
    - mshta
    - wscript
    - cscript
    - certutil
    - bitsadmin
    - bash.exe
    - 'bash '
    - scrcons
    - 'wmic '
    - wmic.exe
    - forfiles
    - scriptrunner
    - hh.exe
  selection_eid:
    EventID: 4702
  selection_paths:
    TaskContentNew|contains:
    - \AppData\Local\Temp\
    - \AppData\Roaming\
    - \Users\Public\
    - \WINDOWS\Temp\
    - C:\Temp\
    - \Desktop\
    - \Downloads\
    - \Temporary Internet
    - C:\ProgramData\
    - C:\Perflogs\
- condition: selection
  selection:
    EventID:
    - 4656
    - 4663
    - 4658
    ObjectName|endswith:
    - .AAA
    - .ZZZ
- condition: selection and not 1 of filter*
  filter1:
    ProcessName:
    - C:\Program Files\VMware\VMware Tools\vmtoolsd.exe
    - C:\Windows\System32\VBoxService.exe
    - C:\Windows\System32\oobe\msoobe.exe
  filter2:
    ProcessName: C:\Windows\System32\svchost.exe
    SubjectUserSid: S-1-5-19
  selection:
    EventID: 4616
- condition: selection
  selection:
    Accesses|contains: WriteData
    EventID: 5145
    RelativeTargetName: svcctl
    ShareName: \\\\\*\\IPC$
- condition: selection
  selection:
    EventID:
    - 4656
    - 4663
    ObjectName|endswith:
    - lsa\JD
    - lsa\GBG
    - lsa\Skew1
    - lsa\Data
    ObjectType: key
- condition: 1 of selection*
  selection1:
    EventID: 4657
    NewValue: 0
    ObjectName|contains:
    - WINEVT\Publishers\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}
    - WINEVT\Channels\Microsoft-Windows-Sysmon/Operational
    ObjectValueName: Enabled
  selection2:
    AccessMask: 65536
    EventID: 4663
    ObjectName|contains:
    - WINEVT\Publishers\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}
    - WINEVT\Channels\Microsoft-Windows-Sysmon/Operational
- condition: selection
  selection:
    EventID: 4697
    ServiceFileName|contains: tap0901
- condition: selection and not filter
  filter:
    ProcessName|contains: \Microsoft\Teams\current\Teams.exe
  selection:
    EventID: 4663
    ObjectName|contains:
    - \Microsoft\Teams\Cookies
    - \Microsoft\Teams\Local Storage\leveldb
- condition: selection
  selection:
    EventID: 5145
    RelativeTargetName|contains:
    - \mimidrv
    - \lsass
    - \windows\minidump\
    - \hiberfil
    - \sqldmpr
    - \sam
    - \ntds.dit
    - \security
- condition: selection and (1 of selection_group*) and not filter
  filter:
    SubjectUserName|endswith: $
  selection:
    EventID: 4732
  selection_group1:
    TargetUserName|startswith: Administr
  selection_group2:
    TargetSid: S-1-5-32-544
- condition: selection
  selection:
    EventID: 4673
    Keywords: '0x8010000000000000'
    Service: LsaRegisterLogonProcess()
- condition: selection
  selection:
    EventID: 4720
- condition: selection_1 and not 1 of filter_*
  filter_endswith:
    ProcessName|endswith:
    - \procexp64.exe
    - \procexp.exe
    - \procmon64.exe
    - \procmon.exe
    - \Google\Chrome\Application\chrome.exe
    - \AppData\Local\Microsoft\Teams\current\Teams.exe
  filter_exact:
    ProcessName:
    - C:\Windows\System32\Dism.exe
    - C:\Windows\System32\rundll32.exe
    - C:\Windows\System32\fltMC.exe
    - C:\Windows\HelpPane.exe
    - C:\Windows\System32\mmc.exe
    - C:\Windows\System32\svchost.exe
    - C:\Windows\System32\wimserv.exe
    - C:\Windows\System32\RuntimeBroker.exe
    - C:\Windows\System32\SystemSettingsBroker.exe
    - C:\Windows\explorer.exe
  filter_startswith:
    ProcessName|startswith: C:\Program Files\WindowsApps\Microsoft
  selection_1:
    EventID: 4673
    PrivilegeList: SeLoadDriverPrivilege
    Service: '-'
- condition: selection
  selection:
    EventID:
    - 4634
    - 4647
- condition: selection
  selection:
    AuditSourceName: VSSAudit
    EventID:
    - 4904
    - 4905
- condition: selection and not filter
  filter:
    SubjectUserName|endswith: $
  selection:
    EventID: 5145
    RelativeTargetName|endswith: \wbem\wbemcomn.dll
- condition: selection
  selection:
    EventID: 4662
    ObjectName|contains: subscription
    ObjectType: WMI Namespace
- condition: selection
  selection:
    EventID: 4800
- condition: selection
  selection:
    AuthenticationPackageName: Negotiate
    EventID: 4624
    ImpersonationLevel: '%%1833'
    LogonProcessName: Advapi
    LogonType: 9
- condition: selection
  selection:
    AuthenticationPackageName: Negotiate
    EventID: 4624
    LogonType: 10
    TargetUserName|startswith: Admin
- condition: selection
  selection:
    EventID: 4624
    LogonType: 9
    TargetOutboundUserName: thisisnotvaliduser
- condition: selection
  selection:
    EventID:
    - 4728
    - 632
- condition: selection
  selection:
    EventID:
    - 633
    - 4729
- condition: selection
  selection:
    AuthenticationPackageName: Negotiate
    EventID: 4624
    LogonProcessName: seclogo
    LogonType: 9
- condition: 1 of selection_* and not filter
  filter:
    TargetUserName: ANONYMOUS LOGON
  selection_logon3:
    EventID: 4624
    KeyLength: 0
    LogonProcessName: NtLmSsp
    LogonType: 3
    SubjectUserSid: S-1-0-0
  selection_logon9:
    EventID: 4624
    LogonProcessName: seclogo
    LogonType: 9
- condition: selection
  selection:
    EventID: 4625
    TargetUserName: AAAAAAA
- condition: selection
  selection:
    EventID: 4624
    IpAddress:
    - ::1
    - 127.0.0.1
    LogonType: 10
- condition: selection and not filter
  filter:
    TargetLogonId: '0x3e7'
  selection:
    EventID: 4624
    LogonType: 3
    ProcessName|endswith: scrcons.exe
- condition: selection
  selection:
    EventID:
    - 4730
    - 634
- condition: selection and not 1 of filter_*
  filter_empty:
    IpAddress: '-'
  filter_ipv4:
    IpAddress|cidr:
    - 127.0.0.0/8
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.168.0.0/16
  filter_ipv6:
  - IpAddress: ::1
  - IpAddress|startswith:
    - 'fe80:'
    - fc
    - fd
  selection:
    EventID: 4624
    LogonType: 10
- condition: selection and not 1 of filter_*
  filter_empty:
    IpAddress: '-'
  filter_ipv4:
    IpAddress|cidr:
    - 127.0.0.0/8
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.168.0.0/16
  filter_ipv6:
  - IpAddress: ::1
  - IpAddress|startswith:
    - 'fe80:'
    - fc
    - fd
  selection:
    EventID: 4624
    LogonType: 3
- condition: selection and not 1 of filter_*
  filter_ip_privatev4:
    IpAddress|startswith:
    - '10.'
    - 192.168.
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - '127.'
    - 169.254.
  filter_ip_privatev6:
  - IpAddress: ::1
  - IpAddress|startswith:
    - 'fe80::'
    - 'fc00::'
  filter_ip_unknown:
    IpAddress|contains: '-'
  selection:
    EventID: 4625
- condition: selection
  selection:
    AuthenticationPackageName: Kerberos
    EventID: 4624
    IpAddress: 127.0.0.1
    LogonType: 3
    TargetUserSid|endswith: '-500'
    TargetUserSid|startswith: S-1-5-21-
- condition: selection
  selection:
    EventID: 4624
    LogonType: 9
- condition: selection
  selection:
    EventID: 4624
    IpAddress:
    - 127.0.0.1
    - ::1
    LogonType: 3
    TargetUserName: ANONYMOUS LOGON
    WorkstationName: '-'
- condition: selection
  selection:
    EventID: 4624
    ProcessName|endswith: \WmiPrvSE.exe
- condition: selection
  selection:
    EventID:
    - 11
    - 12
    ProcessPath|endswith:
    - \MpCmdRun.exe
    - \NisSrv.exe
- condition: selection
  selection:
    EventID:
    - 11
    - 12
    ImageName|contains:
    - \Users\Public\
    - \PerfLogs\
    - \Desktop\
    - \Downloads\
    - \AppData\Local\Temp\
    - C:\Windows\TEMP\
- condition: selection and keywords
  keywords:
  - HybridConnection
  - sb://
  - servicebus.windows.net
  - HybridConnectionManage
  selection:
    EventID:
    - 40300
    - 40301
    - 40302
- condition: 1 of selection_*
  selection_name:
    EventID: 28115
    Name|contains:
    - Zenmap
    - AnyDesk
    - wireshark
    - openvpn
  selection_packageid:
    AppID|contains:
    - zenmap.exe
    - prokzult ad
    - wireshark
    - openvpn
    EventID: 28115
- condition: selection
  selection:
    EventID: 31017
    ServerName|startswith: \1
    UserName: ''
- condition: selection
  selection:
    Caption: sysmon64.exe - Application Error
    EventID: 26
    Provider_Name: Application Popup
- condition: selection
  selection:
    EventID:
    - 6038
    - 6039
    Provider_Name: LsaSrv
- condition: selection
  selection:
    EventID: 1033
    Provider_Name: Microsoft-Windows-DHCP-Server
- condition: selection
  selection:
    EventID:
    - 1031
    - 1032
    - 1034
    Provider_Name: Microsoft-Windows-DHCP-Server
- condition: selection
  selection:
    EventID:
    - 16990
    - 16991
    Provider_Name: Microsoft-Windows-Directory-Services-SAM
- condition: selection
  selection:
    EventID: 10001
    Provider_Name: Microsoft-Windows-DistributedCOM
    param1: C:\Program Files\Common Files\microsoft shared\ink\TabTip.exe
    param2: 2147943140
    param3: '{054AAE20-4BEA-4347-8A35-64A533254A9D}'
- condition: selection and not filter
  filter:
    Channel:
    - Application
    - Microsoft-Windows-PowerShell/Operational
    - Microsoft-Windows-Sysmon/Operational
    - PowerShellCore/Operational
    - Security
    - System
    - Windows PowerShell
  selection:
    EventID: 104
    Provider_Name: Microsoft-Windows-Eventlog
- condition: selection
  selection:
    Channel:
    - Application
    - Microsoft-Windows-PowerShell/Operational
    - Microsoft-Windows-Sysmon/Operational
    - PowerShellCore/Operational
    - Security
    - System
    - Windows PowerShell
    EventID: 104
    Provider_Name: Microsoft-Windows-Eventlog
- condition: selection
  selection:
    EventID: 42
    Level: 2
    Provider_Name: Kerberos-Key-Distribution-Center
- condition: selection
  selection:
    EventID: 16
    HiveName|contains: \AppData\Local\Temp\SAM
    HiveName|endswith: .dmp
    Provider_Name: Microsoft-Windows-Kernel-General
- condition: selection and keywords
  keywords:
    '|all':
    - \AppData\Local\Temp\SAM-
    - .dmp
  selection:
    EventID: 16
    Provider_Name: Microsoft-Windows-Kernel-General
- condition: selection
  selection:
    DeviceName|contains: HarddiskVolumeShadowCopy
    EventID: 98
    Provider_Name: Microsoft-Windows-Ntfs
- condition: selection
  selection:
    EventID: 1511
    Provider_Name: Microsoft-Windows-User Profiles Service
- condition: selection
  selection:
    EventID:
    - 16
    - 20
    - 24
    - 213
    - 217
    Provider_Name: Microsoft-Windows-WindowsUpdateClient
- condition: selection and keywords
  keywords:
  - kali
  - mimikatz
  selection:
    EventID:
    - 5805
    - 5723
- condition: selection
  selection:
    EventID: 5829
    Provider_Name: NetLogon
- condition: selection
  selection:
    Description|contains|all:
    - contains a corrupted file record
    - The name of the file is "\"
    EventID: 55
    Origin: File System Driver
    Provider_Name: Ntfs
- condition: selection
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
    ServiceName:
    - srservice
    - ipvpn
    - hkmsvc
- condition: selection
  selection:
    EventID: 7045
    ImagePath|endswith: ' LocalService'
    Provider_Name: Service Control Manager
    ServiceName: NtsSrv
- condition: selection
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
    ServiceName: WerFaultSvc
- condition: selection_id and (selection1 or selection2 or selection3 or selection4)
  selection1:
    ImagePath|contains|all:
    - ADMIN$
    - .exe
  selection2:
    ImagePath|contains|all:
    - '%COMSPEC%'
    - start
    - powershell
  selection3:
    ImagePath|contains: powershell -nop -w hidden -encodedcommand
  selection4:
    ImagePath|base64offset|contains: 'IEX (New-Object Net.Webclient).DownloadString(''http://127.0.0.1:'
  selection_id:
    EventID: 7045
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7036
    Provider_Name: Service Control Manager
    param1:
    - Windows Defender Antivirus Service
    - Service antivirus Microsoft Defender
    param2: stopped
- condition: selection
  selection:
    EventID: 7045
    ImagePath|endswith: \execute.bat
    Provider_Name: Service Control Manager
    ServiceName: BTOBTO
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains|all:
    - cmd
    - '&&'
    - 'clipboard]::'
    Provider_Name: Service Control Manager
- condition: all of selection_*
  selection_eid:
    EventID: 7045
  selection_imagepath:
  - ImagePath|re: \$PSHome\[\s*\d{1,3}\s*\]\s*\+\s*\$PSHome\[
  - ImagePath|re: \$ShellId\[\s*\d{1,3}\s*\]\s*\+\s*\$ShellId\[
  - ImagePath|re: \$env:Public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:Public\[
  - ImagePath|re: \$env:ComSpec\[(\s*\d{1,3}\s*,){2}
  - ImagePath|re: \\*mdr\*\W\s*\)\.Name
  - ImagePath|re: \$VerbosePreference\.ToString\(
  - ImagePath|re: \String\]\s*\$VerbosePreference
- condition: all of selection_*
  selection_main:
    EventID: 7045
    ImagePath|contains:
    - /c
    - /r
    ImagePath|contains|all:
    - cmd
    - powershell
    Provider_Name: Service Control Manager
  selection_other:
  - ImagePath|contains: noexit
  - ImagePath|contains|all:
    - input
    - $
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains:
    - /c
    - /r
    ImagePath|contains|all:
    - cmd
    - '"set'
    - -f
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains:
    - :system.io.compression.deflatestream
    - system.io.streamreader
    ImagePath|contains|all:
    - new-object
    - text.encoding]::ascii
    - readtoend
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains|all:
    - rundll32.exe
    - shell32.dll
    - shellexec_rundll
    - powershell
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains:
    - environment
    - invoke
    - input
    ImagePath|contains|all:
    - set
    - '&&'
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains: (Clipboard|i
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains|all:
    - mshta
    - vbscript:createobject
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains:
    - value
    - invoke
    - comspec
    - iex
    ImagePath|contains|all:
    - '&&'
    - rundll32
    - shell32.dll
    - shellexec_rundll
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains:
    - '{0}'
    - '{1}'
    - '{2}'
    - '{3}'
    - '{4}'
    - '{5}'
    ImagePath|contains|all:
    - '&&set'
    - cmd
    - /c
    - -f
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    ServiceName: KrbSCM
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains:
    - fgexec
    - dumpsvc
    - cachedump
    - mimidrv
    - gsecdump
    - servpw
    - pwdump
    Provider_Name: Service Control Manager
- condition: selection_id and selection
  selection:
  - ImagePath|contains|all:
    - cmd
    - /c
    - echo
    - \pipe\
  - ImagePath|contains|all:
    - '%COMSPEC%'
    - /c
    - echo
    - \pipe\
  - ImagePath|contains|all:
    - cmd.exe
    - /c
    - echo
    - \pipe\
  - ImagePath|contains|all:
    - rundll32
    - .dll,a
    - '/p:'
  - ImagePath|startswith: \\\\127.0.0.1\\ADMIN$\
  selection_id:
    EventID: 7045
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
    ServiceName: ZzNetSvc
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains:
    - powershell
    - pwsh
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
    ServiceName: AnyDesk Service
- condition: service and selection
  selection:
  - ServiceName|contains:
    - WCESERVICE
    - WCE SERVICE
    - winexesvc
    - DumpSvc
    - pwdump
    - gsecdump
    - cachedump
  - ImagePath|contains: bypass
  service:
    EventID:
    - 7045
    - 7036
    Provider_Name: Service Control Manager
- condition: all of selection_*
  selection_root:
    EventID: 7045
    Provider_Name: Service Control Manager
  selection_service:
  - ImagePath|contains: MeshAgent.exe
  - ServiceName|contains: Mesh Agent
- condition: all of selection_*
  selection_root:
    EventID: 7045
    Provider_Name: Service Control Manager
  selection_service:
  - ImagePath|contains: \NetSupport Manager\client32.exe
  - ServiceName: Client32
- condition: all of selection_*
  selection_eid:
    EventID: 7045
    Provider_Name: Service Control Manager
  selection_image:
  - ServiceName|startswith: PAExec-
  - ImagePath|startswith: C:\WINDOWS\PAExec-
- condition: all of selection_*
  selection_root:
    EventID: 7045
    Provider_Name: Service Control Manager
  selection_service:
  - ImagePath|contains: PDQDeployService.exe
  - ServiceName:
    - PDQDeploy
    - PDQ Deploy
- condition: all of selection_*
  selection_root:
    EventID: 7045
    Provider_Name: Service Control Manager
  selection_service:
  - ImagePath|contains: PDQDeployRunner-
  - ServiceName|startswith: PDQDeployRunner-
- condition: 1 of service_*
  service_execution:
    EventID: 7036
    ServiceName: PSEXESVC
  service_installation:
    EventID: 7045
    ImagePath|endswith: \PSEXESVC.exe
    Provider_Name: Service Control Manager
    ServiceName: PSEXESVC
- condition: selection
  selection:
    EventID:
    - 7045
    - 7036
    Provider_Name: Service Control Manager
    ServiceName|contains:
    - AmmyyAdmin
    - Atera
    - BASupportExpressSrvcUpdater
    - BASupportExpressStandaloneService
    - chromoting
    - GoToAssist
    - GoToMyPC
    - jumpcloud
    - LMIGuardianSvc
    - LogMeIn
    - monblanking
    - Parsec
    - RManService
    - RPCPerformanceService
    - RPCService
    - SplashtopRemoteService
    - SSUService
    - TeamViewer
    - TightVNC
    - vncserver
    - Zoho
- condition: all of selection_*
  selection_root:
    EventID: 7045
    Provider_Name: Service Control Manager
  selection_service:
  - ImagePath|contains|all:
    - \rutserv.exe
    - -service
  - ServiceName: Remote Utilities - Host
- condition: selection_id and 1 of selection_service*
  selection_id:
    EventID: 7045
    Provider_Name: Service Control Manager
  selection_service1:
    ImagePath|re: ^[a-zA-Z]:\\windows\\temp\\[a-zA-Z0-9]{10}\.exe
  selection_service2:
    ServiceName:
    - Sliver
    - Sliver implant
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains: '&&'
    Provider_Name: Service Control Manager
- condition: all of selection_*
  selection_root:
    EventID: 7045
    Provider_Name: Service Control Manager
  selection_service:
  - ImagePath|contains: tacticalrmm.exe
  - ServiceName|contains: TacticalRMM Agent Service
- condition: selection
  selection:
    EventID: 7023
    Provider_Name: Service Control Manager
- condition: all of selection_*
  selection_eid:
    EventID: 7023
    Provider_Name: Service Control Manager
  selection_name:
  - param1|contains:
    - ' Antivirus'
    - ' Firewall'
    - Application Guard
    - BitLocker Drive Encryption Service
    - Encrypting File System
    - Microsoft Defender
    - Threat Protection
    - Windows Event Log
  - Binary|contains:
    - 770069006e0064006500660065006e006400
    - 4500760065006e0074004c006f006700
    - 6d0070007300730076006300
    - 530065006e0073006500
    - '450046005300'
    - '420044004500530056004300'
- condition: all of selection_*
  selection_eid:
    EventID: 7034
    Provider_Name: Service Control Manager
  selection_name:
  - param1|contains: Message Queuing
  - Binary|contains:
    - 4d0053004d005100
    - 6d0073006d007100
- condition: selection
  selection:
    AccountName: LocalSystem
    EventID: 7045
    Provider_Name: Service Control Manager
    ServiceName|startswith: ProcessHacker
- condition: selection
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
    ServiceName: RTCore64
- condition: selection and ( suspicious1 or all of suspicious2* ) and not 1 of filter_*
  filter_defender_def_updates:
    ImagePath|startswith: C:\ProgramData\Microsoft\Windows Defender\Definition Updates\
  filter_thor_remote:
    ImagePath|startswith: C:\WINDOWS\TEMP\thor10-remote\thor64.exe
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
  suspicious1:
    ImagePath|contains:
    - ' -w hidden '
    - ' -nop '
    - ' -sta '
    - \Users\Public\
    - \Windows\Temp\
    - \Perflogs\
    - \\\\.\\pipe
    - \ADMIN$\
    - C:\Temp\
    - .downloadstring(
    - .downloadfile(
  suspicious2a:
    ImagePath|contains: ' -e'
  suspicious2b:
    ImagePath|contains:
    - ' JAB'
    - ' SUVYI'
    - ' SQBFAFgA'
    - ' aWV4I'
    - ' IAB'
    - ' PAA'
    - ' aQBlAHgA'
- condition: all of selection* and not 1 of filter*
  filter_zoom:
    ImagePath|startswith: '"C:\Program Files\Common Files\Zoom\Support\CptService.exe'
    ServiceName: Zoom Sharing Service
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
  selection_suspicious1:
    ImagePath|contains:
    - \AppData\
    - \\\\127.0.0.1
    - \\\\localhost
- condition: selection and 1 of suspicious*
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
  suspicious1:
  - ImagePath|re: ^[Cc]:\\[Pp]rogram[Dd]ata\\.{1,9}\.exe
  - ImagePath|re: ^[Cc]:\\.{1,9}\.exe
- condition: selection and all of suspicious*
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
  suspicious1:
    ImagePath|contains:
    - ' /c '
    - ' /r '
    - ' /k '
  suspicious2:
    ImagePath|contains:
    - powershell
    - pwsh
    - wscript
    - cscript
    - mshta
    - rundll32
    - regsvr32
- condition: selection
  selection:
    EventID: 7045
    ProcessId: 0
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains: tap0901
    Provider_Name: Service Control Manager
- condition: selection
  selection:
    EventID:
    - 56
    - 50
    Provider_Name: TermDD
- condition: selection
  selection:
    EventID: 129
    Path|contains:
    - C:\Windows\Temp\
    - \AppData\Local\Temp\
    - \Desktop\
    - \Downloads\
    - \Users\Public\
    - C:\Temp\
- condition: selection
  selection:
    EventID: 129
    Path|endswith:
    - \calc.exe
    - \cscript.exe
    - \mshta.exe
    - \mspaint.exe
    - \notepad.exe
    - \regsvr32.exe
    - \wscript.exe
- condition: selection and not filter
  filter:
    UserName|contains:
    - AUTHORI
    - AUTORI
  selection:
    EventID: 141
    TaskName|contains:
    - \Windows\SystemRestore\SR
    - \Windows\Windows Defender\
    - \Windows\BitLocker
    - \Windows\WindowsBackup\
    - \Windows\WindowsUpdate\
    - \Windows\UpdateOrchestrator\
    - \Windows\ExploitGuard
- condition: selection
  selection:
    Address|contains: '16777216'
    EventID: 21
- condition: selection and not 1 of filter_*
  filter_begins:
    ProcessName|startswith:
    - C:\Windows\System32\DriverStore\
    - C:\WINDOWS\Installer\
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_exact:
    ProcessName:
    - C:\Windows\System32\atiesrxx.exe
    - C:\Windows\System32\CompatTelRunner.exe
    - C:\Windows\System32\msiexec.exe
    - C:\Windows\System32\nvwmi64.exe
    - C:\Windows\System32\svchost.exe
    - C:\Windows\System32\Taskmgr.exe
    - C:\Windows\System32\wbem\WmiPrvSE.exe
    - C:\Windows\SysWOW64\msiexec.exe
  filter_thor:
    ProcessName|endswith:
    - \thor64.exe
    - \thor.exe
    ProcessName|startswith: C:\Windows\Temp\asgard2-agent\
  selection:
    EventID: 1121
    Path|endswith: \lsass.exe
- condition: selection
  selection:
    EventID: 1116
    SourceName: AMSI
- condition: selection
  selection:
    EventID:
    - 5001
    - 5010
    - 5012
    - 5101
- condition: selection
  selection:
    EventID: 5007
    NewValue|contains: \Microsoft\Windows Defender\Exclusions
- allowed_apps_key:
    EventID: 5007
    NewValue|contains: \Windows Defender\Windows Defender Exploit Guard\Controlled
      Folder Access\AllowedApplications\
  allowed_apps_path:
    NewValue|contains:
    - \Users\Public\
    - \AppData\Local\Temp\
    - \Desktop\
    - \PerfLogs\
    - \Windows\Temp\
  condition: all of allowed_apps* or protected_folders
  protected_folders:
    EventID: 5007
    OldValue|contains: \Windows Defender\Windows Defender Exploit Guard\Controlled
      Folder Access\ProtectedFolders\
- condition: selection
  selection:
    EventID: 1013
- condition: selection
  selection:
    EventID: 1121
    ProcessName|endswith:
    - \wmiprvse.exe
    - \psexesvc.exe
- condition: selection and not 1 of filter_optional_*
  filter_optional_network_inspection:
    Feature_Name: '%%886'
    Reason:
    - '%%892'
    - '%%858'
  selection:
    EventID:
    - 3002
    - 3007
- condition: selection
  selection:
    EventID: 1009
- condition: selection
  selection:
    EventID: 5007
    NewValue|contains:
    - '\Windows Defender\DisableAntiSpyware '
    - '\Windows Defender\Scan\DisableRemovableDriveScanning '
    - '\Windows Defender\Scan\DisableScanningMappedNetworkDrivesForFullScan '
    - '\Windows Defender\SpyNet\DisableBlockAtFirstSeen '
    - '\Real-Time Protection\SpyNetReporting '
    - '\Real-Time Protection\SubmitSamplesConsent '
- condition: selection
  selection:
    EventID: 5013
    Value|endswith:
    - \Windows Defender\DisableAntiSpyware
    - \Windows Defender\DisableAntiVirus
    - \Windows Defender\Scan\DisableArchiveScanning
    - \Windows Defender\Scan\DisableScanningNetworkFiles
    - \Real-Time Protection\DisableRealtimeMonitoring
    - \Real-Time Protection\DisableBehaviorMonitoring
    - \Real-Time Protection\DisableIOAVProtection
    - \Real-Time Protection\DisableScriptScanning
- condition: selection
  selection:
    EventID:
    - 1006
    - 1116
    - 1015
    - 1117
- condition: ( (wmi_filter_to_consumer_binding and consumer_keywords) or (wmi_filter_registration)
    ) and not filter_scmevent
  consumer_keywords:
  - ActiveScriptEventConsumer
  - CommandLineEventConsumer
  - CommandLineTemplate
  filter_scmevent:
    PossibleCause: Permanent
    Provider: SCM Event Provider
    Query: select * from MSFT_SCMEventLogEvent
    User: S-1-5-32-544
  wmi_filter_registration:
    EventID: 5859
  wmi_filter_to_consumer_binding:
    EventID: 5861
- condition: selection
  selection:
    SourceImage|endswith:
    - \System32\cscript.exe
    - \System32\wscript.exe
    - \System32\mshta.exe
    - \winword.exe
    - \excel.exe
    StartModule: null
    TargetImage|contains: \SysWOW64\
- condition: selection
  selection:
    StartAddress|endswith:
    - 0B80
    - 0C7C
    - 0C88
- condition: selection
  selection:
    TargetImage|endswith: \KeePass.exe
- condition: selection
  selection:
    StartFunction: LoadLibraryA
    StartModule|endswith: \kernel32.dll
- condition: selection
  selection:
    StartModule: ''
    TargetImage|endswith: \lsass.exe
- condition: selection and not 1 of filter_main_*
  filter_main_compattelrunner:
    SourceParentImage: C:\Windows\System32\CompatTelRunner.exe
  selection:
    SourceImage|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: selection
  selection:
    SourceImage|endswith:
    - \powershell.exe
    - \pwsh.exe
    TargetImage|endswith: \lsass.exe
- condition: selection
  selection:
    SourceImage|endswith:
    - \powershell.exe
    - \pwsh.exe
    TargetImage|endswith: \rundll32.exe
- condition: selection
  selection:
    SourceImage|endswith: \ttdinject.exe
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_provtool:
    SourceImage: C:\Windows\System32\provtool.exe
    TargetParentProcessId: 0
  filter_main_schtasks_conhost:
    SourceImage:
    - C:\Windows\System32\schtasks.exe
    - C:\Windows\SysWOW64\schtasks.exe
    TargetImage: C:\Windows\System32\conhost.exe
  filter_main_vssvc:
    SourceImage: C:\Windows\System32\VSSVC.exe
    TargetImage: System
  filter_main_winlogon_1:
    SourceImage: C:\Windows\System32\winlogon.exe
    TargetImage:
    - C:\Windows\System32\services.exe
    - C:\Windows\System32\wininit.exe
    - C:\Windows\System32\csrss.exe
  filter_main_winlogon_2:
    SourceImage: C:\Windows\System32\winlogon.exe
    TargetParentImage: System
    TargetParentProcessId: 4
  filter_optional_nvidia:
    SourceImage: C:\Windows\explorer.exe
    TargetImage: C:\Program Files\NVIDIA Corporation\NVIDIA GeForce Experience\NVIDIA
      GeForce Experience.exe
  selection:
    SourceImage|endswith:
    - \bash.exe
    - \cscript.exe
    - \cvtres.exe
    - \defrag.exe
    - \dnx.exe
    - \esentutl.exe
    - \excel.exe
    - \expand.exe
    - \explorer.exe
    - \find.exe
    - \findstr.exe
    - \forfiles.exe
    - \gpupdate.exe
    - \hh.exe
    - \iexplore.exe
    - \installutil.exe
    - \lync.exe
    - \makecab.exe
    - \mDNSResponder.exe
    - \monitoringhost.exe
    - \msbuild.exe
    - \mshta.exe
    - \msiexec.exe
    - \mspaint.exe
    - \outlook.exe
    - \ping.exe
    - \powerpnt.exe
    - \provtool.exe
    - \python.exe
    - \regsvr32.exe
    - \robocopy.exe
    - \runonce.exe
    - \sapcimc.exe
    - \schtasks.exe
    - \smartscreen.exe
    - \spoolsv.exe
    - \tstheme.exe
    - \userinit.exe
    - \vssadmin.exe
    - \vssvc.exe
    - \w3wp.exe
    - \winlogon.exe
    - \winscp.exe
    - \winword.exe
    - \wmic.exe
    - \wscript.exe
- condition: selection and not 1 of filter_optional_*
  filter_optional_aurora_1:
    StartFunction: EtwpNotificationThread
  filter_optional_aurora_2:
    SourceImage|contains: unknown process
  filter_optional_rundll32:
    SourceImage: C:\Windows\System32\rundll32.exe
    StartFunction:
    - LoadLibraryW
    - FreeLibrary
    TargetImage: C:\Windows\explorer.exe
  filter_optional_spoolsv:
    SourceImage: C:\Windows\System32\csrss.exe
    TargetImage: C:\Windows\System32\spoolsv.exe
  filter_optional_vmtoolsd:
    SourceImage: C:\Program Files\VMware\VMware Tools\vmtoolsd.exe
    StartFunction: GetCommandLineW
    TargetImage:
    - C:\Windows\explorer.exe
    - C:\Windows\System32\notepad.exe
    - C:\Windows\System32\spoolsv.exe
  filter_optional_winzip:
    SourceImage: C:\Program Files\WinZip\FAHWindow64.exe
    TargetImage: C:\Windows\explorer.exe
  selection:
    TargetImage|endswith:
    - \calc.exe
    - \calculator.exe
    - \explorer.exe
    - \mspaint.exe
    - \notepad.exe
    - \ping.exe
    - \sethc.exe
    - \spoolsv.exe
    - \wordpad.exe
    - \write.exe
- condition: selection and not 1 of filter_main_*
  filter_main_null:
    Hash|contains: IMPHASH=00000000000000000000000000000000
  selection:
    Hash|contains: IMPHASH=
- condition: selection and not 1 of filter_optional_*
  filter_optional_brave:
    Image|endswith: \brave.exe
  filter_optional_chrome:
    Image:
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  filter_optional_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_optional_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_optional_firefox:
    Image:
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  filter_optional_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_optional_maxthon:
    Image|endswith: \maxthon.exe
  filter_optional_opera:
    Image|endswith: \opera.exe
  filter_optional_safari:
    Image|endswith: \safari.exe
  filter_optional_seamonkey:
    Image|endswith: \seamonkey.exe
  filter_optional_snipping_tool:
    Image|endswith: \SnippingTool\SnippingTool.exe
    Image|startswith: C:\Program Files\WindowsApps\Microsoft.ScreenSketch_
    TargetFilename|contains|all:
    - \AppData\Local\Packages\Microsoft.ScreenSketch_
    - '\TempState\Screenshot '
    TargetFilename|endswith: .png:Zone.Identifier
    TargetFilename|startswith: C:\Users\
  filter_optional_vivaldi:
    Image|endswith: \vivaldi.exe
  filter_optional_whale:
    Image|endswith: \whale.exe
  selection:
    Contents|startswith: '[ZoneTransfer]  ZoneId=3'
    TargetFilename|contains:
    - .exe
    - .scr
    - .bat
    - .cmd
    - .docx
    - .hta
    - .jse
    - .lnk
    - .pptx
    - .ps
    - .reg
    - .sct
    - .vb
    - .wsc
    - .wsf
    - .xlsx
    TargetFilename|endswith: :Zone.Identifier
- condition: all of selection*
  selection_domain:
    Contents|contains:
    - https://transfer.sh/
    - raw.githubusercontent.com
    - gist.githubusercontent.com
    - pastebin.com
    - cdn.discordapp.com/attachments/
    - mediafire.com
    - mega.nz
    - ddns.net
    - .paste.ee
    - .hastebin.com
    - .ghostbin.co/
    - ufile.io
    - storage.googleapis.com
    - anonfiles.com
    - send.exploit.in
    - privatlab.net
    - privatlab.com
    - sendspace.com
    - pastetext.net
    - pastebin.pl
    - paste.ee
  selection_extension:
    TargetFilename|contains:
    - .exe:Zone
    - .vbs:Zone
    - .vbe:Zone
    - .dll:Zone
    - .one:Zone
    - .hta:Zone
    - .lnk:Zone
    - .xll:Zone
    - .cpl:Zone
- condition: all of selection*
  selection_domain:
    Contents|contains:
    - transfer.sh
    - raw.githubusercontent.com
    - gist.githubusercontent.com
    - pastebin.com
    - cdn.discordapp.com/attachments/
    - mediafire.com
    - mega.nz
    - ddns.net
    - .paste.ee
    - .hastebin.com
    - .ghostbin.co/
    - ufile.io
    - storage.googleapis.com
    - anonfiles.com
    - send.exploit.in
    - privatlab.net
    - privatlab.com
    - sendspace.com
    - pastetext.net
    - pastebin.pl
    - paste.ee
  selection_extension:
    TargetFilename|contains:
    - .ps1:Zone
    - .bat:Zone
    - .cmd:Zone
- condition: selection
  selection:
  - Imphash:
    - bcca3c247b619dcd13c8cdff5f123932
    - 3a19059bd7688cb88e70005f18efc439
    - bf6223a49e45d99094406777eb6004ba
    - 0c106686a31bfe2ba931ae1cf6e9dbc6
    - 0d1447d4b3259b3c2a1d4cfb7ece13c3
    - 1b0369a1e06271833f78ffa70ffb4eaf
    - 4c1b52a19748428e51b14c278d0f58e3
    - 4d927a711f77d62cebd4f322cb57ec6f
    - 66ee036df5fc1004d9ed5e9a94a1086a
    - 672b13f4a0b6f27d29065123fe882dfc
    - 6bbd59cea665c4afcc2814c1327ec91f
    - 725bb81dc24214f6ecacc0cfb36ad30d
    - 9528a0e91e28fbb88ad433feabca2456
    - 9da6d5d77be11712527dcab86df449a3
    - a6e01bc1ab89f8d91d9eab72032aae88
    - b24c5eddaea4fe50c6a96a2a133521e4
    - d21bbc50dcc169d7b4d0f01962793154
    - fcc251cceae90d22c392215cc9a2d5d6
    - 23867a89c2b8fc733be6cf5ef902f2d1
    - a37ff327f8d48e8a4d2f757e1b6e70bc
    - f9a28c458284584a93b14216308d31bd
    - 6118619783fc175bc7ebecff0769b46e
    - 959a83047e80ab68b368fdb3f4c6e4ea
    - 563233bfa169acc7892451f71ad5850a
    - 87575cb7a0e0700eb37f2e3668671a08
    - 13f08707f759af6003837a150a371ba1
    - 1781f06048a7e58b323f0b9259be798b
    - 233f85f2d4bc9d6521a6caae11a1e7f5
    - 24af2584cbf4d60bbe5c6d1b31b3be6d
    - 632969ddf6dbf4e0f53424b75e4b91f2
    - 713c29b396b907ed71a72482759ed757
    - 749a7bb1f0b4c4455949c0b2bf7f9e9f
    - 8628b2608957a6b0c6330ac3de28ce2e
    - 8b114550386e31895dfab371e741123d
    - 94cb940a1a6b65bed4d5a8f849ce9793
    - 9d68781980370e00e0bd939ee5e6c141
    - b18a1401ff8f444056d29450fbc0a6ce
    - cb567f9498452721d77a451374955f5f
    - 730073214094cd328547bf1f72289752
    - 17b461a082950fc6332228572138b80c
    - dc25ee78e2ef4d36faa0badf1e7461c9
    - 819b19d53ca6736448f9325a85736792
    - 829da329ce140d873b4a8bde2cbfaa7e
    - c547f2e66061a8dffb6f5a3ff63c0a74
    - 0588081ab0e63ba785938467e1b10cca
    - 0d9ec08bac6c07d9987dfd0f1506587c
    - bc129092b71c89b4d4c8cdf8ea590b29
    - 4da924cf622d039d58bce71cdf05d242
    - e7a3a5c377e2d29324093377d7db1c66
    - 9a9dbec5c62f0380b4fa5fd31deffedf
    - af8a3976ad71e5d5fdfb67ddb8dadfce
    - 0c477898bbf137bbd6f2a54e3b805ff4
    - 0ca9f02b537bcea20d4ea5eb1a9fe338
    - 3ab3655e5a14d4eefc547f4781bf7f9e
    - e6f9d5152da699934b30daab206471f6
    - 3ad59991ccf1d67339b319b15a41b35d
    - ffdd59e0318b85a3e480874d9796d872
    - 0cf479628d7cc1ea25ec7998a92f5051
    - 07a2d4dcbd6cb2c6a45e6b101f0b6d51
    - d6d0f80386e1380d05cb78e871bc72b1
    - 38d9e015591bbfd4929e0d0f47fa0055
    - 0e2216679ca6e1094d63322e3412d650
    - ada161bf41b8e5e9132858cb54cab5fb
    - 2a1bc4913cd5ecb0434df07cb675b798
    - 11083e75553baae21dc89ce8f9a195e4
    - a23d29c9e566f2fa8ffbb79267f5df80
    - 4a07f944a83e8a7c2525efa35dd30e2f
    - 767637c23bb42cd5d7397cf58b0be688
    - 14c4e4c72ba075e9069ee67f39188ad8
    - 3c782813d4afce07bbfc5a9772acdbdc
    - 7d010c6bb6a3726f327f7e239166d127
    - 89159ba4dd04e4ce5559f132a9964eb3
    - 6f33f4a5fc42b8cec7314947bd13f30f
    - 5834ed4291bdeb928270428ebbaf7604
    - 5a8a8a43f25485e7ee1b201edcbc7a38
    - dc7d30b90b2d8abf664fbed2b1b59894
    - 41923ea1f824fe63ea5beb84db7a3e74
    - 3de09703c8e79ed2ca3f01074719906b
    - a53a02b997935fd8eedcb5f7abab9b9f
    - e96a73c7bf33a464c510ede582318bf2
    - 32089b8851bbf8bc2d014e9f37288c83
    - 09D278F9DE118EF09163C6140255C690
    - 03866661686829d806989e2fc5a72606
    - e57401fbdadcd4571ff385ab82bd5d6d
    - 84B763C45C0E4A3E7CA5548C710DB4EE
    - 19584675d94829987952432e018d5056
    - 330768a4f172e10acb6287b87289d83b
    - 885c99ccfbe77d1cbfcb9c4e7c1a3313
    - 22a22bc9e4e0d2f189f1ea01748816ac
    - 7fa30e6bb7e8e8a69155636e50bf1b28
    - 96df3a3731912449521f6f8d183279b1
    - 7e6cf3ff4576581271ac8a313b2aab46
    - 51791678f351c03a0eb4e2a7b05c6e17
  - Hash|contains:
    - IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932
    - IMPHASH=3A19059BD7688CB88E70005F18EFC439
    - IMPHASH=bf6223a49e45d99094406777eb6004ba
    - IMPHASH=0C106686A31BFE2BA931AE1CF6E9DBC6
    - IMPHASH=0D1447D4B3259B3C2A1D4CFB7ECE13C3
    - IMPHASH=1B0369A1E06271833F78FFA70FFB4EAF
    - IMPHASH=4C1B52A19748428E51B14C278D0F58E3
    - IMPHASH=4D927A711F77D62CEBD4F322CB57EC6F
    - IMPHASH=66EE036DF5FC1004D9ED5E9A94A1086A
    - IMPHASH=672B13F4A0B6F27D29065123FE882DFC
    - IMPHASH=6BBD59CEA665C4AFCC2814C1327EC91F
    - IMPHASH=725BB81DC24214F6ECACC0CFB36AD30D
    - IMPHASH=9528A0E91E28FBB88AD433FEABCA2456
    - IMPHASH=9DA6D5D77BE11712527DCAB86DF449A3
    - IMPHASH=A6E01BC1AB89F8D91D9EAB72032AAE88
    - IMPHASH=B24C5EDDAEA4FE50C6A96A2A133521E4
    - IMPHASH=D21BBC50DCC169D7B4D0F01962793154
    - IMPHASH=FCC251CCEAE90D22C392215CC9A2D5D6
    - IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1
    - IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC
    - IMPHASH=F9A28C458284584A93B14216308D31BD
    - IMPHASH=6118619783FC175BC7EBECFF0769B46E
    - IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA
    - IMPHASH=563233BFA169ACC7892451F71AD5850A
    - IMPHASH=87575CB7A0E0700EB37F2E3668671A08
    - IMPHASH=13F08707F759AF6003837A150A371BA1
    - IMPHASH=1781F06048A7E58B323F0B9259BE798B
    - IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5
    - IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D
    - IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2
    - IMPHASH=713C29B396B907ED71A72482759ED757
    - IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F
    - IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E
    - IMPHASH=8B114550386E31895DFAB371E741123D
    - IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793
    - IMPHASH=9D68781980370E00E0BD939EE5E6C141
    - IMPHASH=B18A1401FF8F444056D29450FBC0A6CE
    - IMPHASH=CB567F9498452721D77A451374955F5F
    - IMPHASH=730073214094CD328547BF1F72289752
    - IMPHASH=17B461A082950FC6332228572138B80C
    - IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9
    - IMPHASH=819B19D53CA6736448F9325A85736792
    - IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E
    - IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74
    - IMPHASH=0588081AB0E63BA785938467E1B10CCA
    - IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C
    - IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29
    - IMPHASH=4DA924CF622D039D58BCE71CDF05D242
    - IMPHASH=E7A3A5C377E2D29324093377D7DB1C66
    - IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF
    - IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE
    - IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4
    - IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338
    - IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E
    - IMPHASH=E6F9D5152DA699934B30DAAB206471F6
    - IMPHASH=3AD59991CCF1D67339B319B15A41B35D
    - IMPHASH=FFDD59E0318B85A3E480874D9796D872
    - IMPHASH=0CF479628D7CC1EA25EC7998A92F5051
    - IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51
    - IMPHASH=D6D0F80386E1380D05CB78E871BC72B1
    - IMPHASH=38D9E015591BBFD4929E0D0F47FA0055
    - IMPHASH=0E2216679CA6E1094D63322E3412D650
    - IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB
    - IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798
    - IMPHASH=11083E75553BAAE21DC89CE8F9A195E4
    - IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80
    - IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F
    - IMPHASH=767637C23BB42CD5D7397CF58B0BE688
    - IMPHASH=14C4E4C72BA075E9069EE67F39188AD8
    - IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC
    - IMPHASH=7D010C6BB6A3726F327F7E239166D127
    - IMPHASH=89159BA4DD04E4CE5559F132A9964EB3
    - IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F
    - IMPHASH=5834ED4291BDEB928270428EBBAF7604
    - IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38
    - IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894
    - IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74
    - IMPHASH=3DE09703C8E79ED2CA3F01074719906B
    - IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F
    - IMPHASH=E96A73C7BF33A464C510EDE582318BF2
    - IMPHASH=32089B8851BBF8BC2D014E9F37288C83
    - IMPHASH=09D278F9DE118EF09163C6140255C690
    - IMPHASH=03866661686829d806989e2fc5a72606
    - IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d
    - IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE
    - IMPHASH=19584675D94829987952432E018D5056
    - IMPHASH=330768A4F172E10ACB6287B87289D83B
    - IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313
    - IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC
    - IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28
    - IMPHASH=96DF3A3731912449521F6F8D183279B1
    - IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46
    - IMPHASH=51791678F351C03A0EB4E2A7B05C6E17
- condition: selection
  selection:
    Image|endswith: \regedit.exe
- condition: selection
  selection:
    Contents|re: http[s]?://[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}
    TargetFilename|contains:
    - .ps1:Zone
    - .bat:Zone
    - .exe:Zone
    - .vbe:Zone
    - .vbs:Zone
    - .dll:Zone
    - .one:Zone
    - .cmd:Zone
    - .hta:Zone
    - .xll:Zone
    - .lnk:Zone
- condition: selection
  selection:
    Contents|contains:
    - ://1
    - ://2
    - ://3
    - ://4
    - ://5
    - ://6
    - ://7
    - ://8
    - ://9
    Contents|startswith: '[ZoneTransfer]  ZoneId=3'
    TargetFilename|contains: \AppData\Local\Temp\WinGet\
    TargetFilename|endswith: :Zone.Identifier
- condition: selection
  selection:
    Contents|contains: .zip/
    TargetFilename|contains:
    - .bat:Zone
    - .dat:Zone
    - .dll:Zone
    - .files:Zone
    - .docm:Zone
    - .exe:Zone
    - .hta:Zone
    - .pptm:Zone
    - .ps1:Zone
    - .rar:Zone
    - .rtf:Zone
    - .sct:Zone
    - .vbe:Zone
    - .vbs:Zone
    - .ws:Zone
    - .wsf:Zone
    - .xll:Zone
    - .xls:Zone
    - .xlsm:Zone
    - .zip:Zone
- condition: selection
  selection:
    QueryName|contains: .anonfiles.com
- condition: selection
  selection:
    Image|contains: HybridConnectionManager
    QueryName|contains: servicebus.windows.net
- condition: selection
  selection:
    Image|endswith: \AppInstaller.exe
    Image|startswith: C:\Program Files\WindowsApps\Microsoft.DesktopAppInstaller_
- condition: selection
  selection:
    Image|endswith: \wscript.exe
    QueryName|re: '[a-f0-9]{4,8}\.(?:[a-z0-9\-]+\.){2}[a-z0-9\-]+'
- condition: 1 of selection*
  selection1:
    QueryName|startswith:
    - aaa.stage.
    - post.1
  selection2:
    QueryName|contains: .stage.123456.
- condition: selection
  selection:
    QueryName|contains: userstorage.mega.co.nz
- condition: selection
  selection:
    Image|endswith: \regsvr32.exe
- condition: 1 of selection_* and not 1 of filter_optional_*
  filter_optional_brave:
    Image|endswith: \brave.exe
  filter_optional_chrome:
    Image:
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  filter_optional_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_optional_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_optional_firefox:
    Image:
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  filter_optional_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_optional_maxthon:
    Image|endswith: \maxthon.exe
  filter_optional_opera:
    Image|endswith: \opera.exe
  filter_optional_safari:
    Image|endswith: \safari.exe
  filter_optional_seamonkey:
    Image|endswith: \seamonkey.exe
  filter_optional_vivaldi:
    Image|endswith: \vivaldi.exe
  filter_optional_whale:
    Image|endswith: \whale.exe
  selection_name:
    QueryName|endswith:
    - .getgo.com
    - .logmein.com
    - .ammyy.com
    - .netsupportsoftware.com
    - remoteutilities.com
    - .net.anydesk.com
    - api.playanext.com
    - .relay.splashtop.com
    - .api.splashtop.com
    - app.atera.com
    - .agentreporting.atera.com
    - .pubsub.atera.com
    - logmeincdn.http.internapcdn.net
    - logmein-gateway.com
    - client.teamviewer.com
    - integratedchat.teamviewer.com
    - static.remotepc.com
    - .n-able.com
    - comserver.corporate.beanywhere.com
    - .swi-rc.com
    - .swi-tc.com
    - telemetry.servers.qetqo.com
    - relay.screenconnect.com
    - control.connectwise.com
    - express.gotoassist.com
    - authentication.logmeininc.com
    - .services.vnc.com
    - .tmate.io
    - api.parsec.app
    - parsecusercontent.com
    - remotedesktop-pa.googleapis.com
    - .logmein-gateway.com
    - secure.logmeinrescue.com
    - join.zoho.com
    - assist.zoho.com
    - .zohoassist.com
    - downloads.zohocdn.com
    - agent.jumpcloud.com
    - kickstart.jumpcloud.com
    - cdn.kaseya.net
    - relay.kaseya.net
    - license.bomgar.com
    - .beyondtrustcloud.com
  selection_rustdesk:
    QueryName|endswith: .rustdesk.com
    QueryName|startswith: rs-
- condition: selection and not 1 of filter_optional_*
  filter_optional_brave:
    Image|endswith: \brave.exe
  filter_optional_chrome:
    Image:
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  filter_optional_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_optional_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_optional_firefox:
    Image:
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  filter_optional_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_optional_maxthon:
    Image|endswith: \maxthon.exe
  filter_optional_opera:
    Image|endswith: \opera.exe
  filter_optional_safari:
    Image|endswith: \safari.exe
  filter_optional_seamonkey:
    Image|endswith: \seamonkey.exe
  filter_optional_vivaldi:
    Image|endswith: \vivaldi.exe
  filter_optional_whale:
    Image|endswith: \whale.exe
  selection:
    QueryName|contains:
    - api.2ip.ua
    - api.ipify.org
    - bot.whatismyipaddress.com
    - canireachthe.net
    - checkip.amazonaws.com
    - checkip.dyndns.org
    - curlmyip.com
    - edns.ip-api.com
    - eth0.me
    - freegeoip.app
    - geoipy.com
    - getip.pro
    - icanhazip.com
    - ident.me
    - ifconfig.io
    - ifconfig.me
    - ip-api.com
    - ip.anysrc.net
    - ip.tyk.nu
    - ipaddressworld.com
    - ipecho.net
    - ipinfo.io
    - ipof.in
    - ipv4.icanhazip.com
    - ipv4bot.whatismyipaddress.com
    - ipwho.is
    - l2.io
    - myexternalip.com
    - wgetip.com
    - whatismyip.akamai.com
    - wtfismyip.com
- condition: dns_request and not 1 of filter_*
  dns_request:
    QueryName|startswith: _ldap.
  filter_azure:
    Image|startswith: C:\WindowsAzure\GuestAgent
  filter_defender:
    Image|endswith: \MsMpEng.exe
    Image|startswith:
    - C:\ProgramData\Microsoft\Windows Defender\Platform\
    - C:\Program Files\Windows Defender\MsMpEng.exe
    - C:\Program Files (x86)\Windows Defender\MsMpEng.exe
  filter_image_null:
    Image: null
  filter_unknown:
    Image: <unknown process>
  filter_windows:
    Image|startswith: C:\Windows\
- condition: dns_request and not filter
  dns_request:
    QueryName:
    - taf.teamviewer.com
    - udp.ping.teamviewer.com
  filter:
    Image|contains: TeamViewer
- condition: selection
  selection:
    QueryName|contains: .onion
- condition: selection
  selection:
    QueryName|contains: ufile.io
- condition: selection
  selection:
    ImageLoaded|contains:
    - fgexec
    - dumpsvc
    - cachedump
    - mimidrv
    - gsecdump
    - servpw
    - pwdump
- condition: 1 of selection*
  selection_hash:
  - sha256:
    - 0440ef40c46fdd2b5d86e7feef8577a8591de862cfd7928cdbcc8f47b8fa3ffc
    - 9b1b15a3aacb0e786a608726c3abfc94968915cedcbd239ddf903c4a54bfcf0c
    - 8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104
    - d7c81b0f3c14844f6424e8bdd31a128e773cb96cccef6d05cbff473f0ccb9f9c
    - 05b146a48a69dd62a02759487e769bd30d39f16374bc76c86453b4ae59e7ffa4
    - c8f9e1ad7b8cce62fba349a00bc168c849d42cfb2ca5b2c6cc4b51d054e0c497
  - sha1:
    - 31cc8718894d6e6ce8c132f68b8caaba39b5ba7a
    - a804ebec7e341b4d98d9e94f6e4860a55ea1638d
    - 6debce728bcff73d9d1d334df0c6b1c3735e295c
    - cc65bf60600b64feece5575f21ab89e03a728332
    - 3ef30c95e40a854cc4ded94fc503d0c3dc3e620e
    - b2f955b3e6107f831ebe67997f8586d4fe9f3e98
  - md5:
    - 10f3679384a03cb487bda9621ceb5f90
    - 04a88f5974caa621cee18f34300fc08a
    - 6fcf56f6ca3210ec397e55f727353c4a
    - 0f16a43f7989034641fd2de3eb268bf1
    - ee6b1a79cb6641aa44c762ee90786fe0
    - 909f3fc221acbe999483c87d9ead024a
  selection_image:
    ImageLoaded|contains:
    - \prokiller64.sys
    - \gftkyj64.sys
    - \KApcHelper_x64.sys
    - \NodeDriver.sys
    - \LcTkA.sys
  selection_sysmon:
    Hashes|contains:
    - SHA256=0440ef40c46fdd2b5d86e7feef8577a8591de862cfd7928cdbcc8f47b8fa3ffc
    - SHA256=9b1b15a3aacb0e786a608726c3abfc94968915cedcbd239ddf903c4a54bfcf0c
    - SHA256=8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104
    - SHA256=d7c81b0f3c14844f6424e8bdd31a128e773cb96cccef6d05cbff473f0ccb9f9c
    - SHA256=05b146a48a69dd62a02759487e769bd30d39f16374bc76c86453b4ae59e7ffa4
    - SHA256=c8f9e1ad7b8cce62fba349a00bc168c849d42cfb2ca5b2c6cc4b51d054e0c497
    - SHA1=31cc8718894d6e6ce8c132f68b8caaba39b5ba7a
    - SHA1=a804ebec7e341b4d98d9e94f6e4860a55ea1638d
    - SHA1=6debce728bcff73d9d1d334df0c6b1c3735e295c
    - SHA1=cc65bf60600b64feece5575f21ab89e03a728332
    - SHA1=3ef30c95e40a854cc4ded94fc503d0c3dc3e620e
    - SHA1=b2f955b3e6107f831ebe67997f8586d4fe9f3e98
    - MD5=10f3679384a03cb487bda9621ceb5f90
    - MD5=04a88f5974caa621cee18f34300fc08a
    - MD5=6fcf56f6ca3210ec397e55f727353c4a
    - MD5=0f16a43f7989034641fd2de3eb268bf1
    - MD5=ee6b1a79cb6641aa44c762ee90786fe0
    - MD5=909f3fc221acbe999483c87d9ead024a
- condition: selection
  selection:
    ImageLoaded|contains:
    - powershell
    - pwsh
- condition: 1 of selection_*
  selection_image:
    ImageLoaded|endswith: \kprocesshacker.sys
  selection_processhack_hashes:
    Imphash:
    - 821D74031D3F625BCBD0DF08B70F1E77
    - F86759BB4DE4320918615DC06E998A39
    - 0A64EEB85419257D0CE32BD5D55C3A18
    - 6E7B34DFC017700B1517B230DF6FF0D0
  selection_processhack_sysmon:
    Hashes|contains:
    - IMPHASH=821D74031D3F625BCBD0DF08B70F1E77
    - IMPHASH=F86759BB4DE4320918615DC06E998A39
    - IMPHASH=0A64EEB85419257D0CE32BD5D55C3A18
    - IMPHASH=6E7B34DFC017700B1517B230DF6FF0D0
- condition: 1 of selection_*
  selection_image:
    ImageLoaded|endswith: \SystemInformer.sys
  selection_systeminformer_hashes:
    sha256:
    - 8b9ad98944ac9886ea4cb07700e71b78be4a2740934bb7e46ca3b56a7c59ad24
    - a41348bec147ca4d9ea2869817527eb5cea2e20202af599d2b30625433bcf454
    - 38ee0a88af8535a11efe8d8da9c6812aa07067b75a64d99705a742589bdd846d
    - a773891acf203a7eb0c0d30942fb1347648f1cd918ae2bfd9a4857b4dcf5081b
    - 4c3b81ac88a987bbdf7d41fa0aecc2cedf5b9bd2f45e7a21f376d05345fc211d
    - 3241bc14bec51ce6a691b9a3562e5c1d52e9d057d27a3d67fd0b245c350b6d34
    - 047c42e9bba28366868847c7dafc1e043fb038c796422d37220493517d68ee89
    - 18931dc81e95d0020466fa091e16869dbe824e543a4c2c8fe644fa71a0f44feb
    - b4c2ef76c204273132fde38f0ded641c2c5ee767652e64e4c4071a4a973b6c1b
    - 640954afc268565f7daa6e6f81a8ee05311e33e34332b501a3c3fe5b22adea97
    - 251be949f662c838718f8aa0a5f8211fb90346d02bd63ff91e6b224e0e01b656
    - e2606f272f7ba054df16be464fda57211ef0d14a0d959f9c8dcb0575df1186e4
    - 3a9e1d17beeb514f1b9b3bacaee7420285de5cbdce89c5319a992c6cbd1de138
  selection_systeminformer_sysmon:
    Hashes|contains:
    - SHA256=8B9AD98944AC9886EA4CB07700E71B78BE4A2740934BB7E46CA3B56A7C59AD24
    - SHA256=A41348BEC147CA4D9EA2869817527EB5CEA2E20202AF599D2B30625433BCF454
    - SHA256=38EE0A88AF8535A11EFE8D8DA9C6812AA07067B75A64D99705A742589BDD846D
    - SHA256=A773891ACF203A7EB0C0D30942FB1347648F1CD918AE2BFD9A4857B4DCF5081B
    - SHA256=4C3B81AC88A987BBDF7D41FA0AECC2CEDF5B9BD2F45E7A21F376D05345FC211D
    - SHA256=3241BC14BEC51CE6A691B9A3562E5C1D52E9D057D27A3D67FD0B245C350B6D34
    - SHA256=047C42E9BBA28366868847C7DAFC1E043FB038C796422D37220493517D68EE89
    - SHA256=18931DC81E95D0020466FA091E16869DBE824E543A4C2C8FE644FA71A0F44FEB
    - SHA256=B4C2EF76C204273132FDE38F0DED641C2C5EE767652E64E4C4071A4A973B6C1B
    - SHA256=640954AFC268565F7DAA6E6F81A8EE05311E33E34332B501A3C3FE5B22ADEA97
    - SHA256=251BE949F662C838718F8AA0A5F8211FB90346D02BD63FF91E6B224E0E01B656
    - SHA256=E2606F272F7BA054DF16BE464FDA57211EF0D14A0D959F9C8DCB0575DF1186E4
    - SHA256=3A9E1D17BEEB514F1B9B3BACAEE7420285DE5CBDCE89C5319A992C6CBD1DE138
- condition: selection
  selection:
    ImageLoaded|contains: \Temp\
- condition: 1 of selection* or all of driver_*
  driver_img:
    ImageLoaded|endswith: \aswArPot.sys
  driver_status:
  - Signed: 'false'
  - SignatureStatus: Expired
  selection_other:
  - md5: a179c4093d05a3e1ee73f6ff07f994aa
  - sha1: 5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4
  - sha256: 4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1
  selection_sysmon:
    Hashes|contains:
    - MD5=a179c4093d05a3e1ee73f6ff07f994aa
    - SHA1=5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4
    - SHA256=4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1
- condition: 1 of selection*
  selection_hash:
  - sha256:
    - 0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5
    - ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1
  - sha1:
    - c948ae14761095e4d76b55d9de86412258be7afd
    - 10b30bdee43b3a2ec4aa63375577ade650269d25
  - md5:
    - c996d7971c49252c582171d9380360f2
    - d2fd132ab7bbc6bbb87a84f026fa0244
  selection_image:
    ImageLoaded|contains: \DBUtil_2_3.Sys
  selection_sysmon:
    Hashes|contains:
    - SHA256=0296E2CE999E67C76352613A718E11516FE1B0EFC3FFDB8918FC999DD76A73A5
    - SHA256=DDBF5ECCA5C8086AFDE1FB4F551E9E6400E94F4428FE7FB5559DA5CFFA654CC1
    - SHA1=C948AE14761095E4D76B55D9DE86412258BE7AFD
    - SHA1=10B30BDEE43B3A2EC4AA63375577ADE650269D25
    - MD5=C996D7971C49252C582171D9380360F2
    - MD5=D2FD132AB7BBC6BBB87A84F026FA0244
- condition: 1 of selection_*
  selection_other:
  - md5:
    - 1b5c3c458e31bede55145d0644e88d75
    - 6f5d54ab483659ac78672440422ae3f1
    - ee6b1a79cb6641aa44c762ee90786fe0
    - c02f70960fa934b8defa16a03d7f6556
    - 839cbbc86453960e9eb6db814b776a40
    - acac842a46f3501fe407b1db1b247a0b
    - 95e4c7b0384da89dce8ea6f31c3613d9
    - e700a820f117f65e813b216fccbf78c9
    - 96b463b6fa426ae42c414177af550ba2
    - 27bcbeec8a466178a6057b64bef66512
    - 70dcd07d38017b43f710061f37cb4a91
    - db72def618cbc3c5f9aa82f091b54250
    - 83601bbe5563d92c1fdb4e960d84dc77
    - 5970e8de1b337ca665114511b9d10806
    - 49fe3d1f3d5c2e50a0df0f6e8436d778
    - 1493d342e7a36553c56b2adea150949e
    - 4f191abc652d8f7442ca2636725e1ed6
    - 0ae30291c6cbfa7be39320badd6e8de0
    - d104621c93213942b7b43d65b5d8d33e
    - b89b097b8b8aecb8341d05136f334ebb
    - 14580bd59c55185115fd3abe73b016a2
    - 992ded5b623be3c228f32edb4ca3f2d2
    - a26e600652c33dd054731b4693bf5b01
    - 1f950cfd5ed8dd9de3de004f5416fe20
    - 491aec2249ad8e2020f9f9b559ab68a8
    - e4266262a77fffdea2584283f6c4f51d
    - bd25be845c151370ff177509d95d5add
    - 9638f265b1ddd5da6ecdf5c0619dcbe6
    - 4e90cd77509738d30d3181a4d0880bfa
    - 0a6a1c9a7f80a2a5dcced5c4c0473765
    - 9aa7ed7809eec0d8bc6c545a1d18107a
    - aa1ed3917928f04d97d8a217fe9b5cb1
    - 42f7cc4be348c3efd98b0f1233cf2d69
    - 4cc3ddd5ae268d9a154a426af2c23ef9
    - 2fed983ec44d1e7cffb0d516407746f2
    - f7cbbb5eb263ec9a35a1042f52e82ca4
    - ed6348707f177629739df73b97ba1b6e
    - 40bc58b7615d00eb55ad9ba700c340c1
    - c3fea895fe95ea7a57d9f4d7abed5e71
    - 2128e6c044ee86f822d952a261af0b48
    - 3dbf69f935ea48571ea6b0f5a2878896
    - c6f8983dd3d75640c072a8459b8fa55a
    - 6fcf56f6ca3210ec397e55f727353c4a
    - 79f7e6f98a5d3ab6601622be4471027f
    - bae1f127c4ff21d8fe45e2bbfc59c180
    - c533d6d64b474ffc3169a0e0fc0a701a
    - 3f39f013168428c8e505a7b9e6cba8a2
    - 748cf64b95ca83abc35762ad2c25458f
    - bce7f34912ff59a3926216b206deb09f
    - 2d8e4f38b36c334d0a32a7324832501d
    - 47e6ac52431ca47da17248d80bf71389
    - 3651a6990fe38711ebb285143f867a43
    - dc943bf367ae77016ae399df8e71d38a
    - 02198692732722681f246c1b33f7a9d9
    - ddc2ffe0ab3fcd48db898ab13c38d88d
    - 0ec361f2fba49c73260af351c39ff9cb
    - c1fce7aac4e9dd7a730997e2979fa1e2
    - 49938383844ceec33dba794fb751c9a5
    - 34069a15ae3aa0e879cd0d81708e4bcc
    - 1c294146fc77565030603878fd0106f9
    - fd81af62964f5dd5eb4a828543a33dcf
    - bd5b0514f3b40f139d8079138d01b5f6
    - fa173832dca1b1faeba095e5c82a1559
    - 5cc5c26fc99175997d84fe95c61ab2c2
    - 1ed043249c21ab201edccb37f1d40af9
    - 361a598d8bb92c13b18abb7cac850b01
    - 9b359b722ac80c4e0a5235264e1e0156
    - 296bde4d0ed32c6069eb90c502187d0d
    - d3e40644a91327da2b1a7241606fe559
    - 12cecc3c14160f32b21279c1a36b8338
    - dd39a86852b498b891672ffbcd071c03
    - b2a9ac0600b12ec9819e049d7a6a0b75
    - 444f538daa9f7b340cfd43974ed43690
    - 7b43dfd84de5e81162ebcfafb764b769
    - 13dda15ef67eb265869fc371c72d6ef0
    - 300c5b1795c9b6cc1bc4d7d55c7bbe85
    - 1392b92179b07b672720763d9b1028a5
    - 2e1f8a2a80221deb93496a861693c565
    - 8065a7659562005127673ac52898675f
    - b5ada7fd226d20ec6634fc24768f9e22
    - 84fb76ee319073e77fb364bbbbff5461
    - daf800da15b33bf1a84ee7afc59f0656
    - f7393fb917aed182e4cbef25ce8af950
    - 120b5bbb9d2eb35ff4f62d79507ea63a
    - 73c98438ac64a68e88b7b0afd11ba140
    - 51207adb8dab983332d6b22c29fe8129
    - 4a23e0f2c6f926a41b28d574cbc6ac30
    - 20125794b807116617d43f02b616e092
    - e8ebba56ea799e1e62748c59e1a4c586
    - 8abbb12e61045984eda19e2dc77b235e
    - f66b96aa7ae430b56289409241645099
    - 97e3a44ec4ae58c8cc38eefc613e950e
    - ff7b31fa6e9ab923bce8af31d1be5bb2
    - 12908c285b9d68ee1f39186110df0f1e
    - 6126065af2fc2639473d12ee3c0c198e
    - 356bda2bf0f6899a2c08b2da3ec69f13
    - fd7de498a72b2daf89f321d23948c3c4
    - 338a98e1c27bc76f09331fcd7ae413a5
    - c9a293762319d73c8ee84bcaaf81b7b3
    - e9e786bdba458b8b4f9e93d034f73d00
    - a17c58c0582ee560c72f60764ed63224
    - 21e13f2cb269defeae5e1d09887d47bb
    - a57b47489febc552515778dd0fd1e51c
    - d6e9f6c67d9b3d790d592557a7d57c3c
    - 76bb1a4332666222a8e3e1339e267179
    - 1cd158a64f3d886357535382a6fdad75
    - d9e7e5bcc5b01915dbcef7762a7fc329
    - d253c19194a18030296ae62a10821640
    - b12d1630fd50b2a21fd91e45d522ba3a
    - 50b39072d0ee9af5ef4824eca34be6e3
    - 778b7feea3c750d44745d3bf294bd4ce
    - 0761c357aed5f591142edaefdf0c89c8
    - 23cf3da010497eb2bf39a5c5a57e437c
    - c49a1956a6a25ffc25ad97d6762b0989
    - f406c5536bcf9bacbeb7ce8a3c383bfa
    - f2f728d2f69765f5dfda913d407783d2
    - 4b817d0e7714b9d43db43ae4a22a161e
    - 715f8efab1d1c660e4188055c4b28eed
    - a01c412699b6f21645b2885c2bae4454
    - 010c0e5ac584e3ab97a2daf84cf436f5
    - d5db81974ffda566fa821400419f59be
    - 3247014ba35d406475311a2eab0c4657
    - 4d487f77be4471900d6ccbc47242cc25
    - 1f2888e57fdd6aee466962c25ba7d62d
    - 507a649eb585d8d0447eab0532ef0c73
    - 4ad8fd9e83d7200bd7f8d0d4a9abfb11
    - cd9f0fcecf1664facb3671c0130dc8bb
    - b10b210c5944965d0dc85e70a0b19a42
    - ae5eb2759305402821aeddc52ba9a6d6
    - f5051c756035ef5de9c4c48bacb0612b
    - 1898ceda3247213c084f43637ef163b3
    - 37086ae5244442ba552803984a11d6cb
    - 825703c494e0d270f797f1ecf070f698
    - 909f3fc221acbe999483c87d9ead024a
    - 75d6c3469347de1cdfa3b1b9f1544208
    - 9ab9f3b75a2eb87fafb1b7361be9dfb3
    - 5f9785e7535f8f602cb294a54962c9e7
    - 7d46d0ddaf8c7e1776a70c220bf47524
    - f9844524fb0009e5b784c21c7bad4220
    - 828bb9cb1dd449cd65a29b18ec46055f
    - 4d17b32be70ef39eae5d5edeb5e89877
    - 2391fb461b061d0e5fccb050d4af7941
    - 6d4159694e1754f262e326b52a3b305a
    - a60c9173563b940203cf4ad38ccf2082
    - 63e333d64a8716e1ae59f914cb686ae8
    - a9f220b1507a3c9a327a99995ff99c82
    - c5f5d109f11aadebae94c77b27cb026f
    - 5bab40019419a2713298a5c9173e5d30
    - c996d7971c49252c582171d9380360f2
    - 98763a3dee3cf03de334f00f95fc071a
    - e79c91c27df3eaf82fb7bd1280172517
    - a42249a046182aaaf3a7a7db98bfa69d
    - 803a371a78d528a44ef8777f67443b16
    - 9007c94c9d91ccff8d7f5d4cdddcc403
    - 11fb599312cb1cf43ca5e879ed6fb71e
    - 7f9309f5e4defec132b622fadbcad511
    - 04a88f5974caa621cee18f34300fc08a
    - 8636fe3724f2bcba9399daffd6ef3c7e
    - 9dfd73dadb2f1c7e9c9d2542981aaa63
    - 490b1f404c4f31f4538b36736c990136
    - c1d063c9422a19944cdaa6714623f2ec
    - dacb62578b3ea191ea37486d15f4f83c
    - 2da209dde8188076a9579bd256dc90d0
    - 0ba6afe0ea182236f98365bd977adfdf
    - 4c016fd76ed5c05e84ca8cab77993961
    - ad22a7b010de6f9c6f39c350a471a440
    - 79483cb29a0c428e1362ec8642109eee
    - a179c4093d05a3e1ee73f6ff07f994aa
    - ccf523b951afaa0147f22e2a7aae4976
    - 736c4b85ce346ddf3b49b1e3abb4e72a
    - b0baac4d6cbac384a633c71858b35a2e
    - 798de15f187c1f013095bbbeb6fb6197
    - a86150f2e29b35369afa2cafd7aa9764
    - b941c8364308990ee4cc6eadf7214e0f
    - dd04cd3de0c19bede84e9c95a86b3ca8
    - 6909b5e86e00b4033fedfca1775b0e33
    - 9b91a44a488e4d539f2e55476b216024
    - 8b287636041792f640f92e77e560725e
    - 07f83829e7429e60298440cd1e601a6a
    - 0395b4e0eb21693590ad1cfdf7044b8b
    - 4b058945c9f2b8d8ebc485add1101ba5
    - 0067c788e1cb174f008c325ebde56c22
    - c2c1b8c00b99e913d992a870ed478a24
    - 84ba7af6ada1b3ea5efb9871a0613fc6
    - dbc415304403be25ac83047c170b0ec2
    - 31469f1313871690e8dc2e8ee4799b22
    - 2d465b4487dc81effaa84f122b71c24f
    - 64efbffaa153b0d53dc1bccda4279299
    - b164daf106566f444dfb280d743bc2f7
    - 7c72a7e1d42b0790773efd8700e24952
    - 56a515173b211832e20fbc64e5a0447c
    - c2eb4539a4f6ab6edd01bdc191619975
    - d1bac75205c389d6d5d6418f0457c29b
    - 68dde686d6999ad2e5d182b20403240b
    - a785b3bc4309d2eb111911c1b55e793f
    - 6ab7b8ef0c44e7d2d5909fdb58d37fa5
    - d9ce18960c23f38706ae9c6584d9ac90
    - ab53d07f18a9697139ddc825b466f696
    - ba5f0f6347780c2ed911bbf888e75bef
    - 13ee349c15ee5d6cf640b3d0111ffc0e
    - 9a237fa07ce3ed06ea924a9bed4a6b99
    - fa222bed731713904320723b9c085b11
    - 0898af0888d8f7a9544ef56e5e16354e
    - e076dadf37dd43a6b36aeed957abee9e
    - 4f27c09cc8680e06b04d6a9c34ca1e08
    - 1b32c54b95121ab1683c7b83b2db4b96
    - 715572dfe6fb10b16f980bfa242f3fa5
    - 4a06bcd96ef0b90a1753a805b4235f28
    - f242cffd9926c0ccf94af3bf16b6e527
    - 7ed6030f14e66e743241f2c1fa783e69
    - 0d6fef14f8e1ce5753424bd22c46b1ce
    - a4fda97f452b8f8705695a729f5969f7
    - 62c18d61ed324088f963510bae43b831
    - d5a642329cce4df94b8dc1ba9660ae34
    - a641e3dccba765a10718c9cb0da7879e
    - ed07f1a8038596574184e09211dfc30f
    - 3473faea65fba5d4fbe54c0898a3c044
    - 708ac9f7b12b6ca4553fd8d0c7299296
    - bbe4f5f8b0c0f32f384a83ae31f49a00
    - 257483d5d8b268d0d679956c7acdf02d
    - 312e31851e0fc2072dbf9a128557d6ef
    - 14eead4d42728e9340ec8399a225c124
    - de1cc5c266140bff9d964fab87a29421
    - 9a9dbf5107848c254381be67a4c1b1dd
    - 1dc94a6a82697c62a04e461d7a94d0b0
    - 2850608430dd089f24386f3336c84729
    - 6d131a7462e568213b44ef69156f10a5
    - b8b6686324f7aa77f570bc019ec214e6
    - 22823fed979903f8dfe3b5d28537eb47
    - c1d3a6bb423739a5e781f7eee04c9cfd
    - 0c0195c48b6b8582fa6f6373032118da
    - 5228b7a738dc90a06ae4f4a7412cb1e9
    - 62f02339fe267dc7438f603bfb5431a1
    - 22949977ce5cd96ba674b403a9c81285
    - 5ca1922ed5ee2b533b5f3dd9be20fd9a
    - 1ed08a6264c5c92099d6d1dae5e8f530
    - b0770094c3c64250167b55e4db850c04
    - a6e9d6505f6d2326a8a9214667c61c67
    - 8407ddfab85ae664e507c30314090385
    - 9321a61a25c7961d9f36852ecaa86f55
    - a711e6ab17802fabf2e69e0cd57c54cd
    - 29ccff428e5eb70ae429c3da8968e1ec
    - 79df0eabbf2895e4e2dae15a4772868c
    - fb7c61ef427f9b2fdff3574ee6b1819b
    - f778489c7105a63e9e789a02412aaa5f
    - fef9dd9ea587f8886ade43c1befbdafe
    - 43830326cd5fae66f5508e27cbec39a0
    - c7a57cd4bea07dadba2e2fb914379910
    - f1e054333cc40f79cfa78e5fbf3b54c2
    - dc564bac7258e16627b9de0ce39fae25
    - 054299e09cea38df2b84e6b29348b418
    - 97221e16e7a99a00592ca278c49ffbfc
    - 8d63e1a9ff4cafee1af179c0c544365c
    - 96421b56dbda73e9b965f027a3bda7ba
    - 4ae55080ec8aed49343e40d08370195c
    - 988dabdcf990b134b0ac1e00512c30c4
    - bbbc9a6cc488cfb0f6c6934b193891eb
    - 76c643ab29d497317085e5db8c799960
    - e9a30edef1105b8a64218f892b2e56ed
    - 7bd840ff7f15df79a9a71fec7db1243e
    - 1cff7b947f8c3dea1d34dc791fc78cdc
    - 2c54859a67306e20bfdc8887b537de72
    - a5f637d61719d37a5b4868c385e363c0
    - 2509a71a02296aa65a3428ddfac22180
    - 6cce5bb9c8c2a8293df2d3b1897941a2
    - 7a16fca3d56c6038c692ec75b2bfee15
    - eaea9ccb40c82af8f3867cd0f4dd5e9d
    - d2588631d8aae2a3e54410eaf54f0679
    - b47dee29b5e6e1939567a926c7a3e6a4
    - fac8eb49e2fd541b81fcbdeb98a199cb
    - 1a234f4643f5658bab07bfa611282267
    - 0752f113d983030939b4ab98b0812cf0
  - sha1:
    - f0c463d29a5914b01e4607889094f1b7d95e7aaf
    - a804ebec7e341b4d98d9e94f6e4860a55ea1638d
    - ecb4d096a9c58643b02f328d2c7742a38e017cf0
    - 684786de4b3b3f53816eae9df5f943a22c89601f
    - 745335bcdf02fb42df7d890a24858e16094f48fd
    - 25d812a5ece19ea375178ef9d60415841087726e
    - d417c0be261b0c6f44afdec3d5432100e420c3ed
    - 6afc6b04cf73dd461e4a4956365f25c1f1162387
    - 01a578a3a39697c4de8e3dab04dba55a4c35163e
    - 2b0bb408ff0e66bcdf6574f1ca52cbf4015b257b
    - 7e836dadc2e149a0b758c7e22c989cbfcce18684
    - 4a705af959af61bad48ef7579f839cb5ebd654d2
    - bc2f3850c7b858340d7ed27b90e63b036881fd6c
    - e22495d92ac3dcae5eeb1980549a9ead8155f98a
    - c969f1f73922fd95db1992a5b552fbc488366a40
    - 4c18754dca481f107f0923fb8ef5e149d128525d
    - 2fc6845047abcf2a918fce89ab99e4955d08e72c
    - 4f7a8e26a97980544be634b26899afbefb0a833c
    - 21edff2937eb5cd6f6b0acb7ee5247681f624260
    - 89cd760e8cb19d29ee08c430fb17a5fd4455c741
    - 6c1bb3a72ebfb5359b9e22ca44d0a1ff825a68f2
    - 064de88dbbea67c149e779aac05228e5405985c7
    - ea877092d57373cb466b44e7dbcad4ce9a547344
    - 55ab7e27412eca433d76513edc7e6e03bcdd7eda
    - 976777d39d73034df6b113dfce1aa6e1d00ffcfd
    - 1f7501e01d84a2297c85cb39880ec4e40ac3fe8a
    - a6816949cd469b6e5c35858d19273936fab1bef6
    - 91f832f46e4c38ecc9335460d46f6f71352cffed
    - 43419df1f9a07430a18c5f3b3cc74de621be0f8e
    - 01779ee53f999464465ed690d823d160f73f10e7
    - bfe55cacc7c56c9f7bd75bdb4b352c0b745d071b
    - 27d3ebea7655a72e6e8b95053753a25db944ec0f
    - fcd615df88645d1f57ff5702bd6758b77efea6d0
    - 10115219e3595b93204c70eec6db3e68a93f3144
    - 33285b2e97a0aeb317166cce91f6733cf9c1ad53
    - 2c27abbbbcf10dfb75ad79557e30ace5ed314df8
    - 10e15ba8ff8ed926ddd3636cec66a0f08c9860a4
    - 291b4a88ffd2ac1d6bf812ecaedc2d934dc503cb
    - 05c0c49e8bcf11b883d41441ce87a2ee7a3aba1d
    - 8f5cd4a56e6e15935491aa40adb1ecad61eafe7c
    - a7948a4e9a3a1a9ed0e4e41350e422464d8313cd
    - 19bd488fe54b011f387e8c5d202a70019a204adf
    - eeff4ec4ebc12c6acd2c930dc2eaaf877cfec7ec
    - c4d7fb9db3c3459f7e8c0e3d48c95c7c9c4cff60
    - 15d1a6a904c8409fb47a82aefa42f8c3c7d8c370
    - d02403f85be6f243054395a873b41ef8a17ea279
    - 4243dbbf6e5719d723f24d0f862afd0fcb40bc35
    - 4789b910023a667bee70ff1f1a8f369cffb10fe8
    - 50e2bc41f0186fdce970b80e2a2cb296353af586
    - b97a8d506be2e7eaa4385f70c009b22adbd071ba
    - 78b9481607ca6f3a80b4515c432ddfe6550b18a8
    - e039c9dd21494dbd073b4823fc3a17fbb951ec6c
    - 806832983bb8cb1e26001e60ea3b7c3ade4d3471
    - c1d5cf8c43e7679b782630e93f5e6420ca1749a7
    - c9cbfdd0be7b35751a017ec59ff7237ffdc4df1f
    - a3ed5cbfbc17b58243289f3cf575bf04be49591d
    - 7fb52290883a6b69a96d480f2867643396727e83
    - 5711c88e9e64e45b8fc4b90ab6f2dd6437dc5a8a
    - da9cea92f996f938f699902482ac5313d5e8b28e
    - dc7b022f8bd149efbcb2204a48dce75c72633526
    - d979353d04bf65cc92ad3412605bc81edbb75ec2
    - 4b009e91bae8d27b160dc195f10c095f8a2441e1
    - 51b60eaa228458dee605430aae1bc26f3fc62325
    - c6bd965300f07012d1b651a9b8776028c45b149a
    - 729a8675665c61824f22f06c7b954be4d14b52c4
    - 37364cb5f5cefd68e5eca56f95c0ab4aff43afcc
    - e4436c8c42ba5ffabd58a3b2256f6e86ccc907ab
    - 7ba19a701c8af76988006d616a5f77484c13cb0a
    - 25bf4e30a94df9b8f8ab900d1a43fd056d285c9d
    - d8498707f295082f6a95fd9d32c9782951f5a082
    - 5e6ddd2b39a3de0016385cbd7aa50e49451e376d
    - 943593e880b4d340f2548548e6e673ef6f61eed3
    - 2dfcb799b3c42ecb0472e27c19b24ac7532775ce
    - b2f955b3e6107f831ebe67997f8586d4fe9f3e98
    - 6714380bc0b8ab09b9a0d2fa66d1b025b646b946
    - 4a7d66874a0472a47087fabaa033a85d47413379
    - 012db3a80faf1f7f727b538cbe5d94064e7159de
    - 5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4
    - c6d349823bbb1f5b44bae91357895dba653c5861
    - 643383938d5e0d4fd30d302af3e9293a4798e392
    - ace6b9e34e3e2e73fe584f3bbdb4e4ec106e0a7d
    - 1d0df45ee3fa758f0470e055915004e6eae54c95
    - 3599ea2ac1fa78f423423a4cf90106ea0938dde8
    - f42f28d164205d9f6dab9317c9fecad54c38d5d2
    - d9c09dd725bc7bc3c19b4db37866015817a516ef
    - d5fd9fe10405c4f90235e583526164cd0902ed86
    - 0c74d09da7baf7c05360346e4c3512d0cd433d59
    - 9c256edd10823ca76c0443a330e523027b70522d
    - 65d8a7c2e867b22d1c14592b020c548dd0665646
    - 7859e75580570e23a1ef7208b9a76f81738043d5
    - b242b0332b9c9e8e17ec27ef10d75503d20d97b6
    - 6523b3fd87de39eb5db1332e4523ce99556077dc
    - ac600a2bc06b312d92e649b7b55e3e91e9d63451
    - fe10018af723986db50701c8532df5ed98b17c39
    - b9807b8840327c6d7fbdde45fc27de921f1f1a82
    - a3636986cdcd1d1cb8ab540f3d5c29dcc90bb8f0
    - 054a50293c7b4eea064c91ef59cf120d8100f237
    - 2e3de9bff43d7712707ef8a0b10f7e4ad8427fd8
    - 485c0b9710a196c7177b99ee95e5ddb35b26ddd1
    - faa870b0cb15c9ac2b9bba5d0470bd501ccd4326
    - 4a235f0b84ff615e2879fa9e0ec0d745fcfdaa5c
    - 0291d0457acaf0fe8ed5c3137302390469ce8b35
    - 8183a341ba6c3ce1948bf9be49ab5320e0ee324d
    - 5a7dd0da0aee0bdedc14c1b7831b9ce9178a0346
    - 6debce728bcff73d9d1d334df0c6b1c3735e295c
    - b25170e09c9fb7c0599bfba3cf617187f6a733ac
    - 19f3343bfad0ef3595f41d60272d21746c92ffca
    - a48aa80942fc8e0699f518de4fd6512e341d4196
    - f6f11ad2cd2b0cf95ed42324876bee1d83e01775
    - 9a35ae9a1f95ce4be64adc604c80079173e4a676
    - ea360a9f23bb7cf67f08b88e6a185a699f0c5410
    - 6a3d3b9ab3d201cd6b0316a7f9c3fb4d34d0f403
    - 08596732304351b311970ff96b21f451f23b1e25
    - 29a190727140f40cea9514a6420f5a195e36386b
    - b4d014b5edd6e19ce0e8395a64faedf49688ecb5
    - 31fac347aa26e92db4d8c9e1ba37a7c7a2234f08
    - fcde5275ee1913509927ce5f0f85e6681064c9d2
    - f052dc35b74a1a6246842fbb35eb481577537826
    - c52cef5b9e1d4a78431b7af56a6fdb6aa1bcad65
    - 33cdab3bbc8b3adce4067a1b042778607dce2acd
    - 2d503a2457a787014a1fdd48a2ece2e6cbe98ea7
    - f9519d033d75e1ab6b82b2e156eafe9607edbcfb
    - 89909fa481ff67d7449ee90d24c167b17b0612f1
    - a7d827a41b2c4b7638495cd1d77926f1ba902978
    - c23eeb6f18f626ce1fd840227f351fa7543bb167
    - 3805e4e08ad342d224973ecdade8b00c40ed31be
    - 8302802b709ad242a81b939b6c90b3230e1a1f1e
    - ac13941f436139b909d105ad55637e1308f49d9a
    - 92f251358b3fe86fd5e7aa9b17330afa0d64a705
    - 623cd2abef6c92255f79cbbd3309cb59176771da
    - af50109b112995f8c82be8ef3a88be404510cdde
    - a00e444120449e35641d58e62ed64bb9c9f518d2
    - 9923c8f1e565a05b3c738d283cf5c0ed61a0b90f
    - 7eec3a1edf3b021883a4b5da450db63f7c0afeeb
    - 078ae07dec258db4376d5a2a05b9b508d68c0123
    - ef80da613442047697bec35ea228cde477c09a3d
    - 6003184788cd3d2fc624ca801df291ccc4e225ee
    - 558aad879b6a47d94a968f39d0a4e3a3aaef1ef1
    - 877c6c36a155109888fe1f9797b93cb30b4957ef
    - f3cce7e79ab5bd055f311bb3ac44a838779270b6
    - 80fa962bdfb76dfcb9e5d13efc38bb3d392f2e77
    - 3b6b35bca1b05fafbfc883a844df6d52af44ccdc
    - 351cbd352b3ec0d5f4f58c84af732a0bf41b4463
    - 609fa1efcf61e26d64a5ceb13b044175ab2b3a13
    - dc0e97adb756c0f30b41840a59b85218cbdd198f
    - 71469dce9c2f38d0e0243a289f915131bf6dd2a8
    - 05ac1c64ca16ab0517fe85d4499d08199e63df26
    - 2261198385d62d2117f50f631652eded0ecc71db
    - 414cd15d6c991d19fb5be02e3b9fb0e6c5ce731c
    - 8626ab1da6bfbdf61bd327eb944b39fd9df33d1d
    - 5fb9421be8a8b08ec395d05e00fd45eb753b593a
    - d702d88b12233be9413446c445f22fda4a92a1d9
    - e74b6dda8bc53bc687fc21218bd34062a78d8467
    - a197a02025946aca96d6e74746f84774df31249e
    - 1f25f54e9b289f76604e81e98483309612c5a471
    - e3c1dd569aa4758552566b0213ee4d1fe6382c4b
    - 879fcc6795cebe67718388228e715c470de87dca
    - 3ae56ab63230d6d9552360845b4a37b5801cc5ea
    - 74e4e3006b644392f5fcea4a9bae1d9d84714b57
    - ce549714a11bd43b52be709581c6e144957136ec
    - 3abb9d0a9d600200ae19c706e570465ef0a15643
    - fbf8b0613a2f7039aeb9fa09bd3b40c8ff49ded2
    - cc51be79ae56bc97211f6b73cc905c3492da8f9d
    - b03b1996a40bfea72e4584b82f6b845c503a9748
    - 0307d76750dd98d707c699aee3b626643afb6936
    - 8db869c0674221a2d3280143cbb0807fac08e0cc
    - 2f991435a6f58e25c103a657d24ed892b99690b8
    - c948ae14761095e4d76b55d9de86412258be7afd
    - 3ef30c95e40a854cc4ded94fc503d0c3dc3e620e
    - 152b6bb9ffd2ffec00cc46f5c6e29362d0e66e67
    - a7bd05de737f8ea57857f1e0845a25677df01872
    - aca8e53483b40a06dfdee81bb364b1622f9156fe
    - f36a47edfacd85e0c6d4d22133dd386aee4eec15
    - bf87e32a651bdfd9b9244a8cf24fca0e459eb614
    - bc47e15537fa7c32dfefd23168d7e1741f8477ed
    - 3ee2fd08137e9262d2e911158090e4a7c7427ea0
    - 4e826430a1389032f3fe06e2cc292f643fb0c417
    - 745bad097052134548fe159f158c04be5616afc2
    - 28b1c0b91eb6afd2d26b239c9f93beb053867a1a
    - 0466e90bf0e83b776ca8716e01d35a8a2e5f96d3
    - e6765d8866cad6193df1507c18f31fa7f723ca3e
    - 1fd7f881ea4a1dbb5c9aeb9e7ad659a85421745b
    - 57511ef5ff8162a9d793071b5bf7ebe8371759de
    - d098600152e5ee6a8238d414d2a77a34da8afaaa
    - 16d7ecf09fc98798a6170e4cef2745e0bee3f5c7
    - 8b6aa5b2bff44766ef7afbe095966a71bc4183fa
    - c834c4931b074665d56ccab437dfcc326649d612
    - 8d59fd14a445c8f3f0f7991fa6cd717d466b3754
    - d94f2fb3198e14bfe69b44fb9f00f2551f7248b2
    - 64e4ac8b9ea2f050933b7ec76a55dd04e97773b4
    - 93aa3bb934b74160446df3a47fa085fd7f3a6be9
    - 14bf0eaa90e012169745b3e30c281a327751e316
    - 738b7918d85e5cb4395df9e3f6fc94ddad90e939
    - 8c377ab4eebc5f4d8dd7bb3f90c0187dfdd3349f
    - fff4f28287677caabc60c8ab36786c370226588d
    - 34c85afe6d84cd3deec02c0a72e5abfa7a2886c3
    - 3f223581409492172a1e875f130f3485b90fbe5f
    - 282bb241bda5c4c1b8eb9bf56d018896649ca0e1
    - f1c8c3926d0370459a1b7f0cf3d17b22ff9d0c7f
    - e83458c4a6383223759cd8024e60c17be4e7c85f
    - d569d4bab86e70efbcdfdac9d822139d6f477b7c
    - 2a6e6bd51c7062ad24c02a4d2c1b5e948908d131
    - a65fabaf64aa1934314aae23f25cdf215cbaa4b6
    - c257aa4094539719a3c7b7950598ef872dbf9518
    - 1292c7dd60214d96a71e7705e519006b9de7968f
    - b4d1554ec19504215d27de0758e13c35ddd6db3e
    - 994dc79255aeb662a672a1814280de73d405617a
    - 5dd2c31c4357a8b76db095364952b3d0e3935e1d
    - 21e6c104fe9731c874fab5c9560c929b2857b918
    - e92817a8744ebc4e4fa5383cdce2b2977f01ecd4
    - 35f1ba60ba0da8512a0b1b15ee8e30fe240d77cd
    - bb962c9a8dda93e94fef504c4159de881e4706fe
    - 82ba5513c33e056c3f54152c8555abf555f3e745
    - f50c6b84dfb8f2d53ba3bce000a55f0a486c0e79
    - cb3de54667548a5c9abf5d8fa47db4097fcee9f1
    - 0c26ab1299adcd9a385b541ef1653728270aa23e
    - f02af84393e9627ba808d4159841854a6601cf80
    - cb22723faa5ae2809476e5c5e9b9a597b26cab9b
    - f9feb60b23ca69072ce42264cd821fe588a186a6
    - 160c96b5e5db8c96b821895582b501e3c2d5d6e7
    - 0b8b83f245d94107cb802a285e6529161d9a834d
    - d7e8aef8c8feb87ce722c0b9abf34a7e6bab6eb4
    - d7f7594ff084201c0d9fa2f4ef1626635b67bce5
    - 7d7c03e22049a725ace2a9812c72b53a66c2548b
    - 589a7d4df869395601ba7538a65afae8c4616385
    - 1f3799fed3cf43254fe30dcdfdb8dc02d82e662b
    - 72966ca845759d239d09da0de7eebe3abe86fee3
    - 0f780b7ada5dd8464d9f2cc537d973f5ac804e9c
    - 26c4a7b392d7e7bd7f0a2a758534e45c0d9a56ab
    - 7c6cad6a268230f6e08417d278dda4d66bb00d13
    - d04e5db5b6c848a29732bfd52029001f23c3da75
    - a87d6eac2d70a3fbc04e59412326b28001c179de
    - cce9b82f01ec68f450f5fe4312f40d929c6a506e
    - 8cc8974a05e81678e3d28acfe434e7804abd019c
    - 1e7c241b9a9ea79061b50fb19b3d141dee175c27
    - 00b4e8b7644d1bf93f5ddb5740b444b445e81b02
    - 4d41248078181c7f61e6e4906aa96bbdea320dc2
    - f3db629cfe37a73144d5258e64d9dd8b38084cf4
    - d2e6fc9259420f0c9b6b1769be3b1f63eb36dc57
    - 99201c9555e5faf6e8d82da793b148311f8aa4b8
    - a2e0b3162cfa336cd4ab40a2acc95abe7dc53843
    - 12d38abbc5391369a4c14f3431715b5b76ac5a2a
    - b4dcdbd97f38b24d729b986f84a9cdb3fc34d59f
    - 490109fa6739f114651f4199196c5121d1c6bdf2
    - e5021a98e55d514e2376aa573d143631e5ee1c13
    - af6e1f2cfb230907476e8b2d676129b6d6657124
    - ddbe809b731a0962e404a045ab9e65a0b64917ad
    - b480c54391a2a2f917a44f91a5e9e4590648b332
    - a21c84c6bf2e21d69fa06daaf19b4cc34b589347
    - dc55217b6043d819eadebd423ff07704ee103231
    - 6053d258096bccb07cb0057d700fe05233ab1fbb
    - b0032b8d8e6f4bd19a31619ce38d8e010f29a816
    - eb93d2f564fea9b3dc350f386b45de2cd9a3e001
    - 8692274681e8d10c26ddf2b993f31974b04f5bf0
    - f5696fb352a3fbd14fb1a89ad21a71776027f9ab
    - 5db61d00a001fd493591dc919f69b14713889fc5
    - 2b4d0dead4c1a7cc95543748b3565cfa802e5256
    - 205c69f078a563f54f4c0da2d02a25e284370251
    - 7c1b25518dee1e30b5a6eaa1ea8e4a3780c24d0c
    - 35829e096a15e559fcbabf3441d99e580ca3b26e
    - 17fa047c1f979b180644906fe9265f21af5b0509
    - ec4cc6de4c779bb1ca1dd32ee3a03f7e8d633a9b
    - 461882bd59887617cadc1c7b2b22d0a45458c070
    - 7838fb56fdab816bc1900a4720eea2fc9972ef7a
    - 1f3a9265963b660392c4053329eb9436deeed339
    - e09b5e80805b8fe853ea27d8773e31bff262e3f7
    - 5f8356ffa8201f338dd2ea979eb47881a6db9f03
    - 37e6450c7cd6999d080da94b867ba23faa8c32fe
    - 7ab4565ba24268f0adadb03a5506d4eb1dc7c181
    - 00a442a4305c62cefa8105c0b4c4a9a5f4d1e93b
    - 9c24dd75e4074041dbe03bf21f050c77d748b8e9
    - 3270720a066492b046d7180ca6e60602c764cac7
    - 0b6ec2aedc518849a1c61a70b1f9fb068ede2bc3
    - 814200191551faec65b21f5f6819b46c8fc227a3
    - 696d68bdbe1d684029aaad2861c49af56694473a
    - b89a8eef5aeae806af5ba212a8068845cafdab6f
    - 15df139494d2c40a645fb010908551185c27f3c5
    - 947db58d6f36a8df9fa2a1057f3a7f653ccbc42e
    - fe1d909ab38de1389a2a48352fd1c8415fd2eab0
    - 7667b72471689151e176baeba4e1cd9cd006a09a
    - d25340ae8e92a6d29f599fef426a2bc1b5217299
    - 6abbc3003c7aa69ce79cbbcd2e3210b07f21d202
    - d34a7c497c603f3f7fcad546dc4097c2da17c430
    - b8de3a1aeeda9deea43e3f768071125851c85bd0
    - 9c6749fc6c1127f8788bff70e0ce9062959637c9
    - 4268f30b79ce125a81d0d588bef0d4e2ad409bbb
    - 213ba055863d4226da26a759e8a254062ea77814
    - a4b2c56c12799855162ca3b004b4b2078c6ecf77
    - 27eab595ec403580236e04101172247c4f5d5426
    - d62fa51e520022483bdc5847141658de689c0c29
    - ccdd3a1ebe9a1c8f8a72af20a05a10f11da1d308
    - 8fb149fc476cf5bf18dc575334edad7caf210996
    - e35a2b009d54e1a0b231d8a276251f64231b66a3
    - d0d39e1061f30946141b6ecfa0957f8cc3ddeb63
    - 166759fd511613414d3213942fe2575b926a6226
    - 73bac306292b4e9107147db94d0d836fdb071e33
    - 460008b1ffd31792a6deadfa6280fb2a30c8a5d2
    - 2c5ff272bd345962ed41ab8869aef41da0dfe697
    - 9d07df024ec457168bf0be7e0009619f6ac4f13c
    - c4ed28fdfba7b8a8dfe39e591006f25d39990f07
    - 30a224b22592d952fbe2e6ad97eda4a8f2c734e0
    - 5520ac25d81550a255dc16a0bb89d4b275f6f809
    - 400f833dcc2ef0a122dd0e0b1ec4ec929340d90e
    - 6b54f8f137778c1391285fee6150dfa58a8120b1
    - cc0e0440adc058615e31e8a52372abadf658e6b1
    - cb3f30809b05cf02bc29d4a7796fb0650271e542
    - a64354aac2d68b4fa74b5829a9d42d90d83b040c
    - a6fe4f30ca7cb94d74bc6d42cdd09a136056952e
    - e6305dddd06490d7f87e3b06d09e9d4c1c643af0
    - 90a76945fd2fa45fab2b7bcfdaf6563595f94891
    - 53f776d9a183c42b93960b270dddeafba74eb3fb
    - 6100eb82a25d64a7a7702e94c2b21333bc15bd08
    - 53acd4d9e7ba0b1056cf52af0d191f226eddf312
    - 910cb12aa49e9f35ecc4907e8304adf0dcca8cf1
    - 4b882748faf2c6c360884c6812dd5bcbce75ebff
    - c95db1e82619fb16f8eec9a8209b7b0e853a4ebe
    - 4b8c0445075f09aeef542ab1c86e5de6b06e91a3
    - bbc1e5fd826961d93b76abd161314cb3592c4436
    - bbc0b9fd67c8f4cefa3d76fcb29ff3cef996b825
    - 1acc7a486b52c5ee6619dbdc3b4210b5f48b936f
    - 468e2e5505a3d924b14fedee4ddf240d09393776
    - c8d87f3cd34c572870e63a696cf771580e6ea81b
    - f18e669127c041431cde8f2d03b15cfc20696056
  - sha256:
    - 15c53eb3a0ea44bbd2901a45a6ebeae29bb123f9c1115c38dfb2cdbec0642229
    - ff6729518a380bf57f1bc6f1ec0aa7f3012e1618b8d9b0f31a61d299ee2b4339
    - f088b2ba27dacd5c28f8ee428f1350dca4bc7c6606309c287c801b2e1da1a53d
    - 9a1d66036b0868bbb1b2823209fedea61a301d5dd245f8e7d390bd31e52d663e
    - e6056443537d4d2314dabca1b9168f1eaaf17a14eb41f6f5741b6b82b3119790
    - e1980c6592e6d2d92c1a65acad8f1071b6a404097bb6fcce494f3c8ac31385cf
    - f51bdb0ad924178131c21e39a8ccd191e46b5512b0f2e1cc8486f63e84e5d960
    - b9b3878ddc5dfb237d38f8d25067267870afd67d12a330397a8853209c4d889c
    - 96bf3ee7c6673b69c6aa173bb44e21fa636b1c2c73f4356a7599c121284a51cc
    - 5a826b4fa10891cf63aae832fc645ce680a483b915c608ca26cedbb173b1b80a
    - 6948480954137987a0be626c24cf594390960242cd75f094cd6aaa5c2e7a54fa
    - 49ed27460730b62403c1d2e4930573121ab0c86c442854bc0a62415ca445a810
    - be54f7279e69fb7651f98e91d24069dbc7c4c67e65850e486622ccbdc44d9a57
    - 3d23bdbaf9905259d858df5bf991eb23d2dc9f4ecda7f9f77839691acef1b8c4
    - d205286bffdf09bc033c09e95c519c1c267b40c2ee8bab703c6a2d86741ccd3e
    - b48a309ee0960da3caaaaf1e794e8c409993aeb3a2b64809f36b97aac8a1e62a
    - 84bf1d0bcdf175cfe8aea2973e0373015793d43907410ae97e2071b2c4b8e2d4
    - 32cccc4f249499061c0afa18f534c825d01034a1f6815f5506bf4c4ff55d1351
    - c9b49b52b493b53cd49c12c3fa9553e57c5394555b64e32d1208f5b96a5b8c6e
    - 79e2d37632c417138970b4feba91b7e10c2ea251c5efe3d1fc6fa0190f176b57
    - 3390919bb28d5c36cc348f9ef23be5fa49bfd81263eb7740826e4437cbe904cd
    - 58c071cfe72e9ee867bba85cbd0abe72eb223d27978d6f0650d0103553839b59
    - 607dc4c75ac7aef82ae0616a453866b3b358c6cf5c8f9d29e4d37f844306b97c
    - 358ac54be252673841a1d65bfc2fb6d549c1a4c877fa7f5e1bfa188f30375d69
    - d0bd1ae72aeb5f3eabf1531a635f990e5eaae7fdd560342f915f723766c80889
    - f85cca4badff17d1aa90752153ccec77a68ad282b69e3985fdc4743eaea85004
    - 6908ebf52eb19c6719a0b508d1e2128f198d10441551cbfb9f4031d382f5229f
    - a899b659b08fbae30b182443be8ffb6a6471c1d0497b52293061754886a937a3
    - 771a8d05f1af6214e0ef0886662be500ee910ab99f0154227067fddcfe08a3dd
    - de6bf572d39e2611773e7a01f0388f84fb25da6cba2f1f8b9b36ffba467de6fa
    - 950a4c0c772021cee26011a92194f0e58d61588f77f2873aa0599dff52a160c9
    - 36505921af5a09175395ebaea29c72b2a69a3a9204384a767a5be8a721f31b10
    - 6de84caa2ca18673e01b91af58220c60aecd5cccf269725ec3c7f226b2167492
    - ef86c4e5ee1dbc4f81cd864e8cd2f4a2a85ee4475b9a9ab698a4ae1cc71fbeb0
    - 478917514be37b32d5ccf76e4009f6f952f39f5553953544f1b0688befd95e82
    - 7cfa5e10dff8a99a5d544b011f676bc383991274c693e21e3af40cf6982adb8c
    - f596e64f4c5d7c37a00493728d8756b243cfdc11e3372d6d6dfeffc13c9ab960
    - 0aafa9f47acf69d46c9542985994ff5321f00842a28df2396d4a3076776a83cb
    - 131d5490ceb9a5b2324d8e927fea5becfc633015661de2f4c2f2375a3a3b64c6
    - 3124b0411b8077605db2a9b7909d8240e0d554496600e2706e531c93c931e1b5
    - 1b7fb154a7b7903a3c81f12f4b094f24a3c60a6a8cffca894c67c264ab7545fa
    - f929bead59e9424ab90427b379dcdd63fbfe0c4fb5e1792e3a1685541cd5ec65
    - c8f9e1ad7b8cce62fba349a00bc168c849d42cfb2ca5b2c6cc4b51d054e0c497
    - 9c2f3e9811f7d0c7463eaa1ee6f39c23f902f3797b80891590b43bbe0fdf0e51
    - 05b146a48a69dd62a02759487e769bd30d39f16374bc76c86453b4ae59e7ffa4
    - c60fcff9c8e5243bbb22ec94618b9dcb02c59bb49b90c04d7d6ab3ebbd58dc3a
    - 4045ae77859b1dbf13972451972eaaf6f3c97bea423e9e78f1c2f14330cd47ca
    - a7b000abbcc344444a9b00cfade7aa22ab92ce0cadec196c30eb1851ae4fa062
    - 1963d5a0e512b72353953aadbe694f73a9a576f0241a988378fa40bf574eda52
    - 3f2fda9a7a9c57b7138687bbce49a2e156d6095dddabb3454ea09737e02c3fa5
    - f8965fdce668692c3785afa3559159f9a18287bc0d53abb21902895a8ecf221b
    - 19a212e6fc324f4cb9ee5eba60f5c1fc0191799a4432265cbeaa3307c76a7fc0
    - 1aaf4c1e3cb6774857e2eef27c17e68dc1ae577112e4769665f516c2e8c4e27b
    - 0af5ccb3d33a9ba92071c9637be6254030d61998733a5eb3583e865e17844e05
    - 5bc3994612624da168750455b363f2964e1861dba4f1c305df01b970ac02a7ae
    - da6ca1fb539f825ca0f012ed6976baf57ef9c70143b7a1e88b4650bf7a925e24
    - 0fd2df82341bf5ebb8a53682e60d08978100c01acb0bed7b6ce2876ada80f670
    - 8111085022bda87e5f6aa4c195e743cc6dd6a3a6d41add475d267dc6b105a69f
    - be03e9541f56ac6ed1e81407dcd7cc85c0ffc538c3c2c2c8a9c747edbcf13100
    - 47f08f7d30d824a8f4bb8a98916401a37c0fd8502db308aba91fe3112b892dcc
    - a7c8f4faf3cbb088cac7753d81f8ec4c38ccb97cd9da817741f49272e8d01200
    - 7f375639a0df7fe51e5518cf87c3f513c55bc117db47d28da8c615642eb18bfa
    - a56c2a2425eb3a4260cc7fc5c8d7bed7a3b4cd2af256185f24471c668853aee8
    - a3e507e713f11901017fc328186ae98e23de7cea5594687480229f77d45848d8
    - ded2927f9a4e64eefd09d0caba78e94f309e3a6292841ae81d5528cab109f95d
    - 9529efb1837b1005e5e8f477773752078e0a46500c748bc30c9b5084d04082e6
    - 2bbe65cbec3bb069e92233924f7ee1f95ffa16173fceb932c34f68d862781250
    - 32e1a8513eee746d17eb5402fb9d8ff9507fb6e1238e7ff06f7a5c50ff3df993
    - 39cfde7d401efce4f550e0a9461f5fc4d71fa07235e1336e4f0b4882bd76550e
    - 984a77e5424c6d099051441005f2938ae92b31b5ad8f6521c6b001932862add7
    - db2a9247177e8cdd50fe9433d066b86ffd2a84301aa6b2eb60f361cfff077004
    - 30706f110725199e338e9cc1c940d9a644d19a14f0eb8847712cba4cacda67ab
    - 8c95d28270a4a314299cf50f05dcbe63033b2a555195d2ad2f678e09e00393e6
    - 9f4ce6ab5e8d44f355426d9a6ab79833709f39b300733b5b251a0766e895e0e5
    - d92eab70bcece4432258c9c9a914483a2267f6ab5ce2630048d3a99e8cb1b482
    - e4a7da2cf59a4a21fc42b611df1d59cae75051925a7ddf42bf216cc1a026eadb
    - 525d9b51a80ca0cd4c5889a96f857e73f3a80da1ffbae59851e0f51bdfb0b6cd
    - 01e024cb14b34b6d525c642a710bfa14497ea20fd287c39ba404b10a8b143ece
    - 4cff6e53430b81ecc4fae453e59a0353bcfe73dd5780abfc35f299c16a97998e
    - 3943a796cc7c5352aa57ccf544295bfd6fb69aae147bc8235a00202dc6ed6838
    - f8236fc01d4efaa48f032e301be2ebba4036b2cd945982a29046eca03944d2ae
    - 575e58b62afab094c20c296604dc3b7dd2e1a50f5978d8ee24b7dca028e97316
    - 3d9e83b189fcf5c3541c62d1f54a0da0a4e5b62c3243d2989afc46644056c8e3
    - 0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5
    - 082c39fe2e3217004206535e271ebd45c11eb072efde4cc9885b25ba5c39f91d
    - c0d88db11d0f529754d290ed5f4c34b4dba8c4f2e5c4148866daabeab0d25f9c
    - 7e0124fcc7c95fdc34408cf154cb41e654dade8b898c71ad587b2090b1da30d7
    - 61a1bdddd3c512e681818debb5bee94db701768fc25e674fcad46592a3259bd0
    - b03f26009de2e8eabfcf6152f49b02a55c5e5d0f73e01d48f5a745f93ce93a29
    - 45abdbcd4c0916b7d9faaf1cd08543a3a5178871074628e0126a6eda890d26e0
    - 2003b478b9fd1b3d76ec5bf4172c2e8915babbbee7ad1783794acbf8d4c2519d
    - 06bda5a1594f7121acd2efe38ccb617fbc078bb9a70b665a5f5efd70e3013f50
    - 1e8b0c1966e566a523d652e00f7727d8b0663f1dfdce3b9a09b9adfaef48d8ee
    - e7af7bcb86bd6bab1835f610671c3921441965a839673ac34444cf0ce7b2164e
    - 93d873cdf23d5edc622b74f9544cac7fe247d7a68e1e2a7bf2879fad97a3ae63
    - a9706e320179993dade519a83061477ace195daa1b788662825484813001f526
    - 61d6e40601fa368800980801a662a5b3b36e3c23296e8ae1c85726a56ef18cc8
    - 47eaebc920ccf99e09fc9924feb6b19b8a28589f52783327067c9b09754b5e84
    - fd8669794c67b396c12fc5f08e9c004fdf851a82faf302846878173e4fbecb03
    - 000547560fea0dd4b477eb28bf781ea67bf83c748945ce8923f90fdd14eb7a4b
    - a13054f349b7baa8c8a3fcbd31789807a493cc52224bbff5e412eb2bd52a6433
    - 07b6d69bafcfd767f1b63a490a8843c3bb1f8e1bbea56176109b5743c8f7d357
    - 9f1229cd8dd9092c27a01f5d56e3c0d59c2bb9f0139abf042e56f343637fda33
    - 99f4994a0e5bd1bf6e3f637d3225c69ff4cd620557e23637533e7f18d7d6cba1
    - 22be050955347661685a4343c51f11c7811674e030386d2264cd12ecbf544b7c
    - ece0a900ea089e730741499614c0917432246ceb5e11599ee3a1bb679e24fd2c
    - 8ef0ad86500094e8fa3d9e7d53163aa6feef67c09575c169873c494ed66f057f
    - 36b9e31240ab0341873c7092b63e2e0f2cab2962ebf9b25271c3a1216b7669eb
    - 6b830ea0db6546a044c9900d3f335e7820c2a80e147b0751641899d1a5aa8f74
    - 9c10e2ec4f9ef591415f9a784b93dc9c9cdafa7c69602c0dc860c5b62222e449
    - 5b9623da9ba8e5c80c49473f40ffe7ad315dcadffc3230afdc9d9226d60a715a
    - fafa1bb36f0ac34b762a10e9f327dcab2152a6d0b16a19697362d49a31e7f566
    - e61a54f6d3869b43c4eceac3016df73df67cce03878c5a6167166601c5d3f028
    - f88ebb633406a086d9cca6bc8b66a4ea940c5476529f9033a9e0463512a23a57
    - 2aa1b08f47fbb1e2bd2e4a492f5d616968e703e1359a921f62b38b8e4662f0c4
    - 06508aacb4ed0a1398a2b0da5fa2dbf7da435b56da76fd83c759a50a51c75caf
    - cc383ad11e9d06047a1558ed343f389492da3ac2b84b71462aee502a2fa616c8
    - 845f1e228de249fc1ddf8dc28c39d03e8ad328a6277b6502d3932e83b879a65a
    - 01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd
    - 64f9e664bc6d4b8f5f68616dd50ae819c3e60452efd5e589d6604b9356841b57
    - 2a652de6b680d5ad92376ad323021850dab2c653abf06edf26120f7714b8e08a
    - 85866e8c25d82c1ec91d7a8076c7d073cccf421cf57d9c83d80d63943a4edd94
    - 42851a01469ba97cdc38939b10cf9ea13237aa1f6c37b1ac84904c5a12a81fa0
    - 9b1b15a3aacb0e786a608726c3abfc94968915cedcbd239ddf903c4a54bfcf0c
    - bb50818a07b0eb1bd317467139b7eb4bad6cd89053fecdabfeae111689825955
    - 9bb09752cf3a464455422909edef518ac18fe63cf5e1e8d9d6c2e68db62e0c87
    - b0eb4d999e4e0e7c2e33ff081e847c87b49940eb24a9e0794c6aa9516832c427
    - 43ba8d96d5e8e54cab59d82d495eeca730eeb16e4743ed134cdd495c51a4fc89
    - 76660e91f1ff3cb89630df5af4fe09de6098d09baa66b1a130c89c3c5edd5b22
    - 1c8dfa14888bb58848b4792fb1d8a921976a9463be8334cff45cc96f1276049a
    - 60c6f4f34c7319cb3f9ca682e59d92711a05a2688badbae4891b1303cd384813
    - bb1135b51acca8348d285dc5461d10e8f57260e7d0c8cc4a092734d53fc40cbc
    - 5c1585b1a1c956c7755429544f3596515dfdf928373620c51b0606a520c6245a
    - f40435488389b4fb3b945ca21a8325a51e1b5f80f045ab019748d0ec66056a8b
    - 405472a8f9400a54bb29d03b436ccd58cfd6442fe686f6d2ed4f63f002854659
    - 3a95cc82173032b82a0ffc7d2e438df64c13bc16b4574214c9fe3be37250925e
    - 42579a759f3f95f20a2c51d5ac2047a2662a2675b3fb9f46c1ed7f23393a0f00
    - 65db1b259e305a52042e07e111f4fa4af16542c8bacd33655f753ef642228890
    - 159e7c5a12157af92e0d14a0d3ea116f91c09e21a9831486e6dc592c93c10980
    - 5c04c274a708c9a7d993e33be3ea9e6119dc29527a767410dbaf93996f87369a
    - fcdfe570e6dc6e768ef75138033d9961f78045adca53beb6fdb520f6417e0df1
    - cb57f3a7fe9e1f8e63332c563b0a319b26c944be839eabc03e9a3277756ba612
    - 4744df6ac02ff0a3f9ad0bf47b15854bbebb73c936dd02f7c79293a2828406f6
    - 80cbba9f404df3e642f22c476664d63d7c229d45d34f5cd0e19c65eb41becec3
    - 29e0062a017a93b2f2f5207a608a96df4d554c5de976bd0276c2590a03bd3e94
    - db90e554ad249c2bd888282ecf7d8da4d1538dd364129a3327b54f8242dd5653
    - 8dafe5f3d0527b66f6857559e3c81872699003e0f2ffda9202a1b5e29db2002e
    - 101402d4f5d1ae413ded499c78a5fcbbc7e3bae9b000d64c1dd64e3c48c37558
    - 6ed35f310c96920a271c59a097b382da07856e40179c2a4239f8daa04eef38e7
    - 95d50c69cdbf10c9c9d61e64fe864ac91e6f6caa637d128eb20e1d3510e776d3
    - 37dde6bd8a7a36111c3ac57e0ac20bbb93ce3374d0852bcacc9a2c8c8c30079e
    - 5d530e111400785d183057113d70623e17af32931668ab7c7fc826f0fd4f91a3
    - d7bc7306cb489fe4c285bbeddc6d1a09e814ef55cf30bd5b8daf87a52396f102
    - 7049f3c939efe76a5556c2a2c04386db51daf61d56b679f4868bb0983c996ebb
    - b179e1ab6dc0b1aee783adbcad4ad6bb75a8a64cb798f30c0dd2ee8aaf43e6de
    - 3243aab18e273a9b9c4280a57aecef278e10bfff19abb260d7a7820e41739099
    - 0040153302b88bee27eb4f1eca6855039e1a057370f5e8c615724fa5215bada3
    - f0605dda1def240dc7e14efa73927d6c6d89988c01ea8647b671667b2b167008
    - b1334a71cc73b3d0c54f62d8011bec330dfc355a239bf94a121f6e4c86a30a2e
    - 74a846c61adc53692d3040aff4c1916f32987ad72b07fe226e9e7dbeff1036c4
    - 7f4555a940ce1156c9bcea9a2a0b801f9a5e44ec9400b61b14a7b1a6404ffdf6
    - c1c4310e5d467d24e864177bdbfc57cb5d29aac697481bfa9c11ddbeebfd4cc8
    - 22418016e980e0a4a2d01ca210a17059916a4208352c1018b0079ccb19aaf86a
    - 76b86543ce05540048f954fed37bdda66360c4a3ddb8328213d5aef7a960c184
    - dd4a1253d47de14ef83f1bc8b40816a86ccf90d1e624c5adf9203ae9d51d4097
    - 025e7be9fcefd6a83f4471bba0c11f1c11bd5047047d26626da24ee9a419cdc4
    - 50d5eaa168c077ce5b7f15b3f2c43bd2b86b07b1e926c1b332f8cb13bd2e0793
    - e05eeb2b8c18ad2cb2d1038c043d770a0d51b96b748bc34be3e7fc6f3790ce53
    - 749b0e8c8c8b7dda8c2063c708047cfe95afa0a4d86886b31a12f3018396e67c
    - d8459f7d707c635e2c04d6d6d47b63f73ba3f6629702c7a6e0df0462f6478ae2
    - 49f75746eebe14e5db11706b3e58accc62d4034d2f1c05c681ecef5d1ad933ba
    - 7133a461aeb03b4d69d43f3d26cd1a9e3ee01694e97a0645a3d8aa1a44c39129
    - ae79e760c739d6214c1e314728a78a6cb6060cce206fde2440a69735d639a0a2
    - 4422851a0a102f654e95d3b79c357ae3af1b096d7d1576663c027cfbc04abaf9
    - 84df20b1d9d87e305c92e5ffae21b10b325609d59d835a954dbd8750ef5dabf4
    - 7a7e8df7173387aec593e4fe2b45520ea3156c5f810d2bb1b2784efd1c922376
    - cd4a249c3ef65af285d0f8f30a8a96e83688486aab515836318a2559757a89bb
    - 86a8e0aa29a5b52c84921188cc1f0eca9a7904dcfe09544602933d8377720219
    - 47f0cdaa2359a63ad1389ef4a635f1f6eee1f63bdf6ef177f114bdcdadc2e005
    - 18e1707b319c279c7e0204074088cc39286007a1cf6cb6e269d5067d8d0628c6
    - 70211a3f90376bbc61f49c22a63075d1d4ddd53f0aefa976216c46e6ba39a9f4
    - 4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1
    - 8d9a2363b757d3f127b9c6ed8f7b8b018e652369bc070aa3500b3a978feaa6ce
    - 36875562e747136313ec5db58174e5fab870997a054ca8d3987d181599c7db6a
    - 7877c1b0e7429453b750218ca491c2825dae684ad9616642eff7b41715c70aca
    - 591bd5e92dfa0117b3daa29750e73e2db25baa717c31217539d30ffb1f7f3a52
    - 04a85e359525d662338cae86c1e59b1d7aa9bd12b920e8067503723dc1e03162
    - 4880f40f2e557cff38100620b9aa1a3a753cb693af16cd3d95841583edcb57a8
    - e81230217988f3e7ec6f89a06d231ec66039bdba340fd8ebb2bbb586506e3293
    - 49c827cf48efb122a9d6fd87b426482b7496ccd4a2dbca31ebbf6b2b80c98530
    - d8b58f6a89a7618558e37afc360cd772b6731e3ba367f8d58734ecee2244a530
    - 7ec93f34eb323823eb199fbf8d06219086d517d0e8f4b9e348d7afd41ec9fd5d
    - 2e6b339597a89e875f175023ed952aaac64e9d20d457bbc07acf1586e7fe2df8
    - cf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986
    - a7c2e7910942dd5e43e2f4eb159bcd2b4e71366e34a68109548b9fb12ac0f7cc
    - c5050a2017490fff7aa53c73755982b339ddb0fd7cef2cde32c81bc9834331c5
    - 59626cac380d8fe0b80a6d4c4406d62ba0683a2f0f68d50ad506ca1b1cf25347
    - 89b0017bc30cc026e32b758c66a1af88bd54c6a78e11ec2908ff854e00ac46be
    - e005e8d183e853a27ad3bb56f25489f369c11b0d47e3d4095aad9291b3343bf1
    - 5f5e5f1c93d961985624768b7c676d488c7c7c1d4c043f6fc1ea1904fefb75be
    - cdd2a4575a46bada4837a6153a79c14d60ee3129830717ef09e0e3efd9d00812
    - ac3f613d457fc4d44fa27b2e0b1baa62c09415705efb5a40a4756da39b3ac165
    - 475e5016c9c0f5a127896f9179a1b1577a67b357f399ab5a1e68aab07134729a
    - cc687fe3741bbde1dd142eac0ef59fd1d4457daee43cdde23bb162ef28d04e64
    - 0de4247e72d378713bcf22d5c5d3874d079203bb4364e25f67a90d5570bdcce8
    - 72b99147839bcfb062d29014ec09fe20a8f261748b5925b00171ef3cb849a4c1
    - cc586254e9e89e88334adee44e332166119307e79c2f18f6c2ab90ce8ba7fc9b
    - f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe
    - 5ee292b605cd3751a24e5949aae615d472a3c72688632c3040dc311055b75a92
    - 4429f32db1cc70567919d7d47b844a91cf1329a6cd116f582305f3b7b60cd60b
    - f8886a9c759e0426e08d55e410b02c5b05af3c287b15970175e4874316ffaf13
    - c9cf1d627078f63a36bbde364cd0d5f2be1714124d186c06db5bcdf549a109f8
    - 2da330a2088409efc351118445a824f11edbe51cf3d653b298053785097fe40e
    - 54841d9f89e195196e65aa881834804fe3678f1cf6b328cab8703edd15e3ec57
    - e6a7b0bc01a627a7d0ffb07faddb3a4dd96b6f5208ac26107bdaeb3ab1ec8217
    - cf4b5fa853ce809f1924df3a3ae3c4e191878c4ea5248d8785dc7e51807a512b
    - 6839fcae985774427c65fe38e773aa96ec451a412caa5354ad9e2b9b54ffe6c1
    - 708016fbe22c813a251098f8f992b177b476bd1bbc48c2ed4a122ff74910a965
    - 362c4f3dadc9c393682664a139d65d80e32caa2a97b6e0361dfd713a73267ecc
    - 08eb2d2aa25c5f0af4e72a7e0126735536f6c2c05e9c7437282171afe5e322c6
    - 2d83ccb1ad9839c9f5b3f10b1f856177df1594c66cbbc7661677d4b462ebf44d
    - c725919e6357126d512c638f993cf572112f323da359645e4088f789eb4c7b8c
    - 4941c4298f4560fc1e59d0f16f84bab5c060793700b82be2fd7c63735f1657a8
    - 1aaa9aef39cb3c0a854ecb4ca7d3b213458f302025e0ec5bfbdef973cca9111c
    - 76fb4deaee57ef30e56c382c92abffe2cf616d08dbecb3368c8ee6b02e59f303
    - 3a5ec83fe670e5e23aef3afa0a7241053f5b6be5e6ca01766d6b5f9177183c25
    - 7196187fb1ef8d108b380d37b2af8efdeb3ca1f6eefd37b5dc114c609147216d
    - f461414a2596555cece5cfee65a3c22648db0082ca211f6238af8230e41b3212
    - 55fee54c0d0d873724864dc0b2a10b38b7f40300ee9cae4d9baaf8a202c4049a
    - b9dad0131c51e2645e761b74a71ebad2bf175645fa9f42a4ab0e6921b83306e3
    - fd223833abffa9cd6cc1848d77599673643585925a7ee51259d67c44d361cce8
    - d5586dc1e61796a9ae5e5d1ced397874753056c3df2eb963a8916287e1929a71
    - 543991ca8d1c65113dff039b85ae3f9a87f503daec30f46929fd454bc57e5a91
    - 6cb51ae871fbd5d07c5aad6ff8eea43d34063089528603ca9ceb8b4f52f68ddc
    - 6c7120e40fc850e4715058b233f5ad4527d1084a909114fd6a36b7b7573c4a44
    - e75714f8e0ff45605f6fc7689a1a89c7dcd34aab66c6131c63fefaca584539cf
    - 4a3d4db86f580b1680d6454baee1c1a139e2dde7d55e972ba7c92ec3f555dce2
    - dec8a933dba04463ed9bb7d53338ff87f2c23cfb79e0e988449fc631252c9dcc
    - 6b5cf41512255237064e9274ca8f8a3fef820c45aa6067c9c6a0e6f5751a0421
    - e83908eba2501a00ef9e74e7d1c8b4ff1279f1cd6051707fd51824f87e4378fa
    - 0ebaef662b14410c198395b13347e1d175334ec67919709ad37d65eba013adff
    - 3e9b62d2ea2be50a2da670746c4dbe807db9601980af3a1014bcd72d0248d84c
    - 7d8937c18d6e11a0952e53970a0934cf0e65515637ac24d6ca52ccf4b93d385f
    - 9d58f640c7295952b71bdcb456cae37213baccdcd3032c1e3aeb54e79081f395
    - aa9ab1195dc866270e984f1bed5e1358d6ef24c515dfdb6c2a92d1e1b94bf608
    - 8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104
    - ea0b9eecf4ad5ec8c14aec13de7d661e7615018b1a3c65464bf5eca9bbf6ded3
    - 31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427
    - 258359a7fa3d975620c9810dab3a6493972876a024135feaf3ac8482179b2e79
    - 146d77e80ca70ea5cb17bfc9a5cea92334f809cbdc87a51c2d10b8579a4b9c88
    - 9790a7b9d624b2b18768bb655dda4a05a9929633cef0b1521e79e40d7de0a05b
    - cb9890d4e303a4c03095d7bc176c42dee1b47d8aa58e2f442ec1514c8f9e3cec
    - cbb8239a765bf5b2c1b6a5c8832d2cab8fef5deacadfb65d8ed43ef56d291ab6
    - 436ccab6f62fa2d29827916e054ade7acae485b3de1d3e5c6c62d3debf1480e7
    - b9a4e40a5d80fedd1037eaed958f9f9efed41eb01ada73d51b5dcd86e27e0cbf
    - b4d47ea790920a4531e3df5a4b4b0721b7fea6b49a35679f0652f1e590422602
    - 9fc29480407e5179aa8ea41682409b4ea33f1a42026277613d6484e5419de374
    - 81c7bb39100d358f8286da5e9aa838606c98dfcc263e9a82ed91cd438cb130d1
    - 552f70374715e70c4ade591d65177be2539ec60f751223680dfaccb9e0be0ed9
    - 81939e5c12bd627ff268e9887d6fb57e95e6049f28921f3437898757e7f21469
    - 4ab41816abbf14d59e75b7fad49e2cb1c1feb27a3cb27402297a2a4793ff9da7
    - af095de15a16255ca1b2c27dad365dff9ac32d2a75e8e288f5a1307680781685
    - b7a20b5f15e1871b392782c46ebcc897929443d82073ee4dcb3874b6a5976b5d
    - ea85bbe63d6f66f7efee7007e770af820d57f914c7f179c5fee3ef2845f19c41
    - 06a0ec9a316eb89cb041b1907918e3ad3b03842ec65f004f6fa74d57955573a4
    - 4e3eb5b9bce2fd9f6878ae36288211f0997f6149aa8c290ed91228ba4cdfae80
    - 314384b40626800b1cde6fbc51ebc7d13e91398be2688c2a58354aa08d00b073
    - 11bd2c9f9e2397c9a16e0990e4ed2cf0679498fe0fd418a3dfdac60b5c160ee5
    - 4a9093e8dbcb867e1b97a0a67ce99a8511900658f5201c34ffb8035881f2dbbe
    - 38fa0c663c8689048726666f1c5e019feaa9da8278f1df6ff62da33961891d2a
    - 56a3c9ac137d862a85b4004f043d46542a1b61c6acb438098a9640469e2d80e7
    - 455bc98ba32adab8b47d2d89bdbadca4910f91c182ab2fc3211ba07d3784537b
    - e86cb77de7b6a8025f9a546f6c45d135f471e664963cf70b381bee2dfd0fdef4
    - 3ac5e01689a3d745e60925bc7faca8d4306ae693e803b5e19c94906dc30add46
    - b1d96233235a62dbb21b8dbe2d1ae333199669f67664b107bff1ad49b41d9414
    - dfaefd06b680f9ea837e7815fc1cc7d1f4cc375641ac850667ab20739f46ad22
    - 221dfbc74bbb255b0879360ccc71a74b756b2e0f16e9386b38a9ce9d4e2e34f9
    - afdd66562dea51001c3a9de300f91fc3eb965d6848dfce92ccb9b75853e02508
    - 78827fa00ea48d96ac9af8d1c1e317d02ce11793e7f7f6e4c7aac7b5d7dd490f
    - 7f190f6e5ab0edafd63391506c2360230af4c2d56c45fc8996a168a1fc12d457
    - d5562fb90b0b3deb633ab335bcbd82ce10953466a428b3f27cb5b226b453eaf3
    - fd33fb2735cc5ef466a54807d3436622407287e325276fcd3ed1290c98bd0533
    - f581decc2888ef27ee1ea85ea23bbb5fb2fe6a554266ff5a1476acd1d29d53af
    - 58a74dceb2022cd8a358b92acd1b48a5e01c524c3b0195d7033e4bd55eff4495
    - dde6f28b3f7f2abbee59d4864435108791631e9cb4cdfb1f178e5aa9859956d8
    - 21ccdd306b5183c00ecfd0475b3152e7d94b921e858e59b68a03e925d1715f21
    - 91314768da140999e682d2a290d48b78bb25a35525ea12c1b1f9634d14602b2c
    - 98b734dda78c16ebcaa4afeb31007926542b63b2f163b2f733fa0d00dbb344d8
    - d25904fbf907e19f366d54962ff543d9f53b8fdfd2416c8b9796b6a8dd430e26
    - 6f1ff29e2e710f6d064dc74e8e011331d807c32cc2a622cbe507fd4b4d43f8f4
    - 3326e2d32bbabd69feb6024809afc56c7e39241ebe70a53728c77e80995422a5
    - 8cb62c5d41148de416014f80bd1fd033fd4d2bd504cb05b90eeb6992a382d58f
    - 1d0397c263d51e9fc95bcc8baf98d1a853e1c0401cd0e27c7bf5da3fba1c93a8
    - 50db5480d0392a7dd6ab5df98389dc24d1ed1e9c98c9c35964b19dabcd6dc67f
    - 3ec5ad51e6879464dfbccb9f4ed76c6325056a42548d5994ba869da9c4c039a8
    - 71fe5af0f1564dc187eea8d59c0fbc897712afa07d18316d2080330ba17cf009
    - b47be212352d407d0ef7458a7161c66b47c2aec8391dd101df11e65728337a6a
    - 3871e16758a1778907667f78589359734f7f62f9dc953ec558946dcdbe6951e3
    - 65329dad28e92f4bcc64de15c552b6ef424494028b18875b7dba840053bc0cdd
    - a961f5939088238d76757669a9a81905e33f247c9c635b908daac146ae063499
    - 509628b6d16d2428031311d7bd2add8d5f5160e9ecc0cd909f1e82bbbb3234d6
    - 440883cd9d6a76db5e53517d0ec7fe13d5a50d2f6a7f91ecfc863bc3490e4f5c
    - 09bedbf7a41e0f8dabe4f41d331db58373ce15b2e9204540873a1884f38bdde1
    - 1ddfe4756f5db9fb319d6c6da9c41c588a729d9e7817190b027b38e9c076d219
    - 677c0b1add3990fad51f492553d3533115c50a242a919437ccb145943011d2bf
    - 823da894b2c73ffcd39e77366b6f1abf0ae9604d9b20140a54e6d55053aadeba
    - 05f052c64d192cf69a462a5ec16dda0d43ca5d0245900c9fcb9201685a2e7748
    - 42f0b036687cbd7717c9efed6991c00d4e3e7b032dc965a2556c02177dfdad0f
    - f8430bdc6fd01f42217d66d87a3ef6f66cb2700ebb39c4f25c8b851858cc4b35
    - 927c2a580d51a598177fa54c65e9d2610f5f212f1b6cb2fbf2740b64368f010a
    - e68d453d333854787f8470c8baef3e0d082f26df5aa19c0493898bcf3401e39a
    - eea53103e7a5a55dc1df79797395a2a3e96123ebd71cdd2db4b1be80e7b3f02b
    - 88076e98d45ed3adf0c5355411fe8ca793eb7cec1a1c61f5e1ec337eae267463
    - 9254f012009d55f555418ff85f7d93b184ab7cb0e37aecdfdab62cfe94dea96b
  selection_sysmon:
    Hashes|contains:
    - MD5=1b5c3c458e31bede55145d0644e88d75
    - MD5=6f5d54ab483659ac78672440422ae3f1
    - MD5=ee6b1a79cb6641aa44c762ee90786fe0
    - MD5=c02f70960fa934b8defa16a03d7f6556
    - MD5=839cbbc86453960e9eb6db814b776a40
    - MD5=acac842a46f3501fe407b1db1b247a0b
    - MD5=95e4c7b0384da89dce8ea6f31c3613d9
    - MD5=e700a820f117f65e813b216fccbf78c9
    - MD5=96b463b6fa426ae42c414177af550ba2
    - MD5=27bcbeec8a466178a6057b64bef66512
    - MD5=70dcd07d38017b43f710061f37cb4a91
    - MD5=db72def618cbc3c5f9aa82f091b54250
    - MD5=83601bbe5563d92c1fdb4e960d84dc77
    - MD5=5970e8de1b337ca665114511b9d10806
    - MD5=49fe3d1f3d5c2e50a0df0f6e8436d778
    - MD5=1493d342e7a36553c56b2adea150949e
    - MD5=4f191abc652d8f7442ca2636725e1ed6
    - MD5=0ae30291c6cbfa7be39320badd6e8de0
    - MD5=d104621c93213942b7b43d65b5d8d33e
    - MD5=b89b097b8b8aecb8341d05136f334ebb
    - MD5=14580bd59c55185115fd3abe73b016a2
    - MD5=992ded5b623be3c228f32edb4ca3f2d2
    - MD5=a26e600652c33dd054731b4693bf5b01
    - MD5=1f950cfd5ed8dd9de3de004f5416fe20
    - MD5=491aec2249ad8e2020f9f9b559ab68a8
    - MD5=e4266262a77fffdea2584283f6c4f51d
    - MD5=bd25be845c151370ff177509d95d5add
    - MD5=9638f265b1ddd5da6ecdf5c0619dcbe6
    - MD5=4e90cd77509738d30d3181a4d0880bfa
    - MD5=0a6a1c9a7f80a2a5dcced5c4c0473765
    - MD5=9aa7ed7809eec0d8bc6c545a1d18107a
    - MD5=aa1ed3917928f04d97d8a217fe9b5cb1
    - MD5=42f7cc4be348c3efd98b0f1233cf2d69
    - MD5=4cc3ddd5ae268d9a154a426af2c23ef9
    - MD5=2fed983ec44d1e7cffb0d516407746f2
    - MD5=f7cbbb5eb263ec9a35a1042f52e82ca4
    - MD5=ed6348707f177629739df73b97ba1b6e
    - MD5=40bc58b7615d00eb55ad9ba700c340c1
    - MD5=c3fea895fe95ea7a57d9f4d7abed5e71
    - MD5=2128e6c044ee86f822d952a261af0b48
    - MD5=3dbf69f935ea48571ea6b0f5a2878896
    - MD5=c6f8983dd3d75640c072a8459b8fa55a
    - MD5=6fcf56f6ca3210ec397e55f727353c4a
    - MD5=79f7e6f98a5d3ab6601622be4471027f
    - MD5=bae1f127c4ff21d8fe45e2bbfc59c180
    - MD5=c533d6d64b474ffc3169a0e0fc0a701a
    - MD5=3f39f013168428c8e505a7b9e6cba8a2
    - MD5=748cf64b95ca83abc35762ad2c25458f
    - MD5=bce7f34912ff59a3926216b206deb09f
    - MD5=2d8e4f38b36c334d0a32a7324832501d
    - MD5=47e6ac52431ca47da17248d80bf71389
    - MD5=3651a6990fe38711ebb285143f867a43
    - MD5=dc943bf367ae77016ae399df8e71d38a
    - MD5=02198692732722681f246c1b33f7a9d9
    - MD5=ddc2ffe0ab3fcd48db898ab13c38d88d
    - MD5=0ec361f2fba49c73260af351c39ff9cb
    - MD5=c1fce7aac4e9dd7a730997e2979fa1e2
    - MD5=49938383844ceec33dba794fb751c9a5
    - MD5=34069a15ae3aa0e879cd0d81708e4bcc
    - MD5=1c294146fc77565030603878fd0106f9
    - MD5=fd81af62964f5dd5eb4a828543a33dcf
    - MD5=bd5b0514f3b40f139d8079138d01b5f6
    - MD5=fa173832dca1b1faeba095e5c82a1559
    - MD5=5cc5c26fc99175997d84fe95c61ab2c2
    - MD5=1ed043249c21ab201edccb37f1d40af9
    - MD5=361a598d8bb92c13b18abb7cac850b01
    - MD5=9b359b722ac80c4e0a5235264e1e0156
    - MD5=296bde4d0ed32c6069eb90c502187d0d
    - MD5=d3e40644a91327da2b1a7241606fe559
    - MD5=12cecc3c14160f32b21279c1a36b8338
    - MD5=dd39a86852b498b891672ffbcd071c03
    - MD5=b2a9ac0600b12ec9819e049d7a6a0b75
    - MD5=444f538daa9f7b340cfd43974ed43690
    - MD5=7b43dfd84de5e81162ebcfafb764b769
    - MD5=13dda15ef67eb265869fc371c72d6ef0
    - MD5=300c5b1795c9b6cc1bc4d7d55c7bbe85
    - MD5=1392b92179b07b672720763d9b1028a5
    - MD5=2e1f8a2a80221deb93496a861693c565
    - MD5=8065a7659562005127673ac52898675f
    - MD5=b5ada7fd226d20ec6634fc24768f9e22
    - MD5=84fb76ee319073e77fb364bbbbff5461
    - MD5=daf800da15b33bf1a84ee7afc59f0656
    - MD5=f7393fb917aed182e4cbef25ce8af950
    - MD5=120b5bbb9d2eb35ff4f62d79507ea63a
    - MD5=73c98438ac64a68e88b7b0afd11ba140
    - MD5=51207adb8dab983332d6b22c29fe8129
    - MD5=4a23e0f2c6f926a41b28d574cbc6ac30
    - MD5=20125794b807116617d43f02b616e092
    - MD5=e8ebba56ea799e1e62748c59e1a4c586
    - MD5=8abbb12e61045984eda19e2dc77b235e
    - MD5=f66b96aa7ae430b56289409241645099
    - MD5=97e3a44ec4ae58c8cc38eefc613e950e
    - MD5=ff7b31fa6e9ab923bce8af31d1be5bb2
    - MD5=12908c285b9d68ee1f39186110df0f1e
    - MD5=6126065af2fc2639473d12ee3c0c198e
    - MD5=356bda2bf0f6899a2c08b2da3ec69f13
    - MD5=fd7de498a72b2daf89f321d23948c3c4
    - MD5=338a98e1c27bc76f09331fcd7ae413a5
    - MD5=c9a293762319d73c8ee84bcaaf81b7b3
    - MD5=e9e786bdba458b8b4f9e93d034f73d00
    - MD5=a17c58c0582ee560c72f60764ed63224
    - MD5=21e13f2cb269defeae5e1d09887d47bb
    - MD5=a57b47489febc552515778dd0fd1e51c
    - MD5=d6e9f6c67d9b3d790d592557a7d57c3c
    - MD5=76bb1a4332666222a8e3e1339e267179
    - MD5=1cd158a64f3d886357535382a6fdad75
    - MD5=d9e7e5bcc5b01915dbcef7762a7fc329
    - MD5=d253c19194a18030296ae62a10821640
    - MD5=b12d1630fd50b2a21fd91e45d522ba3a
    - MD5=50b39072d0ee9af5ef4824eca34be6e3
    - MD5=778b7feea3c750d44745d3bf294bd4ce
    - MD5=0761c357aed5f591142edaefdf0c89c8
    - MD5=23cf3da010497eb2bf39a5c5a57e437c
    - MD5=c49a1956a6a25ffc25ad97d6762b0989
    - MD5=f406c5536bcf9bacbeb7ce8a3c383bfa
    - MD5=f2f728d2f69765f5dfda913d407783d2
    - MD5=4b817d0e7714b9d43db43ae4a22a161e
    - MD5=715f8efab1d1c660e4188055c4b28eed
    - MD5=a01c412699b6f21645b2885c2bae4454
    - MD5=010c0e5ac584e3ab97a2daf84cf436f5
    - MD5=d5db81974ffda566fa821400419f59be
    - MD5=3247014ba35d406475311a2eab0c4657
    - MD5=4d487f77be4471900d6ccbc47242cc25
    - MD5=1f2888e57fdd6aee466962c25ba7d62d
    - MD5=507a649eb585d8d0447eab0532ef0c73
    - MD5=4ad8fd9e83d7200bd7f8d0d4a9abfb11
    - MD5=cd9f0fcecf1664facb3671c0130dc8bb
    - MD5=b10b210c5944965d0dc85e70a0b19a42
    - MD5=ae5eb2759305402821aeddc52ba9a6d6
    - MD5=f5051c756035ef5de9c4c48bacb0612b
    - MD5=1898ceda3247213c084f43637ef163b3
    - MD5=37086ae5244442ba552803984a11d6cb
    - MD5=825703c494e0d270f797f1ecf070f698
    - MD5=909f3fc221acbe999483c87d9ead024a
    - MD5=75d6c3469347de1cdfa3b1b9f1544208
    - MD5=9ab9f3b75a2eb87fafb1b7361be9dfb3
    - MD5=5f9785e7535f8f602cb294a54962c9e7
    - MD5=7d46d0ddaf8c7e1776a70c220bf47524
    - MD5=f9844524fb0009e5b784c21c7bad4220
    - MD5=828bb9cb1dd449cd65a29b18ec46055f
    - MD5=4d17b32be70ef39eae5d5edeb5e89877
    - MD5=2391fb461b061d0e5fccb050d4af7941
    - MD5=6d4159694e1754f262e326b52a3b305a
    - MD5=a60c9173563b940203cf4ad38ccf2082
    - MD5=63e333d64a8716e1ae59f914cb686ae8
    - MD5=a9f220b1507a3c9a327a99995ff99c82
    - MD5=c5f5d109f11aadebae94c77b27cb026f
    - MD5=5bab40019419a2713298a5c9173e5d30
    - MD5=c996d7971c49252c582171d9380360f2
    - MD5=98763a3dee3cf03de334f00f95fc071a
    - MD5=e79c91c27df3eaf82fb7bd1280172517
    - MD5=a42249a046182aaaf3a7a7db98bfa69d
    - MD5=803a371a78d528a44ef8777f67443b16
    - MD5=9007c94c9d91ccff8d7f5d4cdddcc403
    - MD5=11fb599312cb1cf43ca5e879ed6fb71e
    - MD5=7f9309f5e4defec132b622fadbcad511
    - MD5=04a88f5974caa621cee18f34300fc08a
    - MD5=8636fe3724f2bcba9399daffd6ef3c7e
    - MD5=9dfd73dadb2f1c7e9c9d2542981aaa63
    - MD5=490b1f404c4f31f4538b36736c990136
    - MD5=c1d063c9422a19944cdaa6714623f2ec
    - MD5=dacb62578b3ea191ea37486d15f4f83c
    - MD5=2da209dde8188076a9579bd256dc90d0
    - MD5=0ba6afe0ea182236f98365bd977adfdf
    - MD5=4c016fd76ed5c05e84ca8cab77993961
    - MD5=ad22a7b010de6f9c6f39c350a471a440
    - MD5=79483cb29a0c428e1362ec8642109eee
    - MD5=a179c4093d05a3e1ee73f6ff07f994aa
    - MD5=ccf523b951afaa0147f22e2a7aae4976
    - MD5=736c4b85ce346ddf3b49b1e3abb4e72a
    - MD5=b0baac4d6cbac384a633c71858b35a2e
    - MD5=798de15f187c1f013095bbbeb6fb6197
    - MD5=a86150f2e29b35369afa2cafd7aa9764
    - MD5=b941c8364308990ee4cc6eadf7214e0f
    - MD5=dd04cd3de0c19bede84e9c95a86b3ca8
    - MD5=6909b5e86e00b4033fedfca1775b0e33
    - MD5=9b91a44a488e4d539f2e55476b216024
    - MD5=8b287636041792f640f92e77e560725e
    - MD5=07f83829e7429e60298440cd1e601a6a
    - MD5=0395b4e0eb21693590ad1cfdf7044b8b
    - MD5=4b058945c9f2b8d8ebc485add1101ba5
    - MD5=0067c788e1cb174f008c325ebde56c22
    - MD5=c2c1b8c00b99e913d992a870ed478a24
    - MD5=84ba7af6ada1b3ea5efb9871a0613fc6
    - MD5=dbc415304403be25ac83047c170b0ec2
    - MD5=31469f1313871690e8dc2e8ee4799b22
    - MD5=2d465b4487dc81effaa84f122b71c24f
    - MD5=64efbffaa153b0d53dc1bccda4279299
    - MD5=b164daf106566f444dfb280d743bc2f7
    - MD5=7c72a7e1d42b0790773efd8700e24952
    - MD5=56a515173b211832e20fbc64e5a0447c
    - MD5=c2eb4539a4f6ab6edd01bdc191619975
    - MD5=d1bac75205c389d6d5d6418f0457c29b
    - MD5=68dde686d6999ad2e5d182b20403240b
    - MD5=a785b3bc4309d2eb111911c1b55e793f
    - MD5=6ab7b8ef0c44e7d2d5909fdb58d37fa5
    - MD5=d9ce18960c23f38706ae9c6584d9ac90
    - MD5=ab53d07f18a9697139ddc825b466f696
    - MD5=ba5f0f6347780c2ed911bbf888e75bef
    - MD5=13ee349c15ee5d6cf640b3d0111ffc0e
    - MD5=9a237fa07ce3ed06ea924a9bed4a6b99
    - MD5=fa222bed731713904320723b9c085b11
    - MD5=0898af0888d8f7a9544ef56e5e16354e
    - MD5=e076dadf37dd43a6b36aeed957abee9e
    - MD5=4f27c09cc8680e06b04d6a9c34ca1e08
    - MD5=1b32c54b95121ab1683c7b83b2db4b96
    - MD5=715572dfe6fb10b16f980bfa242f3fa5
    - MD5=4a06bcd96ef0b90a1753a805b4235f28
    - MD5=f242cffd9926c0ccf94af3bf16b6e527
    - MD5=7ed6030f14e66e743241f2c1fa783e69
    - MD5=0d6fef14f8e1ce5753424bd22c46b1ce
    - MD5=a4fda97f452b8f8705695a729f5969f7
    - MD5=62c18d61ed324088f963510bae43b831
    - MD5=d5a642329cce4df94b8dc1ba9660ae34
    - MD5=a641e3dccba765a10718c9cb0da7879e
    - MD5=ed07f1a8038596574184e09211dfc30f
    - MD5=3473faea65fba5d4fbe54c0898a3c044
    - MD5=708ac9f7b12b6ca4553fd8d0c7299296
    - MD5=bbe4f5f8b0c0f32f384a83ae31f49a00
    - MD5=257483d5d8b268d0d679956c7acdf02d
    - MD5=312e31851e0fc2072dbf9a128557d6ef
    - MD5=14eead4d42728e9340ec8399a225c124
    - MD5=de1cc5c266140bff9d964fab87a29421
    - MD5=9a9dbf5107848c254381be67a4c1b1dd
    - MD5=1dc94a6a82697c62a04e461d7a94d0b0
    - MD5=2850608430dd089f24386f3336c84729
    - MD5=6d131a7462e568213b44ef69156f10a5
    - MD5=b8b6686324f7aa77f570bc019ec214e6
    - MD5=22823fed979903f8dfe3b5d28537eb47
    - MD5=c1d3a6bb423739a5e781f7eee04c9cfd
    - MD5=0c0195c48b6b8582fa6f6373032118da
    - MD5=5228b7a738dc90a06ae4f4a7412cb1e9
    - MD5=62f02339fe267dc7438f603bfb5431a1
    - MD5=22949977ce5cd96ba674b403a9c81285
    - MD5=5ca1922ed5ee2b533b5f3dd9be20fd9a
    - MD5=1ed08a6264c5c92099d6d1dae5e8f530
    - MD5=b0770094c3c64250167b55e4db850c04
    - MD5=a6e9d6505f6d2326a8a9214667c61c67
    - MD5=8407ddfab85ae664e507c30314090385
    - MD5=9321a61a25c7961d9f36852ecaa86f55
    - MD5=a711e6ab17802fabf2e69e0cd57c54cd
    - MD5=29ccff428e5eb70ae429c3da8968e1ec
    - MD5=79df0eabbf2895e4e2dae15a4772868c
    - MD5=fb7c61ef427f9b2fdff3574ee6b1819b
    - MD5=f778489c7105a63e9e789a02412aaa5f
    - MD5=fef9dd9ea587f8886ade43c1befbdafe
    - MD5=43830326cd5fae66f5508e27cbec39a0
    - MD5=c7a57cd4bea07dadba2e2fb914379910
    - MD5=f1e054333cc40f79cfa78e5fbf3b54c2
    - MD5=dc564bac7258e16627b9de0ce39fae25
    - MD5=054299e09cea38df2b84e6b29348b418
    - MD5=97221e16e7a99a00592ca278c49ffbfc
    - MD5=8d63e1a9ff4cafee1af179c0c544365c
    - MD5=96421b56dbda73e9b965f027a3bda7ba
    - MD5=4ae55080ec8aed49343e40d08370195c
    - MD5=988dabdcf990b134b0ac1e00512c30c4
    - MD5=bbbc9a6cc488cfb0f6c6934b193891eb
    - MD5=76c643ab29d497317085e5db8c799960
    - MD5=e9a30edef1105b8a64218f892b2e56ed
    - MD5=7bd840ff7f15df79a9a71fec7db1243e
    - MD5=1cff7b947f8c3dea1d34dc791fc78cdc
    - MD5=2c54859a67306e20bfdc8887b537de72
    - MD5=a5f637d61719d37a5b4868c385e363c0
    - MD5=2509a71a02296aa65a3428ddfac22180
    - MD5=6cce5bb9c8c2a8293df2d3b1897941a2
    - MD5=7a16fca3d56c6038c692ec75b2bfee15
    - MD5=eaea9ccb40c82af8f3867cd0f4dd5e9d
    - MD5=d2588631d8aae2a3e54410eaf54f0679
    - MD5=b47dee29b5e6e1939567a926c7a3e6a4
    - MD5=fac8eb49e2fd541b81fcbdeb98a199cb
    - MD5=1a234f4643f5658bab07bfa611282267
    - MD5=0752f113d983030939b4ab98b0812cf0
    - SHA1=f0c463d29a5914b01e4607889094f1b7d95e7aaf
    - SHA1=a804ebec7e341b4d98d9e94f6e4860a55ea1638d
    - SHA1=ecb4d096a9c58643b02f328d2c7742a38e017cf0
    - SHA1=684786de4b3b3f53816eae9df5f943a22c89601f
    - SHA1=745335bcdf02fb42df7d890a24858e16094f48fd
    - SHA1=25d812a5ece19ea375178ef9d60415841087726e
    - SHA1=d417c0be261b0c6f44afdec3d5432100e420c3ed
    - SHA1=6afc6b04cf73dd461e4a4956365f25c1f1162387
    - SHA1=01a578a3a39697c4de8e3dab04dba55a4c35163e
    - SHA1=2b0bb408ff0e66bcdf6574f1ca52cbf4015b257b
    - SHA1=7e836dadc2e149a0b758c7e22c989cbfcce18684
    - SHA1=4a705af959af61bad48ef7579f839cb5ebd654d2
    - SHA1=bc2f3850c7b858340d7ed27b90e63b036881fd6c
    - SHA1=e22495d92ac3dcae5eeb1980549a9ead8155f98a
    - SHA1=c969f1f73922fd95db1992a5b552fbc488366a40
    - SHA1=4c18754dca481f107f0923fb8ef5e149d128525d
    - SHA1=2fc6845047abcf2a918fce89ab99e4955d08e72c
    - SHA1=4f7a8e26a97980544be634b26899afbefb0a833c
    - SHA1=21edff2937eb5cd6f6b0acb7ee5247681f624260
    - SHA1=89cd760e8cb19d29ee08c430fb17a5fd4455c741
    - SHA1=6c1bb3a72ebfb5359b9e22ca44d0a1ff825a68f2
    - SHA1=064de88dbbea67c149e779aac05228e5405985c7
    - SHA1=ea877092d57373cb466b44e7dbcad4ce9a547344
    - SHA1=55ab7e27412eca433d76513edc7e6e03bcdd7eda
    - SHA1=976777d39d73034df6b113dfce1aa6e1d00ffcfd
    - SHA1=1f7501e01d84a2297c85cb39880ec4e40ac3fe8a
    - SHA1=a6816949cd469b6e5c35858d19273936fab1bef6
    - SHA1=91f832f46e4c38ecc9335460d46f6f71352cffed
    - SHA1=43419df1f9a07430a18c5f3b3cc74de621be0f8e
    - SHA1=01779ee53f999464465ed690d823d160f73f10e7
    - SHA1=bfe55cacc7c56c9f7bd75bdb4b352c0b745d071b
    - SHA1=27d3ebea7655a72e6e8b95053753a25db944ec0f
    - SHA1=fcd615df88645d1f57ff5702bd6758b77efea6d0
    - SHA1=10115219e3595b93204c70eec6db3e68a93f3144
    - SHA1=33285b2e97a0aeb317166cce91f6733cf9c1ad53
    - SHA1=2c27abbbbcf10dfb75ad79557e30ace5ed314df8
    - SHA1=10e15ba8ff8ed926ddd3636cec66a0f08c9860a4
    - SHA1=291b4a88ffd2ac1d6bf812ecaedc2d934dc503cb
    - SHA1=05c0c49e8bcf11b883d41441ce87a2ee7a3aba1d
    - SHA1=8f5cd4a56e6e15935491aa40adb1ecad61eafe7c
    - SHA1=a7948a4e9a3a1a9ed0e4e41350e422464d8313cd
    - SHA1=19bd488fe54b011f387e8c5d202a70019a204adf
    - SHA1=eeff4ec4ebc12c6acd2c930dc2eaaf877cfec7ec
    - SHA1=c4d7fb9db3c3459f7e8c0e3d48c95c7c9c4cff60
    - SHA1=15d1a6a904c8409fb47a82aefa42f8c3c7d8c370
    - SHA1=d02403f85be6f243054395a873b41ef8a17ea279
    - SHA1=4243dbbf6e5719d723f24d0f862afd0fcb40bc35
    - SHA1=4789b910023a667bee70ff1f1a8f369cffb10fe8
    - SHA1=50e2bc41f0186fdce970b80e2a2cb296353af586
    - SHA1=b97a8d506be2e7eaa4385f70c009b22adbd071ba
    - SHA1=78b9481607ca6f3a80b4515c432ddfe6550b18a8
    - SHA1=e039c9dd21494dbd073b4823fc3a17fbb951ec6c
    - SHA1=806832983bb8cb1e26001e60ea3b7c3ade4d3471
    - SHA1=c1d5cf8c43e7679b782630e93f5e6420ca1749a7
    - SHA1=c9cbfdd0be7b35751a017ec59ff7237ffdc4df1f
    - SHA1=a3ed5cbfbc17b58243289f3cf575bf04be49591d
    - SHA1=7fb52290883a6b69a96d480f2867643396727e83
    - SHA1=5711c88e9e64e45b8fc4b90ab6f2dd6437dc5a8a
    - SHA1=da9cea92f996f938f699902482ac5313d5e8b28e
    - SHA1=dc7b022f8bd149efbcb2204a48dce75c72633526
    - SHA1=d979353d04bf65cc92ad3412605bc81edbb75ec2
    - SHA1=4b009e91bae8d27b160dc195f10c095f8a2441e1
    - SHA1=51b60eaa228458dee605430aae1bc26f3fc62325
    - SHA1=c6bd965300f07012d1b651a9b8776028c45b149a
    - SHA1=729a8675665c61824f22f06c7b954be4d14b52c4
    - SHA1=37364cb5f5cefd68e5eca56f95c0ab4aff43afcc
    - SHA1=e4436c8c42ba5ffabd58a3b2256f6e86ccc907ab
    - SHA1=7ba19a701c8af76988006d616a5f77484c13cb0a
    - SHA1=25bf4e30a94df9b8f8ab900d1a43fd056d285c9d
    - SHA1=d8498707f295082f6a95fd9d32c9782951f5a082
    - SHA1=5e6ddd2b39a3de0016385cbd7aa50e49451e376d
    - SHA1=943593e880b4d340f2548548e6e673ef6f61eed3
    - SHA1=2dfcb799b3c42ecb0472e27c19b24ac7532775ce
    - SHA1=b2f955b3e6107f831ebe67997f8586d4fe9f3e98
    - SHA1=6714380bc0b8ab09b9a0d2fa66d1b025b646b946
    - SHA1=4a7d66874a0472a47087fabaa033a85d47413379
    - SHA1=012db3a80faf1f7f727b538cbe5d94064e7159de
    - SHA1=5d6b9e80e12bfc595d4d26f6afb099b3cb471dd4
    - SHA1=c6d349823bbb1f5b44bae91357895dba653c5861
    - SHA1=643383938d5e0d4fd30d302af3e9293a4798e392
    - SHA1=ace6b9e34e3e2e73fe584f3bbdb4e4ec106e0a7d
    - SHA1=1d0df45ee3fa758f0470e055915004e6eae54c95
    - SHA1=3599ea2ac1fa78f423423a4cf90106ea0938dde8
    - SHA1=f42f28d164205d9f6dab9317c9fecad54c38d5d2
    - SHA1=d9c09dd725bc7bc3c19b4db37866015817a516ef
    - SHA1=d5fd9fe10405c4f90235e583526164cd0902ed86
    - SHA1=0c74d09da7baf7c05360346e4c3512d0cd433d59
    - SHA1=9c256edd10823ca76c0443a330e523027b70522d
    - SHA1=65d8a7c2e867b22d1c14592b020c548dd0665646
    - SHA1=7859e75580570e23a1ef7208b9a76f81738043d5
    - SHA1=b242b0332b9c9e8e17ec27ef10d75503d20d97b6
    - SHA1=6523b3fd87de39eb5db1332e4523ce99556077dc
    - SHA1=ac600a2bc06b312d92e649b7b55e3e91e9d63451
    - SHA1=fe10018af723986db50701c8532df5ed98b17c39
    - SHA1=b9807b8840327c6d7fbdde45fc27de921f1f1a82
    - SHA1=a3636986cdcd1d1cb8ab540f3d5c29dcc90bb8f0
    - SHA1=054a50293c7b4eea064c91ef59cf120d8100f237
    - SHA1=2e3de9bff43d7712707ef8a0b10f7e4ad8427fd8
    - SHA1=485c0b9710a196c7177b99ee95e5ddb35b26ddd1
    - SHA1=faa870b0cb15c9ac2b9bba5d0470bd501ccd4326
    - SHA1=4a235f0b84ff615e2879fa9e0ec0d745fcfdaa5c
    - SHA1=0291d0457acaf0fe8ed5c3137302390469ce8b35
    - SHA1=8183a341ba6c3ce1948bf9be49ab5320e0ee324d
    - SHA1=5a7dd0da0aee0bdedc14c1b7831b9ce9178a0346
    - SHA1=6debce728bcff73d9d1d334df0c6b1c3735e295c
    - SHA1=b25170e09c9fb7c0599bfba3cf617187f6a733ac
    - SHA1=19f3343bfad0ef3595f41d60272d21746c92ffca
    - SHA1=a48aa80942fc8e0699f518de4fd6512e341d4196
    - SHA1=f6f11ad2cd2b0cf95ed42324876bee1d83e01775
    - SHA1=9a35ae9a1f95ce4be64adc604c80079173e4a676
    - SHA1=ea360a9f23bb7cf67f08b88e6a185a699f0c5410
    - SHA1=6a3d3b9ab3d201cd6b0316a7f9c3fb4d34d0f403
    - SHA1=08596732304351b311970ff96b21f451f23b1e25
    - SHA1=29a190727140f40cea9514a6420f5a195e36386b
    - SHA1=b4d014b5edd6e19ce0e8395a64faedf49688ecb5
    - SHA1=31fac347aa26e92db4d8c9e1ba37a7c7a2234f08
    - SHA1=fcde5275ee1913509927ce5f0f85e6681064c9d2
    - SHA1=f052dc35b74a1a6246842fbb35eb481577537826
    - SHA1=c52cef5b9e1d4a78431b7af56a6fdb6aa1bcad65
    - SHA1=33cdab3bbc8b3adce4067a1b042778607dce2acd
    - SHA1=2d503a2457a787014a1fdd48a2ece2e6cbe98ea7
    - SHA1=f9519d033d75e1ab6b82b2e156eafe9607edbcfb
    - SHA1=89909fa481ff67d7449ee90d24c167b17b0612f1
    - SHA1=a7d827a41b2c4b7638495cd1d77926f1ba902978
    - SHA1=c23eeb6f18f626ce1fd840227f351fa7543bb167
    - SHA1=3805e4e08ad342d224973ecdade8b00c40ed31be
    - SHA1=8302802b709ad242a81b939b6c90b3230e1a1f1e
    - SHA1=ac13941f436139b909d105ad55637e1308f49d9a
    - SHA1=92f251358b3fe86fd5e7aa9b17330afa0d64a705
    - SHA1=623cd2abef6c92255f79cbbd3309cb59176771da
    - SHA1=af50109b112995f8c82be8ef3a88be404510cdde
    - SHA1=a00e444120449e35641d58e62ed64bb9c9f518d2
    - SHA1=9923c8f1e565a05b3c738d283cf5c0ed61a0b90f
    - SHA1=7eec3a1edf3b021883a4b5da450db63f7c0afeeb
    - SHA1=078ae07dec258db4376d5a2a05b9b508d68c0123
    - SHA1=ef80da613442047697bec35ea228cde477c09a3d
    - SHA1=6003184788cd3d2fc624ca801df291ccc4e225ee
    - SHA1=558aad879b6a47d94a968f39d0a4e3a3aaef1ef1
    - SHA1=877c6c36a155109888fe1f9797b93cb30b4957ef
    - SHA1=f3cce7e79ab5bd055f311bb3ac44a838779270b6
    - SHA1=80fa962bdfb76dfcb9e5d13efc38bb3d392f2e77
    - SHA1=3b6b35bca1b05fafbfc883a844df6d52af44ccdc
    - SHA1=351cbd352b3ec0d5f4f58c84af732a0bf41b4463
    - SHA1=609fa1efcf61e26d64a5ceb13b044175ab2b3a13
    - SHA1=dc0e97adb756c0f30b41840a59b85218cbdd198f
    - SHA1=71469dce9c2f38d0e0243a289f915131bf6dd2a8
    - SHA1=05ac1c64ca16ab0517fe85d4499d08199e63df26
    - SHA1=2261198385d62d2117f50f631652eded0ecc71db
    - SHA1=414cd15d6c991d19fb5be02e3b9fb0e6c5ce731c
    - SHA1=8626ab1da6bfbdf61bd327eb944b39fd9df33d1d
    - SHA1=5fb9421be8a8b08ec395d05e00fd45eb753b593a
    - SHA1=d702d88b12233be9413446c445f22fda4a92a1d9
    - SHA1=e74b6dda8bc53bc687fc21218bd34062a78d8467
    - SHA1=a197a02025946aca96d6e74746f84774df31249e
    - SHA1=1f25f54e9b289f76604e81e98483309612c5a471
    - SHA1=e3c1dd569aa4758552566b0213ee4d1fe6382c4b
    - SHA1=879fcc6795cebe67718388228e715c470de87dca
    - SHA1=3ae56ab63230d6d9552360845b4a37b5801cc5ea
    - SHA1=74e4e3006b644392f5fcea4a9bae1d9d84714b57
    - SHA1=ce549714a11bd43b52be709581c6e144957136ec
    - SHA1=3abb9d0a9d600200ae19c706e570465ef0a15643
    - SHA1=fbf8b0613a2f7039aeb9fa09bd3b40c8ff49ded2
    - SHA1=cc51be79ae56bc97211f6b73cc905c3492da8f9d
    - SHA1=b03b1996a40bfea72e4584b82f6b845c503a9748
    - SHA1=0307d76750dd98d707c699aee3b626643afb6936
    - SHA1=8db869c0674221a2d3280143cbb0807fac08e0cc
    - SHA1=2f991435a6f58e25c103a657d24ed892b99690b8
    - SHA1=c948ae14761095e4d76b55d9de86412258be7afd
    - SHA1=3ef30c95e40a854cc4ded94fc503d0c3dc3e620e
    - SHA1=152b6bb9ffd2ffec00cc46f5c6e29362d0e66e67
    - SHA1=a7bd05de737f8ea57857f1e0845a25677df01872
    - SHA1=aca8e53483b40a06dfdee81bb364b1622f9156fe
    - SHA1=f36a47edfacd85e0c6d4d22133dd386aee4eec15
    - SHA1=bf87e32a651bdfd9b9244a8cf24fca0e459eb614
    - SHA1=bc47e15537fa7c32dfefd23168d7e1741f8477ed
    - SHA1=3ee2fd08137e9262d2e911158090e4a7c7427ea0
    - SHA1=4e826430a1389032f3fe06e2cc292f643fb0c417
    - SHA1=745bad097052134548fe159f158c04be5616afc2
    - SHA1=28b1c0b91eb6afd2d26b239c9f93beb053867a1a
    - SHA1=0466e90bf0e83b776ca8716e01d35a8a2e5f96d3
    - SHA1=e6765d8866cad6193df1507c18f31fa7f723ca3e
    - SHA1=1fd7f881ea4a1dbb5c9aeb9e7ad659a85421745b
    - SHA1=57511ef5ff8162a9d793071b5bf7ebe8371759de
    - SHA1=d098600152e5ee6a8238d414d2a77a34da8afaaa
    - SHA1=16d7ecf09fc98798a6170e4cef2745e0bee3f5c7
    - SHA1=8b6aa5b2bff44766ef7afbe095966a71bc4183fa
    - SHA1=c834c4931b074665d56ccab437dfcc326649d612
    - SHA1=8d59fd14a445c8f3f0f7991fa6cd717d466b3754
    - SHA1=d94f2fb3198e14bfe69b44fb9f00f2551f7248b2
    - SHA1=64e4ac8b9ea2f050933b7ec76a55dd04e97773b4
    - SHA1=93aa3bb934b74160446df3a47fa085fd7f3a6be9
    - SHA1=14bf0eaa90e012169745b3e30c281a327751e316
    - SHA1=738b7918d85e5cb4395df9e3f6fc94ddad90e939
    - SHA1=8c377ab4eebc5f4d8dd7bb3f90c0187dfdd3349f
    - SHA1=fff4f28287677caabc60c8ab36786c370226588d
    - SHA1=34c85afe6d84cd3deec02c0a72e5abfa7a2886c3
    - SHA1=3f223581409492172a1e875f130f3485b90fbe5f
    - SHA1=282bb241bda5c4c1b8eb9bf56d018896649ca0e1
    - SHA1=f1c8c3926d0370459a1b7f0cf3d17b22ff9d0c7f
    - SHA1=e83458c4a6383223759cd8024e60c17be4e7c85f
    - SHA1=d569d4bab86e70efbcdfdac9d822139d6f477b7c
    - SHA1=2a6e6bd51c7062ad24c02a4d2c1b5e948908d131
    - SHA1=a65fabaf64aa1934314aae23f25cdf215cbaa4b6
    - SHA1=c257aa4094539719a3c7b7950598ef872dbf9518
    - SHA1=1292c7dd60214d96a71e7705e519006b9de7968f
    - SHA1=b4d1554ec19504215d27de0758e13c35ddd6db3e
    - SHA1=994dc79255aeb662a672a1814280de73d405617a
    - SHA1=5dd2c31c4357a8b76db095364952b3d0e3935e1d
    - SHA1=21e6c104fe9731c874fab5c9560c929b2857b918
    - SHA1=e92817a8744ebc4e4fa5383cdce2b2977f01ecd4
    - SHA1=35f1ba60ba0da8512a0b1b15ee8e30fe240d77cd
    - SHA1=bb962c9a8dda93e94fef504c4159de881e4706fe
    - SHA1=82ba5513c33e056c3f54152c8555abf555f3e745
    - SHA1=f50c6b84dfb8f2d53ba3bce000a55f0a486c0e79
    - SHA1=cb3de54667548a5c9abf5d8fa47db4097fcee9f1
    - SHA1=0c26ab1299adcd9a385b541ef1653728270aa23e
    - SHA1=f02af84393e9627ba808d4159841854a6601cf80
    - SHA1=cb22723faa5ae2809476e5c5e9b9a597b26cab9b
    - SHA1=f9feb60b23ca69072ce42264cd821fe588a186a6
    - SHA1=160c96b5e5db8c96b821895582b501e3c2d5d6e7
    - SHA1=0b8b83f245d94107cb802a285e6529161d9a834d
    - SHA1=d7e8aef8c8feb87ce722c0b9abf34a7e6bab6eb4
    - SHA1=d7f7594ff084201c0d9fa2f4ef1626635b67bce5
    - SHA1=7d7c03e22049a725ace2a9812c72b53a66c2548b
    - SHA1=589a7d4df869395601ba7538a65afae8c4616385
    - SHA1=1f3799fed3cf43254fe30dcdfdb8dc02d82e662b
    - SHA1=72966ca845759d239d09da0de7eebe3abe86fee3
    - SHA1=0f780b7ada5dd8464d9f2cc537d973f5ac804e9c
    - SHA1=26c4a7b392d7e7bd7f0a2a758534e45c0d9a56ab
    - SHA1=7c6cad6a268230f6e08417d278dda4d66bb00d13
    - SHA1=d04e5db5b6c848a29732bfd52029001f23c3da75
    - SHA1=a87d6eac2d70a3fbc04e59412326b28001c179de
    - SHA1=cce9b82f01ec68f450f5fe4312f40d929c6a506e
    - SHA1=8cc8974a05e81678e3d28acfe434e7804abd019c
    - SHA1=1e7c241b9a9ea79061b50fb19b3d141dee175c27
    - SHA1=00b4e8b7644d1bf93f5ddb5740b444b445e81b02
    - SHA1=4d41248078181c7f61e6e4906aa96bbdea320dc2
    - SHA1=f3db629cfe37a73144d5258e64d9dd8b38084cf4
    - SHA1=d2e6fc9259420f0c9b6b1769be3b1f63eb36dc57
    - SHA1=99201c9555e5faf6e8d82da793b148311f8aa4b8
    - SHA1=a2e0b3162cfa336cd4ab40a2acc95abe7dc53843
    - SHA1=12d38abbc5391369a4c14f3431715b5b76ac5a2a
    - SHA1=b4dcdbd97f38b24d729b986f84a9cdb3fc34d59f
    - SHA1=490109fa6739f114651f4199196c5121d1c6bdf2
    - SHA1=e5021a98e55d514e2376aa573d143631e5ee1c13
    - SHA1=af6e1f2cfb230907476e8b2d676129b6d6657124
    - SHA1=ddbe809b731a0962e404a045ab9e65a0b64917ad
    - SHA1=b480c54391a2a2f917a44f91a5e9e4590648b332
    - SHA1=a21c84c6bf2e21d69fa06daaf19b4cc34b589347
    - SHA1=dc55217b6043d819eadebd423ff07704ee103231
    - SHA1=6053d258096bccb07cb0057d700fe05233ab1fbb
    - SHA1=b0032b8d8e6f4bd19a31619ce38d8e010f29a816
    - SHA1=eb93d2f564fea9b3dc350f386b45de2cd9a3e001
    - SHA1=8692274681e8d10c26ddf2b993f31974b04f5bf0
    - SHA1=f5696fb352a3fbd14fb1a89ad21a71776027f9ab
    - SHA1=5db61d00a001fd493591dc919f69b14713889fc5
    - SHA1=2b4d0dead4c1a7cc95543748b3565cfa802e5256
    - SHA1=205c69f078a563f54f4c0da2d02a25e284370251
    - SHA1=7c1b25518dee1e30b5a6eaa1ea8e4a3780c24d0c
    - SHA1=35829e096a15e559fcbabf3441d99e580ca3b26e
    - SHA1=17fa047c1f979b180644906fe9265f21af5b0509
    - SHA1=ec4cc6de4c779bb1ca1dd32ee3a03f7e8d633a9b
    - SHA1=461882bd59887617cadc1c7b2b22d0a45458c070
    - SHA1=7838fb56fdab816bc1900a4720eea2fc9972ef7a
    - SHA1=1f3a9265963b660392c4053329eb9436deeed339
    - SHA1=e09b5e80805b8fe853ea27d8773e31bff262e3f7
    - SHA1=5f8356ffa8201f338dd2ea979eb47881a6db9f03
    - SHA1=37e6450c7cd6999d080da94b867ba23faa8c32fe
    - SHA1=7ab4565ba24268f0adadb03a5506d4eb1dc7c181
    - SHA1=00a442a4305c62cefa8105c0b4c4a9a5f4d1e93b
    - SHA1=9c24dd75e4074041dbe03bf21f050c77d748b8e9
    - SHA1=3270720a066492b046d7180ca6e60602c764cac7
    - SHA1=0b6ec2aedc518849a1c61a70b1f9fb068ede2bc3
    - SHA1=814200191551faec65b21f5f6819b46c8fc227a3
    - SHA1=696d68bdbe1d684029aaad2861c49af56694473a
    - SHA1=b89a8eef5aeae806af5ba212a8068845cafdab6f
    - SHA1=15df139494d2c40a645fb010908551185c27f3c5
    - SHA1=947db58d6f36a8df9fa2a1057f3a7f653ccbc42e
    - SHA1=fe1d909ab38de1389a2a48352fd1c8415fd2eab0
    - SHA1=7667b72471689151e176baeba4e1cd9cd006a09a
    - SHA1=d25340ae8e92a6d29f599fef426a2bc1b5217299
    - SHA1=6abbc3003c7aa69ce79cbbcd2e3210b07f21d202
    - SHA1=d34a7c497c603f3f7fcad546dc4097c2da17c430
    - SHA1=b8de3a1aeeda9deea43e3f768071125851c85bd0
    - SHA1=9c6749fc6c1127f8788bff70e0ce9062959637c9
    - SHA1=4268f30b79ce125a81d0d588bef0d4e2ad409bbb
    - SHA1=213ba055863d4226da26a759e8a254062ea77814
    - SHA1=a4b2c56c12799855162ca3b004b4b2078c6ecf77
    - SHA1=27eab595ec403580236e04101172247c4f5d5426
    - SHA1=d62fa51e520022483bdc5847141658de689c0c29
    - SHA1=ccdd3a1ebe9a1c8f8a72af20a05a10f11da1d308
    - SHA1=8fb149fc476cf5bf18dc575334edad7caf210996
    - SHA1=e35a2b009d54e1a0b231d8a276251f64231b66a3
    - SHA1=d0d39e1061f30946141b6ecfa0957f8cc3ddeb63
    - SHA1=166759fd511613414d3213942fe2575b926a6226
    - SHA1=73bac306292b4e9107147db94d0d836fdb071e33
    - SHA1=460008b1ffd31792a6deadfa6280fb2a30c8a5d2
    - SHA1=2c5ff272bd345962ed41ab8869aef41da0dfe697
    - SHA1=9d07df024ec457168bf0be7e0009619f6ac4f13c
    - SHA1=c4ed28fdfba7b8a8dfe39e591006f25d39990f07
    - SHA1=30a224b22592d952fbe2e6ad97eda4a8f2c734e0
    - SHA1=5520ac25d81550a255dc16a0bb89d4b275f6f809
    - SHA1=400f833dcc2ef0a122dd0e0b1ec4ec929340d90e
    - SHA1=6b54f8f137778c1391285fee6150dfa58a8120b1
    - SHA1=cc0e0440adc058615e31e8a52372abadf658e6b1
    - SHA1=cb3f30809b05cf02bc29d4a7796fb0650271e542
    - SHA1=a64354aac2d68b4fa74b5829a9d42d90d83b040c
    - SHA1=a6fe4f30ca7cb94d74bc6d42cdd09a136056952e
    - SHA1=e6305dddd06490d7f87e3b06d09e9d4c1c643af0
    - SHA1=90a76945fd2fa45fab2b7bcfdaf6563595f94891
    - SHA1=53f776d9a183c42b93960b270dddeafba74eb3fb
    - SHA1=6100eb82a25d64a7a7702e94c2b21333bc15bd08
    - SHA1=53acd4d9e7ba0b1056cf52af0d191f226eddf312
    - SHA1=910cb12aa49e9f35ecc4907e8304adf0dcca8cf1
    - SHA1=4b882748faf2c6c360884c6812dd5bcbce75ebff
    - SHA1=c95db1e82619fb16f8eec9a8209b7b0e853a4ebe
    - SHA1=4b8c0445075f09aeef542ab1c86e5de6b06e91a3
    - SHA1=bbc1e5fd826961d93b76abd161314cb3592c4436
    - SHA1=bbc0b9fd67c8f4cefa3d76fcb29ff3cef996b825
    - SHA1=1acc7a486b52c5ee6619dbdc3b4210b5f48b936f
    - SHA1=468e2e5505a3d924b14fedee4ddf240d09393776
    - SHA1=c8d87f3cd34c572870e63a696cf771580e6ea81b
    - SHA1=f18e669127c041431cde8f2d03b15cfc20696056
    - SHA256=15c53eb3a0ea44bbd2901a45a6ebeae29bb123f9c1115c38dfb2cdbec0642229
    - SHA256=ff6729518a380bf57f1bc6f1ec0aa7f3012e1618b8d9b0f31a61d299ee2b4339
    - SHA256=f088b2ba27dacd5c28f8ee428f1350dca4bc7c6606309c287c801b2e1da1a53d
    - SHA256=9a1d66036b0868bbb1b2823209fedea61a301d5dd245f8e7d390bd31e52d663e
    - SHA256=e6056443537d4d2314dabca1b9168f1eaaf17a14eb41f6f5741b6b82b3119790
    - SHA256=e1980c6592e6d2d92c1a65acad8f1071b6a404097bb6fcce494f3c8ac31385cf
    - SHA256=f51bdb0ad924178131c21e39a8ccd191e46b5512b0f2e1cc8486f63e84e5d960
    - SHA256=b9b3878ddc5dfb237d38f8d25067267870afd67d12a330397a8853209c4d889c
    - SHA256=96bf3ee7c6673b69c6aa173bb44e21fa636b1c2c73f4356a7599c121284a51cc
    - SHA256=5a826b4fa10891cf63aae832fc645ce680a483b915c608ca26cedbb173b1b80a
    - SHA256=6948480954137987a0be626c24cf594390960242cd75f094cd6aaa5c2e7a54fa
    - SHA256=49ed27460730b62403c1d2e4930573121ab0c86c442854bc0a62415ca445a810
    - SHA256=be54f7279e69fb7651f98e91d24069dbc7c4c67e65850e486622ccbdc44d9a57
    - SHA256=3d23bdbaf9905259d858df5bf991eb23d2dc9f4ecda7f9f77839691acef1b8c4
    - SHA256=d205286bffdf09bc033c09e95c519c1c267b40c2ee8bab703c6a2d86741ccd3e
    - SHA256=b48a309ee0960da3caaaaf1e794e8c409993aeb3a2b64809f36b97aac8a1e62a
    - SHA256=84bf1d0bcdf175cfe8aea2973e0373015793d43907410ae97e2071b2c4b8e2d4
    - SHA256=32cccc4f249499061c0afa18f534c825d01034a1f6815f5506bf4c4ff55d1351
    - SHA256=c9b49b52b493b53cd49c12c3fa9553e57c5394555b64e32d1208f5b96a5b8c6e
    - SHA256=79e2d37632c417138970b4feba91b7e10c2ea251c5efe3d1fc6fa0190f176b57
    - SHA256=3390919bb28d5c36cc348f9ef23be5fa49bfd81263eb7740826e4437cbe904cd
    - SHA256=58c071cfe72e9ee867bba85cbd0abe72eb223d27978d6f0650d0103553839b59
    - SHA256=607dc4c75ac7aef82ae0616a453866b3b358c6cf5c8f9d29e4d37f844306b97c
    - SHA256=358ac54be252673841a1d65bfc2fb6d549c1a4c877fa7f5e1bfa188f30375d69
    - SHA256=d0bd1ae72aeb5f3eabf1531a635f990e5eaae7fdd560342f915f723766c80889
    - SHA256=f85cca4badff17d1aa90752153ccec77a68ad282b69e3985fdc4743eaea85004
    - SHA256=6908ebf52eb19c6719a0b508d1e2128f198d10441551cbfb9f4031d382f5229f
    - SHA256=a899b659b08fbae30b182443be8ffb6a6471c1d0497b52293061754886a937a3
    - SHA256=771a8d05f1af6214e0ef0886662be500ee910ab99f0154227067fddcfe08a3dd
    - SHA256=de6bf572d39e2611773e7a01f0388f84fb25da6cba2f1f8b9b36ffba467de6fa
    - SHA256=950a4c0c772021cee26011a92194f0e58d61588f77f2873aa0599dff52a160c9
    - SHA256=36505921af5a09175395ebaea29c72b2a69a3a9204384a767a5be8a721f31b10
    - SHA256=6de84caa2ca18673e01b91af58220c60aecd5cccf269725ec3c7f226b2167492
    - SHA256=ef86c4e5ee1dbc4f81cd864e8cd2f4a2a85ee4475b9a9ab698a4ae1cc71fbeb0
    - SHA256=478917514be37b32d5ccf76e4009f6f952f39f5553953544f1b0688befd95e82
    - SHA256=7cfa5e10dff8a99a5d544b011f676bc383991274c693e21e3af40cf6982adb8c
    - SHA256=f596e64f4c5d7c37a00493728d8756b243cfdc11e3372d6d6dfeffc13c9ab960
    - SHA256=0aafa9f47acf69d46c9542985994ff5321f00842a28df2396d4a3076776a83cb
    - SHA256=131d5490ceb9a5b2324d8e927fea5becfc633015661de2f4c2f2375a3a3b64c6
    - SHA256=3124b0411b8077605db2a9b7909d8240e0d554496600e2706e531c93c931e1b5
    - SHA256=1b7fb154a7b7903a3c81f12f4b094f24a3c60a6a8cffca894c67c264ab7545fa
    - SHA256=f929bead59e9424ab90427b379dcdd63fbfe0c4fb5e1792e3a1685541cd5ec65
    - SHA256=c8f9e1ad7b8cce62fba349a00bc168c849d42cfb2ca5b2c6cc4b51d054e0c497
    - SHA256=9c2f3e9811f7d0c7463eaa1ee6f39c23f902f3797b80891590b43bbe0fdf0e51
    - SHA256=05b146a48a69dd62a02759487e769bd30d39f16374bc76c86453b4ae59e7ffa4
    - SHA256=c60fcff9c8e5243bbb22ec94618b9dcb02c59bb49b90c04d7d6ab3ebbd58dc3a
    - SHA256=4045ae77859b1dbf13972451972eaaf6f3c97bea423e9e78f1c2f14330cd47ca
    - SHA256=a7b000abbcc344444a9b00cfade7aa22ab92ce0cadec196c30eb1851ae4fa062
    - SHA256=1963d5a0e512b72353953aadbe694f73a9a576f0241a988378fa40bf574eda52
    - SHA256=3f2fda9a7a9c57b7138687bbce49a2e156d6095dddabb3454ea09737e02c3fa5
    - SHA256=f8965fdce668692c3785afa3559159f9a18287bc0d53abb21902895a8ecf221b
    - SHA256=19a212e6fc324f4cb9ee5eba60f5c1fc0191799a4432265cbeaa3307c76a7fc0
    - SHA256=1aaf4c1e3cb6774857e2eef27c17e68dc1ae577112e4769665f516c2e8c4e27b
    - SHA256=0af5ccb3d33a9ba92071c9637be6254030d61998733a5eb3583e865e17844e05
    - SHA256=5bc3994612624da168750455b363f2964e1861dba4f1c305df01b970ac02a7ae
    - SHA256=da6ca1fb539f825ca0f012ed6976baf57ef9c70143b7a1e88b4650bf7a925e24
    - SHA256=0fd2df82341bf5ebb8a53682e60d08978100c01acb0bed7b6ce2876ada80f670
    - SHA256=8111085022bda87e5f6aa4c195e743cc6dd6a3a6d41add475d267dc6b105a69f
    - SHA256=be03e9541f56ac6ed1e81407dcd7cc85c0ffc538c3c2c2c8a9c747edbcf13100
    - SHA256=47f08f7d30d824a8f4bb8a98916401a37c0fd8502db308aba91fe3112b892dcc
    - SHA256=a7c8f4faf3cbb088cac7753d81f8ec4c38ccb97cd9da817741f49272e8d01200
    - SHA256=7f375639a0df7fe51e5518cf87c3f513c55bc117db47d28da8c615642eb18bfa
    - SHA256=a56c2a2425eb3a4260cc7fc5c8d7bed7a3b4cd2af256185f24471c668853aee8
    - SHA256=a3e507e713f11901017fc328186ae98e23de7cea5594687480229f77d45848d8
    - SHA256=ded2927f9a4e64eefd09d0caba78e94f309e3a6292841ae81d5528cab109f95d
    - SHA256=9529efb1837b1005e5e8f477773752078e0a46500c748bc30c9b5084d04082e6
    - SHA256=2bbe65cbec3bb069e92233924f7ee1f95ffa16173fceb932c34f68d862781250
    - SHA256=32e1a8513eee746d17eb5402fb9d8ff9507fb6e1238e7ff06f7a5c50ff3df993
    - SHA256=39cfde7d401efce4f550e0a9461f5fc4d71fa07235e1336e4f0b4882bd76550e
    - SHA256=984a77e5424c6d099051441005f2938ae92b31b5ad8f6521c6b001932862add7
    - SHA256=db2a9247177e8cdd50fe9433d066b86ffd2a84301aa6b2eb60f361cfff077004
    - SHA256=30706f110725199e338e9cc1c940d9a644d19a14f0eb8847712cba4cacda67ab
    - SHA256=8c95d28270a4a314299cf50f05dcbe63033b2a555195d2ad2f678e09e00393e6
    - SHA256=9f4ce6ab5e8d44f355426d9a6ab79833709f39b300733b5b251a0766e895e0e5
    - SHA256=d92eab70bcece4432258c9c9a914483a2267f6ab5ce2630048d3a99e8cb1b482
    - SHA256=e4a7da2cf59a4a21fc42b611df1d59cae75051925a7ddf42bf216cc1a026eadb
    - SHA256=525d9b51a80ca0cd4c5889a96f857e73f3a80da1ffbae59851e0f51bdfb0b6cd
    - SHA256=01e024cb14b34b6d525c642a710bfa14497ea20fd287c39ba404b10a8b143ece
    - SHA256=4cff6e53430b81ecc4fae453e59a0353bcfe73dd5780abfc35f299c16a97998e
    - SHA256=3943a796cc7c5352aa57ccf544295bfd6fb69aae147bc8235a00202dc6ed6838
    - SHA256=f8236fc01d4efaa48f032e301be2ebba4036b2cd945982a29046eca03944d2ae
    - SHA256=575e58b62afab094c20c296604dc3b7dd2e1a50f5978d8ee24b7dca028e97316
    - SHA256=3d9e83b189fcf5c3541c62d1f54a0da0a4e5b62c3243d2989afc46644056c8e3
    - SHA256=0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5
    - SHA256=082c39fe2e3217004206535e271ebd45c11eb072efde4cc9885b25ba5c39f91d
    - SHA256=c0d88db11d0f529754d290ed5f4c34b4dba8c4f2e5c4148866daabeab0d25f9c
    - SHA256=7e0124fcc7c95fdc34408cf154cb41e654dade8b898c71ad587b2090b1da30d7
    - SHA256=61a1bdddd3c512e681818debb5bee94db701768fc25e674fcad46592a3259bd0
    - SHA256=b03f26009de2e8eabfcf6152f49b02a55c5e5d0f73e01d48f5a745f93ce93a29
    - SHA256=45abdbcd4c0916b7d9faaf1cd08543a3a5178871074628e0126a6eda890d26e0
    - SHA256=2003b478b9fd1b3d76ec5bf4172c2e8915babbbee7ad1783794acbf8d4c2519d
    - SHA256=06bda5a1594f7121acd2efe38ccb617fbc078bb9a70b665a5f5efd70e3013f50
    - SHA256=1e8b0c1966e566a523d652e00f7727d8b0663f1dfdce3b9a09b9adfaef48d8ee
    - SHA256=e7af7bcb86bd6bab1835f610671c3921441965a839673ac34444cf0ce7b2164e
    - SHA256=93d873cdf23d5edc622b74f9544cac7fe247d7a68e1e2a7bf2879fad97a3ae63
    - SHA256=a9706e320179993dade519a83061477ace195daa1b788662825484813001f526
    - SHA256=61d6e40601fa368800980801a662a5b3b36e3c23296e8ae1c85726a56ef18cc8
    - SHA256=47eaebc920ccf99e09fc9924feb6b19b8a28589f52783327067c9b09754b5e84
    - SHA256=fd8669794c67b396c12fc5f08e9c004fdf851a82faf302846878173e4fbecb03
    - SHA256=000547560fea0dd4b477eb28bf781ea67bf83c748945ce8923f90fdd14eb7a4b
    - SHA256=a13054f349b7baa8c8a3fcbd31789807a493cc52224bbff5e412eb2bd52a6433
    - SHA256=07b6d69bafcfd767f1b63a490a8843c3bb1f8e1bbea56176109b5743c8f7d357
    - SHA256=9f1229cd8dd9092c27a01f5d56e3c0d59c2bb9f0139abf042e56f343637fda33
    - SHA256=99f4994a0e5bd1bf6e3f637d3225c69ff4cd620557e23637533e7f18d7d6cba1
    - SHA256=22be050955347661685a4343c51f11c7811674e030386d2264cd12ecbf544b7c
    - SHA256=ece0a900ea089e730741499614c0917432246ceb5e11599ee3a1bb679e24fd2c
    - SHA256=8ef0ad86500094e8fa3d9e7d53163aa6feef67c09575c169873c494ed66f057f
    - SHA256=36b9e31240ab0341873c7092b63e2e0f2cab2962ebf9b25271c3a1216b7669eb
    - SHA256=6b830ea0db6546a044c9900d3f335e7820c2a80e147b0751641899d1a5aa8f74
    - SHA256=9c10e2ec4f9ef591415f9a784b93dc9c9cdafa7c69602c0dc860c5b62222e449
    - SHA256=5b9623da9ba8e5c80c49473f40ffe7ad315dcadffc3230afdc9d9226d60a715a
    - SHA256=fafa1bb36f0ac34b762a10e9f327dcab2152a6d0b16a19697362d49a31e7f566
    - SHA256=e61a54f6d3869b43c4eceac3016df73df67cce03878c5a6167166601c5d3f028
    - SHA256=f88ebb633406a086d9cca6bc8b66a4ea940c5476529f9033a9e0463512a23a57
    - SHA256=2aa1b08f47fbb1e2bd2e4a492f5d616968e703e1359a921f62b38b8e4662f0c4
    - SHA256=06508aacb4ed0a1398a2b0da5fa2dbf7da435b56da76fd83c759a50a51c75caf
    - SHA256=cc383ad11e9d06047a1558ed343f389492da3ac2b84b71462aee502a2fa616c8
    - SHA256=845f1e228de249fc1ddf8dc28c39d03e8ad328a6277b6502d3932e83b879a65a
    - SHA256=01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd
    - SHA256=64f9e664bc6d4b8f5f68616dd50ae819c3e60452efd5e589d6604b9356841b57
    - SHA256=2a652de6b680d5ad92376ad323021850dab2c653abf06edf26120f7714b8e08a
    - SHA256=85866e8c25d82c1ec91d7a8076c7d073cccf421cf57d9c83d80d63943a4edd94
    - SHA256=42851a01469ba97cdc38939b10cf9ea13237aa1f6c37b1ac84904c5a12a81fa0
    - SHA256=9b1b15a3aacb0e786a608726c3abfc94968915cedcbd239ddf903c4a54bfcf0c
    - SHA256=bb50818a07b0eb1bd317467139b7eb4bad6cd89053fecdabfeae111689825955
    - SHA256=9bb09752cf3a464455422909edef518ac18fe63cf5e1e8d9d6c2e68db62e0c87
    - SHA256=b0eb4d999e4e0e7c2e33ff081e847c87b49940eb24a9e0794c6aa9516832c427
    - SHA256=43ba8d96d5e8e54cab59d82d495eeca730eeb16e4743ed134cdd495c51a4fc89
    - SHA256=76660e91f1ff3cb89630df5af4fe09de6098d09baa66b1a130c89c3c5edd5b22
    - SHA256=1c8dfa14888bb58848b4792fb1d8a921976a9463be8334cff45cc96f1276049a
    - SHA256=60c6f4f34c7319cb3f9ca682e59d92711a05a2688badbae4891b1303cd384813
    - SHA256=bb1135b51acca8348d285dc5461d10e8f57260e7d0c8cc4a092734d53fc40cbc
    - SHA256=5c1585b1a1c956c7755429544f3596515dfdf928373620c51b0606a520c6245a
    - SHA256=f40435488389b4fb3b945ca21a8325a51e1b5f80f045ab019748d0ec66056a8b
    - SHA256=405472a8f9400a54bb29d03b436ccd58cfd6442fe686f6d2ed4f63f002854659
    - SHA256=3a95cc82173032b82a0ffc7d2e438df64c13bc16b4574214c9fe3be37250925e
    - SHA256=42579a759f3f95f20a2c51d5ac2047a2662a2675b3fb9f46c1ed7f23393a0f00
    - SHA256=65db1b259e305a52042e07e111f4fa4af16542c8bacd33655f753ef642228890
    - SHA256=159e7c5a12157af92e0d14a0d3ea116f91c09e21a9831486e6dc592c93c10980
    - SHA256=5c04c274a708c9a7d993e33be3ea9e6119dc29527a767410dbaf93996f87369a
    - SHA256=fcdfe570e6dc6e768ef75138033d9961f78045adca53beb6fdb520f6417e0df1
    - SHA256=cb57f3a7fe9e1f8e63332c563b0a319b26c944be839eabc03e9a3277756ba612
    - SHA256=4744df6ac02ff0a3f9ad0bf47b15854bbebb73c936dd02f7c79293a2828406f6
    - SHA256=80cbba9f404df3e642f22c476664d63d7c229d45d34f5cd0e19c65eb41becec3
    - SHA256=29e0062a017a93b2f2f5207a608a96df4d554c5de976bd0276c2590a03bd3e94
    - SHA256=db90e554ad249c2bd888282ecf7d8da4d1538dd364129a3327b54f8242dd5653
    - SHA256=8dafe5f3d0527b66f6857559e3c81872699003e0f2ffda9202a1b5e29db2002e
    - SHA256=101402d4f5d1ae413ded499c78a5fcbbc7e3bae9b000d64c1dd64e3c48c37558
    - SHA256=6ed35f310c96920a271c59a097b382da07856e40179c2a4239f8daa04eef38e7
    - SHA256=95d50c69cdbf10c9c9d61e64fe864ac91e6f6caa637d128eb20e1d3510e776d3
    - SHA256=37dde6bd8a7a36111c3ac57e0ac20bbb93ce3374d0852bcacc9a2c8c8c30079e
    - SHA256=5d530e111400785d183057113d70623e17af32931668ab7c7fc826f0fd4f91a3
    - SHA256=d7bc7306cb489fe4c285bbeddc6d1a09e814ef55cf30bd5b8daf87a52396f102
    - SHA256=7049f3c939efe76a5556c2a2c04386db51daf61d56b679f4868bb0983c996ebb
    - SHA256=b179e1ab6dc0b1aee783adbcad4ad6bb75a8a64cb798f30c0dd2ee8aaf43e6de
    - SHA256=3243aab18e273a9b9c4280a57aecef278e10bfff19abb260d7a7820e41739099
    - SHA256=0040153302b88bee27eb4f1eca6855039e1a057370f5e8c615724fa5215bada3
    - SHA256=f0605dda1def240dc7e14efa73927d6c6d89988c01ea8647b671667b2b167008
    - SHA256=b1334a71cc73b3d0c54f62d8011bec330dfc355a239bf94a121f6e4c86a30a2e
    - SHA256=74a846c61adc53692d3040aff4c1916f32987ad72b07fe226e9e7dbeff1036c4
    - SHA256=7f4555a940ce1156c9bcea9a2a0b801f9a5e44ec9400b61b14a7b1a6404ffdf6
    - SHA256=c1c4310e5d467d24e864177bdbfc57cb5d29aac697481bfa9c11ddbeebfd4cc8
    - SHA256=22418016e980e0a4a2d01ca210a17059916a4208352c1018b0079ccb19aaf86a
    - SHA256=76b86543ce05540048f954fed37bdda66360c4a3ddb8328213d5aef7a960c184
    - SHA256=dd4a1253d47de14ef83f1bc8b40816a86ccf90d1e624c5adf9203ae9d51d4097
    - SHA256=025e7be9fcefd6a83f4471bba0c11f1c11bd5047047d26626da24ee9a419cdc4
    - SHA256=50d5eaa168c077ce5b7f15b3f2c43bd2b86b07b1e926c1b332f8cb13bd2e0793
    - SHA256=e05eeb2b8c18ad2cb2d1038c043d770a0d51b96b748bc34be3e7fc6f3790ce53
    - SHA256=749b0e8c8c8b7dda8c2063c708047cfe95afa0a4d86886b31a12f3018396e67c
    - SHA256=d8459f7d707c635e2c04d6d6d47b63f73ba3f6629702c7a6e0df0462f6478ae2
    - SHA256=49f75746eebe14e5db11706b3e58accc62d4034d2f1c05c681ecef5d1ad933ba
    - SHA256=7133a461aeb03b4d69d43f3d26cd1a9e3ee01694e97a0645a3d8aa1a44c39129
    - SHA256=ae79e760c739d6214c1e314728a78a6cb6060cce206fde2440a69735d639a0a2
    - SHA256=4422851a0a102f654e95d3b79c357ae3af1b096d7d1576663c027cfbc04abaf9
    - SHA256=84df20b1d9d87e305c92e5ffae21b10b325609d59d835a954dbd8750ef5dabf4
    - SHA256=7a7e8df7173387aec593e4fe2b45520ea3156c5f810d2bb1b2784efd1c922376
    - SHA256=cd4a249c3ef65af285d0f8f30a8a96e83688486aab515836318a2559757a89bb
    - SHA256=86a8e0aa29a5b52c84921188cc1f0eca9a7904dcfe09544602933d8377720219
    - SHA256=47f0cdaa2359a63ad1389ef4a635f1f6eee1f63bdf6ef177f114bdcdadc2e005
    - SHA256=18e1707b319c279c7e0204074088cc39286007a1cf6cb6e269d5067d8d0628c6
    - SHA256=70211a3f90376bbc61f49c22a63075d1d4ddd53f0aefa976216c46e6ba39a9f4
    - SHA256=4b5229b3250c8c08b98cb710d6c056144271de099a57ae09f5d2097fc41bd4f1
    - SHA256=8d9a2363b757d3f127b9c6ed8f7b8b018e652369bc070aa3500b3a978feaa6ce
    - SHA256=36875562e747136313ec5db58174e5fab870997a054ca8d3987d181599c7db6a
    - SHA256=7877c1b0e7429453b750218ca491c2825dae684ad9616642eff7b41715c70aca
    - SHA256=591bd5e92dfa0117b3daa29750e73e2db25baa717c31217539d30ffb1f7f3a52
    - SHA256=04a85e359525d662338cae86c1e59b1d7aa9bd12b920e8067503723dc1e03162
    - SHA256=4880f40f2e557cff38100620b9aa1a3a753cb693af16cd3d95841583edcb57a8
    - SHA256=e81230217988f3e7ec6f89a06d231ec66039bdba340fd8ebb2bbb586506e3293
    - SHA256=49c827cf48efb122a9d6fd87b426482b7496ccd4a2dbca31ebbf6b2b80c98530
    - SHA256=d8b58f6a89a7618558e37afc360cd772b6731e3ba367f8d58734ecee2244a530
    - SHA256=7ec93f34eb323823eb199fbf8d06219086d517d0e8f4b9e348d7afd41ec9fd5d
    - SHA256=2e6b339597a89e875f175023ed952aaac64e9d20d457bbc07acf1586e7fe2df8
    - SHA256=cf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986
    - SHA256=a7c2e7910942dd5e43e2f4eb159bcd2b4e71366e34a68109548b9fb12ac0f7cc
    - SHA256=c5050a2017490fff7aa53c73755982b339ddb0fd7cef2cde32c81bc9834331c5
    - SHA256=59626cac380d8fe0b80a6d4c4406d62ba0683a2f0f68d50ad506ca1b1cf25347
    - SHA256=89b0017bc30cc026e32b758c66a1af88bd54c6a78e11ec2908ff854e00ac46be
    - SHA256=e005e8d183e853a27ad3bb56f25489f369c11b0d47e3d4095aad9291b3343bf1
    - SHA256=5f5e5f1c93d961985624768b7c676d488c7c7c1d4c043f6fc1ea1904fefb75be
    - SHA256=cdd2a4575a46bada4837a6153a79c14d60ee3129830717ef09e0e3efd9d00812
    - SHA256=ac3f613d457fc4d44fa27b2e0b1baa62c09415705efb5a40a4756da39b3ac165
    - SHA256=475e5016c9c0f5a127896f9179a1b1577a67b357f399ab5a1e68aab07134729a
    - SHA256=cc687fe3741bbde1dd142eac0ef59fd1d4457daee43cdde23bb162ef28d04e64
    - SHA256=0de4247e72d378713bcf22d5c5d3874d079203bb4364e25f67a90d5570bdcce8
    - SHA256=72b99147839bcfb062d29014ec09fe20a8f261748b5925b00171ef3cb849a4c1
    - SHA256=cc586254e9e89e88334adee44e332166119307e79c2f18f6c2ab90ce8ba7fc9b
    - SHA256=f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe
    - SHA256=5ee292b605cd3751a24e5949aae615d472a3c72688632c3040dc311055b75a92
    - SHA256=4429f32db1cc70567919d7d47b844a91cf1329a6cd116f582305f3b7b60cd60b
    - SHA256=f8886a9c759e0426e08d55e410b02c5b05af3c287b15970175e4874316ffaf13
    - SHA256=c9cf1d627078f63a36bbde364cd0d5f2be1714124d186c06db5bcdf549a109f8
    - SHA256=2da330a2088409efc351118445a824f11edbe51cf3d653b298053785097fe40e
    - SHA256=54841d9f89e195196e65aa881834804fe3678f1cf6b328cab8703edd15e3ec57
    - SHA256=e6a7b0bc01a627a7d0ffb07faddb3a4dd96b6f5208ac26107bdaeb3ab1ec8217
    - SHA256=cf4b5fa853ce809f1924df3a3ae3c4e191878c4ea5248d8785dc7e51807a512b
    - SHA256=6839fcae985774427c65fe38e773aa96ec451a412caa5354ad9e2b9b54ffe6c1
    - SHA256=708016fbe22c813a251098f8f992b177b476bd1bbc48c2ed4a122ff74910a965
    - SHA256=362c4f3dadc9c393682664a139d65d80e32caa2a97b6e0361dfd713a73267ecc
    - SHA256=08eb2d2aa25c5f0af4e72a7e0126735536f6c2c05e9c7437282171afe5e322c6
    - SHA256=2d83ccb1ad9839c9f5b3f10b1f856177df1594c66cbbc7661677d4b462ebf44d
    - SHA256=c725919e6357126d512c638f993cf572112f323da359645e4088f789eb4c7b8c
    - SHA256=4941c4298f4560fc1e59d0f16f84bab5c060793700b82be2fd7c63735f1657a8
    - SHA256=1aaa9aef39cb3c0a854ecb4ca7d3b213458f302025e0ec5bfbdef973cca9111c
    - SHA256=76fb4deaee57ef30e56c382c92abffe2cf616d08dbecb3368c8ee6b02e59f303
    - SHA256=3a5ec83fe670e5e23aef3afa0a7241053f5b6be5e6ca01766d6b5f9177183c25
    - SHA256=7196187fb1ef8d108b380d37b2af8efdeb3ca1f6eefd37b5dc114c609147216d
    - SHA256=f461414a2596555cece5cfee65a3c22648db0082ca211f6238af8230e41b3212
    - SHA256=55fee54c0d0d873724864dc0b2a10b38b7f40300ee9cae4d9baaf8a202c4049a
    - SHA256=b9dad0131c51e2645e761b74a71ebad2bf175645fa9f42a4ab0e6921b83306e3
    - SHA256=fd223833abffa9cd6cc1848d77599673643585925a7ee51259d67c44d361cce8
    - SHA256=d5586dc1e61796a9ae5e5d1ced397874753056c3df2eb963a8916287e1929a71
    - SHA256=543991ca8d1c65113dff039b85ae3f9a87f503daec30f46929fd454bc57e5a91
    - SHA256=6cb51ae871fbd5d07c5aad6ff8eea43d34063089528603ca9ceb8b4f52f68ddc
    - SHA256=6c7120e40fc850e4715058b233f5ad4527d1084a909114fd6a36b7b7573c4a44
    - SHA256=e75714f8e0ff45605f6fc7689a1a89c7dcd34aab66c6131c63fefaca584539cf
    - SHA256=4a3d4db86f580b1680d6454baee1c1a139e2dde7d55e972ba7c92ec3f555dce2
    - SHA256=dec8a933dba04463ed9bb7d53338ff87f2c23cfb79e0e988449fc631252c9dcc
    - SHA256=6b5cf41512255237064e9274ca8f8a3fef820c45aa6067c9c6a0e6f5751a0421
    - SHA256=e83908eba2501a00ef9e74e7d1c8b4ff1279f1cd6051707fd51824f87e4378fa
    - SHA256=0ebaef662b14410c198395b13347e1d175334ec67919709ad37d65eba013adff
    - SHA256=3e9b62d2ea2be50a2da670746c4dbe807db9601980af3a1014bcd72d0248d84c
    - SHA256=7d8937c18d6e11a0952e53970a0934cf0e65515637ac24d6ca52ccf4b93d385f
    - SHA256=9d58f640c7295952b71bdcb456cae37213baccdcd3032c1e3aeb54e79081f395
    - SHA256=aa9ab1195dc866270e984f1bed5e1358d6ef24c515dfdb6c2a92d1e1b94bf608
    - SHA256=8e035beb02a411f8a9e92d4cf184ad34f52bbd0a81a50c222cdd4706e4e45104
    - SHA256=ea0b9eecf4ad5ec8c14aec13de7d661e7615018b1a3c65464bf5eca9bbf6ded3
    - SHA256=31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427
    - SHA256=258359a7fa3d975620c9810dab3a6493972876a024135feaf3ac8482179b2e79
    - SHA256=146d77e80ca70ea5cb17bfc9a5cea92334f809cbdc87a51c2d10b8579a4b9c88
    - SHA256=9790a7b9d624b2b18768bb655dda4a05a9929633cef0b1521e79e40d7de0a05b
    - SHA256=cb9890d4e303a4c03095d7bc176c42dee1b47d8aa58e2f442ec1514c8f9e3cec
    - SHA256=cbb8239a765bf5b2c1b6a5c8832d2cab8fef5deacadfb65d8ed43ef56d291ab6
    - SHA256=436ccab6f62fa2d29827916e054ade7acae485b3de1d3e5c6c62d3debf1480e7
    - SHA256=b9a4e40a5d80fedd1037eaed958f9f9efed41eb01ada73d51b5dcd86e27e0cbf
    - SHA256=b4d47ea790920a4531e3df5a4b4b0721b7fea6b49a35679f0652f1e590422602
    - SHA256=9fc29480407e5179aa8ea41682409b4ea33f1a42026277613d6484e5419de374
    - SHA256=81c7bb39100d358f8286da5e9aa838606c98dfcc263e9a82ed91cd438cb130d1
    - SHA256=552f70374715e70c4ade591d65177be2539ec60f751223680dfaccb9e0be0ed9
    - SHA256=81939e5c12bd627ff268e9887d6fb57e95e6049f28921f3437898757e7f21469
    - SHA256=4ab41816abbf14d59e75b7fad49e2cb1c1feb27a3cb27402297a2a4793ff9da7
    - SHA256=af095de15a16255ca1b2c27dad365dff9ac32d2a75e8e288f5a1307680781685
    - SHA256=b7a20b5f15e1871b392782c46ebcc897929443d82073ee4dcb3874b6a5976b5d
    - SHA256=ea85bbe63d6f66f7efee7007e770af820d57f914c7f179c5fee3ef2845f19c41
    - SHA256=06a0ec9a316eb89cb041b1907918e3ad3b03842ec65f004f6fa74d57955573a4
    - SHA256=4e3eb5b9bce2fd9f6878ae36288211f0997f6149aa8c290ed91228ba4cdfae80
    - SHA256=314384b40626800b1cde6fbc51ebc7d13e91398be2688c2a58354aa08d00b073
    - SHA256=11bd2c9f9e2397c9a16e0990e4ed2cf0679498fe0fd418a3dfdac60b5c160ee5
    - SHA256=4a9093e8dbcb867e1b97a0a67ce99a8511900658f5201c34ffb8035881f2dbbe
    - SHA256=38fa0c663c8689048726666f1c5e019feaa9da8278f1df6ff62da33961891d2a
    - SHA256=56a3c9ac137d862a85b4004f043d46542a1b61c6acb438098a9640469e2d80e7
    - SHA256=455bc98ba32adab8b47d2d89bdbadca4910f91c182ab2fc3211ba07d3784537b
    - SHA256=e86cb77de7b6a8025f9a546f6c45d135f471e664963cf70b381bee2dfd0fdef4
    - SHA256=3ac5e01689a3d745e60925bc7faca8d4306ae693e803b5e19c94906dc30add46
    - SHA256=b1d96233235a62dbb21b8dbe2d1ae333199669f67664b107bff1ad49b41d9414
    - SHA256=dfaefd06b680f9ea837e7815fc1cc7d1f4cc375641ac850667ab20739f46ad22
    - SHA256=221dfbc74bbb255b0879360ccc71a74b756b2e0f16e9386b38a9ce9d4e2e34f9
    - SHA256=afdd66562dea51001c3a9de300f91fc3eb965d6848dfce92ccb9b75853e02508
    - SHA256=78827fa00ea48d96ac9af8d1c1e317d02ce11793e7f7f6e4c7aac7b5d7dd490f
    - SHA256=7f190f6e5ab0edafd63391506c2360230af4c2d56c45fc8996a168a1fc12d457
    - SHA256=d5562fb90b0b3deb633ab335bcbd82ce10953466a428b3f27cb5b226b453eaf3
    - SHA256=fd33fb2735cc5ef466a54807d3436622407287e325276fcd3ed1290c98bd0533
    - SHA256=f581decc2888ef27ee1ea85ea23bbb5fb2fe6a554266ff5a1476acd1d29d53af
    - SHA256=58a74dceb2022cd8a358b92acd1b48a5e01c524c3b0195d7033e4bd55eff4495
    - SHA256=dde6f28b3f7f2abbee59d4864435108791631e9cb4cdfb1f178e5aa9859956d8
    - SHA256=21ccdd306b5183c00ecfd0475b3152e7d94b921e858e59b68a03e925d1715f21
    - SHA256=91314768da140999e682d2a290d48b78bb25a35525ea12c1b1f9634d14602b2c
    - SHA256=98b734dda78c16ebcaa4afeb31007926542b63b2f163b2f733fa0d00dbb344d8
    - SHA256=d25904fbf907e19f366d54962ff543d9f53b8fdfd2416c8b9796b6a8dd430e26
    - SHA256=6f1ff29e2e710f6d064dc74e8e011331d807c32cc2a622cbe507fd4b4d43f8f4
    - SHA256=3326e2d32bbabd69feb6024809afc56c7e39241ebe70a53728c77e80995422a5
    - SHA256=8cb62c5d41148de416014f80bd1fd033fd4d2bd504cb05b90eeb6992a382d58f
    - SHA256=1d0397c263d51e9fc95bcc8baf98d1a853e1c0401cd0e27c7bf5da3fba1c93a8
    - SHA256=50db5480d0392a7dd6ab5df98389dc24d1ed1e9c98c9c35964b19dabcd6dc67f
    - SHA256=3ec5ad51e6879464dfbccb9f4ed76c6325056a42548d5994ba869da9c4c039a8
    - SHA256=71fe5af0f1564dc187eea8d59c0fbc897712afa07d18316d2080330ba17cf009
    - SHA256=b47be212352d407d0ef7458a7161c66b47c2aec8391dd101df11e65728337a6a
    - SHA256=3871e16758a1778907667f78589359734f7f62f9dc953ec558946dcdbe6951e3
    - SHA256=65329dad28e92f4bcc64de15c552b6ef424494028b18875b7dba840053bc0cdd
    - SHA256=a961f5939088238d76757669a9a81905e33f247c9c635b908daac146ae063499
    - SHA256=509628b6d16d2428031311d7bd2add8d5f5160e9ecc0cd909f1e82bbbb3234d6
    - SHA256=440883cd9d6a76db5e53517d0ec7fe13d5a50d2f6a7f91ecfc863bc3490e4f5c
    - SHA256=09bedbf7a41e0f8dabe4f41d331db58373ce15b2e9204540873a1884f38bdde1
    - SHA256=1ddfe4756f5db9fb319d6c6da9c41c588a729d9e7817190b027b38e9c076d219
    - SHA256=677c0b1add3990fad51f492553d3533115c50a242a919437ccb145943011d2bf
    - SHA256=823da894b2c73ffcd39e77366b6f1abf0ae9604d9b20140a54e6d55053aadeba
    - SHA256=05f052c64d192cf69a462a5ec16dda0d43ca5d0245900c9fcb9201685a2e7748
    - SHA256=42f0b036687cbd7717c9efed6991c00d4e3e7b032dc965a2556c02177dfdad0f
    - SHA256=f8430bdc6fd01f42217d66d87a3ef6f66cb2700ebb39c4f25c8b851858cc4b35
    - SHA256=927c2a580d51a598177fa54c65e9d2610f5f212f1b6cb2fbf2740b64368f010a
    - SHA256=e68d453d333854787f8470c8baef3e0d082f26df5aa19c0493898bcf3401e39a
    - SHA256=eea53103e7a5a55dc1df79797395a2a3e96123ebd71cdd2db4b1be80e7b3f02b
    - SHA256=88076e98d45ed3adf0c5355411fe8ca793eb7cec1a1c61f5e1ec337eae267463
    - SHA256=9254f012009d55f555418ff85f7d93b184ab7cb0e37aecdfdab62cfe94dea96b
- condition: selection
  selection:
    ImageLoaded|endswith:
    - \mtcbsv64.sys
    - \bs_def64.sys
    - \gameink.sys
    - \81.sys
    - \bs_rcio.sys
    - \sense5ext.sys
    - \asrdrv10.sys
    - \gvcidrv64.sys
    - \wantd_5.sys
    - \driver7-x86-withoutdbg.sys
    - \atillk64.sys
    - \lurker.sys
    - \segwindrvx64.sys
    - \nt3.sys
    - \enetechio64.sys
    - \asio64.sys
    - \inpoutx64.sys
    - \windows8-10-32.sys
    - \directio.sys
    - \rtkio.sys
    - \corsairllaccess64.sys
    - \nt6.sys
    - \winflash64.sys
    - \paniox64.sys
    - \blackbonedrv10.sys
    - \msio32.sys
    - \fiddrv.sys
    - \asio.sys
    - \dbutildrv2.sys
    - \my.sys
    - \wantd_3.sys
    - \winio32a.sys
    - \wyproxy64.sys
    - \ni.sys
    - \bs_i2cio.sys
    - \kprocesshacker.sys
    - \protects.sys
    - \phymem64.sys
    - \proxy32.sys
    - \b.sys
    - \netproxydriver.sys
    - \bs_hwmio64_w10.sys
    - \physmem.sys
    - \asrsmartconnectdrv.sys
    - \b3.sys
    - \monitor_win10_x64.sys
    - \poortry2.sys
    - \amdryzenmasterdriver.sys
    - \t.sys
    - \sandra.sys
    - \bsmix64.sys
    - \bs_i2c64.sys
    - \wantd_6.sys
    - \bs_rcio64.sys
    - \zam64.sys
    - \viragt64.sys
    - \winio32b.sys
    - \poortry1.sys
    - \msio64.sys
    - \winio32.sys
    - \ncpl.sys
    - \nchgbios2x64.sys
    - \bwrsh.sys
    - \panio.sys
    - \lha.sys
    - \ntbios.sys
    - \blacklotus_driver.sys
    - \fidpcidrv.sys
    - \b4.sys
    - \mhyprot3.sys
    - \ucorew64.sys
    - \hwos2ec7x64.sys
    - \bsmemx64.sys
    - \windows7-32.sys
    - \asrdrv106.sys
    - \elbycdio.sys
    - \iomem64.sys
    - \asupio.sys
    - \otipcibus.sys
    - \windows-xp-64.sys
    - \aswarpot.sys
    - \amdpowerprofiler.sys
    - \d.sys
    - \2.sys
    - \tgsafe.sys
    - \ntiolib_x64.sys
    - \asrrapidstartdrv.sys
    - \1.sys
    - \hwos2ec10x64.sys
    - \daxin_blank5.sys
    - \viraglt64.sys
    - \iomap64.sys
    - \lv561av.sys
    - \nscm.sys
    - \c.sys
    - \asribdrv.sys
    - \b1.sys
    - \eneio64.sys
    - \capcom.sys
    - \80.sys
    - \asio32.sys
    - \iobitunlocker.sys
    - \zamguard64.sys
    - \nstrwsk.sys
    - \wiseunlo.sys
    - \t7.sys
    - \bs_hwmio64.sys
    - \hostnt.sys
    - \glckio2.sys
    - \hpportiox64.sys
    - \citmdrv_amd64.sys
    - \kevp64.sys
    - \bsmixp64.sys
    - \nbiolib_x64.sys
    - \d3.sys
    - \full.sys
    - \nvflash.sys
    - \rtcore64.sys
    - \speedfan.sys
    - \fidpcidrv64.sys
    - \hwrwdrv.sys
    - \msrhook.sys
    - \proxy64.sys
    - \7.sys
    - \winring0.sys
    - \hw_sys
    - \winio64b.sys
    - \semav6msr64.sys
    - \bandai.sys
    - \piddrv.sys
    - \t8.sys
    - \asrdrv103.sys
    - \adv64drv.sys
    - \asrsetupdrv103.sys
    - \bwrs.sys
    - \d4.sys
    - \dbk64.sys
    - \fiddrv64.sys
    - \goad.sys
    - \gametersafe.sys
    - \mhyprot2.sys
    - \lenovodiagnosticsdriver.sys
    - \netflt.sys
    - \bw.sys
    - \ntbios_2.sys
    - \dbutil.sys
    - \dh_kernel.sys
    - \rtkiow8x64.sys
    - \daxin_blank.sys
    - \superbmc.sys
    - \nodedriver.sys
    - \cpuz141.sys
    - \gftkyj64.sys
    - \d2.sys
    - \4.sys
    - \dh_kernel_10.sys
    - \naldrv.sys
    - \winiodrv.sys
    - \asmmap64.sys
    - \smep_namco.sys
    - \mhyprot.sys
    - \iqvw64e.sys
    - \nstr.sys
    - \ntiolib.sys
    - \pciecubed.sys
    - \vmdrv.sys
    - \daxin_blank2.sys
    - \atszio.sys
    - \agent64.sys
    - \cpupress.sys
    - \driver7-x86.sys
    - \krpocesshacker.sys
    - \asrdrv102.sys
    - \aswvmm.sys
    - \tmcomm.sys
    - \bs_def.sys
    - \bsmi.sys
    - \alsysio64.sys
    - \cpuz.sys
    - \daxin_blank1.sys
    - \amifldrv64.sys
    - \rwdrv.sys
    - \testbone.sys
    - \winio64c.sys
    - \winring0x64.sys
    - \nt4.sys
    - \procexp.sys
    - \winio64.sys
    - \se64a.sys
    - \air_system10.sys
    - \wantd.sys
    - \wcpu.sys
    - \nicm.sys
    - \daxin_blank6.sys
    - \kbdcap64.sys
    - \lctka.sys
    - \nvflsh64.sys
    - \phlashnt.sys
    - \viragt.sys
    - \atszio64.sys
    - \dbutil_2_3.sys
    - \phymemx64.sys
    - \wantd_4.sys
    - \ndislan.sys
    - \panmonfltx64.sys
    - \t3.sys
    - \panmonflt.sys
    - \daxin_blank3.sys
    - \gdrv.sys
    - \smep_capcom.sys
    - \wyproxy32.sys
    - \black.sys
    - \vboxdrv.sys
    - \cpuz_x64.sys
    - \poortry.sys
    - \mydrivers.sys
    - \winio64a.sys
    - \openlibsys.sys
    - \bs_flash64.sys
    - \vproeventmonitor.sys
    - \piddrv64.sys
    - \wantd_2.sys
    - \sysinfo.sys
    - \asrdrv104.sys
    - \netfilterdrv.sys
    - \libnicm.sys
    - \driver7-x64.sys
    - \semav6msr.sys
    - \pchunter.sys
    - \asupio64.sys
    - \rtkio64.sys
    - \rzpnk.sys
    - \magdrvamd64.sys
    - \elrawdsk.sys
    - \amp.sys
    - \asrautochkupddrv.sys
    - \lgdcatcher.sys
    - \fairplaykd.sys
    - \daxin_blank4.sys
    - \rtkiow10x64.sys
    - \citmdrv_ia64.sys
    - \nt5.sys
    - \asromgdrv.sys
    - \nt2.sys
    - \asrdrv101.sys
- condition: 1 of selection*
  selection_other:
  - md5:
    - 9ab9f3b75a2eb87fafb1b7361be9dfb3
    - c832a4313ff082258240b61b88efa025
  - sha1:
    - fe10018af723986db50701c8532df5ed98b17c39
    - 1f1ce28c10453acbc9d3844b4604c59c0ab0ad46
  - sha256:
    - 31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427
    - cfc5c585dd4e592dd1a08887ded28b92d9a5820587b6f4f8fa4f56d60289259b
  selection_sysmon:
    Hashes|contains:
    - MD5=9AB9F3B75A2EB87FAFB1B7361BE9DFB3
    - MD5=C832A4313FF082258240B61B88EFA025
    - SHA1=FE10018AF723986DB50701C8532DF5ED98B17C39
    - SHA1=1F1CE28C10453ACBC9D3844B4604C59C0AB0AD46
    - SHA256=31F4CFB4C71DA44120752721103A16512444C13C2AC2D857A7E6F13CB679B427
    - SHA256=CFC5C585DD4E592DD1A08887DED28B92D9A5820587B6F4F8FA4F56D60289259B
- condition: 1 of selection*
  selection_name:
    ImageLoaded|endswith: \HEVD.sys
  selection_other:
    Imphash:
    - f26d0b110873a1c7d8c4f08fbeab89c5
    - c46ea2e651fd5f7f716c8867c6d13594
  selection_sysmon:
    Hashes|contains:
    - IMPHASH=f26d0b110873a1c7d8c4f08fbeab89c5
    - IMPHASH=c46ea2e651fd5f7f716c8867c6d13594
- condition: 1 of selection*
  selection_name:
    ImageLoaded|endswith: \HW.sys
  selection_other:
  - sha256:
    - 4880f40f2e557cff38100620b9aa1a3a753cb693af16cd3d95841583edcb57a8
    - 55963284bbd5a3297f39f12f0d8a01ed99fe59d008561e3537bcd4db4b4268fa
    - 6a4875ae86131a594019dec4abd46ac6ba47e57a88287b814d07d929858fe3e5
  - sha1:
    - 74e4e3006b644392f5fcea4a9bae1d9d84714b57
    - 18f34a0005e82a9a1556ba40b997b0eae554d5fd
    - 4e56e0b1d12664c05615c69697a2f5c5d893058a
  - md5:
    - 3247014ba35d406475311a2eab0c4657
    - 376b1e8957227a3639ec1482900d9b97
    - 45c2d133d41d2732f3653ed615a745c8
  selection_sysmon:
    Hashes|contains:
    - SHA256=4880F40F2E557CFF38100620B9AA1A3A753CB693AF16CD3D95841583EDCB57A8
    - SHA256=55963284BBD5A3297F39F12F0D8A01ED99FE59D008561E3537BCD4DB4B4268FA
    - SHA256=6A4875AE86131A594019DEC4ABD46AC6BA47E57A88287B814D07D929858FE3E5
    - SHA1=74E4E3006B644392F5FCEA4A9BAE1D9D84714B57
    - SHA1=18F34A0005E82A9A1556BA40B997B0EAE554D5FD
    - SHA1=4E56E0B1D12664C05615C69697A2F5C5D893058A
    - MD5=3247014BA35D406475311A2EAB0C4657
    - MD5=376B1E8957227A3639EC1482900D9B97
    - MD5=45C2D133D41D2732F3653ED615A745C8
- condition: 1 of selection*
  selection_hash:
  - sha256: f05b1ee9e2f6ab704b8919d5071becbce6f9d0f9d0ba32a460c41d5272134abe
  - sha1: b89a8eef5aeae806af5ba212a8068845cafdab6f
  - md5: b941c8364308990ee4cc6eadf7214e0f
  selection_sysmon:
    Hashes|contains:
    - SHA256=F05B1EE9E2F6AB704B8919D5071BECBCE6F9D0F9D0BA32A460C41D5272134ABE
    - SHA1=B89A8EEF5AEAE806AF5BA212A8068845CAFDAB6F
    - MD5=B941C8364308990EE4CC6EADF7214E0F
- condition: 1 of selection*
  selection_name:
    ImageLoaded|endswith:
    - \WinRing0x64.sys
    - \WinRing0.sys
    - \WinRing0.dll
    - \WinRing0x64.dll
    - \winring00x64.sys
  selection_other:
    Imphash: d41fa95d4642dc981f10de36f4dc8cd7
  selection_sysmon:
    Hashes|contains: IMPHASH=D41FA95D4642DC981F10DE36F4DC8CD7
- condition: 1 of selection*
  selection:
    ImageLoaded|contains:
    - \WinDivert.sys
    - \WinDivert64.sys
    - \NordDivert.sys
    - \lingtiwfp.sys
    - \eswfp.sys
  selection_hashes:
    Imphash:
    - 0604bb7cb4bb851e2168d5c7d9399087
    - 2e5f0e649d97f32b03c09e4686d0574f
    - 52f8aa269f69f0edad9e8fcdaedce276
    - c0e5d314da39dbf65a2dbff409cc2c76
    - 58623490691babe8330adc81cd04a663
    - 8ee39b48656e4d6b8459d7ba7da7438b
    - 45ee545ae77e8d43fc70ede9efcd4c96
    - a1b2e245acd47e4a348e1a552a02859a
    - 2a5f85fe4609461c6339637594fa9b0a
    - 6b2c6f95233c2914d1d488ee27531acc
    - 9f2fdd3f9ab922bbb0560a7df46f4342
    - d8a719865c448b1bd2ec241e46ac1c88
    - 0ea54f8c9af4a2fe8367fa457f48ed38
    - 9d519ae0a0864d6d6ae3f8b6c9c70af6
    - a74929edfc3289895e3f2885278947ae
    - a66b476c2d06c370f0a53b5537f2f11e
    - bdcd836a46bc2415773f6b5ea77a46e4
    - c28cd6ccd83179e79dac132a553693d9
  selection_sysmon:
    Hashes|contains:
    - IMPHASH=0604bb7cb4bb851e2168d5c7d9399087
    - IMPHASH=2e5f0e649d97f32b03c09e4686d0574f
    - IMPHASH=52f8aa269f69f0edad9e8fcdaedce276
    - IMPHASH=c0e5d314da39dbf65a2dbff409cc2c76
    - IMPHASH=58623490691babe8330adc81cd04a663
    - IMPHASH=8ee39b48656e4d6b8459d7ba7da7438b
    - IMPHASH=45ee545ae77e8d43fc70ede9efcd4c96
    - IMPHASH=a1b2e245acd47e4a348e1a552a02859a
    - IMPHASH=2a5f85fe4609461c6339637594fa9b0a
    - IMPHASH=6b2c6f95233c2914d1d488ee27531acc
    - IMPHASH=9f2fdd3f9ab922bbb0560a7df46f4342
    - IMPHASH=d8a719865c448b1bd2ec241e46ac1c88
    - IMPHASH=0ea54f8c9af4a2fe8367fa457f48ed38
    - IMPHASH=9d519ae0a0864d6d6ae3f8b6c9c70af6
    - IMPHASH=a74929edfc3289895e3f2885278947ae
    - IMPHASH=a66b476c2d06c370f0a53b5537f2f11e
    - IMPHASH=bdcd836a46bc2415773f6b5ea77a46e4
    - IMPHASH=c28cd6ccd83179e79dac132a553693d9
- condition: 1 of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\WINDOWS\system32\
    - C:\WINDOWS\SysWOW64\
  filter_main_system:
    Image: System
    ParentImage: Idle
  filter_optional_defender:
    Image|endswith:
    - \MpCopyAccelerator.exe
    - \MsMpEng.exe
    Image|startswith: C:\ProgramData\Microsoft\Windows Defender\
  filter_optional_msiexec:
    ParentImage: C:\Windows\System32\msiexec.exe
  filter_optional_thor:
    Image|endswith:
    - \thor64.exe
    - \thor.exe
  selection_chromium:
    FileName|contains:
    - \AppData\Local\Google\Chrome\User Data\Default\Network\Cookies
    - \Appdata\Local\Chrome\User Data\Default\Login Data
    - \AppData\Local\Google\Chrome\User Data\Local State
  selection_firefox:
    FileName|endswith:
    - \cookies.sqlite
    - release\key3.db
    - release\key4.db
    - release\logins.json
  selection_ie:
    FileName|endswith: \Appdata\Local\Microsoft\Windows\WebCache\WebCacheV01.dat
- condition: selection and not 1 of filter_*
  filter_system_folders:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\Windows\system32\
    - C:\Windows\SysWOW64\
  selection:
    FileName|contains:
    - \AppData\Local\Microsoft\Credentials\
    - \AppData\Roaming\Microsoft\Credentials\
    - \AppData\Local\Microsoft\Vault\
    - \ProgramData\Microsoft\Vault\
- condition: selection and not 1 of filter_*
  filter_system_folders:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\Windows\system32\
    - C:\Windows\SysWOW64\
  selection:
    FileName|contains:
    - \Microsoft\Protect\S-1-5-18\
    - \Microsoft\Protect\S-1-5-21-
- condition: selection and not 1 of filter_*
  filter_processes:
    Image: C:\Windows\explorer.exe
  filter_system_folders:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\Windows\system32\
    - C:\Windows\SysWOW64\
  selection:
    FileName|endswith: \Microsoft\Protect\CREDHIST
- condition: (( selection1 and not filter1 ) or ( selection2 and not filter2 )) and
    not 1 of gen_filter*
  filter1:
    CreationUtcTime|startswith: '2022'
  filter2:
    CreationUtcTime|startswith: '202'
  gen_filter_tiworker:
    Image|endswith: \TiWorker.exe
    Image|startswith: C:\WINDOWS\
    TargetFilename|endswith: .cab
  gen_filter_updates:
  - Image:
    - C:\Windows\system32\ProvTool.exe
    - C:\Windows\System32\usocoreworker.exe
    - C:\Windows\ImmersiveControlPanel\SystemSettings.exe
  - TargetFilename|startswith: C:\ProgramData\USOPrivate\UpdateStore\
  - TargetFilename|endswith:
    - .tmp
    - .temp
  selection1:
    PreviousCreationUtcTime|startswith: '2022'
  selection2:
    PreviousCreationUtcTime|startswith: '202'
- condition: selection and not filter
  filter:
    TargetFilename|endswith: \dns.log
  selection:
    Image|endswith: \dns.exe
- condition: selection
  selection:
    Image|endswith: \spoolsv.exe
    TargetFilename|contains: C:\Windows\System32\spool\drivers\x64\3\
- condition: selection
  selection:
    Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \wt.exe
    - \rundll32.exe
    - \regsvr32.exe
    TargetFilename|endswith:
    - .VHD
    - .bac
    - .bak
    - .wbcat
    - .bkf
    - .set
    - .win
    - .dsk
- condition: selection
  selection:
    TargetFilename|endswith: .evtx
    TargetFilename|startswith: C:\Windows\System32\winevt\Logs\
- condition: selection
  selection:
    TargetFilename|contains: _Cmdlet_
    TargetFilename|startswith: \Logging\CmdletInfra\LocalPowerShell\Cmdlet\
- condition: selection
  selection:
    TargetFilename|contains: \inetpub\logs\LogFiles\
    TargetFilename|endswith: .log
- condition: selection
  selection:
    TargetFilename|endswith: \PSReadLine\ConsoleHost_history.txt
- condition: selection and not filter
  filter:
    Image: C:\windows\system32\svchost.exe
    User|contains:
    - AUTHORI
    - AUTORI
  selection:
    TargetFilename|endswith: .pf
    TargetFilename|startswith: C:\Windows\Prefetch\
- condition: selection and not filter
  filter:
    Image: C:\Windows\system32\svchost.exe
  selection:
    TargetFilename|contains: \TeamViewer_
    TargetFilename|endswith: .log
- condition: selection
  selection:
    TargetFilename|contains:
    - catalina.
    - _access_log.
    - localhost.
    TargetFilename|contains|all:
    - \Tomcat
    - \logs\
- condition: selection and not 1 of filter_*
  filter_wireshark:
    TargetFilename|endswith: \Wireshark\radius\dictionary.alcatel-lucent.aaa
  selection:
    TargetFilename|endswith:
    - .AAA
    - .ZZZ
- condition: selection and not filter
  filter:
    Image|contains: \Microsoft\Teams\current\Teams.exe
  selection:
    TargetFilename|contains:
    - \Microsoft\Teams\Cookies
    - \Microsoft\Teams\Local Storage\leveldb
- condition: selection
  selection:
    TargetFilename|endswith: \unattend.xml
- condition: selection
  selection:
    TargetFilename|contains: \AppData\Local\Temp\Advanced IP Scanner 2
- condition: selection
  selection:
    TargetFilename|contains:
    - \AppData\Roaming\AnyDesk\user.conf
    - \AppData\Roaming\AnyDesk\system.conf
    TargetFilename|endswith: .temp
- condition: selection and not 1 of filter_*
  filter_dlls:
    TargetFilename|endswith: \gcapi.dll
  selection:
    Image|endswith: \anydesk.exe
    TargetFilename|endswith:
    - .dll
    - .exe
- condition: selection and not 1 of filter_optional_*
  filter_optional_ms_winapps:
    Image|endswith: \svchost.exe
    TargetFilename|endswith: \pocket_containers.json
    TargetFilename|startswith: C:\Program Files\WindowsApps\Microsoft.
  selection:
    TargetFilename|endswith:
    - BloodHound.zip
    - _computers.json
    - _containers.json
    - _domains.json
    - _gpos.json
    - _groups.json
    - _ous.json
    - _users.json
- condition: 1 of selection*
  selection_lsass_dump1:
    Image: C:\WINDOWS\system32\rundll32.exe
    TargetFilename|endswith:
    - .rtf
    - .otf
    - .odt
    - .txt
    - .files
    - .pdf
    - .dll
    - .docx
    - .wpd
    - .icns
    - .db
    - .ini
    - .tex
    - .sys
    - .csv
    - .fon
    - .tar
    - .ttf
    - .xml
    - .cfg
    - .cpl
    - .jpg
    - .drv
    - .cur
    - .tmp
    TargetFilename|startswith: C:\Windows\Temp\
    User|contains:
    - AUTHORI
    - AUTORI
  selection_procdump:
    TargetFilename: C:\Windows\Temp\procdump.exe
    User|contains:
    - AUTHORI
    - AUTORI
- condition: selection and not 1 of filter_main_*
  filter_main_baseimage:
    TargetFilename|endswith: \Windows\System32\winevt\Logs\
    TargetFilename|startswith: C:\ProgramData\Microsoft\Windows\Containers\BaseImages\
  filter_main_generic_img:
    Image:
    - C:\Windows\explorer.exe
    - C:\Windows\system32\dllhost.exe
  filter_main_path:
    TargetFilename|startswith: C:\Windows\System32\winevt\Logs\
  selection:
    TargetFilename|endswith: .evtx
- condition: selection and not filter
  filter:
    Image|startswith: C:\Windows\System32\
  selection:
  - TargetFilename:
    - C:\Windows\System32\WLBSCTRL.dll
    - C:\Windows\System32\TSMSISrv.dll
    - C:\Windows\System32\TSVIPSrv.dll
    - C:\Windows\System32\wow64log.dll
    - C:\Windows\System32\WptsExtensions.dll
    - C:\Windows\System32\wbem\wbemcomn.dll
  - TargetFilename|endswith: \SprintCSP.dll
- condition: selection
  selection:
    TargetFilename|contains: \Windows\apppatch\Custom\
    TargetFilename|endswith: .sdb
- condition: selection and not 1 of filter_*
  filter_generic:
    Image|endswith:
    - \Kindle.exe
    - \Bin\ccSvcHst.exe
  filter_tiworker:
    Image|endswith: \TiWorker.exe
    TargetFilename|endswith: \uwfservicingscr.scr
  selection:
    TargetFilename|endswith: .scr
- condition: selection and not 1 of filter*
  filter1:
    Image|endswith:
    - \Windows\System32\dism.exe
    - \TiWorker.exe
    TargetFilename|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
    - C:\Windows\SoftwareDistribution\
    - \SystemRoot\System32\
  filter2:
    Image: C:\$WINDOWS.~BT\Sources\SetupHost.exe
    TargetFilename|startswith: C:\$WINDOWS.~BT\
  filter3:
    Image: C:\Windows\system32\wbengine.exe
    TargetFilename|endswith: \RuntimeBroker.exe
  filter4:
    Image|endswith: :\Windows\system32\svchost.exe
    TargetFilename|endswith:
    - \spoolsv.exe
    - \bcdedit.exe
    TargetFilename|startswith: C:\Windows\SoftwareDistribution\Download\
  filter5:
    Image|endswith: :\Windows\system32\svchost.exe
    TargetFilename|startswith: C:Program Files\WindowsApps\
  filter6:
    Image: C:\Windows\System32\wuauclt.exe
  filter7:
    TargetFilename: C:\Windows\explorer.exe
  filter8:
    Image: C:\WINDOWS\system32\msiexec.exe
    TargetFilename: C:\Program Files\PowerShell\7\pwsh.exe
  filter_healtray:
    Image|endswith: \SecurityHealthSetup.exe
    TargetFilename|endswith: \SecurityHealthSystray.exe
    TargetFilename|startswith: C:\Windows\System32\SecurityHealth\
  selection:
    TargetFilename|endswith:
    - \AtBroker.exe
    - \audiodg.exe
    - \backgroundTaskHost.exe
    - \bcdedit.exe
    - \bitsadmin.exe
    - \cmdl32.exe
    - \cmstp.exe
    - \conhost.exe
    - \csrss.exe
    - \dasHost.exe
    - \dfrgui.exe
    - \dllhost.exe
    - \dwm.exe
    - \eventcreate.exe
    - \eventvwr.exe
    - \explorer.exe
    - \extrac32.exe
    - \fontdrvhost.exe
    - \ipconfig.exe
    - \iscsicli.exe
    - \iscsicpl.exe
    - \logman.exe
    - \LogonUI.exe
    - \LsaIso.exe
    - \lsass.exe
    - \lsm.exe
    - \msiexec.exe
    - \msinfo32.exe
    - \mstsc.exe
    - \nbtstat.exe
    - \odbcconf.exe
    - \powershell.exe
    - \pwsh.exe
    - \regini.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \RuntimeBroker.exe
    - \schtasks.exe
    - \SearchFilterHost.exe
    - \SearchIndexer.exe
    - \SearchProtocolHost.exe
    - \SecurityHealthService.exe
    - \SecurityHealthSystray.exe
    - \services.exe
    - \ShellAppRuntime.exe
    - \sihost.exe
    - \smartscreen.exe
    - \smss.exe
    - \spoolsv.exe
    - \svchost.exe
    - \SystemSettingsBroker.exe
    - \taskhost.exe
    - \taskhostw.exe
    - \Taskmgr.exe
    - \TiWorker.exe
    - \vssadmin.exe
    - \w32tm.exe
    - \WerFault.exe
    - \WerFaultSecure.exe
    - \wermgr.exe
    - \wevtutil.exe
    - \wininit.exe
    - \winlogon.exe
    - \winrshost.exe
    - \WinRTNetMUAHostServer.exe
    - \wlanext.exe
    - \wlrmdr.exe
    - \WmiPrvSE.exe
    - \wslhost.exe
    - \WSReset.exe
    - \WUDFHost.exe
    - \WWAHost.exe
- condition: selection
  selection:
    TargetFilename: C:\program.exe
- condition: selection
  selection:
  - TargetFilename|contains:
    - \pwdump
    - \kirbi
    - \pwhashes
    - \wce_ccache
    - \wce_krbtkts
    - \fgdump-log
  - TargetFilename|endswith:
    - \test.pwd
    - \lsremora64.dll
    - \lsremora.dll
    - \fgexec.exe
    - \wceaux.dll
    - \SAM.out
    - \SECURITY.out
    - \SYSTEM.out
    - \NTDS.out
    - \DumpExt.dll
    - \DumpSvc.exe
    - \cachedump64.exe
    - \cachedump.exe
    - \pstgdump.exe
    - \servpw.exe
    - \servpw64.exe
    - \pwdump.exe
    - \procdump64.exe
    - \Dumpy.exe
- condition: selection
  selection:
    Image|endswith:
    - \wscript.exe
    - \cscript.exe
    TargetFilename|endswith:
    - .jse
    - .vbe
    - .js
    - .vba
    - .vbs
    TargetFilename|startswith:
    - C:\Users\
    - C:\ProgramData
- condition: selection
  selection:
    TargetFilename|endswith: .cmdline
- condition: selection
  selection:
    TargetFilename|contains: C:\Windows\System32\spool\drivers\x64\3\old\1\123
- condition: selection and not filter
  filter:
    TargetFilename|endswith:
    - CacheCleanup.bin
    - .txt
    - .LOG
    - .cfg
    - cleanup.bin
  selection:
    Image|endswith: UMWorkerProcess.exe
- condition: selection
  selection:
    TargetFilename|contains:
    - C:\Windows\system32\physmem.sys
    - C:\Windows\System32\IME\IMEJP\imjpueact.dll
    - C:\Windows\system32\ime\IMETC\IMTCPROT.DLL
    - C:\Windows\system32\ime\SHARED\imecpmeid.dll
    - C:\Windows\system32\config\spp\ServiceState\Recovery\pac.dat
    - C:\Windows\system32\config\cy-GB\Setup\SKB\InputMethod\TupTask.dat
    - C:\Windows\system32\config\config\startwus.dat
    - C:\Windows\system32\ime\SHARED\WimBootConfigurations.ini
    - C:\Windows\system32\ime\IMEJP\WimBootConfigurations.ini
    - C:\Windows\system32\ime\IMETC\WimBootConfigurations.ini
- condition: selection
  selection:
    Image|endswith: \msiexec.exe
    TargetFilename|endswith: \elevation_service.exe
    TargetFilename|startswith: C:\Program Files (x86)\Microsoft\Edge\Application
- condition: selection
  selection:
    TargetFilename|endswith: \ManageEngine\SupportCenterPlus\bin\msiexec.exe
- condition: selection and not filter
  filter:
    User|contains:
    - AUTHORI
    - AUTORI
  selection:
    TargetFilename|endswith: WindowsPowerShell\Modules\webAdministration\webAdministration.psm1
- condition: selection
  selection:
    Image: System
    TargetFilename|endswith: \Internet Explorer\iertutil.dll
- condition: selection
  selection:
    TargetFilename|endswith: .dll
    TargetFilename|startswith:
    - C:\Windows \
    - C:\Program Files \
    - C:\Program Files (x86) \
- condition: selection
  selection:
    TargetFilename|endswith: \WINDOWS\Setup\Scripts\ErrorHandler.cmd
- condition: all of selection*
  selection:
    CommandLine|contains: MSExchange
    Image|endswith: \w3wp.exe
    TargetFilename|contains:
    - FrontEnd\HttpProxy\
    - \inetpub\wwwroot\aspnet_client\
  selection_types:
    TargetFilename|endswith:
    - .aspx
    - .asp
    - .ashx
- condition: all of selection*
  selection:
    CommandLine|contains: MSExchange
    Image|endswith: \w3wp.exe
  selection_types:
    TargetFilename|endswith:
    - .aspx
    - .asp
    - .ashx
    - .ps1
    - .bat
    - .exe
    - .dll
    - .vbs
- condition: selection
  selection:
    TargetFilename|contains: \AppData\Local\Temp\LogMeInInc\GoToAssist Remote Support
      Expert\
- condition: selection
  selection:
    TargetFilename|endswith: dumpert.dmp
- condition: selection
  selection:
  - TargetFilename|contains:
    - \hive_sam_
    - \SAM-2021-
    - \SAM-2022-
    - \SAM-2023-
    - \SAM-haxx
    - \Sam.save
  - TargetFilename: C:\windows\temp\sam
- condition: selection
  selection:
    TargetFilename|endswith:
    - \Inveigh-Log.txt
    - \Inveigh-Cleartext.txt
    - \Inveigh-NTLMv1Users.txt
    - \Inveigh-NTLMv2Users.txt
    - \Inveigh-NTLMv1.txt
    - \Inveigh-NTLMv2.txt
    - \Inveigh-FormInput.txt
    - \Inveigh.dll
    - \Inveigh.exe
    - \Inveigh.ps1
    - \Inveigh-Relay.ps1
- condition: selection
  selection:
    TargetFilename|endswith:
    - .kirbi
    - mimilsa.log
- condition: selection
  selection:
    TargetFilename|endswith:
    - \NPPSpy.txt
    - \NPPSpy.dll
- condition: selection
  selection:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    TargetFilename|endswith: .bat
- condition: selection
  selection:
    TargetFilename|contains|all:
    - \AppData\Local\Temp\SAM-
    - .dmp
- condition: selection
  selection:
    Image|endswith: \svchost.exe
    TargetFilename|re: \\Windows\\System32\\[a-zA-Z0-9]{8}\.tmp$
- condition: selection
  selection:
    TargetFilename|endswith: \Temp\debug.bin
- condition: selection and not filter
  filter:
    Image|endswith: \cmd.exe
    TargetFilename|contains|all:
    - \Users\
    - \AppData\
    - \Microsoft\OneDrive\
    - \api-ms-win-core-
  selection:
    Image|endswith:
    - \winword.exe
    - \excel.exe
    - \powerpnt.exe
    - \MSACCESS.EXE
    - \MSPUB.EXE
    - \fltldr.exe
    - \cmd.exe
    - \certutil.exe
    - \mshta.exe
    - \cscript.exe
    - \wscript.exe
    - \curl.exe
    - \powershell.exe
    - \pwsh.exe
    TargetFilename|contains:
    - \Microsoft\OneDrive\
    - \Microsoft OneDrive\
    - \Microsoft\Teams\
    - \Local\slack\app-
    - \Local\Programs\Microsoft VS Code\
    TargetFilename|contains|all:
    - \Users\
    - \AppData\
    TargetFilename|endswith: .dll
- condition: selection
  selection:
    TargetFilename|endswith: \TeamViewer_Desktop.exe
- condition: selection
  selection:
    TargetFilename|contains|all:
    - iphlpapi.dll
    - \AppData\Local\Microsoft
- condition: 1 of selection*
  selection_1:
    TargetFilename|contains|all:
    - \AppData\Local\Temp\
    - .zip\
    TargetFilename|endswith: .iso
  selection_2:
    TargetFilename|contains: \AppData\Local\Microsoft\Windows\INetCache\Content.Outlook\
    TargetFilename|endswith: .iso
- condition: selection
  selection:
    TargetFilename|contains: \Microsoft\Windows\Recent\
    TargetFilename|endswith:
    - .iso.lnk
    - .img.lnk
    - .vhd.lnk
    - .vhdx.lnk
- condition: all of selection*
  selection:
    TargetFilename|endswith:
    - \Hotfixinfo.txt
    - \netiostate.txt
    - \sysportslog.txt
    - \VmSwitchLog.evtx
    TargetFilename|startswith: C:\Windows\System32\config
- condition: 1 of selection*
  selection1:
    TargetFilename|endswith:
    - \lsass.dmp
    - \lsass.zip
    - \lsass.rar
    - \Andrew.dmp
    - \Coredump.dmp
    - \NotLSASS.zip
  selection2:
    TargetFilename|contains:
    - \lsass_2
    - \lsassdump
    - \lsassdmp
  selection3:
    TargetFilename|contains|all:
    - \lsass
    - .dmp
  selection4:
    TargetFilename|contains: SQLDmpr
    TargetFilename|endswith: .mdmp
  selection5:
    TargetFilename|endswith: .dmp
    TargetFilename|startswith: nanodump
- condition: selection
  selection:
    TargetFilename|contains: lsass
    TargetFilename|endswith: dmp
- condition: selection
  selection:
    TargetFilename|contains: lsass.exe.
    TargetFilename|endswith: .dmp
    TargetFilename|startswith: C:\Windows\System32\config\systemprofile\AppData\Local\CrashDumps\
- condition: selection
  selection:
    Image: C:\WINDOWS\system32\WerFault.exe
    TargetFilename|contains:
    - \lsass
    - lsass.exe
- condition: selection
  selection:
  - TargetFilename|contains|all:
    - \AppData\Roaming\Oracle\bin\java
    - .exe
  - TargetFilename|contains|all:
    - \Retrive
    - .vbs
- condition: selection
  selection:
    TargetFilename|endswith:
    - \AppData\Local\Microsoft\Cache134.dat
    - \AppData\Local\Microsoft\ExplorerSync.db
- condition: selection
  selection:
    Image|endswith: \msdt.exe
    TargetFilename|contains:
    - \Desktop\
    - \Start Menu\Programs\Startup\
    - C:\PerfLogs\
    - C:\ProgramData\
    - C:\Users\Public\
- condition: selection and not 1 of filter_main_*
  filter_main_rundll32:
    CommandLine|contains|all:
    - Temp
    - zzzzInvokeManagedCustomActionOutOfProc
    Image|endswith: \rundll32.exe
    ParentCommandLine|contains: ' -Embedding'
    ParentImage|endswith: \MsiExec.exe
  selection:
    TargetFilename|endswith:
    - \UsageLogs\cmstp.exe.log
    - \UsageLogs\cscript.exe.log
    - \UsageLogs\mshta.exe.log
    - \UsageLogs\msxsl.exe.log
    - \UsageLogs\regsvr32.exe.log
    - \UsageLogs\rundll32.exe.log
    - \UsageLogs\svchost.exe.log
    - \UsageLogs\wscript.exe.log
    - \UsageLogs\wmic.exe.log
- condition: selection and not filter_main
  filter_main:
    TargetFilename|contains:
    - \AppData\Local\
    - \AppData\LocalLow\
    - \AppData\Roaming\
    TargetFilename|startswith: C:\Users\
  selection:
    TargetFilename|contains: \AppData\
    TargetFilename|endswith:
    - .bat
    - .cmd
    - .cpl
    - .dll
    - .exe
    - .hta
    - .iso
    - .lnk
    - .msi
    - .ps1
    - .psm1
    - .scr
    - .vbe
    - .vbs
    TargetFilename|startswith: C:\Users\
- condition: selection and not filter
  filter:
    TargetFilename|startswith:
    - C:\$WINDOWS.~BT\NewOS\
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
    - :\WUDownloadCache\
  selection:
    TargetFilename|endswith: .scr
- condition: selection and not 1 of filter_*
  filter_gup:
    Image|endswith: \Notepad++\updater\gup.exe
  filter_install:
    Image|contains: \AppData\Local\Temp\
    Image|endswith:
    - \target.exe
    - Installer.x64.exe
    Image|startswith: C:\Users\
  selection:
    TargetFilename|contains: \Notepad++\plugins\
    TargetFilename|endswith: .dll
- condition: selection
  selection:
    TargetFilename|endswith: ntds.dit
- condition: selection_file and 1 of selection_process_*
  selection_file:
    TargetFilename|endswith: \ntds.dit
  selection_process_parent:
    ParentImage|endswith:
    - \cscript.exe
    - \httpd.exe
    - \nginx.exe
    - \php-cgi.exe
    - \powershell.exe
    - \pwsh.exe
    - \w3wp.exe
    - \wscript.exe
  selection_process_parent_path:
    ParentImage|contains:
    - \apache
    - \tomcat
    - \AppData\
    - \Temp\
    - \Public\
    - \PerfLogs\
- condition: selection_ntds and 1 of selection_process_*
  selection_ntds:
    TargetFilename|endswith: \ntds.dit
  selection_process_img:
    Image|endswith:
    - \cmd.exe
    - \cscript.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \wscript.exe
    - \wsl.exe
    - \wt.exe
  selection_process_paths:
    Image|contains:
    - \AppData\
    - \Temp\
    - \Public\
    - \PerfLogs\
- condition: selection
  selection:
    TargetFilename|endswith:
    - \All.cab
    - .ntds.cleartext
- condition: 1 of selection_*
  selection_generic:
    TargetFilename|contains: \Microsoft\Addins\
    TargetFilename|endswith:
    - .xlam
    - .xla
    - .ppam
  selection_wlldropped:
    TargetFilename|contains: \Microsoft\Word\Startup\
    TargetFilename|endswith: .wll
  selection_xladropped:
    TargetFilename|contains: Microsoft\Excel\XLSTART\
    TargetFilename|endswith: .xlam
  selection_xlldropped:
    TargetFilename|contains: \Microsoft\Excel\Startup\
    TargetFilename|endswith: .xll
- condition: selection
  selection:
    TargetFilename|endswith:
    - .docm
    - .dotm
    - .xlsm
    - .xltm
    - .potm
    - .pptm
- condition: all of selection_*
  selection_ext:
  - TargetFilename|endswith:
    - .docm
    - .dotm
    - .xlsm
    - .xltm
    - .potm
    - .pptm
  - TargetFilename|contains:
    - .docm:Zone
    - .dotm:Zone
    - .xlsm:Zone
    - .xltm:Zone
    - .potm:Zone
    - .pptm:Zone
  selection_processes:
    Image|endswith:
    - \RuntimeBroker.exe
    - \outlook.exe
    - \thunderbird.exe
    - \brave.exe
    - \chrome.exe
    - \firefox.exe
    - \iexplore.exe
    - \maxthon.exe
    - \MicrosoftEdge.exe
    - \msedge.exe
    - \msedgewebview2.exe
    - \opera.exe
    - \safari.exe
    - \seamonkey.exe
    - \vivaldi.exe
    - \whale.exe
- condition: all of selection_*
  selection_cmd:
  - Image|endswith:
    - \cscript.exe
    - \mshta.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \wscript.exe
  - ParentImage|endswith:
    - \cscript.exe
    - \mshta.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \wscript.exe
  selection_ext:
    TargetFilename|endswith:
    - .docm
    - .dotm
    - .xlsm
    - .xltm
    - .potm
    - .pptm
- condition: selection
  selection:
    TargetFilename|contains:
    - \AppData\Local\Temp\
    - \Users\Public\
    - \Windows\Temp\
    - C:\Temp\
    TargetFilename|endswith:
    - .one
    - .onepkg
- condition: selection
  selection:
    Image|endswith:
    - \onenote.exe
    - \onenotem.exe
    - \onenoteim.exe
    TargetFilename|contains: \AppData\Local\Temp\OneNote\
    TargetFilename|endswith:
    - .bat
    - .chm
    - .cmd
    - .dll
    - .exe
    - .hta
    - .htm
    - .html
    - .js
    - .lnk
    - .ps1
    - .vbe
    - .vbs
    - .wsf
- condition: selection
  selection:
    Image|endswith: \outlook.exe
    TargetFilename|endswith: \Microsoft\Outlook\VbaProject.OTM
- condition: selection
  selection:
    Image|endswith: \outlook.exe
    TargetFilename|contains:
    - \AppData\Local\Microsoft\FORMS\IPM
    - \Local Settings\Application Data\Microsoft\Forms
- condition: selection and not filter
  filter:
    Image|endswith: \outlook.exe
  selection:
    TargetFilename|endswith: \Microsoft\Outlook\VbaProject.OTM
- condition: selection
  selection:
    TargetFilename|contains:
    - \AppData\Local\Temp\
    - \Users\Public\
    - \Windows\Temp\
    - C:\Temp\
    TargetFilename|endswith: .pub
- condition: (all of selection_word_* or all of selection_excel_*) and not filter_main_office
  filter_main_office:
    Image|endswith:
    - \WINWORD.exe
    - \EXCEL.exe
  selection_excel_extension:
    TargetFilename|endswith:
    - .xls
    - .xlsm
    - .xlsx
    - .xlt
    - .xltm
  selection_excel_paths:
  - TargetFilename|contains: \Microsoft\Excel\XLSTART
  - TargetFilename|contains|all:
    - \Office
    - \Program Files
    - \XLSTART
  selection_word_extension:
    TargetFilename|endswith:
    - .files
    - .docm
    - .docx
    - .dot
    - .dotm
    - .rtf
  selection_word_paths:
  - TargetFilename|contains: \Microsoft\Word\STARTUP
  - TargetFilename|contains|all:
    - \Office
    - \Program Files
    - \STARTUP
- condition: all of selection* and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_localassembly:
    TargetFilename|contains: \AppData\Local\assembly\tmp\
    TargetFilename|endswith: .dll
  filter_optional_webex:
    Image|endswith: \winword.exe
    TargetFilename|contains: \AppData\Local\Temp\webexdelta\
    TargetFilename|endswith:
    - .dll
    - .exe
  filter_optional_webservicecache:
    TargetFilename|contains|all:
    - C:\Users\
    - \AppData\Local\Microsoft\Office\
    - \WebServiceCache\AllUsers
    TargetFilename|endswith: .com
  selection1:
    Image|endswith:
    - \excel.exe
    - \msaccess.exe
    - \mspub.exe
    - \powerpnt.exe
    - \visio.exe
    - \winword.exe
  selection2:
    TargetFilename|endswith:
    - .bat
    - .cmd
    - .com
    - .dll
    - .exe
    - .hta
    - .ocx
    - .proj
    - .ps1
    - .scf
    - .scr
    - .sys
    - .vbe
    - .vbs
    - .wsf
    - .wsh
- condition: ((selection_word_paths and not filter_exclude_word_ext) or (selection_excel_paths
    and not filter_exclude_excel_ext)) and not 1 of filter_main_*
  filter_exclude_excel_ext:
    TargetFilename|endswith:
    - .xls
    - .xlsm
    - .xlsx
    - .xlt
    - .xltm
    - .xll
    - .xlw
  filter_exclude_word_ext:
    TargetFilename|endswith:
    - .docb
    - .docm
    - .docx
    - .dotm
    - .pdf
    - .wll
    - .wwl
  filter_main_office_apps:
    Image|endswith:
    - \winword.exe
    - \excel.exe
    Image|startswith:
    - C:\Program Files\Microsoft Office\
    - C:\Program Files (x86)\Microsoft Office\
  filter_main_office_click_to_run:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith: C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
  selection_excel_paths:
  - TargetFilename|contains: \Microsoft\Excel\XLSTART
  - TargetFilename|contains|all:
    - \Office
    - \Program Files
    - \XLSTART
  selection_word_paths:
  - TargetFilename|contains: \Microsoft\Word\STARTUP
  - TargetFilename|contains|all:
    - \Office
    - \Program Files
    - \STARTUP
- condition: selection
  selection:
    TargetFilename|contains: \AppData\Local\Temp\ba9ea7344a4a5f591d6e5dc32a13494b\
- condition: selection
  selection:
    TargetFilename|endswith:
    - .7z
    - .bat
    - .bin
    - .chm
    - .dll
    - .exe
    - .hta
    - .lnk
    - .ps1
    - .psm1
    - .py
    - .scr
    - .sys
    - .vbe
    - .vbs
    - .zip
    TargetFilename|startswith: C:\PerfLogs\
- condition: selection and not 1 of filter_main_*
  filter_main_admin_temp:
    TargetFilename|endswith:
    - .dll
    - .exe
    TargetFilename|startswith: C:\Windows\Temp\
  filter_main_user_temp:
    TargetFilename|contains: \AppData\Local\Temp\
    TargetFilename|endswith:
    - .dll
    - .exe
    TargetFilename|startswith: C:\Users\
  selection:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    TargetFilename|endswith:
    - .bat
    - .chm
    - .cmd
    - .com
    - .dll
    - .exe
    - .hta
    - .jar
    - .js
    - .ocx
    - .scr
    - .sys
    - .vbe
    - .vbs
    - .wsf
- condition: selection and not 1 of filter_main_*
  filter_main_appdata:
    TargetFilename|contains: \AppData\Local\Temp\
    TargetFilename|startswith: C:\Users\
  filter_main_psscriptpolicytest:
    TargetFilename|contains: __PSScriptPolicyTest_
  filter_main_windows_temp:
    TargetFilename|startswith: C:\Windows\Temp\
  selection:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    TargetFilename|endswith: .ps1
- condition: 1 of selection_*
  selection_generic:
    TargetFilename|endswith:
    - \Add-ConstrainedDelegationBackdoor.ps1
    - \Add-Exfiltration.ps1
    - \Add-Persistence.ps1
    - \Add-RegBackdoor.ps1
    - \Add-RemoteRegBackdoor.ps1
    - \Add-ScrnSaveBackdoor.ps1
    - \ADRecon.ps1
    - \AzureADRecon.ps1
    - \Check-VM.ps1
    - \ConvertTo-ROT13.ps1
    - \Copy-VSS.ps1
    - \Create-MultipleSessions.ps1
    - \DNS_TXT_Pwnage.ps1
    - \Do-Exfiltration.ps1
    - \DomainPasswordSpray.ps1
    - \Download_Execute.ps1
    - \Download-Execute-PS.ps1
    - \Enable-DuplicateToken.ps1
    - \Enabled-DuplicateToken.ps1
    - \Execute-Command-MSSQL.ps1
    - \Execute-DNSTXT-Code.ps1
    - \Execute-OnTime.ps1
    - \ExetoText.ps1
    - \Exploit-Jboss.ps1
    - \Find-AVSignature.ps1
    - \Find-Fruit.ps1
    - \Find-GPOLocation.ps1
    - \Find-TrustedDocuments.ps1
    - \FireBuster.ps1
    - \FireListener.ps1
    - \Get-ApplicationHost.ps1
    - \Get-ChromeDump.ps1
    - \Get-ClipboardContents.ps1
    - \Get-ComputerDetail.ps1
    - \Get-FoxDump.ps1
    - \Get-GPPAutologon.ps1
    - \Get-GPPPassword.ps1
    - \Get-IndexedItem.ps1
    - \Get-Keystrokes.ps1
    - \Get-LSASecret.ps1
    - \Get-MicrophoneAudio.ps1
    - \Get-PassHashes.ps1
    - \Get-PassHints.ps1
    - \Get-RegAlwaysInstallElevated.ps1
    - \Get-RegAutoLogon.ps1
    - \Get-RickAstley.ps1
    - \Get-Screenshot.ps1
    - \Get-SecurityPackages.ps1
    - \Get-ServiceFilePermission.ps1
    - \Get-ServicePermission.ps1
    - \Get-ServiceUnquoted.ps1
    - \Get-SiteListPassword.ps1
    - \Get-System.ps1
    - \Get-TimedScreenshot.ps1
    - \Get-UnattendedInstallFile.ps1
    - \Get-Unconstrained.ps1
    - \Get-USBKeystrokes.ps1
    - \Get-VaultCredential.ps1
    - \Get-VulnAutoRun.ps1
    - \Get-VulnSchTask.ps1
    - \Get-WebConfig.ps1
    - \Get-WebCredentials.ps1
    - \Get-WLAN-Keys.ps1
    - \Gupt-Backdoor.ps1
    - \HTTP-Backdoor.ps1
    - \HTTP-Login.ps1
    - \Install-ServiceBinary.ps1
    - \Install-SSP.ps1
    - \Invoke-ACLScanner.ps1
    - \Invoke-ADSBackdoor.ps1
    - \Invoke-AmsiBypass.ps1
    - \Invoke-ARPScan.ps1
    - \Invoke-BackdoorLNK.ps1
    - \Invoke-BadPotato.ps1
    - \Invoke-BetterSafetyKatz.ps1
    - \Invoke-BruteForce.ps1
    - \Invoke-BypassUAC.ps1
    - \Invoke-Carbuncle.ps1
    - \Invoke-Certify.ps1
    - \Invoke-ConPtyShell.ps1
    - \Invoke-CredentialInjection.ps1
    - \Invoke-CredentialsPhish.ps1
    - \Invoke-DAFT.ps1
    - \Invoke-DCSync.ps1
    - \Invoke-Decode.ps1
    - \Invoke-DinvokeKatz.ps1
    - \Invoke-DllInjection.ps1
    - \Invoke-DNSUpdate.ps1
    - \Invoke-DowngradeAccount.ps1
    - \Invoke-EgressCheck.ps1
    - \Invoke-Encode.ps1
    - \Invoke-EventViewer.ps1
    - \Invoke-Eyewitness.ps1
    - \Invoke-FakeLogonScreen.ps1
    - \Invoke-Farmer.ps1
    - \Invoke-Get-RBCD-Threaded.ps1
    - \Invoke-Gopher.ps1
    - \Invoke-Grouper2.ps1
    - \Invoke-Grouper3.ps1
    - \Invoke-HandleKatz.ps1
    - \Invoke-Interceptor.ps1
    - \Invoke-Internalmonologue.ps1
    - \Invoke-Inveigh.ps1
    - \Invoke-InveighRelay.ps1
    - \Invoke-JSRatRegsvr.ps1
    - \Invoke-JSRatRundll.ps1
    - \Invoke-KrbRelay.ps1
    - \Invoke-KrbRelayUp.ps1
    - \Invoke-LdapSignCheck.ps1
    - \Invoke-Lockless.ps1
    - \Invoke-MalSCCM.ps1
    - \Invoke-Mimikatz.ps1
    - \Invoke-MimikatzWDigestDowngrade.ps1
    - \Invoke-Mimikittenz.ps1
    - \Invoke-MITM6.ps1
    - \Invoke-NanoDump.ps1
    - \Invoke-NetRipper.ps1
    - \Invoke-NetworkRelay.ps1
    - \Invoke-NinjaCopy.ps1
    - \Invoke-OxidResolver.ps1
    - \Invoke-P0wnedshell.ps1
    - \Invoke-P0wnedshellx86.ps1
    - \Invoke-Paranoia.ps1
    - \Invoke-PortScan.ps1
    - \Invoke-PoshRatHttp.ps1
    - \Invoke-PoshRatHttps.ps1
    - \Invoke-PostExfil.ps1
    - \Invoke-PowerDump.ps1
    - \Invoke-PowerShellIcmp.ps1
    - \Invoke-PowerShellTCP.ps1
    - \Invoke-PowerShellTcpOneLine.ps1
    - \Invoke-PowerShellTcpOneLineBind.ps1
    - \Invoke-PowerShellUdp.ps1
    - \Invoke-PowerShellUdpOneLine.ps1
    - \Invoke-PowerShellWMI.ps1
    - \Invoke-PowerThIEf.ps1
    - \Invoke-PPLDump.ps1
    - \Invoke-Prasadhak.ps1
    - \Invoke-PsExec.ps1
    - \Invoke-PsGcat.ps1
    - \Invoke-PsGcatAgent.ps1
    - \Invoke-PSInject.ps1
    - \Invoke-PsUaCme.ps1
    - \Invoke-ReflectivePEInjection.ps1
    - \Invoke-ReverseDNSLookup.ps1
    - \Invoke-Rubeus.ps1
    - \Invoke-RunAs.ps1
    - \Invoke-SafetyKatz.ps1
    - \Invoke-SauronEye.ps1
    - \Invoke-SCShell.ps1
    - \Invoke-Seatbelt.ps1
    - \Invoke-ServiceAbuse.ps1
    - \Invoke-SessionGopher.ps1
    - \Invoke-ShellCode.ps1
    - \Invoke-SMBScanner.ps1
    - \Invoke-Snaffler.ps1
    - \Invoke-Spoolsample.ps1
    - \Invoke-SSHCommand.ps1
    - \Invoke-SSIDExfil.ps1
    - \Invoke-StandIn.ps1
    - \Invoke-StickyNotesExtract.ps1
    - \Invoke-Tater.ps1
    - \Invoke-Thunderfox.ps1
    - \Invoke-ThunderStruck.ps1
    - \Invoke-TokenManipulation.ps1
    - \Invoke-Tokenvator.ps1
    - \Invoke-TotalExec.ps1
    - \Invoke-UrbanBishop.ps1
    - \Invoke-UserHunter.ps1
    - \Invoke-VoiceTroll.ps1
    - \Invoke-Whisker.ps1
    - \Invoke-WinEnum.ps1
    - \Invoke-winPEAS.ps1
    - \Invoke-WireTap.ps1
    - \Invoke-WmiCommand.ps1
    - \Invoke-WScriptBypassUAC.ps1
    - \Invoke-Zerologon.ps1
    - \Keylogger.ps1
    - \MailRaider.ps1
    - \New-HoneyHash.ps1
    - \OfficeMemScraper.ps1
    - \Offline_Winpwn.ps1
    - \Out-CHM.ps1
    - \Out-DnsTxt.ps1
    - \Out-Excel.ps1
    - \Out-HTA.ps1
    - \Out-Java.ps1
    - \Out-JS.ps1
    - \Out-Minidump.ps1
    - \Out-RundllCommand.ps1
    - \Out-SCF.ps1
    - \Out-SCT.ps1
    - \Out-Shortcut.ps1
    - \Out-WebQuery.ps1
    - \Out-Word.ps1
    - \Parse_Keys.ps1
    - \Port-Scan.ps1
    - \PowerBreach.ps1
    - \powercat.ps1
    - \Powermad.ps1
    - \PowerRunAsSystem.psm1
    - \PowerSharpPack.ps1
    - \PowerUp.ps1
    - \PowerUpSQL.ps1
    - \PowerView.ps1
    - \PSAsyncShell.ps1
    - \RemoteHashRetrieval.ps1
    - \Remove-Persistence.ps1
    - \Remove-PoshRat.ps1
    - \Remove-Update.ps1
    - \Run-EXEonRemote.ps1
    - \Schtasks-Backdoor.ps1
    - \Set-DCShadowPermissions.ps1
    - \Set-MacAttribute.ps1
    - \Set-RemotePSRemoting.ps1
    - \Set-RemoteWMI.ps1
    - \Set-Wallpaper.ps1
    - \Show-TargetScreen.ps1
    - \Speak.ps1
    - \Start-CaptureServer.ps1
    - \Start-WebcamRecorder.ps1
    - \StringToBase64.ps1
    - \TexttoExe.ps1
    - \VolumeShadowCopyTools.ps1
    - \WinPwn.ps1
    - \WSUSpendu.ps1
  selection_invoke_sharp:
    TargetFilename|contains: Invoke-Sharp
    TargetFilename|endswith: .ps1
- condition: selection
  selection:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    TargetFilename|contains:
    - \WindowsPowerShell\Modules\
    - \PowerShell\7\Modules\
- condition: selection
  selection:
    TargetFilename|endswith:
    - \\WindowsPowerShell\\Modules\\*\.ps
    - \\WindowsPowerShell\\Modules\\*\.dll
- condition: selection and not 1 of filter_main_*
  filter_main_pwsh:
    Image|endswith:
    - \powerShell_ise.exe
    - \powershell.exe
    - \pwsh.exe
  selection:
    TargetFilename|contains:
    - \WindowsPowerShell\Modules\
    - \PowerShell\7\Modules\
- condition: selection
  selection:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    TargetFilename|contains: \start menu\programs\startup\
    TargetFilename|endswith: .lnk
- condition: selection and not 1 of filter_main_*
  filter_main_generic:
    Image|endswith:
    - :\Program Files\PowerShell\7\pwsh.exe
    - :\Windows\System32\dsac.exe
    - :\Windows\System32\ServerManager.exe
    - :\Windows\System32\WindowsPowerShell\v1.0\powershell_ise.exe
    - :\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
    - :\Windows\System32\wsmprovhost.exe
    - :\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell_ise.exe
    - :\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe
  selection:
    TargetFilename|contains: __PSScriptPolicyTest_
- condition: selection
  selection:
    TargetFilename|contains|all:
    - :\Users\
    - \.config\rclone\
- condition: selection
  selection:
    Image|endswith:
    - \brave.exe
    - \CCleaner Browser\Application\CCleanerBrowser.exe
    - \chromium.exe
    - \firefox.exe
    - \Google\Chrome\Application\chrome.exe
    - \iexplore.exe
    - \microsoftedge.exe
    - \msedge.exe
    - \Opera.exe
    - \Vivaldi.exe
    - \Whale.exe
    - \Outlook.exe
    - \RuntimeBroker.exe
    - \Thunderbird.exe
    - \Discord.exe
    - \Keybase.exe
    - \msteams.exe
    - \Slack.exe
    - \teams.exe
    TargetFilename|contains: .rdp
- condition: selection
  selection:
    TargetFilename|endswith:
    - \gthread-3.6.dll
    - \sigcmm-2.4.dll
    - \Windows\Temp\tmp.bat
- condition: selection
  selection:
    TargetFilename|contains: \Bin\ScreenConnect.
- condition: selection
  selection:
    Image|endswith: \explorer.exe
    TargetFilename|contains|all:
    - \Microsoft\Windows\Start Menu\Programs\Startup
    - .lnk.{0AFACED1-E828-11D1-9187-B532F1E9575D}
- condition: selection
  selection:
  - TargetFilename|endswith:
    - \Temp\sam
    - \sam.sav
    - \Intel\sam
    - \sam.hive
    - \Perflogs\sam
    - \ProgramData\sam
    - \Users\Public\sam
    - \AppData\Local\sam
    - \AppData\Roaming\sam
    - _ShadowSteal.zip
    - \Documents\SAM.export
    - :\sam
  - TargetFilename|contains:
    - \hive_sam_
    - \sam.save
    - \sam.export
    - \~reg_sam.save
    - \sam_backup
    - \sam.bck
    - \sam.backup
- condition: 1 of selection_*
  selection_1:
    Image|endswith:
    - \bash.exe
    - \cmd.exe
    - \cscript.exe
    - \msbuild.exe
    - \powershell.exe
    - \pwsh.exe
    - \sh.exe
    - \wscript.exe
    TargetFilename|startswith:
    - C:\PerfLogs\
    - C:\Users\Public\
  selection_2:
    Image|endswith:
    - \certutil.exe
    - \forfiles.exe
    - \mshta.exe
    - \schtasks.exe
    - \scriptrunner.exe
    - \wmic.exe
    TargetFilename|contains:
    - C:\PerfLogs\
    - C:\Users\Public\
    - C:\Windows\Temp\
- condition: 1 of selection_*
  selection_generic:
    Image|endswith:
    - \smss.exe
    - \RuntimeBroker.exe
    - \sihost.exe
    - \lsass.exe
    - \csrss.exe
    - \winlogon.exe
    - \wininit.exe
    TargetFilename|endswith:
    - .bat
    - .vbe
    - .txt
    - .vbs
    - .exe
    - .ps1
    - .hta
    - .iso
    - .dll
  selection_special:
    Image|endswith:
    - \rundll32.exe
    - \svchost.exe
    - \dllhost.exe
    TargetFilename|endswith:
    - .bat
    - .vbe
    - .vbs
    - .ps1
    - .hta
    - .iso
- condition: selection and not filter_update
  filter_update:
  - Image: C:\Windows\System32\wuauclt.exe
  - TargetFilename|startswith: C:\$WINDOWS.~BT\NewOS\
  selection:
    TargetFilename|contains: \Microsoft\Windows\Start Menu\Programs\StartUp
- condition: selection and not 1 of filter_*
  filter_begins:
    Image|startswith:
    - C:\Windows\ccmsetup\autoupgrade\ccmsetup
    - C:\Program Files\SentinelOne\Sentinel Agent
  filter_citrix:
    Image|endswith: :\Program Files\Citrix\Receiver StoreFront\Services\DefaultDomainServices\Citrix.DeliveryServices.DomainServices.ServiceHost.exe
  filter_domain_controller:
    Image:
    - C:\Windows\system32\efsui.exe
    - C:\Windows\system32\dsac.exe
  filter_ends:
    Image|endswith: \LANDesk\LDCLient\ldapwhoami.exe
  filter_eq:
    Image:
    - C:\windows\system32\svchost.exe
    - C:\windows\system32\dllhost.exe
    - C:\windows\system32\mmc.exe
    - C:\windows\system32\WindowsPowerShell\v1.0\powershell.exe
    - C:\Windows\CCM\CcmExec.exe
    - C:\Program Files\Cylance\Desktop\CylanceSvc.exe
    - C:\Windows\System32\wbem\WmiPrvSE.exe
  selection:
    TargetFilename|contains: \Local\Microsoft\Windows\SchCache\
    TargetFilename|endswith: .sch
- condition: selection and not 1 of filter_*
  filter_ext:
    TargetFilename|endswith:
    - .icm
    - .gmmp
    - .cdmp
    - .camp
  selection:
    Image|endswith: \colorcpl.exe
- condition: selection_mobsync and filter_created_file
  filter_created_file:
    TargetFilename|endswith:
    - .dll
    - .exe
  selection_mobsync:
    Image|endswith: \mobsync.exe
- condition: selection
  selection:
    TargetFilename|contains: \Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\
    TargetFilename|endswith:
    - .dll
    - .exe
- condition: selection and not filter1 and not filter2
  filter1:
    TargetFilename|contains: C:\Windows\
  filter2:
    TargetFilename|contains:
    - .jpg
    - .jpeg
    - .png
  selection:
    Image|endswith: \svchost.exe
    TargetFilename|contains: \Personalization\LockScreenImage\
- condition: selection and not 1 of filter_*
  filter_generic:
    Image|startswith:
    - C:\Windows\
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_jetbrains:
    Image|endswith: \AppData\Local\JetBrains\Toolbox\bin\7z.exe
    TargetFilename|contains: \JetBrains\apps\
  filter_upgrade:
    TargetFilename|startswith: C:\$WINDOWS.~BT\NewOS\
  selection:
    TargetFilename|endswith: \desktop.ini
- condition: selection
  selection:
    Image|endswith: \cmd.exe
    TargetFilename|contains|all:
    - \Users\
    - \Desktop\
    TargetFilename|endswith: .txt
- condition: selection
  selection:
    TargetFilename|endswith: .diagcab
- condition: 1 of selection_*
  selection_exe:
    TargetFilename|endswith:
    - .rar.exe
    - .zip.exe
  selection_gen:
    TargetFilename|contains:
    - .files.
    - .docx.
    - .jpg.
    - .pdf.
    - .ppt.
    - .pptx.
    - .xls.
    - .xlsx.
    TargetFilename|endswith:
    - .exe
    - .iso
    - .rar
    - .zip
- condition: selection and not 1 of filter_*
  filter_defender:
    Image|startswith:
    - C:\ProgramData\Microsoft\Windows Defender\
    - C:\Program Files\Windows Defender\
  filter_githubdesktop:
    Image|endswith: \AppData\Local\GitHubDesktop\Update.exe
    TargetFilename|contains: \AppData\Local\SquirrelTemp\
  filter_mscorsvw:
    Image|endswith: \mscorsvw.exe
    Image|startswith: C:\Windows\Microsoft.NET\Framework\
    TargetFilename|startswith: C:\Windows\assembly\NativeImages_
  filter_programfiles:
  - Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  - TargetFilename|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_teams:
    Image|endswith: \AppData\Local\Microsoft\Teams\Update.exe
    TargetFilename|endswith:
    - \AppData\Local\Microsoft\Teams\stage\Teams.exe
    - \AppData\Local\Microsoft\Teams\stage\Squirrel.exe
    - \AppData\Local\Microsoft\SquirrelTemp\tempb\
  filter_tiworker:
    Image|endswith: \TiWorker.exe
    Image|startswith: C:\Windows\WinSxS\
  filter_update:
    Image: C:\WINDOWS\system32\svchost.exe
    TargetFilename|startswith: C:\Windows\SoftwareDistribution\Download\
  filter_upgrade:
    Image: C:\Windows\system32\svchost.exe
    TargetFilename|contains|all:
    - :\WUDownloadCache\
    - \WindowsUpdateBox.exe
  filter_vscode:
    Image|contains: \AppData\Local\
    Image|endswith: \Microsoft VS Code\Code.exe
    TargetFilename|contains: \.vscode\extensions\
  filter_whitelist:
    Image:
    - C:\Windows\System32\msiexec.exe
    - C:\Windows\system32\cleanmgr.exe
    - C:\Windows\explorer.exe
    - C:\WINDOWS\system32\dxgiadaptercache.exe
    - C:\WINDOWS\system32\Dism.exe
    - C:\Windows\System32\wuauclt.exe
  filter_windows_apps:
    TargetFilename|contains: \Microsoft\WindowsApps\
  filter_windows_temp:
    TargetFilename|startswith: C:\WINDOWS\TEMP\
  filter_windows_update_box:
    Image|endswith: \WindowsUpdateBox.Exe
    Image|startswith: C:\WINDOWS\SoftwareDistribution\Download\
    TargetFilename|startswith: C:\$WINDOWS.~BT\Sources\
  selection:
    Image|endswith: .exe
    TargetFilename|endswith: .exe
- condition: selection
  selection:
    Image|endswith: \MSExchangeMailboxReplication.exe
    TargetFilename|endswith:
    - .aspx
    - .asp
- condition: 1 of selection_*
  selection_double:
    TargetFilename|endswith:
    - .bat.exe
    - .sys.exe
  selection_folder:
    TargetFilename:
    - C:\$Recycle.Bin.exe
    - C:\Documents and Settings.exe
    - C:\MSOCache.exe
    - C:\Recovery.exe
    - C:\PerfLogs.exe
- condition: selection
  selection:
    TargetFilename|endswith: Local\Microsoft\WindowsApps\Get-Variable.exe
- condition: 1 of selection_*
  selection_lower:
    TargetFilename|contains:
    - "\u0430"
    - "\u0435"
    - "\u043E"
    - "\u0440"
    - "\u0441"
    - "\u0445"
    - "\u0455"
    - "\u0456"
    - "\u04CF"
    - "\u0458"
    - "\u04BB"
    - "\u0501"
    - "\u051B"
    - "\u051D"
    - "\u03BF"
  selection_upper:
    TargetFilename|contains:
    - "\u0410"
    - "\u0412"
    - "\u0415"
    - "\u041A"
    - "\u041C"
    - "\u041D"
    - "\u041E"
    - "\u0420"
    - "\u0421"
    - "\u0422"
    - "\u0425"
    - "\u0405"
    - "\u0406"
    - "\u0408"
    - "\u04AE"
    - "\u04C0"
    - "\u050C"
    - "\u051A"
    - "\u051C"
    - "\u0391"
    - "\u0392"
    - "\u0395"
    - "\u0396"
    - "\u0397"
    - "\u0399"
    - "\u039A"
    - "\u039C"
    - "\u039D"
    - "\u039F"
    - "\u03A1"
    - "\u03A4"
    - "\u03A5"
    - "\u03A7"
- condition: selection
  selection:
    Image|endswith:
    - \winword.exe
    - \excel.exe
    - \powerpnt.exe
    - \msaccess.exe
    - \mspub.exe
    - \eqnedt32.exe
    - \visio.exe
    - \wordpad.exe
    - \wordview.exe
    - \certutil.exe
    - \certoc.exe
    - \CertReq.exe
    - \Desktopimgdownldr.exe
    - \esentutl.exe
    - \finger.exe
    - \notepad.exe
    - \AcroRd32.exe
    - \RdrCEF.exe
    - \mshta.exe
    - \hh.exe
    TargetFilename|endswith:
    - .zip
    - .rar
    - .7z
    - .diagcab
    - .appx
- condition: selection
  selection:
    Image|endswith:
    - \eqnedt32.exe
    - \wordpad.exe
    - \wordview.exe
    - \certutil.exe
    - \certoc.exe
    - \CertReq.exe
    - \Desktopimgdownldr.exe
    - \esentutl.exe
    - \mshta.exe
    - \AcroRd32.exe
    - \RdrCEF.exe
    - \hh.exe
    - \finger.exe
    TargetFilename|endswith:
    - .exe
    - .dll
    - .ocx
- condition: selection
  selection:
    Image|endswith:
    - \eqnedt32.exe
    - \wordpad.exe
    - \wordview.exe
    - \certutil.exe
    - \certoc.exe
    - \CertReq.exe
    - \Desktopimgdownldr.exe
    - \esentutl.exe
    - \mshta.exe
    - \AcroRd32.exe
    - \RdrCEF.exe
    - \hh.exe
    - \finger.exe
    TargetFilename|endswith:
    - .ps1
    - .bat
    - .vbs
    - .scf
    - .wsf
    - .wsh
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_recent:
    TargetFilename|contains: \AppData\Roaming\Microsoft\Windows\Recent\
  filter_optional_excel:
    Image|endswith: \excel.exe
    TargetFilename|contains: \AppData\Roaming\Microsoft\Excel
  filter_optional_office:
    Image|endswith:
    - \excel.exe
    - \powerpnt.exe
    - \winword.exe
    TargetFilename|contains: \AppData\Roaming\Microsoft\Office\Recent\
  filter_optional_powerpoint:
    Image|endswith: \powerpnt.exe
    TargetFilename|contains: \AppData\Roaming\Microsoft\PowerPoint
  filter_optional_word:
    Image|endswith: \winword.exe
    TargetFilename|contains: \AppData\Roaming\Microsoft\Word
  selection:
    TargetFilename|contains:
    - .files.
    - .docx.
    - .jpg.
    - .pdf.
    - .ppt.
    - .pptx.
    - .xls.
    - .xlsx.
    TargetFilename|endswith: .lnk
- condition: selection and not 1 of filter*
  filter:
    TargetFilename|contains|all:
    - \Templates\Windows\Windows_TemporaryKey.pfx
    - \CMake\
  selection:
    TargetFilename|endswith: .pfx
- condition: selection
  selection:
    TargetFilename|endswith:
    - \Microsoft.PowerShell_profile.ps1
    - \WindowsPowerShell\profile.ps1
    - \PowerShell\profile.ps1
    - \Windows\System32\WindowsPowerShell\v1.0\profile.ps1
    - \Program Files\PowerShell\7\profile.ps1
- condition: selection and not filter
  filter:
    Image|contains:
    - \procexp64.exe
    - \procexp.exe
    - \procmon64.exe
    - \procmon.exe
  selection:
    TargetFilename|contains: \AppData\Local\Temp\
    TargetFilename|endswith: PROCEXP152.sys
- condition: selection
  selection:
  - Image|contains:
    - :\RECYCLERS.BIN\
    - :\RECYCLER.BIN\
    - :\RECYCLE.BIN\
  - TargetFilename|contains:
    - :\RECYCLERS.BIN\
    - :\RECYCLER.BIN\
    - :\RECYCLE.BIN\
- condition: selection
  selection:
    TargetFilename|endswith:
    - .dll
    - .exe
    - .sys
    TargetFilename|startswith: C:\Windows\System32\spool\drivers\color\
- condition: selection
  selection:
    TargetFilename|contains: \Windows\Start Menu\Programs\Startup\
    TargetFilename|endswith:
    - .vbs
    - .vbe
    - .bat
    - .ps1
    - .hta
    - .dll
    - .jar
    - .msi
    - .scr
    - .cmd
- condition: selection
  selection:
    TargetFilename:
    - C:\Windows\System32\config\systemprofile\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
    - C:\Windows\System32\config\systemprofile\AppData\Local\Microsoft\Windows\PowerShell\StartupProfileData-Interactive
- condition: selection
  selection:
    Image|contains:
    - \AppData\
    - C:\PerfLogs
    - \Windows\System32\config\systemprofile
    TargetFilename|contains: \Windows\System32\Tasks
- condition: 1 of selection*
  selection1:
    TargetFilename|endswith:
    - \TeamViewer\RemotePrinting\tvprint.db
    - \TeamViewer\TVNetwork.log
  selection2:
    TargetFilename|contains|all:
    - \TeamViewer
    - _Logfile.log
- condition: selection
  selection:
    TargetFilename|endswith: \Microsoft.VSCode_profile.ps1
- condition: selection
  selection:
    Image|endswith:
    - \cmd.exe
    - \cscript.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
    TargetFilename|endswith: \AppData\Local\Packages\Microsoft.WindowsTerminal_8wekyb3d8bbwe\LocalState\settings.json
- condition: selection and not 1 of filter_main_*
  filter_main_system_location:
    Image|startswith:
    - C:\Windows\Systems32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  selection:
    TargetFilename|endswith: .exe
    TargetFilename|startswith: C:\Windows\WinSxS\
- condition: selection
  selection:
    TargetFilename: C:\Windows\livekd.dmp
- condition: selection
  selection:
    Image|endswith:
    - \livekd.exe
    - \livek64.exe
    TargetFilename: C:\Windows\System32\drivers\LiveKdD.SYS
- condition: selection and not 1 of filter_main_*
  filter_main_legit_name:
    Image|endswith:
    - \livekd.exe
    - \livek64.exe
  selection:
    TargetFilename: C:\Windows\System32\drivers\LiveKdD.SYS
- condition: selection and not 1 of filter_main_*
  filter_main_process_explorer:
    Image|endswith:
    - \procexp.exe
    - \procexp64.exe
  selection:
    TargetFilename|contains: \PROCEXP
    TargetFilename|endswith: .sys
- condition: selection and not 1 of filter_main_*
  filter_main_process_explorer:
    Image|endswith:
    - \procmon.exe
    - \procmon64.exe
  selection:
    TargetFilename|contains: \procmon
    TargetFilename|endswith: .sys
- condition: selection
  selection:
    TargetFilename|endswith: .key
    TargetFilename|startswith: C:\Windows\PSEXEC-
- condition: selection
  selection:
    TargetFilename|endswith: \comctl32.dll
    TargetFilename|startswith:
    - C:\Windows\System32\logonUI.exe.local
    - C:\Windows\System32\werFault.exe.local
    - C:\Windows\System32\consent.exe.local
    - C:\Windows\System32\narrator.exe.local
    - C:\Windows\System32\wermgr.exe.local
- condition: selection
  selection:
    TargetFilename|endswith: \PSEXESVC.exe
- condition: selection
  selection:
    Image|endswith: \mstsc.exe
    TargetFilename|contains: \Microsoft\Windows\Start Menu\Programs\Startup\
- condition: selection
  selection:
    TargetFilename|endswith: \comctl32.dll
    TargetFilename|startswith: C:\Windows\System32\consent.exe.@
- condition: selection
  selection:
    TargetFilename|endswith: \AppData\Local\Temp\pe386.dll
    TargetFilename|startswith: C:\Users\
- condition: selection and not filter
  filter:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  selection:
    TargetFilename|endswith:
    - \Microsoft\Event Viewer\RecentViews
    - \Microsoft\EventV~1\RecentViews
- condition: selection
  selection:
    Image|endswith: \DllHost.exe
    TargetFilename|endswith: .dll
    TargetFilename|startswith: C:\Windows\System32\
- condition: selection
  selection:
    Image: C:\Program Files\Internet Explorer\IEInstal.exe
    TargetFilename|contains: \AppData\Local\Temp\
    TargetFilename|endswith: consent.exe
    TargetFilename|startswith: C:\Users\
- condition: selection
  selection:
    TargetFilename|endswith: \AppData\Local\Temp\pkgmgr.exe
    TargetFilename|startswith: C:\Users\
- condition: selection
  selection:
    TargetFilename|endswith: \AppData\Local\Temp\api-ms-win-core-kernel32-legacy-l1.DLL
    TargetFilename|startswith: C:\Users\
- condition: selection
  selection:
    TargetFilename|endswith:
    - \AppData\Local\Temp\system32\winsat.exe
    - \AppData\Local\Temp\system32\winmm.dll
    TargetFilename|startswith: C:\Users\
- condition: 1 of selection*
  selection1:
    TargetFilename|endswith: \AppData\Local\Temp\OskSupport.dll
    TargetFilename|startswith: C:\Users\
  selection2:
    Image: C:\Windows\system32\DllHost.exe
    TargetFilename: C:\Program Files\Windows Media Player\osk.exe
- condition: selection
  selection:
    Image|endswith:
    - \brave.exe
    - \chrome.exe
    - \firefox.exe
    - \iexplore.exe
    - \maxthon.exe
    - \MicrosoftEdge.exe
    - \msedge.exe
    - \msedgewebview2.exe
    - \opera.exe
    - \safari.exe
    - \seamonkey.exe
    - \vivaldi.exe
    - \whale.exe
    TargetFilename|contains: .vhd
- condition: ((selection_wwwroot and selection_ext1) or (selection_static and selection_ext2))
    and not 1 of false_positive*
  false_positive1:
    TargetFilename|contains:
    - \AppData\Local\Temp\
    - \Windows\Temp\
  false_positive_legitimate:
    TargetFilename|contains: \xampp
  false_positive_system:
    Image: System
  selection_ext1:
    TargetFilename|contains:
    - .asp
    - .ashx
    - .ph
  selection_ext2:
    TargetFilename|contains: .ph
  selection_static:
    TargetFilename|contains:
    - \www\
    - \htdocs\
    - \html\
  selection_wwwroot:
    TargetFilename|contains: \inetpub\wwwroot\
- condition: selection and not filter_whitelist
  filter_whitelist:
    TargetFilename|contains:
    - \System32\
    - \SysWOW64\
    - \WinSxS\
  selection:
    TargetFilename|endswith:
    - \WerFault.exe
    - \wer.dll
- condition: system_files and not in_system_folder
  in_system_folder:
    TargetFilename|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  system_files:
    TargetFilename|endswith:
    - WsmPty.xsl
    - WsmTxt.xsl
- condition: selection
  selection:
  - TargetFilename|re: \\Windows\\__1\d{9}\.\d{1,7}$
  - TargetFilename|re: C:\\__1\d{9}\.\d{1,7}$
  - TargetFilename|re: D:\\__1\d{9}\.\d{1,7}$
- condition: selection
  selection:
    Image: System
    TargetFilename|endswith: \wbem\wbemcomn.dll
- condition: selection
  selection:
    Image: C:\WINDOWS\system32\wbem\scrcons.exe
- condition: selection
  selection:
    TargetFilename: C:\Windows\System32\wpbbin.exe
- condition: selection
  selection:
    TargetFilename|contains|all:
    - \\\\127.0.0
    - \ADMIN$\
- condition: to_dll and not 1 of filter*
  filter_empty_source:
    SourceFilename: ''
  filter_from_dll:
  - SourceFilename|endswith:
    - .dll
    - .tmp
  - SourceFilename|contains:
    - .dll.
    - \SquirrelTemp\temp
  filter_non_existing_source:
    SourceFilename: null
  filter_program_files:
    Image|startswith:
    - C:\Program Files (x86)\
    - C:\Program Files\
  filter_tiworker:
    Image|endswith: \TiWorker.exe
    Image|startswith: C:\Windows\WinSxS\
  filter_upgrade:
  - Image: C:\Windows\System32\wuauclt.exe
  - TargetFilename|startswith: C:\$WINDOWS.~BT\Sources\
  to_dll:
    TargetFilename|endswith: .dll
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic:
    TargetFilename|endswith:
    - .tmp
    - .bak
    - .old
    - .orig
    - .backup
    - .temp
  filter_optional_anaconda:
    TargetFilename|endswith: .c~
    TargetFilename|startswith: C:\ProgramData\Anaconda3\
  selection:
    SourceFilename|endswith:
    - .lnk
    - .rtf
    - .pst
    - .docx
    - .xlsx
    - .jpg
    - .jpeg
    - .png
    - .pdf
    TargetFilename|contains:
    - .lnk.
    - .rtf.
    - .pst.
    - .docx.
    - .xlsx.
    - .jpg.
    - .jpeg.
    - .png.
    - .pdf.
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_bgtaskhost:
    Image|endswith: \BackgroundTaskHost.exe
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  filter_optional_devenv:
    Image|endswith: \IDE\devenv.exe
    Image|startswith:
    - C:\Program Files\Microsoft Visual Studio\
    - C:\Program Files (x86)\Microsoft Visual Studio\
  filter_optional_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_optional_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_optional_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_optional_null:
    Image: null
  filter_optional_onedrive:
    Image|endswith: \AppData\Local\Microsoft\OneDrive\OneDrive.exe
  selection:
    ImageLoaded: C:\Windows\System32\MicrosoftAccountTokenProvider.dll
- condition: all of selection_*
  selection_path:
    Image|contains: \AppData\Local\Apps\2.0\
  selection_sig_status:
  - Signed: 'false'
  - SignatureStatus: Expired
- condition: selection
  selection:
    ImageLoaded|contains:
    - \PerfLogs\
    - \ProgramData\
    - \Users\
    - \Windows\Temp\
    - C:\Temp\
    ImageLoaded|endswith:
    - .dll
    - .ocx
    Image|endswith: \cmstp.exe
- condition: selection
  selection:
    ImageLoaded|endswith: \amsi.dll
    Image|endswith:
    - \ExtExport.exe
    - \odbcconf.exe
    - \regsvr32.exe
    - \rundll32.exe
- condition: selection and not 1 of filter_*
  filter_main_dotnet:
    Image|endswith: \ngentask.exe
    Image|startswith:
    - C:\Windows\Microsoft.NET\Framework\
    - C:\Windows\Microsoft.NET\Framework64\
  filter_main_empty:
    Image: ''
  filter_main_exact:
    Image:
    - C:\Windows\explorer.exe
    - C:\Windows\Sysmon64.exe
  filter_main_generic:
    Image|startswith:
    - C:\Program Files (x86)\
    - C:\Program Files\
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  filter_main_null:
    Image: null
  filter_optional_defender:
    Image|endswith: \MsMpEng.exe
    Image|startswith: C:\ProgramData\Microsoft\Windows Defender\Platform\
  selection:
    ImageLoaded|endswith: \amsi.dll
- condition: selection and not filter
  filter:
    ImageLoaded|endswith: \comsvcs.dll
  selection:
    Hashes|contains:
    - IMPHASH=eed93054cb555f3de70eaa9787f32ebb
    - IMPHASH=5e0dbdec1fce52daae251a110b4f309d
    - IMPHASH=eadbccbb324829acb5f2bbe87e5549a8
    - IMPHASH=407ca0f7b523319d758a40d7c0193699
    - IMPHASH=281d618f4e6271e527e6386ea6f748de
    Image|endswith: \rundll32.exe
- condition: selection and not 1 of filter*
  filter_tiworker:
    CommandLine|endswith: \TiWorker.exe -Embedding
    CommandLine|startswith: C:\WINDOWS\winsxs\
  selection:
    ImageLoaded|endswith:
    - \dbghelp.dll
    - \dbgcore.dll
    Image|endswith:
    - \msbuild.exe
    - \cmd.exe
    - \rundll32.exe
    - \winword.exe
    - \excel.exe
    - \powerpnt.exe
    - \outlook.exe
    - \monitoringhost.exe
    - \wmic.exe
    - \bash.exe
    - \wscript.exe
    - \cscript.exe
    - \mshta.exe
    - \dnx.exe
    - \regsvcs.exe
    - \sc.exe
    - \scriptrunner.exe
- condition: selection
  selection:
    ImageLoaded|endswith:
    - \dbghelp.dll
    - \dbgcore.dll
    Signed: 'false'
- condition: selection
  selection:
    ImageLoaded|contains: \AppData\Local\Temp\ba9ea7344a4a5f591d6e5dc32a13494b\
- condition: selection
  selection:
    ImageLoaded|endswith: \sdiageng.dll
    Image|endswith: \msdt.exe
- condition: selection
  selection:
    ImageLoaded|endswith: \System.Drawing.ni.dll
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_dotnet:
    Image|contains:
    - :\Windows\Microsoft.NET\Framework\
    - :\Windows\Microsoft.NET\Framework64\
    Image|endswith: \mscorsvw.exe
  filter_main_generic:
    Image|endswith:
    - :\Program Files\PowerShell\7\pwsh.exe
    - :\Windows\System32\dsac.exe
    - :\WINDOWS\System32\RemoteFXvGPUDisablement.exe
    - :\Windows\System32\runscripthelper.exe
    - :\WINDOWS\System32\sdiagnhost.exe
    - :\Windows\System32\ServerManager.exe
    - :\Windows\System32\SyncAppvPublishingServer.exe
    - :\Windows\System32\WindowsPowerShell\v1.0\powershell_ise.exe
    - :\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
    - :\Windows\System32\winrshost.exe
    - :\Windows\System32\wsmprovhost.exe
    - :\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell_ise.exe
    - :\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe
    - :\Windows\SysWOW64\winrshost.exe
    - :\Windows\SysWOW64\wsmprovhost.exe
  filter_optional_aurora:
    Image: null
  filter_optional_citrix:
    Image|endswith: \Citrix\ConfigSync\ConfigSyncRun.exe
  filter_optional_nextron:
    Image|endswith:
    - \thor64.exe
    - \thor.exe
    Image|startswith: C:\Windows\Temp\asgard2-agent\
  filter_optional_sql_server_mgmt:
    Image|contains:
    - :\Program Files (x86)\Microsoft SQL Server Management Studio
    - :\Program Files\Microsoft SQL Server Management Studio
    Image|endswith: \IDE\Ssms.exe
  filter_optional_sql_server_tools:
    Image|contains:
    - :\Program Files (x86)\Microsoft SQL Server\
    - :\Program Files\Microsoft SQL Server\
    Image|endswith: \Tools\Binn\SQLPS.exe
  filter_optional_vs:
    Image|startswith:
    - C:\Program Files (x86)\Microsoft Visual Studio\
    - C:\Program Files\Microsoft Visual Studio\
  selection:
  - Description: System.Management.Automation
  - OriginalFileName: System.Management.Automation.dll
  - ImageLoaded|endswith:
    - \System.Management.Automation.dll
    - \System.Management.Automation.ni.dll
- condition: selection and not 1 of filter_*
  filter_program_files:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_programdata_packagecache:
    Image|startswith: C:\ProgramData\Package Cache\
  filter_windows:
  - Image:
    - C:\Windows\explorer.exe
    - C:\Windows\ImmersiveControlPanel\SystemSettings.exe
  - Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\Temp\{
    - C:\Windows\WinSxS\
  selection:
    ImageLoaded|endswith: \vssapi.dll
- condition: selection and not 1 of filter_*
  filter_program_files:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_windows:
  - Image:
    - C:\Windows\explorer.exe
    - C:\Windows\ImmersiveControlPanel\SystemSettings.exe
  - Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\Temp\{
    - C:\Windows\WinSxS\
  selection:
    ImageLoaded|endswith: \vsstrace.dll
- condition: selection and not 1 of filter_*
  filter_image_null:
    Image: null
  filter_legit:
    Image|endswith:
    - \clussvc.exe
    - \dismhost.exe
    - \dllhost.exe
    - \inetsrv\appcmd.exe
    - \inetsrv\iissetup.exe
    - \msiexec.exe
    - \rundll32.exe
    - \searchindexer.exe
    - \srtasks.exe
    - \svchost.exe
    - \taskhostw.exe
    - \thor.exe
    - \thor64.exe
    - \tiworker.exe
    - \vssvc.exe
    - \WmiPrvSE.exe
    - \System32\SystemPropertiesAdvanced.exe
    Image|startswith: C:\Windows\
  filter_programfiles:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_update:
    CommandLine|contains: \dismhost.exe {
    CommandLine|startswith: C:\$WinREAgent\Scratch\
  selection:
    ImageLoaded|endswith: \vss_ps.dll
- condition: selection
  selection:
  - Hashes|contains: IMPHASH=330768A4F172E10ACB6287B87289D83B
  - Imphash: 330768a4f172e10acb6287b87289d83b
- condition: selection
  selection:
    Description|contains: st2stager
- condition: selection
  selection:
    ImageLoaded|endswith: \Internet Explorer\iertutil.dll
    Image|endswith: \Internet Explorer\iexplore.exe
- condition: selection
  selection:
    ImageLoaded|startswith: C:\Windows\assembly\
    Image|endswith:
    - \excel.exe
    - \mspub.exe
    - \onenote.exe
    - \onenoteim.exe
    - \outlook.exe
    - \powerpnt.exe
    - \winword.exe
- condition: selection
  selection:
    ImageLoaded|contains: \clr.dll
    Image|endswith:
    - \excel.exe
    - \mspub.exe
    - \outlook.exe
    - \onenote.exe
    - \onenoteim.exe
    - \powerpnt.exe
    - \winword.exe
- condition: selection
  selection:
    ImageLoaded|startswith: C:\Windows\Microsoft.NET\assembly\GAC_MSIL
    Image|endswith:
    - \excel.exe
    - \mspub.exe
    - \onenote.exe
    - \onenoteim.exe
    - \outlook.exe
    - \powerpnt.exe
    - \winword.exe
- condition: selection
  selection:
    ImageLoaded|contains: \dsparse.dll
    Image|endswith:
    - \excel.exe
    - \mspub.exe
    - \onenote.exe
    - \onenoteim.exe
    - \outlook.exe
    - \powerpnt.exe
    - \winword.exe
- condition: selection
  selection:
    ImageLoaded|contains:
    - \Desktop\
    - \Downloads\
    - \Perflogs\
    - \Temp\
    - \Users\Public\
    - \Windows\Tasks\
    ImageLoaded|endswith: .xll
    Image|endswith: \excel.exe
- condition: selection
  selection:
    ImageLoaded|endswith: \kerberos.dll
    Image|endswith:
    - \excel.exe
    - \mspub.exe
    - \onenote.exe
    - \onenoteim.exe
    - \outlook.exe
    - \powerpnt.exe
    - \winword.exe
- condition: selection
  selection:
    ImageLoaded|startswith: \outlvba.dll
    Image|endswith: \outlook.exe
- condition: selection
  selection:
    ImageLoaded|contains:
    - \System.Management.Automation.Dll
    - \System.Management.Automation.ni.Dll
    Image|endswith:
    - \excel.exe
    - \mspub.exe
    - \outlook.exe
    - \onenote.exe
    - \onenoteim.exe
    - \powerpnt.exe
    - \winword.exe
- condition: selection
  selection:
    ImageLoaded|endswith:
    - \VBE7.DLL
    - \VBEUI.DLL
    - \VBE7INTL.DLL
    Image|endswith:
    - \excel.exe
    - \mspub.exe
    - \onenote.exe
    - \onenoteim.exe
    - \outlook.exe
    - \powerpnt.exe
    - \winword.exe
- condition: selection
  selection:
    ImageLoaded|endswith:
    - \vbscript.dll
    - \wbemdisp.dll
    - \wshom.ocx
    - \scrrun.dll
    Image|endswith: \scrcons.exe
- condition: selection and not 1 of filter_main_*
  filter_main_legit_path:
    ImageLoaded|startswith:
    - C:\Program Files (x86)\
    - C:\Program Files\
    Image|startswith:
    - C:\Program Files (x86)\
    - C:\Program Files\
  selection:
    ImageLoaded|endswith: \7za.dll
- condition: selection_dll and 1 of selection_folders_*
  selection_dll:
    ImageLoaded|endswith:
    - \coreclr.dll
    - \facesdk.dll
    - \HPCustPartUI.dll
    - \libcef.dll
    - \ZIPDLL.dll
  selection_folders_1:
    ImageLoaded|contains:
    - :\Perflogs\
    - :\Users\Public\
    - \Temporary Internet
    - \Windows\Temp\
  selection_folders_2:
  - ImageLoaded|contains|all:
    - :\Users\
    - \Favorites\
  - ImageLoaded|contains|all:
    - :\Users\
    - \Favourites\
  - ImageLoaded|contains|all:
    - :\Users\
    - \Contacts\
  - ImageLoaded|contains|all:
    - :\Users\
    - \Pictures\
- condition: (selection_bitdefender and not 1 of filter_log_dll_*) or (selection_fsecure
    and not filter_fsecure) or (selection_mcafee and not filter_mcafee) or (selection_cyberark
    and not filter_cyberark) or (selection_avast and not filter_avast) or (selection_titanium
    and not filter_titanium) or (selection_eset_deslock and not filter_eset_deslock)
  filter_avast:
    ImageLoaded|startswith:
    - C:\program Files\AVAST Software\Avast\
    - C:\program Files (x86)\AVAST Software\Avast\
  filter_cyberark:
    ImageLoaded|startswith:
    - C:\Program Files\CyberArk\Endpoint Privilege Manager\Agent\x32\
    - C:\Program Files (x86)\CyberArk\Endpoint Privilege Manager\Agent\x32\
  filter_eset_deslock:
    ImageLoaded|startswith:
    - C:\program Files\ESET
    - C:\program Files (x86)\ESET
  filter_fsecure:
    ImageLoaded|startswith:
    - C:\Program Files\F-Secure\Anti-Virus\
    - C:\Program Files (x86)\F-Secure\Anti-Virus\
  filter_log_dll_bitdefender:
    ImageLoaded|startswith:
    - C:\Program Files\Bitdefender Antivirus Free\
    - C:\Program Files (x86)\Bitdefender Antivirus Free\
  filter_log_dll_canon:
    ImageLoaded|startswith: C:\Program Files\Canon\MyPrinter\
  filter_log_dll_dell_sar:
    Image: C:\Program Files\Dell\SARemediation\audit\TelemetryUtility.exe
    ImageLoaded:
    - C:\Program Files\Dell\SARemediation\plugin\log.dll
    - C:\Program Files\Dell\SARemediation\audit\log.dll
  filter_mcafee:
    ImageLoaded|startswith:
    - C:\Program Files\McAfee\
    - C:\Program Files (x86)\McAfee\
  filter_titanium:
    ImageLoaded|startswith:
    - C:\program Files\Trend Micro\Titanium\
    - C:\program Files (x86)\Trend Micro\Titanium\
  selection_avast:
    ImageLoaded|endswith: \wsc.dll
  selection_bitdefender:
    ImageLoaded|endswith: \log.dll
  selection_cyberark:
    ImageLoaded|endswith: \vftrace.dll
  selection_eset_deslock:
    ImageLoaded|endswith: \DLPPREM32.dll
  selection_fsecure:
    ImageLoaded|endswith: \qrt.dll
  selection_mcafee:
    ImageLoaded|endswith:
    - \ashldres.dll
    - \lockdown.dll
    - \vsodscpl.dll
  selection_titanium:
    ImageLoaded|endswith: \tmdbglog.dll
- condition: selection and not 1 of filter_main_*
  filter_main_legit_path:
    Image:
    - C:\Windows\SysWOW64\appverif.exe
    - C:\Windows\System32\appverif.exe
    ImageLoaded|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  selection:
    ImageLoaded|endswith: \appverifUI.dll
- condition: selection and not filter
  filter:
    ImageLoaded|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  selection:
    ImageLoaded|endswith:
    - \wtsapi32.dll
    - \msvcr100.dll
    - \msvcp100.dll
    - \dbghelp.dll
    - \dbgcore.dll
    - \wininet.dll
    - \iphlpapi.dll
    - \version.dll
    - \cryptsp.dll
    - \cryptbase.dll
    - \wldp.dll
    - \profapi.dll
    - \sspicli.dll
    - \winsta.dll
    - \dpapi.dll
    Image|endswith: \arubanetsvc.exe
- condition: selection and not 1 of filter_main_*
  filter_main_path:
    Image|endswith:
    - \CCleaner.exe
    - \CCleaner64.exe
    Image|startswith:
    - C:\Program Files\CCleaner\
    - C:\Program Files (x86)\CCleaner\
  selection:
    ImageLoaded|endswith: \CCleanerDU.dll
- condition: selection and not 1 of filter_main_*
  filter_main_path:
    Image|endswith: \CCleanerReactivator.exe
    Image|startswith:
    - C:\Program Files\CCleaner\
    - C:\Program Files (x86)\CCleaner\
  selection:
    ImageLoaded|endswith: \CCleanerReactivator.dll
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_path:
    ImageLoaded|startswith:
    - C:\Program Files\Google\Chrome\Application\
    - C:\Program Files (x86)\Google\Chrome\Application\
  filter_optional_user_path:
    ImageLoaded|contains: \AppData\local\Google\Chrome\Application\
  selection:
    ImageLoaded|endswith: \chrome_frame_helper.dll
- condition: selection_classicexplorer and not filter_classicexplorer
  filter_classicexplorer:
    ImageLoaded|startswith: C:\Program Files\Classic Shell\
  selection_classicexplorer:
    ImageLoaded|endswith: \ClassicExplorer32.dll
- condition: selection
  selection:
    ImageLoaded|endswith: \comctl32.dll
    ImageLoaded|startswith:
    - C:\Windows\System32\logonUI.exe.local\
    - C:\Windows\System32\werFault.exe.local\
    - C:\Windows\System32\consent.exe.local\
    - C:\Windows\System32\narrator.exe.local\
    - C:\windows\system32\wermgr.exe.local\
- condition: selection and not filter
  filter:
    ImageLoaded|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Program Files\Microsoft Silverlight\
    - C:\Program Files (x86)\Microsoft Silverlight\
  selection:
    Image|endswith: \coregen.exe
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic:
    ImageLoaded|startswith:
    - C:\Program Files (x86)\
    - C:\Program Files\
    - C:\Windows\SoftwareDistribution\
    - C:\Windows\System32\
    - C:\Windows\SystemTemp\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  filter_optional_steam:
    ImageLoaded|endswith: \Steam\bin\cef\cef.win7x64\dbgcore.dll
  selection:
    ImageLoaded|endswith: \dbgcore.dll
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic:
    ImageLoaded|startswith:
    - C:\Program Files (x86)\
    - C:\Program Files\
    - C:\Windows\SoftwareDistribution\
    - C:\Windows\System32\
    - C:\Windows\SystemTemp\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  filter_optional_anaconda:
    ImageLoaded|endswith:
    - \Anaconda3\Lib\site-packages\vtrace\platforms\windll\amd64\dbghelp.dll
    - \Anaconda3\Lib\site-packages\vtrace\platforms\windll\i386\dbghelp.dll
  filter_optional_epicgames:
    ImageLoaded|endswith:
    - \Epic Games\Launcher\Engine\Binaries\ThirdParty\DbgHelp\dbghelp.dll
    - \Epic Games\MagicLegends\x86\dbghelp.dll
  selection:
    ImageLoaded|endswith: \dbghelp.dll
- condition: selection and not 1 of filter_main_*
  filter_main_generic:
    ImageLoaded|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C\Windows\WinSxS\
  selection:
    ImageLoaded|endswith: \edputil.dll
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic:
    ImageLoaded|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
    - C:\Windows\SoftwareDistribution\
    - C:\Windows\SystemTemp\
    - C:\$WINDOWS.~BT\
  filter_optional_azure:
    ImageLoaded|startswith: C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\
  filter_optional_checkpoint:
    ImageLoaded|endswith: \PolicyManager.dll
    ImageLoaded|startswith:
    - C:\Program Files\CheckPoint\
    - C:\Program Files (x86)\CheckPoint\
    Image|endswith: \SmartConsole.exe
    Image|startswith:
    - C:\Program Files\CheckPoint\
    - C:\Program Files (x86)\CheckPoint\
  filter_optional_dell:
    ImageLoaded|startswith: C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs
    Image|startswith:
    - C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs
    - C:\Windows\System32\backgroundTaskHost.exe
  filter_optional_dell_wldp:
    Image|endswith: \wldp.dll
    Image|startswith: C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs
  filter_optional_office_appvpolicy:
    Image: C:\Program Files\Common Files\microsoft shared\ClickToRun\OfficeClickToRun.exe
    ImageLoaded: C:\Program Files\Common Files\microsoft shared\ClickToRun\AppVPolicy.dll
  selection:
    ImageLoaded|endswith:
    - \shfolder.dll
    - \activeds.dll
    - \adsldpc.dll
    - \aepic.dll
    - \apphelp.dll
    - \applicationframe.dll
    - \appxalluserstore.dll
    - \appxdeploymentclient.dll
    - \archiveint.dll
    - \atl.dll
    - \audioses.dll
    - \auditpolcore.dll
    - \authfwcfg.dll
    - \authz.dll
    - \avrt.dll
    - \bcd.dll
    - \bcp47langs.dll
    - \bcp47mrm.dll
    - \bcrypt.dll
    - \cabinet.dll
    - \cabview.dll
    - \certenroll.dll
    - \cldapi.dll
    - \clipc.dll
    - \clusapi.dll
    - \cmpbk32.dll
    - \coloradapterclient.dll
    - \colorui.dll
    - \comdlg32.dll
    - \connect.dll
    - \coremessaging.dll
    - \credui.dll
    - \cryptbase.dll
    - \cryptdll.dll
    - \cryptui.dll
    - \cryptxml.dll
    - \cscapi.dll
    - \cscobj.dll
    - \cscui.dll
    - \d2d1.dll
    - \d3d10.dll
    - \d3d10_1.dll
    - \d3d10_1core.dll
    - \d3d10core.dll
    - \d3d10warp.dll
    - \d3d11.dll
    - \d3d12.dll
    - \d3d9.dll
    - \dataexchange.dll
    - \davclnt.dll
    - \dcomp.dll
    - \defragproxy.dll
    - \desktopshellext.dll
    - \deviceassociation.dll
    - \devicecredential.dll
    - \devicepairing.dll
    - \devobj.dll
    - \devrtl.dll
    - \dhcpcmonitor.dll
    - \dhcpcsvc.dll
    - \dhcpcsvc6.dll
    - \directmanipulation.dll
    - \dismapi.dll
    - \dismcore.dll
    - \dmcfgutils.dll
    - \dmcmnutils.dll
    - \dmenrollengine.dll
    - \dmenterprisediagnostics.dll
    - \dmiso8601utils.dll
    - \dmoleaututils.dll
    - \dmprocessxmlfiltered.dll
    - \dmpushproxy.dll
    - \dmxmlhelputils.dll
    - \dnsapi.dll
    - \dot3api.dll
    - \dot3cfg.dll
    - \drprov.dll
    - \dsclient.dll
    - \dsparse.dll
    - \dsreg.dll
    - \dsrole.dll
    - \dui70.dll
    - \duser.dll
    - \dusmapi.dll
    - \dwmapi.dll
    - \dwrite.dll
    - \dxgi.dll
    - \dxva2.dll
    - \eappcfg.dll
    - \eappprxy.dll
    - \edputil.dll
    - \efsadu.dll
    - \efsutil.dll
    - \esent.dll
    - \execmodelproxy.dll
    - \explorerframe.dll
    - \fastprox.dll
    - \faultrep.dll
    - \fddevquery.dll
    - \feclient.dll
    - \fhcfg.dll
    - \firewallapi.dll
    - \flightsettings.dll
    - \fltlib.dll
    - \fveapi.dll
    - \fwbase.dll
    - \fwcfg.dll
    - \fwpolicyiomgr.dll
    - \fwpuclnt.dll
    - \getuname.dll
    - \hid.dll
    - \hnetmon.dll
    - \httpapi.dll
    - \idstore.dll
    - \ieadvpack.dll
    - \iedkcs32.dll
    - \iertutil.dll
    - \ifmon.dll
    - \iphlpapi.dll
    - \iri.dll
    - \iscsidsc.dll
    - \iscsium.dll
    - \isv.exe_rsaenh.dll
    - \joinutil.dll
    - \ksuser.dll
    - \ktmw32.dll
    - \licensemanagerapi.dll
    - \licensingdiagspp.dll
    - \linkinfo.dll
    - \loadperf.dll
    - \logoncli.dll
    - \logoncontroller.dll
    - \lpksetupproxyserv.dll
    - \magnification.dll
    - \mapistub.dll
    - \mfcore.dll
    - \mfplat.dll
    - \mi.dll
    - \midimap.dll
    - \miutils.dll
    - \mlang.dll
    - \mmdevapi.dll
    - \mobilenetworking.dll
    - \mpr.dll
    - \mprapi.dll
    - \mrmcorer.dll
    - \msacm32.dll
    - \mscms.dll
    - \mscoree.dll
    - \msctf.dll
    - \msctfmonitor.dll
    - \msdrm.dll
    - \msftedit.dll
    - \msi.dll
    - \msutb.dll
    - \mswb7.dll
    - \mswsock.dll
    - \msxml3.dll
    - \mtxclu.dll
    - \napinsp.dll
    - \ncrypt.dll
    - \ndfapi.dll
    - \netid.dll
    - \netiohlp.dll
    - \netplwiz.dll
    - \netprofm.dll
    - \netsetupapi.dll
    - \netshell.dll
    - \netutils.dll
    - \networkexplorer.dll
    - \newdev.dll
    - \ninput.dll
    - \nlaapi.dll
    - \nlansp_c.dll
    - \npmproxy.dll
    - \nshhttp.dll
    - \nshipsec.dll
    - \nshwfp.dll
    - \ntdsapi.dll
    - \ntlanman.dll
    - \ntlmshared.dll
    - \ntmarta.dll
    - \ntshrui.dll
    - \oleacc.dll
    - \omadmapi.dll
    - \onex.dll
    - \osbaseln.dll
    - \osuninst.dll
    - \p2p.dll
    - \p2pnetsh.dll
    - \p9np.dll
    - \pcaui.dll
    - \pdh.dll
    - \peerdistsh.dll
    - \pla.dll
    - \pnrpnsp.dll
    - \policymanager.dll
    - \polstore.dll
    - \printui.dll
    - \propsys.dll
    - \prvdmofcomp.dll
    - \puiapi.dll
    - \radcui.dll
    - \rasapi32.dll
    - \rasgcw.dll
    - \rasman.dll
    - \rasmontr.dll
    - \reagent.dll
    - \regapi.dll
    - \resutils.dll
    - \rmclient.dll
    - \rpcnsh.dll
    - \rsaenh.dll
    - \rtutils.dll
    - \rtworkq.dll
    - \samcli.dll
    - \samlib.dll
    - \sapi_onecore.dll
    - \sas.dll
    - \scansetting.dll
    - \scecli.dll
    - \schedcli.dll
    - \secur32.dll
    - \shell32.dll
    - \slc.dll
    - \snmpapi.dll
    - \spp.dll
    - \sppc.dll
    - \srclient.dll
    - \srpapi.dll
    - \srvcli.dll
    - \ssp.exe_rsaenh.dll
    - \ssp_isv.exe_rsaenh.dll
    - \sspicli.dll
    - \ssshim.dll
    - \staterepository.core.dll
    - \structuredquery.dll
    - \sxshared.dll
    - \tapi32.dll
    - \tbs.dll
    - \tdh.dll
    - \tquery.dll
    - \tsworkspace.dll
    - \ttdrecord.dll
    - \twext.dll
    - \twinapi.dll
    - \twinui.appcore.dll
    - \uianimation.dll
    - \uiautomationcore.dll
    - \uireng.dll
    - \uiribbon.dll
    - \updatepolicy.dll
    - \userenv.dll
    - \utildll.dll
    - \uxinit.dll
    - \uxtheme.dll
    - \vaultcli.dll
    - \virtdisk.dll
    - \vssapi.dll
    - \vsstrace.dll
    - \wbemprox.dll
    - \wbemsvc.dll
    - \wcmapi.dll
    - \wcnnetsh.dll
    - \wdi.dll
    - \wdscore.dll
    - \webservices.dll
    - \wecapi.dll
    - \wer.dll
    - \wevtapi.dll
    - \whhelper.dll
    - \wimgapi.dll
    - \winbrand.dll
    - \windows.storage.dll
    - \windows.storage.search.dll
    - \windowscodecs.dll
    - \windowscodecsext.dll
    - \windowsudk.shellcommon.dll
    - \winhttp.dll
    - \wininet.dll
    - \winipsec.dll
    - \winmde.dll
    - \winmm.dll
    - \winnsi.dll
    - \winrnr.dll
    - \winsqlite3.dll
    - \winsta.dll
    - \wkscli.dll
    - \wlanapi.dll
    - \wlancfg.dll
    - \wldp.dll
    - \wlidprov.dll
    - \wmiclnt.dll
    - \wmidcom.dll
    - \wmiutils.dll
    - \wmsgapi.dll
    - \wofutil.dll
    - \wpdshext.dll
    - \wshbth.dll
    - \wshelper.dll
    - \wtsapi32.dll
    - \wwapi.dll
    - \xmllite.dll
    - \xolehlp.dll
    - \xwizards.dll
    - \xwtpw32.dll
    - \aclui.dll
    - \bderepair.dll
    - \bootmenuux.dll
    - \dcntel.dll
    - \dwmcore.dll
    - \dynamoapi.dll
    - \fhsvcctl.dll
    - \fxsst.dll
    - \inproclogger.dll
    - \iumbase.dll
    - \kdstub.dll
    - \maintenanceui.dll
    - \mdmdiagnostics.dll
    - \mintdh.dll
    - \msdtctm.dll
    - \nettrace.dll
    - \osksupport.dll
    - \reseteng.dll
    - \resetengine.dll
    - \spectrumsyncclient.dll
    - \srcore.dll
    - \systemsettingsthresholdadminflowui.dll
    - \timesync.dll
    - \upshared.dll
    - \wmpdui.dll
    - \wwancfg.dll
    - \dpx.dll
    - \fxsapi.dll
    - \fxstiff.dll
    - \xpsservices.dll
    - \appvpolicy.dll
    - \batmeter.dll
    - \bootux.dll
    - \cmutil.dll
    - \configmanager2.dll
    - \coredplus.dll
    - \coreuicomponents.dll
    - \cryptsp.dll
    - \dmcommandlineutils.dll
    - \drvstore.dll
    - \dsprop.dll
    - \dxcore.dll
    - \edgeiso.dll
    - \framedynos.dll
    - \fveskybackup.dll
    - \fvewiz.dll
    - \gpapi.dll
    - \icmp.dll
    - \ifsutil.dll
    - \iumsdk.dll
    - \lockhostingframework.dll
    - \lrwizdll.dll
    - \mbaexmlparser.dll
    - \mfc42u.dll
    - \msiso.dll
    - \msvcp110_win.dll
    - \netapi32.dll
    - \netjoin.dll
    - \netprovfw.dll
    - \opcservices.dll
    - \pkeyhelper.dll
    - \playsndsrv.dll
    - \powrprof.dll
    - \prntvpt.dll
    - \profapi.dll
    - \proximitycommon.dll
    - \proximityservicepal.dll
    - \rasdlg.dll
    - \security.dll
    - \sppcext.dll
    - \srmtrace.dll
    - \tpmcoreprovisioning.dll
    - \umpdc.dll
    - \unattend.dll
    - \urlmon.dll
    - \vdsutil.dll
    - \version.dll
    - \winbio.dll
    - \windows.ui.immersive.dll
    - \winscard.dll
    - \winsync.dll
    - \wscapi.dll
    - \wsmsvc.dll
    - \FxsCompose.dll
    - \WfsR.dll
    - \rpchttp.dll
    - \storageusage.dll
    - \amsi.dll
    - \PrintIsolationProxy.dll
    - \msdtcVSp1res.dll
    - \rdpendp.dll
    - \dxilconv.dll
    - \utcutil.dll
    - \appraiser.dll
    - \dsound.dll
    - \DispBroker.dll
    - \FXSRESM.DLL
    - \cryptnet.dll
    - \COMRES.DLL
    - \igdumdim64.dll
    - \igd10iumd64.dll
    - \igd12umd64.dll
    - \igdusc64.dll
    - \WLBSCTRL.dll
    - \TSMSISrv.dll
    - \TSVIPSrv.dll
    - \wow64log.dll
    - \WptsExtensions.dll
    - \wbemcomn.dll
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic:
    ImageLoaded|startswith:
    - C:\Program Files (x86)\
    - C:\Program Files\
  filter_optional_dropbox_installer_temp:
    ImageLoaded|contains|all:
    - \AppData\Local\Temp\GUM
    - .tmp\\goopdate.dll
    Image|contains|all:
    - \AppData\Local\Temp\GUM
    - .tmp\Dropbox
  selection:
    ImageLoaded|endswith: \goopdate.dll
- condition: selection and not 1 of filter_main_*
  filter_main_notepad_plusplus:
    Image|endswith: \Notepad++\updater\GUP.exe
  selection:
    ImageLoaded|endswith: \libcurl.dll
    Image|endswith: \gup.exe
- condition: selection and not filter
  filter:
    ImageLoaded|startswith:
    - C:\Program Files (x86)\Windows Kits\
    - C:\Program Files\Windows Kits\
  selection:
    ImageLoaded|endswith: \iviewers.dll
- condition: selection and not filter
  filter:
    ImageLoaded|startswith: C:\Program Files\Common Files\Justsystem\JsSchHlp\
  selection:
    ImageLoaded|endswith: \JSESPR.dll
- condition: selection and not 1 of filter_main_*
  filter_main_vlc:
    ImageLoaded|startswith:
    - C:\Program Files (x86)\VideoLAN\VLC\
    - C:\Program Files\VideoLAN\VLC\
  selection:
    ImageLoaded|endswith: \libvlc.dll
- condition: selection and not 1 of filter_*
  filter_ms_signed:
    Signature: Microsoft Windows
    Signed: 'true'
  selection:
    ImageLoaded:
    - C:\Windows\System32\WLBSCTRL.dll
    - C:\Windows\System32\TSMSISrv.dll
    - C:\Windows\System32\TSVIPSrv.dll
    - C:\Windows\System32\wow64log.dll
    - C:\Windows\System32\WptsExtensions.dll
    - C:\Windows\System32\wbem\wbemcomn.dll
- condition: selection and not filter
  filter:
    ImageLoaded|startswith:
    - C:\Program Files\Microsoft Office\OFFICE
    - C:\Program Files (x86)\Microsoft Office\OFFICE
    - C:\Program Files\Microsoft Office\Root\OFFICE
    - C:\Program Files (x86)\Microsoft Office\Root\OFFICE
  selection:
    ImageLoaded|endswith: \outllib.dll
- condition: selection and not filter
  filter:
    ImageLoaded|startswith:
    - C:\Program Files (x86)\Microsoft Visual Studio\
    - C:\Program Files (x86)\Windows Kits\
  selection:
    ImageLoaded|endswith: \rcdll.dll
- condition: selection
  selection:
    Image: C:\Windows\System32\SystemResetPlatform\SystemResetPlatform.exe
    ImageLoaded: C:\$SysReset\Framework\Stack\RjvPlatform.dll
- condition: selection and not 1 of filter_main_*
  filter_main_legit_path:
    Image|startswith: C:\Windows\System32\SystemResetPlatform\
  selection:
    Image: \SystemResetPlatform.exe
    ImageLoaded|endswith: \RjvPlatform.dll
- condition: selection and not 1 of filter_main_*
  filter_main_path:
    Image|endswith:
    - \robotaskbaricon.exe
    - \robotaskbaricon-x64.exe
    Image|startswith:
    - ' C:\Program Files (x86)\Siber Systems\AI RoboForm\'
    - ' C:\Program Files\Siber Systems\AI RoboForm\'
  selection:
    ImageLoaded|endswith:
    - \roboform.dll
    - \roboform-x64.dll
- condition: selection and not 1 of filter_main_*
  filter_main_legit_path:
  - ImageLoaded|contains|all:
    - :\Users\
    - \AppData\Local\Temp\
  - ImageLoaded|contains: :\Windows\Temp\
  selection:
    ImageLoaded|endswith: \ShellDispatch.dll
- condition: selection
  selection:
    ImageLoaded|endswith: \ShellChromeAPI.dll
- condition: selection and not 1 of filter_main_*
  filter_main_legit_path:
    Image:
    - C:\Program Files (x86)\SMADAV\SmadavProtect32.exe
    - C:\Program Files (x86)\SMADAV\SmadavProtect64.exe
    - C:\Program Files\SMADAV\SmadavProtect32.exe
    - C:\Program Files\SMADAV\SmadavProtect64.exe
    ImageLoaded|startswith:
    - C:\Program Files (x86)\SMADAV\
    - C:\Program Files\SMADAV\
  selection:
    ImageLoaded|endswith:
    - \SmadHook32c.dll
    - \SmadHook64c.dll
- condition: selection and not 1 of filter_main_*
  filter_main_path:
    ImageLoaded|startswith:
    - C:\Program Files (x86)\SolidDocuments\SolidPDFCreator\
    - C:\Program Files\SolidDocuments\SolidPDFCreator\
    Image|endswith: \SolidPDFCreator.exe
  selection:
    ImageLoaded|endswith: \SolidPDFCreator.dll
- condition: selection and not filter
  filter:
    ImageLoaded|startswith: C:\Windows\WinSxS\
  selection:
    ImageLoaded|endswith:
    - \tsmsisrv.dll
    - \tsvipsrv.dll
    - \wlbsctrl.dll
    Image|endswith: \svchost.exe
- condition: (selection_lenovo and not filter_lenovo) or (selection_toshiba and not
    filter_toshiba)
  filter_lenovo:
  - ImageLoaded|contains: \AppData\local\Google\Chrome\Application\
  - ImageLoaded|startswith:
    - C:\Program Files\Lenovo\Communications Utility\
    - C:\Program Files (x86)\Lenovo\Communications Utility\
  filter_toshiba:
    ImageLoaded|startswith:
    - C:\Program Files\Toshiba\Bluetooth Toshiba Stack\
    - C:\Program Files (x86)\Toshiba\Bluetooth Toshiba Stack\
  selection_lenovo:
    ImageLoaded|endswith: \commfunc.dll
  selection_toshiba:
    ImageLoaded|endswith: \tosbtkbd.dll
- condition: selection and not filter
  filter:
    ImageLoaded|startswith: C:\Windows\WinSxS\
  selection:
    ImageLoaded|endswith: ualapi.dll
    Image|endswith: \fxssvc.exe
- condition: selection and not filter
  filter:
    Signed: 'true'
  selection:
    ImageLoaded|contains|all:
    - \VMware\VMware Tools\vmStatsProvider\win32
    - \vmGuestLib.dll
    Image|endswith: \Windows\System32\wbem\WmiApSrv.exe
- condition: selection and not filter
  filter:
    ImageLoaded|startswith: C:\Program Files\VMware\
  selection:
    ImageLoaded|endswith: \glib-2.0.dll
    Image|endswith: \VMwareXferlogs.exe
- condition: selection and not 1 of filter_main_*
  filter_main_legit_path:
    Image:
    - C:\Program Files (x86)\Nero\Nero Apps\Nero WaveEditor\waveedit.exe
    - C:\Program Files\Nero\Nero Apps\Nero WaveEditor\waveedit.exe
    ImageLoaded|startswith:
    - C:\Program Files (x86)\Nero\Nero Apps\Nero WaveEditor\
    - C:\Program Files\Nero\Nero Apps\Nero WaveEditor\
  selection:
    ImageLoaded|endswith: \waveedit.dll
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic:
    ImageLoaded|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_optional_mingw64:
    ImageLoaded|contains:
    - \AppData\Local\
    - \ProgramData\
    ImageLoaded|endswith: \mingw64\bin\libwinpthread-1.dll
  selection:
    ImageLoaded|endswith:
    - \libwazuhshared.dll
    - \libwinpthread-1.dll
- condition: selection and not filter
  filter:
    ImageLoaded|startswith:
    - C:\Program Files\Windows Defender\
    - C:\Program Files (x86)\Windows Defender\
    - C:\ProgramData\Microsoft\Windows Defender\Platform\
  selection:
    ImageLoaded|endswith: \mpclient.dll
    Image|endswith:
    - \MpCmdRun.exe
    - \NisSrv.exe
- condition: selection and not 1 of filter_main_*
  filter_main_path:
    ImageLoaded|startswith:
    - C:\Program Files (x86)\Microsoft Office\
    - C:\Program Files\Microsoft Office\
    Image|endswith: \winword.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft Office\
    - C:\Program Files\Microsoft Office\
  selection:
    ImageLoaded|endswith: \wwlib.dll
- condition: selection
  selection:
    ImageLoaded|contains:
    - \Windows\System32\spool\drivers\x64\3\
    - \Windows\System32\spool\drivers\x64\4\
    ImageLoaded|endswith: .dll
    Image|endswith: \spoolsv.exe
- condition: selection
  selection:
    ImageLoaded|startswith:
    - C:\Users\Public\
    - C:\PerfLogs\
    Image|startswith: C:\Windows\
- condition: selection and not 1 of filter_*
  filter_aurora:
    Image: null
  filter_generic:
  - Image|contains: Python
  - Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\ProgramData\Anaconda3\
  selection:
    Description: Python Core
- condition: selection
  selection:
    ImageLoaded|endswith:
    - \clr.dll
    - \mscoree.dll
    - \mscorlib.dll
    Image|endswith:
    - \cmstp.exe
    - \cscript.exe
    - \mshta.exe
    - \msxsl.exe
    - \regsvr32.exe
    - \wmic.exe
    - \wscript.exe
- condition: selection
  selection:
    ImageLoaded|endswith:
    - \samlib.dll
    - \WinSCard.dll
    Image|endswith: \notepad.exe
- condition: selection
  selection:
    ImageLoaded|endswith:
    - \ttdrecord.dll
    - \ttdwriter.dll
    - \ttdloader.dll
- condition: selection and not filter
  filter:
    ImageLoaded|contains|all:
    - C:\Windows\
    - iscsiexe.dll
  selection:
    Image: C:\Windows\SysWOW64\iscsicpl.exe
    ImageLoaded|endswith: \iscsiexe.dll
- condition: selection and not filter
  filter:
    ImageLoaded: C:\Windows\System32\Dism\dismcore.dll
  selection:
    ImageLoaded|endswith: \dismcore.dll
    Image|endswith: \dism.exe
- condition: selection and not 1 of filter_*
  filter_contains:
    Image|contains: \AppData\Local\Microsoft\OneDrive\
    Image|startswith: C:\Users\
  filter_end:
    Image|endswith:
    - \opera_autoupdate.exe
    - \procexp64.exe
    - \procexp.exe
  filter_full:
    Image:
    - C:\Windows\ImmersiveControlPanel\SystemSettings.exe
    - C:\Windows\explorer.exe
  filter_regedit:
    Image: C:\Windows\regedit.exe
  filter_spotify_aurora:
    CommandLine|contains: C:\Program Files\WindowsApps\SpotifyAB.SpotifyMusic_
    Provider_Name: Microsoft-Windows-Kernel-Process
  filter_start:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_user:
    Image|endswith:
    - \AppData\Roaming\Spotify\Spotify.exe
    - \AppData\Local\Microsoft\Teams\current\Teams.exe
    - \AppData\Local\Microsoft\Teams\stage\Teams.exe
    Image|startswith: C:\Users\
  selection:
  - ImageLoaded|endswith:
    - \credui.dll
    - \wincredui.dll
  - OriginalFileName:
    - credui.dll
    - wincredui.dll
- condition: selection
  selection:
    Image|endswith: \lsass.exe
    Signed: 'false'
- condition: selection
  selection:
    ImageLoaded|endswith:
    - \jscript.dll
    - \vbscript.dll
    Image|endswith: \wmic.exe
- condition: selection
  selection:
    ImageLoaded|endswith: \wbem\wbemcomn.dll
    Image|endswith: \wmiprvse.exe
- condition: selection and not filter and not filter_generic
  filter:
    Image|endswith:
    - \WmiPrvSE.exe
    - \WmiApSrv.exe
    - \svchost.exe
    - \DeviceCensus.exe
    - \CompatTelRunner.exe
    - \sdiagnhost.exe
    - \SIHClient.exe
    - \ngentask.exe
    - \windows\system32\taskhostw.exe
    - \windows\system32\MoUsoCoreWorker.exe
    - \windows\system32\wbem\WMIADAP.exe
    - C:\Windows\Sysmon64.exe
    - C:\Windows\Sysmon.exe
    - C:\Windows\System32\wbem\unsecapp.exe
    - \logman.exe
    - \systeminfo.exe
    - \nvcontainer.exe
    - C:\Windows\System32\wbem\WMIC.exe
    - \explorer.exe
    - \opera_autoupdate.exe
    - \MsMpEng.exe
    - \thor64.exe
    - \thor.exe
  filter_generic:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  selection:
    ImageLoaded|endswith:
    - \wmiclnt.dll
    - \WmiApRpl.dll
    - \wmiprov.dll
    - \wmiutils.dll
    - \wbemcomn.dll
    - \wbemprox.dll
    - \WMINet_Utils.dll
    - \wbemsvc.dll
    - \fastprox.dll
- condition: selection
  selection:
    Image: C:\Windows\System32\wbem\WmiPrvSE.exe
    ImageLoaded|endswith: \wbemcons.dll
- commandline_null:
    CommandLine: null
  condition: ( request_client or respond_server ) and not 1 of filter* and not ( svchost
    and commandline_null )
  filter_citrix:
    Image|startswith: C:\Program Files\Citrix\
  filter_general:
    Image|endswith:
    - \powershell.exe
    - C:\Windows\System32\sdiagnhost.exe
    - C:\Windows\System32\services.exe
  filter_mscorsvw:
    Image|endswith: \mscorsvw.exe
    Image|startswith:
    - C:\Windows\Microsoft.NET\Framework64\v
    - C:\Windows\Microsoft.NET\Framework\v
  filter_nextron:
    Image|startswith: C:\Windows\Temp\asgard2-agent\
  filter_ps_ise:
    Image|endswith: \powershell_ise.exe
  filter_svchost:
    CommandLine|contains:
    - svchost.exe -k netsvcs -p -s BITS
    - svchost.exe -k GraphicsPerfSvcGroup -s GraphicsPerfSvc
    - svchost.exe -k NetworkService -p -s Wecsvc
    - svchost.exe -k netsvcs
  filter_svr_2019:
    Image:
    - C:\Windows\System32\Configure-SMRemoting.exe
    - C:\Windows\System32\ServerManager.exe
  filter_upgrade:
    Image|startswith: C:\$WINDOWS.~BT\Sources\
  request_client:
  - ImageLoaded|endswith:
    - \WsmSvc.dll
    - \WsmAuto.dll
    - \Microsoft.WSMan.Management.ni.dll
  - OriginalFileName:
    - WsmSvc.dll
    - WSMANAUTOMATION.DLL
    - Microsoft.WSMan.Management.dll
  respond_server:
    Image|endswith: \svchost.exe
    OriginalFileName: WsmWmiPl.dll
  svchost:
    Image|endswith: \svchost.exe
- condition: all of selection_*
  selection_domains:
    DestinationHostname|endswith:
    - .ghostbin.co
    - .githubusercontent.com
    - .hastebin.com
    - .paste.ee
    - .pastebin.com
    - anonfiles.com
    - cdn.discordapp.com
    - ddns.net
    - dl.dropboxusercontent.com
    - mediafire.com
    - mega.nz
    - paste.ee
    - pastebin.pl
    - pastetext.net
    - privatlab.com
    - privatlab.net
    - send.exploit.in
    - sendspace.com
    - transfer.sh
    - ufile.io
    Initiated: 'true'
  selection_paths:
  - Image|startswith:
    - C:\PerfLogs
    - C:\Temp\
    - C:\Users\Public\
    - C:\Windows\
  - Image|contains: \AppData\Temp\
- condition: selection
  selection:
    DestinationPort:
    - 80
    - 135
    - 443
    - 445
    Image|endswith: \certutil.exe
    Initiated: 'true'
- condition: selection
  selection:
    DestinationHostname:
    - alimabi.cn
    - ap.luckpool.net
    - bcn.pool.minergate.com
    - bcn.vip.pool.minergate.com
    - bohemianpool.com
    - ca.minexmr.com
    - ca.monero.herominers.com
    - cbd.monerpool.org
    - cbdv2.monerpool.org
    - cryptmonero.com
    - crypto-pool.fr
    - crypto-pool.info
    - cryptonight-hub.miningpoolhub.com
    - d1pool.ddns.net
    - d5pool.us
    - daili01.monerpool.org
    - de.minexmr.com
    - dl.nbminer.com
    - donate.graef.in
    - donate.ssl.xmrig.com
    - donate.v2.xmrig.com
    - donate.xmrig.com
    - donate2.graef.in
    - drill.moneroworld.com
    - dwarfpool.com
    - emercoin.com
    - emercoin.net
    - emergate.net
    - ethereumpool.co
    - eu.luckpool.net
    - eu.minerpool.pw
    - fcn-xmr.pool.minergate.com
    - fee.xmrig.com
    - fr.minexmr.com
    - hellominer.com
    - herominers.com
    - huadong1-aeon.ppxxmr.com
    - iwanttoearn.money
    - jw-js1.ppxxmr.com
    - koto-pool.work
    - lhr.nbminer.com
    - lhr3.nbminer.com
    - linux.monerpool.org
    - lokiturtle.herominers.com
    - luckpool.net
    - masari.miner.rocks
    - mine.c3pool.com
    - mine.moneropool.com
    - mine.ppxxmr.com
    - mine.zpool.ca
    - mine1.ppxxmr.com
    - minemonero.gq
    - miner.ppxxmr.com
    - miner.rocks
    - minercircle.com
    - minergate.com
    - minerpool.pw
    - minerrocks.com
    - miners.pro
    - minerxmr.ru
    - minexmr.cn
    - minexmr.com
    - mining-help.ru
    - miningpoolhub.com
    - mixpools.org
    - moner.monerpool.org
    - moner1min.monerpool.org
    - monero-master.crypto-pool.fr
    - monero.crypto-pool.fr
    - monero.hashvault.pro
    - monero.herominers.com
    - monero.lindon-pool.win
    - monero.miners.pro
    - monero.riefly.id
    - monero.us.to
    - monerocean.stream
    - monerogb.com
    - monerohash.com
    - moneroocean.stream
    - moneropool.com
    - moneropool.nl
    - monerorx.com
    - monerpool.org
    - moriaxmr.com
    - mro.pool.minergate.com
    - multipool.us
    - myxmr.pw
    - na.luckpool.net
    - nanopool.org
    - nbminer.com
    - node3.luckpool.net
    - noobxmr.com
    - pangolinminer.comgandalph3000.com
    - pool.4i7i.com
    - pool.armornetwork.org
    - pool.cortins.tk
    - pool.gntl.co.uk
    - pool.hashvault.pro
    - pool.minergate.com
    - pool.minexmr.com
    - pool.monero.hashvault.pro
    - pool.ppxxmr.com
    - pool.somec.cc
    - pool.support
    - pool.supportxmr.com
    - pool.usa-138.com
    - pool.xmr.pt
    - pool.xmrfast.com
    - pool2.armornetwork.org
    - poolchange.ppxxmr.com
    - pooldd.com
    - poolmining.org
    - poolto.be
    - ppxvip1.ppxxmr.com
    - ppxxmr.com
    - prohash.net
    - r.twotouchauthentication.online
    - randomx.xmrig.com
    - ratchetmining.com
    - seed.emercoin.com
    - seed.emercoin.net
    - seed.emergate.net
    - seed1.joulecoin.org
    - seed2.joulecoin.org
    - seed3.joulecoin.org
    - seed4.joulecoin.org
    - seed5.joulecoin.org
    - seed6.joulecoin.org
    - seed7.joulecoin.org
    - seed8.joulecoin.org
    - sg.minexmr.com
    - sheepman.mine.bz
    - siamining.com
    - sumokoin.minerrocks.com
    - supportxmr.com
    - suprnova.cc
    - teracycle.net
    - trtl.cnpool.cc
    - trtl.pool.mine2gether.com
    - turtle.miner.rocks
    - us-west.minexmr.com
    - usxmrpool.com
    - viaxmr.com
    - webservicepag.webhop.net
    - xiazai.monerpool.org
    - xiazai1.monerpool.org
    - xmc.pool.minergate.com
    - xmo.pool.minergate.com
    - xmr-asia1.nanopool.org
    - xmr-au1.nanopool.org
    - xmr-eu1.nanopool.org
    - xmr-eu2.nanopool.org
    - xmr-jp1.nanopool.org
    - xmr-us-east1.nanopool.org
    - xmr-us-west1.nanopool.org
    - xmr-us.suprnova.cc
    - xmr-usa.dwarfpool.com
    - xmr.2miners.com
    - xmr.5b6b7b.ru
    - xmr.alimabi.cn
    - xmr.bohemianpool.com
    - xmr.crypto-pool.fr
    - xmr.crypto-pool.info
    - xmr.f2pool.com
    - xmr.hashcity.org
    - xmr.hex7e4.ru
    - xmr.ip28.net
    - xmr.monerpool.org
    - xmr.mypool.online
    - xmr.nanopool.org
    - xmr.pool.gntl.co.uk
    - xmr.pool.minergate.com
    - xmr.poolto.be
    - xmr.ppxxmr.com
    - xmr.prohash.net
    - xmr.simka.pw
    - xmr.somec.cc
    - xmr.suprnova.cc
    - xmr.usa-138.com
    - xmr.vip.pool.minergate.com
    - xmr1min.monerpool.org
    - xmrf.520fjh.org
    - xmrf.fjhan.club
    - xmrfast.com
    - xmrigcc.graef.in
    - xmrminer.cc
    - xmrpool.de
    - xmrpool.eu
    - xmrpool.me
    - xmrpool.net
    - xmrpool.xyz
    - xx11m.monerpool.org
    - xx11mv2.monerpool.org
    - xxx.hex7e4.ru
    - zarabotaibitok.ru
    - zer0day.ru
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_avant:
    Image|endswith: \avant.exe
    Image|startswith:
    - C:\Program Files (x86)\Avant Browser\
    - C:\Program Files\Avant Browser\
  filter_main_brave:
    Image|endswith: \brave.exe
    Image|startswith: C:\Program Files\BraveSoftware\
  filter_main_chrome:
    Image:
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  filter_main_discord:
    Image|contains: \AppData\Local\Discord\
    Image|endswith: \Discord.exe
  filter_main_dropbox:
    Image|endswith: \Dropbox.exe
    Image|startswith:
    - C:\Program Files (x86)\Dropbox\Client\
    - C:\Program Files\Dropbox\Client\
  filter_main_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_main_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_main_falkon:
    Image|endswith: \falkon.exe
    Image|startswith:
    - C:\Program Files\Falkon\
    - C:\Program Files (x86)\Falkon\
  filter_main_firefox:
    Image:
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  filter_main_flock:
    Image|contains: \AppData\Local\Flock\
    Image|endswith: \Flock.exe
  filter_main_googledrive:
    Image|endswith: GoogleDriveFS.exe
    Image|startswith:
    - C:\Program Files\Google\Drive File Stream\
    - C:\Program Files (x86)\Google\Drive File Stream\
  filter_main_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_main_maxthon:
    Image|contains: \AppData\Local\Maxthon\
    Image|endswith: \maxthon.exe
  filter_main_mega:
    Image|contains: \AppData\Local\MEGAsync\
    Image|endswith: MEGAsync.exe
  filter_main_midori:
    Image|contains: \AppData\Local\Programs\midori-ng\
    Image|endswith: \Midori Next Generation.exe
  filter_main_onedrive:
    Image|contains: \AppData\Local\Microsoft\OneDrive\
    Image|endswith: \OneDrive.exe
  filter_main_opera:
    Image|contains: \AppData\Local\Programs\Opera\
    Image|endswith: \opera.exe
  filter_main_phoebe:
    Image|contains: \AppData\Local\Phoebe\
    Image|endswith: \Phoebe.exe
  filter_main_qtweb:
    Image|endswith: \QtWeb.exe
    Image|startswith:
    - C:\Program Files (x86)\QtWeb\
    - C:\Program Files\QtWeb\
  filter_main_safari:
    Image|endswith: \safari.exe
  filter_main_seamonkey:
    Image|endswith: \seamonkey.exe
    Image|startswith:
    - C:\Program Files\SeaMonkey\
    - C:\Program Files (x86)\SeaMonkey\
  filter_main_slimbrowser:
    Image|endswith: \slimbrowser.exe
    Image|startswith:
    - C:\Program Files\SlimBrowser\
    - C:\Program Files (x86)\SlimBrowser\
  filter_main_telegram:
    Image|contains: \AppData\Roaming\Telegram Desktop\
    Image|endswith: \Telegram.exe
  filter_main_tor:
    Image|contains: \Tor Browser\
  filter_main_vivaldi:
    Image|contains: \AppData\Local\Vivaldi\
    Image|endswith: \vivaldi.exe
  filter_main_whale:
    Image|endswith: \whale.exe
    Image|startswith:
    - C:\Program Files\Naver\Naver Whale\
    - C:\Program Files (x86)\Naver\Naver Whale\
  filter_main_whaterfox:
    Image|endswith: \Waterfox.exe
    Image|startswith:
    - C:\Program Files\Waterfox\
    - C:\Program Files (x86)\Waterfox\
  filter_main_whatsapp:
    Image|endswith: WhatsApp.exe
    Image|startswith:
    - C:\Program Files (x86)\WindowsApps\
    - C:\Program Files\WindowsApps\
  filter_optional_defender:
    Image|endswith:
    - \MsMpEng.exe
    - \MsSense.exe
  filter_optional_prtg:
    Image|endswith: \PRTG Probe.exe
  filter_optional_qlik:
    Image|endswith: \Engine.exe
  selection:
    DestinationHostname|endswith:
    - .cloudflare.com
    - .githubusercontent.com
    - 4shared.com
    - anonfiles.com
    - cdn.discordapp.com
    - ddns.net
    - discord.com/api/webhooks/
    - docs.google.com
    - drive.google.com
    - dropbox.com
    - dropmefiles.com
    - facebook.com
    - feeds.rapidfeeds.com
    - fotolog.com
    - ghostbin.co/
    - gist.githubusercontent.com
    - hastebin.com
    - imgur.com
    - livejournal.com
    - mediafire.com
    - mega.nz
    - onedrive.com
    - paste.ee
    - pastebin.com
    - pastebin.pl
    - pastetext.net
    - privatlab.com
    - privatlab.net
    - raw.githubusercontent.com
    - reddit.com
    - send.exploit.in
    - sendspace.com
    - steamcommunity.com
    - storage.googleapis.com
    - t.me
    - technet.microsoft.com
    - temp.sh
    - transfer.sh
    - twitter.com
    - ufile.io
    - vimeo.com
    - wetransfer.com
    - youtube.com
    Initiated: 'true'
- condition: selection and not 1 of filter_main_*
  filter_main_known_ports:
    DestinationPort:
    - 80
    - 443
    - 445
  selection:
    Image|endswith: \dfsvc.exe
    Initiated: 'true'
- condition: selection and not 1 of filter_*
  filter_ipv4:
    DestinationIp|startswith:
    - '10.'
    - 192.168.
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - 169.254.
    - '127.'
  filter_ipv6:
    DestinationIp|startswith:
    - ::1
    - 0:0:0:0:0:0:0:1
    - 'fe80:'
    - fc
    - fd
  filter_msrange:
    DestinationIp|startswith:
    - 20.184.
    - 20.185.
    - 20.186.
    - 20.187.
    - 20.188.
    - 20.189.
    - 20.190.
    - 20.191.
    - 23.79.
    - 51.10.
    - 51.103.
    - 51.104.
    - 51.105.
    - 52.239.
  selection:
    Image|endswith: \dllhost.exe
    Initiated: 'true'
- condition: selection
  selection:
    Image|endswith: \eqnedt32.exe
- condition: selection and not filter
  filter:
    DestinationIp|startswith:
    - '10.'
    - 192.168.
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - 127.0.0.1
  selection:
    DestinationIsIpv6: 'false'
    Image|endswith: \excel.exe
    Initiated: 'true'
- condition: selection and not 1 of filter_optional_*
  filter_optional_brave:
    Image|endswith: \brave.exe
  filter_optional_chrome:
    Image:
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  filter_optional_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_optional_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_optional_firefox:
    Image:
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  filter_optional_google_drive:
    Image|startswith:
    - C:\Program Files\Google\Drive File Stream\
    - C:\Program Files\Google\Drive File Stream\*\GoogleDriveFS.exe
  filter_optional_googleupdate:
    Image|endswith: \GoogleUpdate.exe
  filter_optional_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_optional_maxthon:
    Image|endswith: \maxthon.exe
  filter_optional_opera:
    Image|endswith: \opera.exe
  filter_optional_outlook.exe:
    Image|endswith: \outlook.exe
  filter_optional_safari:
    Image|endswith: \safari.exe
  filter_optional_seamonkey:
    Image|endswith: \seamonkey.exe
  filter_optional_teams:
    Image|endswith: \teams.exe
  filter_optional_vivaldi:
    Image|endswith: \vivaldi.exe
  filter_optional_whale:
    Image|endswith: \whale.exe
  selection:
    DestinationHostname|contains:
    - oauth2.googleapis.com
    - sheets.googleapis.com
    - drive.googleapis.com
    - www.googleapis.com
- condition: selection
  selection:
    DestinationPort:
    - 80
    - 443
    - 135
    - 445
    Image|endswith: \hh.exe
    Initiated: 'true'
- condition: selection
  selection:
    Image|endswith: \IMEWDBLD.exe
    Initiated: 'true'
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_local_ips:
    DestinationIp|startswith:
    - '10.'
    - '127.'
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - 192.168.
  filter_optional_sys_directories:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  selection:
    DestinationPort:
    - 100
    - 198
    - 200
    - 243
    - 473
    - 666
    - 700
    - 743
    - 777
    - 1443
    - 1515
    - 1777
    - 1817
    - 1904
    - 1960
    - 2443
    - 2448
    - 3360
    - 3675
    - 3939
    - 4040
    - 4433
    - 4438
    - 4443
    - 4444
    - 4455
    - 5445
    - 5552
    - 5649
    - 6625
    - 7210
    - 8080
    - 8143
    - 8843
    - 8888
    - 9631
    - 9943
    - 10101
    - 12102
    - 12103
    - 12322
    - 13145
    - 13394
    - 13504
    - 13505
    - 13506
    - 13507
    - 14102
    - 14103
    - 14154
    - 49180
    - 65520
    - 65535
    Initiated: 'true'
- condition: selection
  selection:
    DestinationHostname|endswith: api.mega.co.nz
    Initiated: 'true'
- condition: selection
  selection:
    Image|endswith: \msiexec.exe
    Initiated: 'true'
- condition: selection
  selection:
    DestinationHostname|endswith: .ngrok.io
    Initiated: 'true'
- condition: selection and not filter
  filter:
    DestinationPort: 9100
  selection:
    Image|endswith: \notepad.exe
- condition: selection and not 1 of filter_main_*
  filter_main_brave:
    Image|endswith: \brave.exe
  filter_main_chrome:
    Image:
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  filter_main_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_main_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_main_firefox:
    Image:
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  filter_main_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_main_maxthon:
    Image|endswith: \maxthon.exe
  filter_main_notion:
    Image|endswith: \AppData\Local\Programs\Notion\Notion.exe
  filter_main_opera:
    Image|endswith: \opera.exe
  filter_main_safari:
    Image|endswith: \safari.exe
  filter_main_seamonkey:
    Image|endswith: \seamonkey.exe
  filter_main_vivaldi:
    Image|endswith: \vivaldi.exe
  filter_main_whale:
    Image|endswith: \whale.exe
  selection:
    DestinationHostname|contains: api.notion.com
- condition: selection and not 1 of filter_main_*
  filter_main_ports:
    DestinationPort:
    - 139
    - 443
    - 445
    - 80
  selection:
    Image|endswith:
    - \excel.exe
    - \outlook.exe
    - \powerpnt.exe
    - \winword.exe
    - \wordpad.exe
    - \wordview.exe
- condition: selection and not 1 of filter_*
  filter_internal_ip:
    DestinationIp|startswith:
    - '10.'
    - 192.168.
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - 127.0.0.1
    User|contains:
    - AUTHORI
    - AUTORI
  filter_ipv6:
    DestinationIp|startswith:
    - ::1
    - 0:0:0:0:0:0:0:1
    - 'fe80:'
    - fc
    - fd
  filter_msrange:
    DestinationIp|startswith:
    - 20.184.
    - 20.185.
    - 20.186.
    - 20.187.
    - 20.188.
    - 20.189.
    - 20.190.
    - 20.191.
    - 23.79.
    - 51.10.
    - 51.103.
    - 51.104.
    - 51.105.
    - 52.239.
  selection:
    DestinationIsIpv6: 'false'
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    Initiated: 'true'
- condition: selection and not 1 of filter_*
  filter_conda:
    CommandLine|contains|all:
    - C:\ProgramData\Anaconda3\Scripts\conda-script.py
    - update
    ParentImage: C:\ProgramData\Anaconda3\Scripts\conda.exe
  filter_conda_jupyter_notebook:
    CommandLine|contains: C:\ProgramData\Anaconda3\Scripts\jupyter-notebook-script.py
    ParentImage: C:\ProgramData\Anaconda3\python.exe
  filter_local_communication:
    DestinationIp: 127.0.0.1
    SourceIp: 127.0.0.1
  selection:
    Image|contains: python
    Initiated: 'true'
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_mstsc:
    Image:
    - C:\Windows\System32\mstsc.exe
    - C:\Windows\SysWOW64\mstsc.exe
  filter_optional_avast:
    Image|endswith:
    - \Avast Software\Avast\AvastSvc.exe
    - \Avast\AvastSvc.exe
  filter_optional_chrome:
    Image: C:\Program Files\Google\Chrome\Application\chrome.exe
  filter_optional_dns:
    Image: C:\Windows\System32\dns.exe
    Protocol: udp
    SourcePort: 53
  filter_optional_empty:
    Image: ''
  filter_optional_firefox:
    Image: C:\Program Files\Mozilla Firefox\firefox.exe
  filter_optional_null:
    Image: null
  filter_optional_sentinel_one:
    Image|endswith: \Ranger\SentinelRanger.exe
  filter_optional_splunk:
    Image|startswith: C:\Program Files\SplunkUniversalForwarder\bin\
  filter_optional_sysinternals_rdcman:
    Image|endswith: \RDCMan.exe
  filter_optional_third_party:
  - \FSAssessment.exe
  - \FSDiscovery.exe
  - \MobaRTE.exe
  - \mRemote.exe
  - \mRemoteNG.exe
  - \Passwordstate.exe
  - \RemoteDesktopManager.exe
  - \RemoteDesktopManager64.exe
  - \RemoteDesktopManagerFree.exe
  - \RSSensor.exe
  - \RTS2App.exe
  - \RTSApp.exe
  - \spiceworks-finder.exe
  - \Terminals.exe
  - \ws_TunnelService.exe
  filter_optional_thor:
    Image|endswith:
    - \thor.exe
    - \thor64.exe
  filter_optional_unknown:
    Image: <unknown process>
  selection:
    DestinationPort: 3389
    Initiated: 'true'
- condition: selection and selection2
  selection:
    Image|endswith: \svchost.exe
    Initiated: 'true'
    SourcePort: 3389
  selection2:
  - DestinationIp|startswith: '127.'
  - DestinationIp: ::1
- condition: selection
  selection:
    DestinationPort:
    - 80
    - 443
    Image|endswith: \svchost.exe
    Initiated: 'true'
    SourcePort: 3389
- condition: selection and not 1 of filter_optional_*
  filter_optional_brave:
    Image|endswith: \brave.exe
  filter_optional_chrome:
    Image:
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  filter_optional_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_optional_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_optional_firefox:
    Image:
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  filter_optional_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_optional_maxthon:
    Image|endswith: \maxthon.exe
  filter_optional_opera:
    Image|endswith: \opera.exe
  filter_optional_safari:
    Image|endswith: \safari.exe
  filter_optional_seamonkey:
    Image|endswith: \seamonkey.exe
  filter_optional_vivaldi:
    Image|endswith: \vivaldi.exe
  filter_optional_whale:
    Image|endswith: \whale.exe
  selection:
    DestinationHostname|contains: reddit.com
- condition: selection and not 1 of filter_*
  filter_generic:
  - User|contains:
    - NETWORK SERVICE
    - NETZWERKDIENST
    - SERVIZIO DI RETE
    - SERVICIO DE RED
  - User|contains|all:
    - SERVICE R
    - SEAU
  - SourceIp|startswith: '0:0:'
  - Image:
    - C:\Program Files\Avast Software\Avast\AvastSvc.exe
    - C:\Program Files (x86)\Avast Software\Avast\AvastSvc.exe
  filter_localhost:
    DestinationIp:
    - ::1
    - 127.0.0.1
    SourceIp:
    - ::1
    - 127.0.0.1
  selection:
    DestinationPort:
    - 5985
    - 5986
    Initiated: 'true'
- condition: selection and not 1 of filter*
  filter:
  - DestinationIp|startswith:
    - '10.'
    - 192.168.
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - '127.'
    - '20.'
    - 51.103.
    - 51.104.
    - 51.105.
  - CommandLine|contains: PcaSvc.dll,PcaPatchSdbTask
  - SourceHostname|endswith: .internal.cloudapp.net
  filter_update_processes:
    DestinationPort: 443
    ParentImage: C:\Windows\System32\svchost.exe
  selection:
    Image|endswith: \rundll32.exe
    Initiated: 'true'
- condition: selection
  selection:
    Image|endswith:
    - \wscript.exe
    - \cscript.exe
    Initiated: 'true'
- condition: selection and not 1 of filter*
  filter_ipv6:
    DestinationIp|startswith:
    - ::1
    - 0:0:0:0:0:0:0:1
    - 'fe80:'
    - fc
    - fd
  filter_lan:
    DestinationIp|startswith:
    - '127.'
    - '10.'
    - '172.'
    - '192.'
    - 169.254.
    - '20.'
  selection:
    Image|endswith:
    - \wscript.exe
    - \cscript.exe
    Initiated: 'true'
- condition: selection and filter
  filter:
    DestinationPort:
    - 80
    - 443
    Initiated: 'true'
  selection:
    Image|endswith: \msbuild.exe
- condition: selection and not 1 of filter*
  filter_no_cmdline:
    CommandLine: ''
  filter_null:
    CommandLine: null
  selection:
    CommandLine|endswith:
    - \regsvr32.exe
    - \rundll32.exe
    - \dllhost.exe
    Image|endswith:
    - \regsvr32.exe
    - \rundll32.exe
    - \dllhost.exe
    Initiated: 'true'
- condition: selection
  selection:
    Image|endswith: \cmstp.exe
    Initiated: 'true'
- condition: selection and not filter
  filter:
    Image|contains: \Dropbox
  selection:
    DestinationHostname|endswith:
    - api.dropboxapi.com
    - content.dropboxapi.com
    Initiated: 'true'
- condition: selection and not filter
  filter:
    Image|startswith:
    - C:\Windows\
    - C:\ProgramData\Amazon\SSM\Update\amazon-ssm-agent-updater
  selection:
    DestinationPort: 135
    Initiated: 'true'
    Protocol: tcp
- condition: selection and not 1 of filter_optional_*
  filter_optional_brave:
    Image|endswith: \brave.exe
  filter_optional_chrome:
    Image:
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  filter_optional_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_optional_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_optional_firefox:
    Image:
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  filter_optional_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_optional_maxthon:
    Image|endswith: \maxthon.exe
  filter_optional_opera:
    Image|endswith: \opera.exe
  filter_optional_safari:
    Image|endswith: \safari.exe
  filter_optional_seamonkey:
    Image|endswith: \seamonkey.exe
  filter_optional_vivaldi:
    Image|endswith: \vivaldi.exe
  filter_optional_whale:
    Image|endswith: \whale.exe
  selection:
    DestinationHostname|contains:
    - api.2ip.ua
    - api.ipify.org
    - bot.whatismyipaddress.com
    - canireachthe.net
    - checkip.amazonaws.com
    - checkip.dyndns.org
    - curlmyip.com
    - edns.ip-api.com
    - eth0.me
    - freegeoip.app
    - geoipy.com
    - getip.pro
    - icanhazip.com
    - ident.me
    - ifconfig.io
    - ifconfig.me
    - ip-api.com
    - ip.anysrc.net
    - ip.tyk.nu
    - ipaddressworld.com
    - ipecho.net
    - ipinfo.io
    - ipof.in
    - ipv4.icanhazip.com
    - ipv4bot.whatismyipaddress.com
    - ipwho.is
    - l2.io
    - myexternalip.com
    - wgetip.com
    - whatismyip.akamai.com
    - wtfismyip.com
- condition: selection and not 1 of filter_*
  filter_exact:
    Image:
    - C:\Windows\System32\lsass.exe
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files\Mozilla Firefox\firefox.exe
  selection:
    DestinationPort: 88
    Initiated: 'true'
- condition: selection_mobsync and not filter
  filter:
    DestinationIp|startswith:
    - '10.'
    - 192.168.
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    DestinationIsIpv6: 'false'
  selection_mobsync:
    Image|endswith: \mobsync.exe
- condition: selection and not 1 of filter_*
  filter_clients:
    Image|endswith:
    - \thunderbird.exe
    - \outlook.exe
  filter_mailserver:
    Image|startswith: C:\Program Files\Microsoft\Exchange Server\
  filter_outlook:
    Image|endswith: \HxTsr.exe
    Image|startswith: C:\Program Files\WindowsApps\microsoft.windowscommunicationsapps_
  selection:
    DestinationPort:
    - 25
    - 587
    - 465
    - 2525
    Initiated: 'true'
- condition: selection and not 1 of false_positive*
  false_positive1:
    Image|startswith: C:\Users\Public\IBM\ClientSolutions\Start_Programs\
  selection:
  - Image|contains:
    - \Users\All Users\
    - \Users\Default\
    - \Users\Public\
    - \Users\Contacts\
    - \Users\Searches\
    - \config\systemprofile\
    - \Windows\Fonts\
    - \Windows\IME\
    - \Windows\addins\
  - Image|endswith: \$Recycle.bin
  - Image|startswith: C:\Perflogs\
- condition: selection and not 1 of filter_main_*
  filter_main_brave:
    Image|endswith: \brave.exe
  filter_main_chrome:
    Image:
    - C:\Program Files\Google\Chrome\Application\chrome.exe
    - C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  filter_main_edge_1:
  - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
  - Image|endswith: \WindowsApps\MicrosoftEdge.exe
  - Image:
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
    - C:\Program Files\Microsoft\Edge\Application\msedge.exe
  filter_main_edge_2:
    Image|endswith:
    - \msedge.exe
    - \msedgewebview2.exe
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeCore\
    - C:\Program Files\Microsoft\EdgeCore\
  filter_main_firefox:
    Image:
    - C:\Program Files\Mozilla Firefox\firefox.exe
    - C:\Program Files (x86)\Mozilla Firefox\firefox.exe
  filter_main_ie:
    Image:
    - C:\Program Files (x86)\Internet Explorer\iexplore.exe
    - C:\Program Files\Internet Explorer\iexplore.exe
  filter_main_maxthon:
    Image|endswith: \maxthon.exe
  filter_main_opera:
    Image|endswith: \opera.exe
  filter_main_safari:
    Image|endswith: \safari.exe
  filter_main_seamonkey:
    Image|endswith: \seamonkey.exe
  filter_main_vivaldi:
    Image|endswith: \vivaldi.exe
  filter_main_whale:
    Image|endswith: \whale.exe
  selection:
    DestinationHostname|contains: api.telegram.org
- condition: selection and not 1 of filter_optional_*
  filter_optional_local_ip:
    DestinationIp|startswith:
    - '10.'
    - '127.'
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - 192.168.
  selection:
    Image|endswith: \winlogon.exe
    Initiated: 'true'
- condition: selection and not 1 of filter_*
  filter_cmdline:
    CommandLine|contains: '\UpdateDeploy.dll /ClassId '
  filter_msrange:
    DestinationIp|startswith:
    - 20.184.
    - 20.185.
    - 20.186.
    - 20.187.
    - 20.188.
    - 20.189.
    - 20.190.
    - 20.191.
    - 23.79.
    - 51.10.
    - 51.103.
    - 51.104.
    - 51.105.
    - 52.239.
  selection:
    Image|contains: wuauclt
- condition: selection and not 1 of filter*
  filter1:
    Image|endswith:
    - \powershell.exe
    - \powershell_ise.exe
    - \WINDOWS\System32\sdiagnhost.exe
    - \WINDOWS\System32\wsmprovhost.exe
    - \Windows\system32\dsac.exe
    - \Windows\system32\wbem\wmiprvse.exe
    - \ForefrontActiveDirectoryConnector.exe
    - c:\windows\system32\inetsrv\w3wp.exe
  filter2:
    Image: null
  filter3:
    Image|contains|all:
    - :\Program Files
    - \Microsoft SQL Server\
    Image|endswith: \Tools\Binn\SQLPS.exe
  filter4:
    Image|startswith:
    - C:\Program Files\Citrix\
    - C:\Program Files\Microsoft\Exchange Server\
  filter5:
    Image:
    - C:\Windows\system32\ServerManager.exe
    - C:\Program Files\PowerShell\7\pwsh.exe
  selection:
    PipeName|startswith: \PSHost
- condition: selection
  selection:
    PipeName:
    - \atctl
    - \userpipe
    - \iehelper
    - \sdlrpc
    - \comnap
- condition: selection
  selection:
    PipeName|contains:
    - \lsadump
    - \cachedump
    - \wceservicepipe
- condition: selection
  selection:
    PipeName|contains: thisispipe
- condition: selection and not filter
  filter:
    PipeName|contains: \CtxShare
  selection:
    PipeName|contains:
    - \pipe\
    - \pipe\srvsvc
- condition: selection
  selection:
    PipeName|contains:
    - \imposecost
    - \imposingcost
- condition: 1 of selection*
  selection_MSSE:
    PipeName|contains|all:
    - \MSSE-
    - -server
  selection_interprocess:
    PipeName|startswith: \interprocess_
  selection_lsarpc:
    PipeName|startswith: \lsarpc_
  selection_mojo:
    PipeName|startswith: \mojo_
  selection_msagent:
    PipeName|startswith: \msagent_
  selection_netlogon:
    PipeName|startswith: \netlogon_
  selection_postex:
    PipeName|startswith: \postex_
  selection_samr:
    PipeName|startswith: \samr_
  selection_srvsvc:
    PipeName|startswith: \srvsvc_
  selection_status:
    PipeName|startswith: \status_
  selection_wkssvc:
    PipeName|startswith: \wkssvc_
- condition: selection
  selection:
  - PipeName|re: \\mojo\.5688\.8052\.(?:183894939787088877|35780273329370473)[0-9a-f]{2}
  - PipeName|re: \\wkssvc_?[0-9a-f]{2}
  - PipeName|re: \\ntsvcs[0-9a-f]{2}
  - PipeName|re: \\DserNamePipe[0-9a-f]{2}
  - PipeName|re: \\SearchTextHarvester[0-9a-f]{2}
  - PipeName|re: \\mypipe-(?:f|h)[0-9a-f]{2}
  - PipeName|re: \\windows\.update\.manager[0-9a-f]{2,3}
  - PipeName|re: \\ntsvcs_[0-9a-f]{2}
  - PipeName|re: \\scerpc_?[0-9a-f]{2}
  - PipeName|re: \\PGMessagePipe[0-9a-f]{2}
  - PipeName|re: \\MsFteWds[0-9a-f]{2}
  - PipeName|re: \\f4c3[0-9a-f]{2}
  - PipeName|re: \\fullduplex_[0-9a-f]{2}
  - PipeName|re: \\msrpc_[0-9a-f]{4}
  - PipeName|re: \\win\\msrpc_[0-9a-f]{2}
  - PipeName|re: \\f53f[0-9a-f]{2}
  - PipeName|re: \\rpc_[0-9a-f]{2}
  - PipeName|re: \\spoolss_[0-9a-f]{2}
  - PipeName|re: \\Winsock2\\CatalogChangeListener-[0-9a-f]{3}-0,
- condition: selection
  selection:
    PipeName:
    - \isapi_http
    - \isapi_dg
    - \isapi_dg2
    - \sdlrpc
    - \ahexec
    - \winsession
    - \lsassw
    - \46a676ab7f179e511e30dd2dc41bd388
    - \9f81f59bc58452127884ce513865ed20
    - \e710f28d59aa529d6792ca6ff0ca1b34
    - \rpchlp_3
    - \NamePipe_MoreWindows
    - \pcheap_reuse
    - \gruntsvc
    - \583da945-62af-10e8-4902-a8f205c72b2e
    - \bizkaz
    - \svcctl
    - \Posh*
    - \jaccdpqnvbrrxlaf
    - \csexecsvc
    - \6e7645c4-32c5-4fe3-aabf-e94c2f4370e7
    - \adschemerpc
    - \AnonymousPipe
    - \bc367
    - \bc31a7
    - \testPipe
    - \dce_3d
- condition: selection
  selection:
    PipeName|startswith: \PAExec
- condition: selection
  selection:
    PipeName|startswith: \PSHost
- condition: selection
  selection:
    PipeName: \PSEXESVC
- condition: selection
  selection:
    Image|contains:
    - C:\Users\Public\
    - \Desktop\
    - \Downloads\
    - \AppData\Local\Temp\
    - C:\Windows\Temp\
    PipeName: \PSEXESVC
- condition: selection
  selection:
    PipeName|startswith:
    - psexec
    - paexec
    - remcom
    - csexec
- condition: selection and not filter
  filter:
    Image|endswith:
    - \Microsoft.IdentityServer.ServiceHost.exe
    - \Microsoft.Identity.Health.Adfs.PshSurrogate.exe
    - \AzureADConnect.exe
    - \Microsoft.Tri.Sensor.exe
    - \wsmprovhost.exe
    - \mmc.exe
    - \sqlservr.exe
    - \tssdis.exe
    - C:\Windows\system32\svchost.exe
  selection:
    PipeName: \MICROSOFT##WID\tsql\query
- condition: 1 of selection_malleable_profile* and not filter
  filter:
    PipeName:
    - \wkssvc
    - \spoolss
    - \scerpc
    - \ntsvcs
    - \SearchTextHarvester
    - \PGMessagePipe
    - \MsFteWds
  selection_malleable_profile_CatalogChangeListener:
    PipeName|endswith: -0,
    PipeName|startswith: \Winsock2\CatalogChangeListener-
  selection_malleable_profiles:
  - PipeName|startswith:
    - \mojo.5688.8052.183894939787088877
    - \mojo.5688.8052.35780273329370473
    - \mypipe-f
    - \mypipe-h
    - \ntsvcs
    - \scerpc
    - \win_svc
    - \spoolss
    - \msrpc_
    - \win\msrpc_
    - \wkssvc
    - \f53f
    - \windows.update.manager
    - \SearchTextHarvester
    - \DserNamePipe
    - \PGMessagePipe
    - \MsFteWds
    - \f4c3
    - \fullduplex_
    - \rpc_
  - PipeName:
    - \demoagent_11
    - \demoagent_22
- condition: selection
  selection:
    Image|endswith: \scrcons.exe
- condition: selection
  selection:
    HostApplication|contains:
    - -q=txt
    - -querytype=txt
    HostApplication|contains|all:
    - powershell
    - nslookup
- condition: selection and not filter
  filter:
  - HostApplication|startswith:
    - powershell
    - C:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exe
  - ContextInfo|contains: Citrix\ConfigSync\ConfigSync.ps1
  selection:
    HostApplication|contains: '*'
- condition: selection
  selection:
    HostApplication|contains:
    - Delete()
    - Remove-WmiObject
    HostApplication|contains|all:
    - Get-WmiObject
    - ' Win32_Shadowcopy'
- condition: selection and not filter
  filter:
    HostVersion|startswith: '2.'
  selection:
    EngineVersion|startswith: '2.'
- condition: selection1
  selection1:
    EngineVersion|startswith:
    - '2.'
    - '4.'
    - '5.'
    HostVersion|startswith: '3.'
- condition: selection
  selection:
    HostApplication|contains:
    - 'powercat '
    - powercat.ps1
- condition: selection
  selection:
    Data|contains: ModuleContents=function Get-VMRemoteFXPhysicalVideoAdapter {
- condition: selection
  selection:
    HostApplication|contains: wsmprovhost.exe
    HostName: ServerRemoteHost
- condition: selection and not filter
  filter:
    HostApplication|startswith:
    - powershell.exe
    - C:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exe
  selection:
    HostName: ConsoleHost
- condition: all of selection_*
  selection_download:
    HostApplication|contains:
    - .DownloadFile(
    - .DownloadString(
  selection_webclient:
    HostApplication|contains: Net.WebClient
- condition: selection
  selection:
    HostApplication|contains: Get-NetTCPConnection
- condition: selection
  selection:
    HostApplication|contains|all:
    - 'Compress-Archive '
    - ' -Path '
    - ' -DestinationPath '
    - $env:TEMP\
- condition: all of selection_options_disabling_* or 1 of selection_other_*
  selection_options_disabling_function:
    HostApplication|contains:
    - -dbaf $true
    - -dbaf 1
    - -dbm $true
    - -dbm 1
    - -dips $true
    - -dips 1
    - -DisableArchiveScanning $true
    - -DisableArchiveScanning 1
    - -DisableBehaviorMonitoring $true
    - -DisableBehaviorMonitoring 1
    - -DisableBlockAtFirstSeen $true
    - -DisableBlockAtFirstSeen 1
    - -DisableIntrusionPreventionSystem $true
    - -DisableIntrusionPreventionSystem 1
    - -DisableIOAVProtection $true
    - -DisableIOAVProtection 1
    - -DisableRealtimeMonitoring $true
    - -DisableRealtimeMonitoring 1
    - -DisableRemovableDriveScanning $true
    - -DisableRemovableDriveScanning 1
    - -DisableScanningMappedNetworkDrivesForFullScan $true
    - -DisableScanningMappedNetworkDrivesForFullScan 1
    - -DisableScanningNetworkFiles $true
    - -DisableScanningNetworkFiles 1
    - -DisableScriptScanning $true
    - -DisableScriptScanning 1
    - -drdsc $true
    - -drdsc 1
    - -drtm $true
    - -drtm 1
    - -dscrptsc $true
    - -dscrptsc 1
    - -dsmndf $true
    - -dsmndf 1
    - -dsnf $true
    - -dsnf 1
    - -dss $true
    - -dss 1
  selection_options_disabling_preference:
    HostApplication|contains: Set-MpPreference
  selection_other_default_actions_allow:
    HostApplication|contains: Set-MpPreference
  selection_other_default_actions_func:
    HostApplication|contains:
    - HighThreatDefaultAction Allow
    - htdefac Allow
    - LowThreatDefaultAction Allow
    - ltdefac Allow
    - ModerateThreatDefaultAction Allow
    - mtdefac Allow
    - SevereThreatDefaultAction Allow
    - stdefac Allow
- condition: selection and not filter
  filter:
    HostApplication|contains: powershell
  selection:
    ProviderName: WSMan
- condition: selection and filter
  filter:
    HostApplication|contains:
    - bxor
    - join
    - char
  selection:
    HostName: ConsoleHost
- condition: all of selection_*
  selection_cmdlet:
    Payload|contains:
    - 'Import-Module '
    - 'ipmo '
  selection_dll:
    Payload|contains: Microsoft.ActiveDirectory.Management.dll
- condition: selection and not 1 of filter_*
  filter_adace:
    ContextInfo|contains: C:\Windows\system32\dsac.exe
  filter_citrix:
    ContextInfo|contains: ConfigSyncRun.exe
  filter_help_update:
    Payload|contains:
    - Update-Help
    - Failed to update Help for the module
  filter_powershell:
    ContextInfo|contains:
    - = powershell
    - = C:\Windows\System32\WindowsPowerShell\v1.0\powershell
    - = C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell
    - = C:/Windows/System32/WindowsPowerShell/v1.0/powershell
    - = C:/Windows/SysWOW64/WindowsPowerShell/v1.0/powershell
  filter_sdiagnhost:
    ContextInfo|contains: = C:\WINDOWS\System32\sdiagnhost.exe -Embedding
  filter_winrm:
    ContextInfo|contains: C:\Windows\system32\wsmprovhost.exe -Embedding
  selection:
    ContextInfo|contains: '*'
- condition: selection_4103
  selection_4103:
    Payload|contains:
    - $DoIt
    - harmj0y
    - mattifestation
    - _RastaMouse
    - tifkin_
    - '0xdeadbeef'
- condition: 1 of selection_payload_* or all of selection_1*
  selection_1a_payload:
    Payload|contains:
    - del
    - Remove-Item
    - rm
  selection_1b_payload:
    Payload|contains: (Get-PSReadlineOption).HistorySavePath
  selection_payload_2:
    Payload|contains|all:
    - Set-PSReadlineOption
    - "\u2013HistorySaveStyle"
    - SaveNothing
  selection_payload_3:
    Payload|contains|all:
    - Set-PSReadlineOption
    - -HistorySaveStyle
    - SaveNothing
- condition: selection_4103
  selection_4103:
    Payload|contains: Expand-Archive
- condition: 1 of selection_*
  selection_generic:
    ContextInfo|contains:
    - Add-ConstrainedDelegationBackdoor.ps1
    - Add-Exfiltration.ps1
    - Add-Persistence.ps1
    - Add-RegBackdoor.ps1
    - Add-RemoteRegBackdoor.ps1
    - Add-ScrnSaveBackdoor.ps1
    - Check-VM.ps1
    - ConvertTo-ROT13.ps1
    - Copy-VSS.ps1
    - Create-MultipleSessions.ps1
    - DNS_TXT_Pwnage.ps1
    - Do-Exfiltration.ps1
    - DomainPasswordSpray.ps1
    - Download_Execute.ps1
    - Download-Execute-PS.ps1
    - Enabled-DuplicateToken.ps1
    - Enable-DuplicateToken.ps1
    - Execute-Command-MSSQL.ps1
    - Execute-DNSTXT-Code.ps1
    - Execute-OnTime.ps1
    - ExetoText.ps1
    - Exploit-Jboss.ps1
    - Find-AVSignature.ps1
    - Find-Fruit.ps1
    - Find-GPOLocation.ps1
    - Find-TrustedDocuments.ps1
    - FireBuster.ps1
    - FireListener.ps1
    - Get-ApplicationHost.ps1
    - Get-ChromeDump.ps1
    - Get-ClipboardContents.ps1
    - Get-ComputerDetail.ps1
    - Get-FoxDump.ps1
    - Get-GPPAutologon.ps1
    - Get-GPPPassword.ps1
    - Get-IndexedItem.ps1
    - Get-Keystrokes.ps1
    - Get-LSASecret.ps1
    - Get-MicrophoneAudio.ps1
    - Get-PassHashes.ps1
    - Get-PassHints.ps1
    - Get-RegAlwaysInstallElevated.ps1
    - Get-RegAutoLogon.ps1
    - Get-RickAstley.ps1
    - Get-Screenshot.ps1
    - Get-SecurityPackages.ps1
    - Get-ServiceFilePermission.ps1
    - Get-ServicePermission.ps1
    - Get-ServiceUnquoted.ps1
    - Get-SiteListPassword.ps1
    - Get-System.ps1
    - Get-TimedScreenshot.ps1
    - Get-UnattendedInstallFile.ps1
    - Get-Unconstrained.ps1
    - Get-USBKeystrokes.ps1
    - Get-VaultCredential.ps1
    - Get-VulnAutoRun.ps1
    - Get-VulnSchTask.ps1
    - Get-WebConfig.ps1
    - Get-WebCredentials.ps1
    - Get-WLAN-Keys.ps1
    - Gupt-Backdoor.ps1
    - HTTP-Backdoor.ps1
    - HTTP-Login.ps1
    - Install-ServiceBinary.ps1
    - Install-SSP.ps1
    - Invoke-ACLScanner.ps1
    - Invoke-ADSBackdoor.ps1
    - Invoke-AmsiBypass.ps1
    - Invoke-ARPScan.ps1
    - Invoke-BackdoorLNK.ps1
    - Invoke-BadPotato.ps1
    - Invoke-BetterSafetyKatz.ps1
    - Invoke-BruteForce.ps1
    - Invoke-BypassUAC.ps1
    - Invoke-Carbuncle.ps1
    - Invoke-Certify.ps1
    - Invoke-ConPtyShell.ps1
    - Invoke-CredentialInjection.ps1
    - Invoke-CredentialsPhish.ps1
    - Invoke-DAFT.ps1
    - Invoke-DCSync.ps1
    - Invoke-Decode.ps1
    - Invoke-DinvokeKatz.ps1
    - Invoke-DllInjection.ps1
    - Invoke-DowngradeAccount.ps1
    - Invoke-EgressCheck.ps1
    - Invoke-Encode.ps1
    - Invoke-EventViewer.ps1
    - Invoke-Eyewitness.ps1
    - Invoke-FakeLogonScreen.ps1
    - Invoke-Farmer.ps1
    - Invoke-Get-RBCD-Threaded.ps1
    - Invoke-Gopher.ps1
    - Invoke-Grouper2.ps1
    - Invoke-Grouper3.ps1
    - Invoke-HandleKatz.ps1
    - Invoke-Interceptor.ps1
    - Invoke-Internalmonologue.ps1
    - Invoke-Inveigh.ps1
    - Invoke-InveighRelay.ps1
    - Invoke-JSRatRegsvr.ps1
    - Invoke-JSRatRundll.ps1
    - Invoke-KrbRelay.ps1
    - Invoke-KrbRelayUp.ps1
    - Invoke-LdapSignCheck.ps1
    - Invoke-Lockless.ps1
    - Invoke-MalSCCM.ps1
    - Invoke-Mimikatz.ps1
    - Invoke-MimikatzWDigestDowngrade.ps1
    - Invoke-Mimikittenz.ps1
    - Invoke-MITM6.ps1
    - Invoke-NanoDump.ps1
    - Invoke-NetRipper.ps1
    - Invoke-NetworkRelay.ps1
    - Invoke-NinjaCopy.ps1
    - Invoke-OxidResolver.ps1
    - Invoke-P0wnedshell.ps1
    - Invoke-P0wnedshellx86.ps1
    - Invoke-Paranoia.ps1
    - Invoke-PortScan.ps1
    - Invoke-PoshRatHttp.ps1
    - Invoke-PoshRatHttps.ps1
    - Invoke-PostExfil.ps1
    - Invoke-PowerDump.ps1
    - Invoke-PowerShellIcmp.ps1
    - Invoke-PowerShellTCP.ps1
    - Invoke-PowerShellTcpOneLine.ps1
    - Invoke-PowerShellTcpOneLineBind.ps1
    - Invoke-PowerShellUdp.ps1
    - Invoke-PowerShellUdpOneLine.ps1
    - Invoke-PowerShellWMI.ps1
    - Invoke-PowerThIEf.ps1
    - Invoke-PPLDump.ps1
    - Invoke-Prasadhak.ps1
    - Invoke-PsExec.ps1
    - Invoke-PsGcat.ps1
    - Invoke-PsGcatAgent.ps1
    - Invoke-PSInject.ps1
    - Invoke-PsUaCme.ps1
    - Invoke-ReflectivePEInjection.ps1
    - Invoke-ReverseDNSLookup.ps1
    - Invoke-Rubeus.ps1
    - Invoke-RunAs.ps1
    - Invoke-SafetyKatz.ps1
    - Invoke-SauronEye.ps1
    - Invoke-SCShell.ps1
    - Invoke-Seatbelt.ps1
    - Invoke-ServiceAbuse.ps1
    - Invoke-SessionGopher.ps1
    - Invoke-ShellCode.ps1
    - Invoke-SMBScanner.ps1
    - Invoke-Snaffler.ps1
    - Invoke-Spoolsample.ps1
    - Invoke-SSHCommand.ps1
    - Invoke-SSIDExfil.ps1
    - Invoke-StandIn.ps1
    - Invoke-StickyNotesExtract.ps1
    - Invoke-Tater.ps1
    - Invoke-Thunderfox.ps1
    - Invoke-ThunderStruck.ps1
    - Invoke-TokenManipulation.ps1
    - Invoke-Tokenvator.ps1
    - Invoke-TotalExec.ps1
    - Invoke-UrbanBishop.ps1
    - Invoke-UserHunter.ps1
    - Invoke-VoiceTroll.ps1
    - Invoke-Whisker.ps1
    - Invoke-WinEnum.ps1
    - Invoke-winPEAS.ps1
    - Invoke-WireTap.ps1
    - Invoke-WmiCommand.ps1
    - Invoke-WScriptBypassUAC.ps1
    - Invoke-Zerologon.ps1
    - Keylogger.ps1
    - MailRaider.ps1
    - New-HoneyHash.ps1
    - OfficeMemScraper.ps1
    - Offline_Winpwn.ps1
    - Out-CHM.ps1
    - Out-DnsTxt.ps1
    - Out-Excel.ps1
    - Out-HTA.ps1
    - Out-Java.ps1
    - Out-JS.ps1
    - Out-Minidump.ps1
    - Out-RundllCommand.ps1
    - Out-SCF.ps1
    - Out-SCT.ps1
    - Out-Shortcut.ps1
    - Out-WebQuery.ps1
    - Out-Word.ps1
    - Parse_Keys.ps1
    - Port-Scan.ps1
    - PowerBreach.ps1
    - powercat.ps1
    - PowerRunAsSystem.psm1
    - PowerSharpPack.ps1
    - PowerUp.ps1
    - PowerUpSQL.ps1
    - PowerView.ps1
    - PSAsyncShell.ps1
    - RemoteHashRetrieval.ps1
    - Remove-Persistence.ps1
    - Remove-PoshRat.ps1
    - Remove-Update.ps1
    - Run-EXEonRemote.ps1
    - Schtasks-Backdoor.ps1
    - Set-DCShadowPermissions.ps1
    - Set-MacAttribute.ps1
    - Set-RemotePSRemoting.ps1
    - Set-RemoteWMI.ps1
    - Set-Wallpaper.ps1
    - Show-TargetScreen.ps1
    - Speak.ps1
    - Start-CaptureServer.ps1
    - Start-WebcamRecorder.ps1
    - StringToBase64.ps1
    - TexttoExe.ps1
    - VolumeShadowCopyTools.ps1
    - WinPwn.ps1
    - WSUSpendu.ps1
  selection_invoke_sharp:
    ContextInfo|contains|all:
    - Invoke-Sharp
    - .ps1
- condition: selection
  selection:
    Payload|contains|all:
    - Get-ADDBAccount
    - 'BootKey '
    - 'DatabasePath '
- condition: selection
  selection:
    Payload|contains: Get-Clipboard
- condition: selection_4103
  selection_4103:
    Payload|re: .*cmd.{0,5}(?:/c|/r).+clip(?:\.exe)?.{0,4}&&.+clipboard]::\(\s\\"\{\d\}.+-f.+"
- condition: selection_payload
  selection_payload:
  - Payload|re: \$PSHome\[\s*\d{1,3}\s*\]\s*\+\s*\$PSHome\[
  - Payload|re: \$ShellId\[\s*\d{1,3}\s*\]\s*\+\s*\$ShellId\[
  - Payload|re: \$env:Public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:Public\[
  - Payload|re: \$env:ComSpec\[(\s*\d{1,3}\s*,){2}
  - Payload|re: \*mdr\*\W\s*\)\.Name
  - Payload|re: \$VerbosePreference\.ToString\(
  - Payload|re: \[String\]\s*\$VerbosePreference
- condition: selection_4103
  selection_4103:
    Payload|re: .*cmd.{0,5}(?:/c|/r).+powershell.+(?:\$\{?input\}?|noexit).+"
- condition: selection_4103
  selection_4103:
    Payload|re: .*cmd.{0,5}(?:/c|/r)(?:\s|)"set\s[a-zA-Z]{3,6}.*(?:\{\d\}){1,}\\"\s+?-f(?:.*\)){1,}.*"
- condition: selection_4103
  selection_4103:
    Payload|contains:
    - system.io.compression.deflatestream
    - system.io.streamreader
    Payload|contains|all:
    - new-object
    - text.encoding]::ascii
    Payload|endswith: readtoend
- condition: selection_4103
  selection_4103:
    Payload|contains|all:
    - rundll32.exe
    - shell32.dll
    - shellexec_rundll
    - powershell
- condition: selection_4103
  selection_4103:
    Payload|re: (?i).*(set).*&&\s?set.*(environment|invoke|\$?\{?input).*&&.*"
- condition: selection_4103
  selection_4103:
    Payload|re: (?i).*?echo.*clip.*&&.*(Clipboard|i`?n`?v`?o`?k`?e`?).*
- condition: selection
  selection:
    Payload|contains|all:
    - set
    - '&&'
    - mshta
    - vbscript:createobject
    - .run
    - (window.close)
- condition: selection_4103
  selection_4103:
    Payload|contains:
    - value
    - invoke
    - comspec
    - iex
    Payload|contains|all:
    - '&&'
    - rundll32
    - shell32.dll
    - shellexec_rundll
- condition: selection_4103
  selection_4103:
    Payload|re: (?i).*&&set.*(\{\d\}){2,}\\"\s+?-f.*&&.*cmd.*/c
- condition: selection
  selection:
    Payload|contains:
    - Add-Exfiltration
    - Add-Persistence
    - Add-RegBackdoor
    - Add-RemoteRegBackdoor
    - Add-ScrnSaveBackdoor
    - Check-VM
    - ConvertTo-Rc4ByteStream
    - Decrypt-Hash
    - Disable-ADIDNSNode
    - Disable-MachineAccount
    - Do-Exfiltration
    - Enable-ADIDNSNode
    - Enable-MachineAccount
    - Enabled-DuplicateToken
    - Exploit-Jboss
    - Export-ADR
    - Export-ADRCSV
    - Export-ADRExcel
    - Export-ADRHTML
    - Export-ADRJSON
    - Export-ADRXML
    - Find-Fruit
    - Find-GPOLocation
    - Find-TrustedDocuments
    - Get-ADIDNS
    - Get-ApplicationHost
    - Get-ChromeDump
    - Get-ClipboardContents
    - Get-FoxDump
    - Get-GPPPassword
    - Get-IndexedItem
    - Get-KerberosAESKey
    - Get-Keystrokes
    - Get-LSASecret
    - Get-MachineAccountAttribute
    - Get-MachineAccountCreator
    - Get-PassHashes
    - Get-RegAlwaysInstallElevated
    - Get-RegAutoLogon
    - Get-RemoteBootKey
    - Get-RemoteCachedCredential
    - Get-RemoteLocalAccountHash
    - Get-RemoteLSAKey
    - Get-RemoteMachineAccountHash
    - Get-RemoteNLKMKey
    - Get-RickAstley
    - Get-Screenshot
    - Get-SecurityPackages
    - Get-ServiceFilePermission
    - Get-ServicePermission
    - Get-ServiceUnquoted
    - Get-SiteListPassword
    - Get-System
    - Get-TimedScreenshot
    - Get-UnattendedInstallFile
    - Get-Unconstrained
    - Get-USBKeystrokes
    - Get-VaultCredential
    - Get-VulnAutoRun
    - Get-VulnSchTask
    - Grant-ADIDNSPermission
    - Gupt-Backdoor
    - HTTP-Login
    - Install-ServiceBinary
    - Install-SSP
    - Invoke-ACLScanner
    - Invoke-ADRecon
    - Invoke-ADSBackdoor
    - Invoke-AgentSmith
    - Invoke-AllChecks
    - Invoke-ARPScan
    - Invoke-AzureHound
    - Invoke-BackdoorLNK
    - Invoke-BadPotato
    - Invoke-BetterSafetyKatz
    - Invoke-BypassUAC
    - Invoke-Carbuncle
    - Invoke-Certify
    - Invoke-ConPtyShell
    - Invoke-CredentialInjection
    - Invoke-DAFT
    - Invoke-DCSync
    - Invoke-DinvokeKatz
    - Invoke-DllInjection
    - Invoke-DNSUpdate
    - Invoke-DomainPasswordSpray
    - Invoke-DowngradeAccount
    - Invoke-EgressCheck
    - Invoke-Eyewitness
    - Invoke-FakeLogonScreen
    - Invoke-Farmer
    - Invoke-Get-RBCD-Threaded
    - Invoke-Gopher
    - Invoke-Grouper
    - Invoke-HandleKatz
    - Invoke-ImpersonatedProcess
    - Invoke-ImpersonateSystem
    - Invoke-InteractiveSystemPowerShell
    - Invoke-Internalmonologue
    - Invoke-Inveigh
    - Invoke-InveighRelay
    - Invoke-KrbRelay
    - Invoke-LdapSignCheck
    - Invoke-Lockless
    - Invoke-MalSCCM
    - Invoke-Mimikatz
    - Invoke-Mimikittenz
    - Invoke-MITM6
    - Invoke-NanoDump
    - Invoke-NetRipper
    - Invoke-Nightmare
    - Invoke-NinjaCopy
    - Invoke-OfficeScrape
    - Invoke-OxidResolver
    - Invoke-P0wnedshell
    - Invoke-Paranoia
    - Invoke-PortScan
    - Invoke-PoshRatHttp
    - Invoke-PostExfil
    - Invoke-PowerDump
    - Invoke-PowerShellTCP
    - Invoke-PowerShellWMI
    - Invoke-PPLDump
    - Invoke-PsExec
    - Invoke-PSInject
    - Invoke-PsUaCme
    - Invoke-ReflectivePEInjection
    - Invoke-ReverseDNSLookup
    - Invoke-Rubeus
    - Invoke-RunAs
    - Invoke-SafetyKatz
    - Invoke-SauronEye
    - Invoke-SCShell
    - Invoke-Seatbelt
    - Invoke-ServiceAbuse
    - Invoke-ShadowSpray
    - Invoke-Sharp
    - Invoke-Shellcode
    - Invoke-SMBScanner
    - Invoke-Snaffler
    - Invoke-Spoolsample
    - Invoke-SpraySinglePassword
    - Invoke-SSHCommand
    - Invoke-StandIn
    - Invoke-StickyNotesExtract
    - Invoke-SystemCommand
    - Invoke-Tasksbackdoor
    - Invoke-Tater
    - Invoke-Thunderfox
    - Invoke-ThunderStruck
    - Invoke-TokenManipulation
    - Invoke-Tokenvator
    - Invoke-TotalExec
    - Invoke-UrbanBishop
    - Invoke-UserHunter
    - Invoke-VoiceTroll
    - Invoke-Whisker
    - Invoke-WinEnum
    - Invoke-winPEAS
    - Invoke-WireTap
    - Invoke-WmiCommand
    - Invoke-WMIExec
    - Invoke-WScriptBypassUAC
    - Invoke-Zerologon
    - MailRaider
    - New-ADIDNSNode
    - New-DNSRecordArray
    - New-HoneyHash
    - New-InMemoryModule
    - New-MachineAccount
    - New-SOASerialNumberArray
    - Out-Minidump
    - Port-Scan
    - PowerBreach
    - 'powercat '
    - PowerUp
    - PowerView
    - Remove-ADIDNSNode
    - Remove-MachineAccount
    - Remove-Update
    - Rename-ADIDNSNode
    - Revoke-ADIDNSPermission
    - Set-ADIDNSNode
    - Set-MacAttribute
    - Set-MachineAccountAttribute
    - Set-Wallpaper
    - Show-TargetScreen
    - Start-CaptureServer
    - Start-WebcamRecorder
    - VolumeShadowCopyTools
- condition: selection
  selection:
    Payload|contains: ModuleContents=function Get-VMRemoteFXPhysicalVideoAdapter {
- condition: selection and not 1 of filter_*
  filter_pwsh_archive:
    ContextInfo|contains: \Windows\system32\WindowsPowerShell\v1.0\Modules\Microsoft.PowerShell.Archive\Microsoft.PowerShell.Archive.psm1
  selection:
    ContextInfo|contains|all:
    - ' = ServerRemoteHost '
    - wsmprovhost.exe
- condition: 1 of selection_*
  selection_ad_principal:
  - Payload|contains: get-ADPrincipalGroupMembership
  - ContextInfo|contains: get-ADPrincipalGroupMembership
  selection_get_aduser:
  - Payload|contains|all:
    - get-aduser
    - '-f '
    - '-pr '
    - DoesNotRequirePreAuth
  - ContextInfo|contains|all:
    - get-aduser
    - '-f '
    - '-pr '
    - DoesNotRequirePreAuth
- condition: all of selection_*
  selection_function:
    ContextInfo|contains:
    - .DownloadFile(
    - .DownloadString(
  selection_webclient_:
    ContextInfo|contains: System.Net.WebClient
- condition: selection
  selection:
    ContextInfo|contains: Get-NetTCPConnection
- condition: all of selection*
  selection_encoded:
    ContextInfo|contains:
    - ' -enc '
    - ' -EncodedCommand '
    - ' -ec '
  selection_hidden:
    ContextInfo|contains:
    - ' -w hidden '
    - ' -window hidden '
    - ' -windowstyle hidden '
    - ' -w 1 '
  selection_noninteractive:
    ContextInfo|contains:
    - ' -noni '
    - ' -noninteractive '
- condition: 1 of selection_* and not 1 of filter_*
  filter_chocolatey:
    ContextInfo|contains:
    - (New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1
    - Write-ChocolateyWarning
  selection_convert_b64:
    ContextInfo|contains|all:
    - -nop
    - ' -w '
    - hidden
    - ' -c '
    - '[Convert]::FromBase64String'
  selection_enc:
    ContextInfo|contains|all:
    - ' -w '
    - hidden
    - -ep
    - bypass
    - -Enc
  selection_iex:
    ContextInfo|contains|all:
    - ' -w '
    - hidden
    - -noni
    - -nop
    - ' -c '
    - iex
    - New-Object
  selection_iex_webclient:
    ContextInfo|contains|all:
    - iex
    - New-Object
    - Net.WebClient
    - .Download
  selection_reg:
    ContextInfo|contains|all:
    - powershell
    - reg
    - add
    - HKCU\software\microsoft\windows\currentversion\run
  selection_webclient:
    ContextInfo|contains|all:
    - bypass
    - -noprofile
    - -windowstyle
    - hidden
    - new-object
    - system.net.webclient
    - .download
- condition: 1 of test_*
  test_3:
  - Payload|contains:
    - get-localgroup
    - Get-LocalGroupMember
  - ContextInfo|contains:
    - get-localgroup
    - Get-LocalGroupMember
  test_6:
  - Payload|contains|all:
    - Get-WMIObject
    - Win32_Group
  - ContextInfo|contains|all:
    - Get-WMIObject
    - Win32_Group
- condition: selection
  selection:
    ContextInfo|contains: Reset-ComputerMachinePassword
- condition: selection
  selection:
  - Payload|contains: get-smbshare
  - ContextInfo|contains: get-smbshare
- condition: selection_4103
  selection_4103:
    ContextInfo|contains|all:
    - 'Compress-Archive '
    - ' -Path '
    - ' -DestinationPath '
    - $env:TEMP\
- condition: selection
  selection:
    ContextInfo|contains: SyncAppvPublishingServer.exe
- condition: selection
  selection:
    ScriptBlockText|contains:
    - Add-AADInt
    - ConvertTo-AADInt
    - Disable-AADInt
    - Enable-AADInt
    - Export-AADInt
    - Get-AADInt
    - Grant-AADInt
    - Install-AADInt
    - Invoke-AADInt
    - Join-AADInt
    - New-AADInt
    - Open-AADInt
    - Read-AADInt
    - Register-AADInt
    - Remove-AADInt
    - Restore-AADInt
    - Search-AADInt
    - Send-AADInt
    - Set-AADInt
    - Start-AADInt
    - Update-AADInt
- condition: selection and not 1 of filter_optional_*
  filter_optional_amazon:
    ScriptBlockText|contains:
    - 'function Import-SerialPortUtil '
    - CloseHandle
    - DllImport("KernelBase.dll"
    ScriptBlockText|startswith: '# Copyright 2016 Amazon.com, Inc. or its affiliates.'
  selection:
    ScriptBlockText|contains:
    - AddSecurityPackage
    - AdjustTokenPrivileges
    - CloseHandle
    - CreateProcessWithToken
    - CreateRemoteThread
    - CreateThread
    - CreateUserThread
    - DangerousGetHandle
    - DuplicateTokenEx
    - EnumerateSecurityPackages
    - FreeLibrary
    - GetDelegateForFunctionPointer
    - GetLogonSessionData
    - GetModuleHandle
    - GetProcAddress
    - GetProcessHandle
    - GetTokenInformation
    - ImpersonateLoggedOnUser
    - kernel32
    - LoadLibrary
    - memcpy
    - MiniDumpWriteDump
    - msvcrt
    - ntdll
    - OpenDesktop
    - OpenProcess
    - OpenProcessToken
    - OpenThreadToken
    - OpenWindowStation
    - QueueUserApc
    - ReadProcessMemory
    - RevertToSelf
    - RtlCreateUserThread
    - secur32
    - SetThreadToken
    - VirtualAlloc
    - VirtualFree
    - VirtualProtect
    - WaitForSingleObject
    - WriteInt32
    - WriteProcessMemory
    - ZeroFreeGlobalAllocUnicode
- condition: all of selection_*
  selection_cmd:
    ScriptBlockText|contains|all:
    - Copy-Item
    - -Destination
  selection_path:
    ScriptBlockText|contains:
    - \Opera Software\Opera Stable\Login Data
    - \Mozilla\Firefox\Profiles
    - \Microsoft\Edge\User Data\Default
    - \Google\Chrome\User Data\Default\Login Data
    - \Google\Chrome\User Data\Default\Login Data For Account
- condition: 1 of selection_*
  selection_generic:
    ScriptBlockText|contains|all:
    - 'Import-Module '
    - Microsoft.ActiveDirectory.Management.dll
  selection_specific:
    ScriptBlockText|contains: ipmo Microsoft.ActiveDirectory.Management.dll
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Add-DnsClientNrptRule
    - -Namesp
    - -NameSe
- condition: all of selection_*
  selection_capa:
    ScriptBlockText|contains: -Name OpenSSH.
  selection_cmdlet:
    ScriptBlockText|contains: 'Add-WindowsCapability '
- condition: selection
  selection:
    ScriptBlockText|contains:
    - Function Get-ADRExcelComOb
    - Get-ADRGPO
    - Get-ADRDomainController
    - ADRecon-Report.xlsx
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - '[Ref].Assembly.GetType'
    - SetValue($null,$true)
    - NonPublic,Static
- condition: selection
  selection:
    ScriptBlockText|contains:
    - if(0){{{0}}}' -f $(0 -as [char]) +
    - '#<NULL>'
- condition: empire and dnscat
  dnscat:
    ScriptBlockText|contains|all:
    - set type=$LookupType`nserver
    - $Command | nslookup 2>&1 | Out-String
    - New-RandomDNSField
    - '[Convert]::ToString($SYNOptions, 16)'
    - $Session.Dead = $True
    - $Session["Driver"] -eq
  empire:
    ScriptBlockText|contains|all:
    - System.Diagnostics.Process
    - Stop-Computer
    - Restart-Computer
    - Exception in execution
    - $cmdargs
    - Close-Dnscat2Tunnel
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Get-ADUser
    - -Filter
    - useraccountcontrol
    - -band
    - '4194304'
- condition: selection_main and 1 of selection_header_*
  selection_header_wav:
    ScriptBlockText|contains|all:
    - '0x52'
    - '0x49'
    - '0x46'
    - '0x57'
    - '0x41'
    - '0x56'
    - '0x45'
    - '0xAC'
  selection_main:
    ScriptBlockText|contains|all:
    - '[System.Math]::'
    - '[IO.FileMode]::'
    - BinaryWriter
- condition: all of selection*
  selection_cmd:
    ScriptBlockText|contains|all:
    - Get-ChildItem
    - ' -Recurse '
    - ' -Include '
  selection_ext:
    ScriptBlockText|contains:
    - .files
    - .docx
    - .xls
    - .xlsx
    - .ppt
    - .pptx
    - .rtf
    - .pdf
    - .txt
- condition: selection
  selection:
    ScriptBlockText|contains: .CopyFromScreen
- condition: selection1 or selection2a and selection2b
  selection1:
    ScriptBlockText|contains: Clear-History
  selection2a:
    ScriptBlockText|contains:
    - Remove-Item
    - rm
  selection2b:
    ScriptBlockText|contains:
    - ConsoleHost_history.txt
    - (Get-PSReadlineOption).HistorySavePath
- condition: 1 of selection_* or all of selection1*
  selection1a:
    ScriptBlockText|contains:
    - del
    - Remove-Item
    - rm
  selection1b:
    ScriptBlockText|contains: (Get-PSReadlineOption).HistorySavePath
  selection_2:
    ScriptBlockText|contains|all:
    - Set-PSReadlineOption
    - "\u2013HistorySaveStyle"
    - SaveNothing
  selection_3:
    ScriptBlockText|contains|all:
    - Set-PSReadlineOption
    - -HistorySaveStyle
    - SaveNothing
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - CL_Invocation.ps1
    - SyncInvoke
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - CL_Mutexverifiers.ps1
    - runAfterCancelProcess
- condition: 1 of selection_*
  selection_cimmethod:
    ScriptBlockText|contains|all:
    - Invoke-CimMethod
    - -ClassName
    - PS_ScheduledTask
    - -NameSpace
    - Root\Microsoft\Windows\TaskScheduler
  selection_cmdlet:
    ScriptBlockText|contains:
    - New-ScheduledTaskAction
    - New-ScheduledTaskTrigger
    - New-ScheduledTaskPrincipal
    - New-ScheduledTaskSettingsSet
    - New-ScheduledTask
    - Register-ScheduledTask
- condition: selection
  selection:
    ScriptBlockText|contains:
    - ' | Select '
    - Out-File
    - Set-Content
    - Add-Content
    ScriptBlockText|contains|all:
    - 'Get-ADComputer '
    - ' -Filter \*'
- condition: all of selection*
  selection_copy:
    ScriptBlockText|contains|all:
    - 'Copy-Item '
    - '-Destination '
  selection_paths:
    ScriptBlockText|contains:
    - \Windows\System32
    - \Windows\SysWOW64
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - $env:COR_ENABLE_PROFILING
    - $env:COR_PROFILER
    - $env:COR_PROFILER_PATH
- condition: selection
  selection:
    ScriptBlockText|contains: New-LocalUser
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - win32_shadowcopy
    - ).Create(
    - ClientAccessible
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - -Recurse
    - '|'
    - Compress-Archive
- condition: all of selection*
  selection_action:
    ScriptBlockText|contains:
    - Get-WmiObject
    - gwmi
  selection_module:
    ScriptBlockText|contains:
    - MSAcpi_ThermalZoneTemperature
    - Win32_ComputerSystem
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'New-Object '
    - System.DirectoryServices.DirectorySearcher
    - .PropertiesToLoad.Add
    - .findall()
    - Properties.name
- condition: selection
  selection:
    ScriptBlockText|contains: System.DirectoryServices.AccountManagement
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Remove-Module
    - psreadline
- condition: all of selection*
  selection_cmd:
    ScriptBlockText|contains|all:
    - Disable-WindowsOptionalFeature
    - -Online
    - -FeatureName
  selection_feature:
    ScriptBlockText|contains:
    - Windows-Defender-Gui
    - Windows-Defender-Features
    - Windows-Defender
    - Windows-Defender-ApplicationGuard
- condition: selection
  selection:
    ScriptBlockText|contains: Start-Dnscat2
- condition: selection
  selection:
    ScriptBlockText|contains: '[Reflection.Assembly]::load'
- condition: all of selection_*
  selection_1:
    ScriptBlockText|contains: '[Type]::GetTypeFromCLSID('
  selection_2:
    ScriptBlockText|contains:
    - 0002DF01-0000-0000-C000-000000000046
    - F6D90F16-9C73-11D3-B32E-00C04F990BB4
    - F5078F35-C551-11D3-89B9-0000F81FE221
    - 88d96a0a-f192-11d4-a65f-0040963251e5
    - AFBA6B42-5692-48EA-8141-DC517DCF0EF1
    - AFB40FFD-B609-40A3-9828-F88BBE11E4E3
    - 88d96a0b-f192-11d4-a65f-0040963251e5
    - 2087c2f4-2cef-4953-a8ab-66779b670495
    - 000209FF-0000-0000-C000-000000000046
    - 00024500-0000-0000-C000-000000000046
- condition: 1 of selection_*
  selection_kiddie:
    ScriptBlockText|contains:
    - Get-PasswordVaultCredentials
    - Get-CredManCreds
  selection_rename_Password:
    ScriptBlockText|contains|all:
    - New-Object
    - Windows.Security.Credentials.PasswordVault
  selection_rename_credman:
    ScriptBlockText|contains|all:
    - New-Object
    - Microsoft.CSharp.CSharpCodeProvider
    - '[System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())'
    - Collections.ArrayList
    - System.CodeDom.Compiler.CompilerParameters
- condition: selection_cmdlet
  selection_cmdlet:
    ScriptBlockText|contains: 'Enable-PSRemoting '
- condition: all of selection_*
  selection_cmd:
    ScriptBlockText|contains|all:
    - Enable-WindowsOptionalFeature
    - -Online
    - -FeatureName
  selection_feature:
    ScriptBlockText|contains:
    - TelnetServer
    - Internet-Explorer-Optional-amd64
    - TFTP
    - SMB1Protocol
    - Client-ProjFS
    - Microsoft-Windows-Subsystem-Linux
- condition: all of selection_*
  selection_cmd:
    ScriptBlockText|contains|all:
    - vaultcmd
    - '/listcreds:'
  selection_option:
    ScriptBlockText|contains:
    - Windows Credentials
    - Web Credentials
- condition: 1 of selection*
  selection_pwsh_remove:
    ScriptBlockText|contains: 'Remove-EtwTraceProvider '
  selection_pwsh_set:
    ScriptBlockText|contains|all:
    - 'Set-EtwTraceProvider '
    - '0x11'
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'Set-Mailbox '
    - ' -DeliverToMailboxAndForward '
    - ' -ForwardingSmtpAddress '
- condition: selection and not 1 of filter_optional_*
  filter_optional_module_export:
    ScriptBlockText|contains: CmdletsToExport = @(
  selection:
    ScriptBlockText|contains:
    - Export-PfxCertificate
    - Export-Certificate
- condition: selection and recurse
  recurse:
    ScriptBlockText|contains: -recurse
  selection:
    ScriptBlockText|contains:
    - ls
    - get-childitem
    - gci
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - FromBase64String
    - MemoryStream
    - H4sI
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - get-acl
    - REGISTRY::HKLM\SYSTEM\CurrentControlSet\Services\
- condition: all of selection_*
  selection_cmdlet:
    ScriptBlockText|contains: 'Get-AdComputer '
  selection_option:
    ScriptBlockText|contains:
    - '-Filter '
    - '-LDAPFilter '
    - '-Properties '
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'Get-AdGroup '
    - -Filter
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Get-ADReplAccount
    - '-All '
    - '-Server '
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Get-ChildItem
    - ' -Recurse '
    - ' -Path '
    - ' -Filter Bookmarks'
    - ' -ErrorAction SilentlyContinue'
    - ' -Force'
- condition: selection
  selection:
    ScriptBlockText|contains:
    - 'asreproast '
    - 'dump /service:krbtgt '
    - dump /luid:0x
    - 'kerberoast '
    - 'createnetonly /program:'
    - 'ptt /ticket:'
    - '/impersonateuser:'
    - 'renew /ticket:'
    - 'asktgt /user:'
    - 'harvest /interval:'
    - 's4u /user:'
    - 's4u /ticket:'
    - 'hash /password:'
    - 'golden /aes256:'
    - 'silver /user:'
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Win32_QuickFixEngineering
    - HotFixID
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - New-Object
    - System.Net.NetworkInformation.Ping
    - .Send(
- condition: selection
  selection:
    ScriptBlockText|contains:
    - Import-Module "$Env:Temp\
    - Import-Module '$Env:Temp\
    - Import-Module $Env:Temp\
    - Import-Module "$Env:Appdata\
    - Import-Module '$Env:Appdata\
    - Import-Module $Env:Appdata\
    - Import-Module C:\Users\Public\
    - ipmo "$Env:Temp\
    - ipmo '$Env:Temp\
    - ipmo $Env:Temp\
    - ipmo "$Env:Appdata\
    - ipmo '$Env:Appdata\
    - ipmo $Env:Appdata\
    - ipmo C:\Users\Public\
- condition: all of selection_*
  selection_cmdlet:
    ScriptBlockText|contains:
    - 'Add-AppPackage '
    - 'Add-AppxPackage '
  selection_flag:
    ScriptBlockText|contains: ' -AllowUnsigned'
- condition: selection_cmdlet
  selection_cmdlet:
    ScriptBlockText|contains|all:
    - 'invoke-command '
    - ' -ComputerName '
- condition: selection_cmdlet
  selection_cmdlet:
  - ScriptBlockText|contains: Invoke-DNSExfiltrator
  - ScriptBlockText|contains|all:
    - ' -i '
    - ' -d '
    - ' -p '
    - ' -doh '
    - ' -t '
- condition: selection_4104
  selection_4104:
    ScriptBlockText|re: .*cmd.{0,5}(?:/c|/r).+clip(?:\.exe)?.{0,4}&&.+clipboard]::\(\s\\"\{\d\}.+-f.+"
- condition: selection_iex
  selection_iex:
  - ScriptBlockText|re: \$PSHome\[\s*\d{1,3}\s*\]\s*\+\s*\$PSHome\[
  - ScriptBlockText|re: \$ShellId\[\s*\d{1,3}\s*\]\s*\+\s*\$ShellId\[
  - ScriptBlockText|re: \$env:Public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:Public\[
  - ScriptBlockText|re: \$env:ComSpec\[(\s*\d{1,3}\s*,){2}
  - ScriptBlockText|re: \*mdr\*\W\s*\)\.Name
  - ScriptBlockText|re: \$VerbosePreference\.ToString\(
- condition: selection_4104
  selection_4104:
    ScriptBlockText|re: .*cmd.{0,5}(?:/c|/r).+powershell.+(?:\$?\{?input\}?|noexit).+"
- condition: selection_4104
  selection_4104:
    ScriptBlockText|re: .*cmd.{0,5}(?:/c|/r)(?:\s|)"set\s[a-zA-Z]{3,6}.*(?:\{\d\}){1,}\\"\s+?-f(?:.*\)){1,}.*"
- condition: selection_4104
  selection_4104:
    ScriptBlockText|contains:
    - system.io.compression.deflatestream
    - system.io.streamreader
    ScriptBlockText|contains|all:
    - new-object
    - text.encoding]::ascii
    ScriptBlockText|endswith: readtoend
- condition: selection_4104
  selection_4104:
    ScriptBlockText|contains|all:
    - rundll32.exe
    - shell32.dll
    - shellexec_rundll
    - powershell
- condition: selection_4104
  selection_4104:
    ScriptBlockText|re: (?i).*(set).*&&\s?set.*(environment|invoke|\$\{?input).*&&.*"
- condition: selection_4104
  selection_4104:
    ScriptBlockText|re: (?i).*?echo.*clip.*&&.*(Clipboard|i`?n`?v`?o`?k`?e`?).*
- condition: selection_4104
  selection_4104:
    ScriptBlockText|contains|all:
    - set
    - '&&'
    - mshta
    - vbscript:createobject
    - .run
    - (window.close)
- condition: selection_4104
  selection_4104:
    ScriptBlockText|contains:
    - value
    - invoke
    - comspec
    - iex
    ScriptBlockText|contains|all:
    - '&&'
    - rundll32
    - shell32.dll
    - shellexec_rundll
- condition: selection_4104
  selection_4104:
    ScriptBlockText|re: (?i).*&&set.*(\{\d\}){2,}\\"\s+?-f.*&&.*cmd.*/c
- condition: 1 of selection_*
  selection_basic:
    ScriptBlockText|contains: Get-Keystrokes
  selection_high:
    ScriptBlockText|contains|all:
    - Get-ProcAddress user32.dll GetAsyncKeyState
    - Get-ProcAddress user32.dll GetForegroundWindow
- condition: selection
  selection:
    ScriptBlockText|contains:
    - Disable-LocalUser
    - Enable-LocalUser
    - Get-LocalUser
    - Set-LocalUser
    - New-LocalUser
    - Rename-LocalUser
    - Remove-LocalUser
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - New-MailboxExportRequest
    - ' -Mailbox '
    - ' -FilePath \\\\'
- condition: selection and not 1 of filter_optional_*
  filter_optional_amazon_ec2:
    ScriptBlockText|contains:
    - Get-SystemDriveInfo
    - C:\ProgramData\Amazon\EC2-Windows\Launch\Module\
  selection:
    ScriptBlockText|contains:
    - Add-Exfiltration
    - Add-Persistence
    - Add-RegBackdoor
    - Add-RemoteRegBackdoor
    - Add-ScrnSaveBackdoor
    - Check-VM
    - ConvertTo-Rc4ByteStream
    - Decrypt-Hash
    - Disable-ADIDNSNode
    - Disable-MachineAccount
    - Do-Exfiltration
    - Enable-ADIDNSNode
    - Enable-MachineAccount
    - Enabled-DuplicateToken
    - Exploit-Jboss
    - Export-ADR
    - Export-ADRCSV
    - Export-ADRExcel
    - Export-ADRHTML
    - Export-ADRJSON
    - Export-ADRXML
    - Find-Fruit
    - Find-GPOLocation
    - Find-TrustedDocuments
    - Get-ADIDNS
    - Get-ApplicationHost
    - Get-ChromeDump
    - Get-ClipboardContents
    - Get-FoxDump
    - Get-GPPPassword
    - Get-IndexedItem
    - Get-KerberosAESKey
    - Get-Keystrokes
    - Get-LSASecret
    - Get-MachineAccountAttribute
    - Get-MachineAccountCreator
    - Get-PassHashes
    - Get-RegAlwaysInstallElevated
    - Get-RegAutoLogon
    - Get-RemoteBootKey
    - Get-RemoteCachedCredential
    - Get-RemoteLocalAccountHash
    - Get-RemoteLSAKey
    - Get-RemoteMachineAccountHash
    - Get-RemoteNLKMKey
    - Get-RickAstley
    - Get-Screenshot
    - Get-SecurityPackages
    - Get-ServiceFilePermission
    - Get-ServicePermission
    - Get-ServiceUnquoted
    - Get-SiteListPassword
    - Get-System
    - Get-TimedScreenshot
    - Get-UnattendedInstallFile
    - Get-Unconstrained
    - Get-USBKeystrokes
    - Get-VaultCredential
    - Get-VulnAutoRun
    - Get-VulnSchTask
    - Grant-ADIDNSPermission
    - Gupt-Backdoor
    - HTTP-Login
    - Install-ServiceBinary
    - Install-SSP
    - Invoke-ACLScanner
    - Invoke-ADRecon
    - Invoke-ADSBackdoor
    - Invoke-AgentSmith
    - Invoke-AllChecks
    - Invoke-ARPScan
    - Invoke-AzureHound
    - Invoke-BackdoorLNK
    - Invoke-BadPotato
    - Invoke-BetterSafetyKatz
    - Invoke-BypassUAC
    - Invoke-Carbuncle
    - Invoke-Certify
    - Invoke-ConPtyShell
    - Invoke-CredentialInjection
    - Invoke-DAFT
    - Invoke-DCSync
    - Invoke-DinvokeKatz
    - Invoke-DllInjection
    - Invoke-DNSUpdate
    - Invoke-DomainPasswordSpray
    - Invoke-DowngradeAccount
    - Invoke-EgressCheck
    - Invoke-Eyewitness
    - Invoke-FakeLogonScreen
    - Invoke-Farmer
    - Invoke-Get-RBCD-Threaded
    - Invoke-Gopher
    - Invoke-Grouper
    - Invoke-HandleKatz
    - Invoke-ImpersonatedProcess
    - Invoke-ImpersonateSystem
    - Invoke-InteractiveSystemPowerShell
    - Invoke-Internalmonologue
    - Invoke-Inveigh
    - Invoke-InveighRelay
    - Invoke-KrbRelay
    - Invoke-LdapSignCheck
    - Invoke-Lockless
    - Invoke-MalSCCM
    - Invoke-Mimikatz
    - Invoke-Mimikittenz
    - Invoke-MITM6
    - Invoke-NanoDump
    - Invoke-NetRipper
    - Invoke-Nightmare
    - Invoke-NinjaCopy
    - Invoke-OfficeScrape
    - Invoke-OxidResolver
    - Invoke-P0wnedshell
    - Invoke-Paranoia
    - Invoke-PortScan
    - Invoke-PoshRatHttp
    - Invoke-PostExfil
    - Invoke-PowerDump
    - Invoke-PowerShellTCP
    - Invoke-PowerShellWMI
    - Invoke-PPLDump
    - Invoke-PsExec
    - Invoke-PSInject
    - Invoke-PsUaCme
    - Invoke-ReflectivePEInjection
    - Invoke-ReverseDNSLookup
    - Invoke-Rubeus
    - Invoke-RunAs
    - Invoke-SafetyKatz
    - Invoke-SauronEye
    - Invoke-SCShell
    - Invoke-Seatbelt
    - Invoke-ServiceAbuse
    - Invoke-ShadowSpray
    - Invoke-Sharp
    - Invoke-Shellcode
    - Invoke-SMBScanner
    - Invoke-Snaffler
    - Invoke-Spoolsample
    - Invoke-SpraySinglePassword
    - Invoke-SSHCommand
    - Invoke-StandIn
    - Invoke-StickyNotesExtract
    - Invoke-SystemCommand
    - Invoke-Tasksbackdoor
    - Invoke-Tater
    - Invoke-Thunderfox
    - Invoke-ThunderStruck
    - Invoke-TokenManipulation
    - Invoke-Tokenvator
    - Invoke-TotalExec
    - Invoke-UrbanBishop
    - Invoke-UserHunter
    - Invoke-VoiceTroll
    - Invoke-Whisker
    - Invoke-WinEnum
    - Invoke-winPEAS
    - Invoke-WireTap
    - Invoke-WmiCommand
    - Invoke-WMIExec
    - Invoke-WScriptBypassUAC
    - Invoke-Zerologon
    - MailRaider
    - New-ADIDNSNode
    - New-DNSRecordArray
    - New-HoneyHash
    - New-InMemoryModule
    - New-MachineAccount
    - New-SOASerialNumberArray
    - Out-Minidump
    - Port-Scan
    - PowerBreach
    - 'powercat '
    - PowerUp
    - PowerView
    - Remove-ADIDNSNode
    - Remove-MachineAccount
    - Remove-Update
    - Rename-ADIDNSNode
    - Revoke-ADIDNSPermission
    - Set-ADIDNSNode
    - Set-MacAttribute
    - Set-MachineAccountAttribute
    - Set-Wallpaper
    - Show-TargetScreen
    - Start-CaptureServer
    - Start-WebcamRecorder
    - VolumeShadowCopyTools
- condition: selection
  selection:
    ScriptBlockText|contains:
    - AdjustTokenPrivileges
    - IMAGE_NT_OPTIONAL_HDR64_MAGIC
    - Metasploit
    - Microsoft.Win32.UnsafeNativeMethods
    - Mimikatz
    - MiniDumpWriteDump
    - PAGE_EXECUTE_READ
    - ReadProcessMemory.Invoke
    - SE_PRIVILEGE_ENABLED
    - SECURITY_DELEGATION
    - TOKEN_ADJUST_PRIVILEGES
    - TOKEN_ALL_ACCESS
    - TOKEN_ASSIGN_PRIMARY
    - TOKEN_DUPLICATE
    - TOKEN_ELEVATION
    - TOKEN_IMPERSONATE
    - TOKEN_INFORMATION_CLASS
    - TOKEN_PRIVILEGES
    - TOKEN_QUERY
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Get-StorageDiagnosticInfo
    - -IncludeLiveDump
- condition: all of selection_*
  selection_key:
    ScriptBlockText|contains:
    - GroupPolicyRefreshTimeDC
    - GroupPolicyRefreshTimeOffsetDC
    - GroupPolicyRefreshTime
    - GroupPolicyRefreshTimeOffset
    - EnableSmartScreen
    - ShellSmartScreenLevel
  selection_path:
    ScriptBlockText|contains: \SOFTWARE\Policies\Microsoft\Windows\System
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - New-Object
    - -ComObject
    - MsXml2.
    - XmlHttp
- condition: selection
  selection:
    ScriptBlockText|contains:
    - Add-ConstrainedDelegationBackdoor
    - Copy-VSS
    - Create-MultipleSessions
    - DataToEncode
    - DNS_TXT_Pwnage
    - Do-Exfiltration-Dns
    - Download_Execute
    - Download-Execute-PS
    - DownloadAndExtractFromRemoteRegistry
    - DumpCerts
    - DumpCreds
    - DumpHashes
    - Enable-DuplicateToken
    - Enable-Duplication
    - Execute-Command-MSSQL
    - Execute-DNSTXT-Code
    - Execute-OnTime
    - ExetoText
    - exfill
    - ExfilOption
    - FakeDC
    - FireBuster
    - FireListener
    - 'Get-Information '
    - Get-PassHints
    - Get-Web-Credentials
    - Get-WebCredentials
    - Get-WLAN-Keys
    - HTTP-Backdoor
    - Invoke-AmsiBypass
    - Invoke-BruteForce
    - Invoke-CredentialsPhish
    - Invoke-Decode
    - Invoke-Encode
    - Invoke-Interceptor
    - Invoke-JSRatRegsvr
    - Invoke-JSRatRundll
    - Invoke-MimikatzWDigestDowngrade
    - Invoke-NetworkRelay
    - Invoke-PowerShellIcmp
    - Invoke-PowerShellUdp
    - Invoke-Prasadhak
    - Invoke-PSGcat
    - Invoke-PsGcatAgent
    - Invoke-SessionGopher
    - Invoke-SSIDExfil
    - LoggedKeys
    - Nishang
    - NotAllNameSpaces
    - Out-CHM
    - OUT-DNSTXT
    - Out-HTA
    - Out-RundllCommand
    - Out-SCF
    - Out-SCT
    - Out-Shortcut
    - Out-WebQuery
    - Out-Word
    - Parse_Keys
    - Password-List
    - Powerpreter
    - Remove-Persistence
    - Remove-PoshRat
    - Remove-Update
    - Run-EXEonRemote
    - Set-DCShadowPermissions
    - Set-RemotePSRemoting
    - Set-RemoteWMI
    - Shellcode32
    - Shellcode64
    - StringtoBase64
    - TexttoExe
- condition: all of selection*
  selection_content:
    ScriptBlockText|contains:
    - set-content
    - add-content
  selection_stream:
    ScriptBlockText|contains: -stream
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'new-object '
    - '-ComObject '
    - .application
    - .RegisterXLL
- condition: 1 of selection*
  selection_1:
    ScriptBlockText|contains|all:
    - DumpCreds
    - DumpCerts
  selection_2:
    ScriptBlockText|contains: sekurlsa::logonpasswords
  selection_3:
    ScriptBlockText|contains|all:
    - crypto::certificates
    - CERT_SYSTEM_STORE_LOCAL_MACHINE
- condition: selection
  selection:
    ScriptBlockText|contains:
    - Add-DomainGroupMember
    - Add-DomainObjectAcl
    - Add-ObjectAcl
    - Add-RemoteConnection
    - Convert-ADName
    - ConvertFrom-UACValue
    - Convert-NameToSid
    - ConvertTo-SID
    - Export-PowerViewCSV
    - Find-DomainLocalGroupMember
    - Find-DomainObjectPropertyOutlier
    - Find-DomainProcess
    - Find-DomainShare
    - Find-DomainUserEvent
    - Find-DomainUserLocation
    - Find-ForeignGroup
    - Find-ForeignUser
    - Find-GPOComputerAdmin
    - Find-GPOLocation
    - Find-InterestingDomain
    - Find-InterestingFile
    - Find-LocalAdminAccess
    - Find-ManagedSecurityGroups
    - Get-CachedRDPConnection
    - Get-DFSshare
    - Get-DNSRecord
    - Get-DNSZone
    - Get-DomainComputer
    - Get-DomainController
    - Get-DomainDFSShare
    - Get-DomainDNSRecord
    - Get-DomainDNSZone
    - Get-DomainFileServer
    - Get-DomainGPO
    - Get-DomainGroup
    - Get-DomainGroupMember
    - Get-DomainManagedSecurityGroup
    - Get-DomainObject
    - Get-DomainObjectAcl
    - Get-DomainOU
    - Get-DomainPolicy
    - Get-DomainSID
    - Get-DomainSite
    - Get-DomainSPNTicket
    - Get-DomainSubnet
    - Get-DomainUser
    - Get-DomainUserEvent
    - Get-Forest
    - Get-IPAddress
    - Get-LastLoggedOn
    - Get-LoggedOnLocal
    - Get-NetComputer
    - Get-NetDomain
    - Get-NetFileServer
    - Get-NetForest
    - Get-NetGPO
    - Get-NetGroup
    - Get-NetLocalGroup
    - Get-NetLoggedon
    - Get-NetOU
    - Get-NetProcess
    - Get-NetRDPSession
    - Get-NetSession
    - Get-NetShare
    - Get-NetSite
    - Get-NetSubnet
    - Get-NetUser
    - Get-ObjectAcl
    - Get-PathAcl
    - Get-Proxy
    - Get-RegistryMountedDrive
    - Get-RegLoggedOn
    - Get-SiteName
    - Get-UserEvent
    - Get-WMIProcess
    - Get-WMIReg
    - Invoke-ACLScanner
    - Invoke-CheckLocalAdminAccess
    - Invoke-EnumerateLocalAdmin
    - Invoke-EventHunter
    - Invoke-FileFinder
    - Invoke-Kerberoast
    - Invoke-MapDomainTrust
    - Invoke-ProcessHunter
    - Invoke-RevertToSelf
    - Invoke-ShareFinder
    - Invoke-UserHunter
    - Invoke-UserImpersonation
    - New-DomainGroup
    - New-DomainUser
    - Remove-RemoteConnection
    - Request-SPNTicket
    - Resolve-IPAddress
    - Set-ADObject
    - Set-DomainObject
    - Set-DomainUserPassword
    - Test-AdminAccess
- condition: selection
  selection:
    ScriptBlockText|contains: PromptForCredential
- condition: selection
  selection:
    ScriptBlockText|contains: PSAsyncShell
- condition: selection
  selection:
    ScriptBlockText|contains: PS ATTACK!!!
- condition: selection
  selection:
    ScriptBlockText|startswith: function Get-VMRemoteFXPhysicalVideoAdapter {
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - New-PSSession
    - '-ComputerName '
- condition: selection and not filter_reg
  filter_reg:
    ScriptBlockText|contains:
    - HKCU:\
    - HKLM:\
  selection:
    ScriptBlockText|contains|all:
    - Remove-Item
    - '-Path '
- condition: selection
  selection:
    ScriptBlockText|contains: System.IdentityModel.Tokens.KerberosRequestorSecurityToken
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'Get-content '
    - foreach
    - '[System.Net.Dns]::GetHostEntry'
    - Out-File
- condition: 1 of selection*
  selection1:
    ScriptBlockText|contains|all:
    - Move-Item
    - Cert:\LocalMachine\Root
  selection2:
    ScriptBlockText|contains|all:
    - Import-Certificate
    - Cert:\LocalMachine\Root
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'Mount-DiskImage '
    - '-ImagePath '
    - Get-Volume
    - .DriveLetter
    - 'invoke-item '
    - ):\
- condition: all of selection_*
  selection_cmdlet:
    ScriptBlockText|contains:
    - Invoke-WebRequest
    - 'iwr '
  selection_flag:
    ScriptBlockText|contains:
    - -Method Put
    - -Method Post
- condition: all of selection_*
  selection_1:
    ScriptBlockText|contains|all:
    - get-process
    - .Description
    - -like
  selection_2:
    ScriptBlockText|contains:
    - '"*virus*"'
    - '"*carbonblack*"'
    - '"*defender*"'
    - '"*cylance*"'
- condition: selection and not filter
  filter:
    ScriptBlockText|contains: CmdletsToExport
  selection:
    ScriptBlockText|contains: Send-MailMessage
- condition: all of selection_*
  selection_action:
    ScriptBlockText|contains:
    - ls
    - get-childitem
    - gci
  selection_file:
    ScriptBlockText|contains:
    - .pass
    - .kdbx
    - .kdb
  selection_recurse:
    ScriptBlockText|contains: -recurse
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'Set-Acl '
    - '-AclObject '
    - '-Path '
- condition: all of selection_*
  selection_cmdlet:
    ScriptBlockText|contains|all:
    - 'Set-Acl '
    - '-AclObject '
  selection_paths:
    ScriptBlockText|contains:
    - -Path "C:\Windows
    - -Path "C:/Windows
    - -Path 'C:\Windows
    - -Path 'C:/Windows
    - -Path C:\\Windows
    - -Path C:/Windows
    - -Path $env:windir
    - -Path "$env:windir
    - -Path '$env:windir
  selection_permissions:
    ScriptBlockText|contains:
    - FullControl
    - Allow
- cmdlet:
    ScriptBlockText|contains: Set-ExecutionPolicy
  condition: cmdlet and option and not filter
  filter:
    ScriptBlockText|contains:
    - (New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1')
    - (New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1')
    - \AppData\Roaming\Code\
  option:
    ScriptBlockText|contains:
    - Unrestricted
    - bypass
    - RemoteSigned
- condition: selection and selection2
  selection:
    ScriptBlockText|contains: AAAAYInlM
  selection2:
    ScriptBlockText|contains:
    - OiCAAAAYInlM
    - OiJAAAAYInlM
- condition: selection
  selection:
    ScriptBlockText|contains:
    - Invoke-SMBAutoBrute
    - Invoke-GPOLinks
    - Invoke-Potato
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - get-itemProperty
    - \software\
    - select-object
    - format-table
- condition: selection_compspec
  selection_compspec:
    ScriptBlockText|contains|all:
    - Start-Process
    - '-FilePath "$env:comspec" '
    - '-ArgumentList '
    - '>'
- condition: selection
  selection:
    ScriptBlockText|contains:
    - \Lsa\JD
    - \Lsa\Skew1
    - \Lsa\Data
    - \Lsa\GBG
    ScriptBlockText|contains|all:
    - win32_Trustee
    - win32_Ace
    - .AccessMask
    - .AceType
    - .SetSecurityDescriptor
- condition: 1 of test_*
  test_2:
    ScriptBlockText|contains: get-ADPrincipalGroupMembership
  test_7:
    ScriptBlockText|contains|all:
    - get-aduser
    - '-f '
    - '-pr '
    - DoesNotRequirePreAuth
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - -Alias
    - ' -Value (-join('
- condition: selection
  selection:
    ScriptBlockText|contains:
    - 'Clear-EventLog '
    - 'Remove-EventLog '
    - 'Limit-EventLog '
    - 'Clear-WinEvent '
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - foreach
    - Get-ChildItem
    - '-Path '
    - '-ErrorAction '
    - SilentlyContinue
    - 'Out-File '
    - -append
- condition: webclient and download
  download:
    ScriptBlockText|contains:
    - .DownloadFile(
    - .DownloadString(
  webclient:
    ScriptBlockText|contains: System.Net.WebClient
- condition: all of selection_*
  selection_batch:
    ScriptBlockText|contains:
    - .cmd
    - .bat
  selection_start:
    ScriptBlockText|contains: Start-Process
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - ls
    - ' -R'
    - 'select-string '
    - '-Pattern '
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Invoke-TroubleshootingPack
    - C:\Windows\Diagnostics\System\PCW
    - -AnswerFile
    - -Unattended
- condition: selection
  selection:
    ScriptBlockText|contains: Get-Process lsass
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - ::GetTypeFromCLSID(
    - .ShellExecute(
- condition: selection
  selection:
    ScriptBlockText|contains: Get-AdDefaultDomainPasswordPolicy
- condition: selection
  selection:
    ScriptBlockText|contains:
    - '[System.Environment]::UserName'
    - $env:UserName
    - '[System.Security.Principal.WindowsIdentity]::GetCurrent()'
- condition: selection
  selection:
    ScriptBlockText|contains: Get-GPO
- condition: selection
  selection:
    ScriptBlockText|contains: Get-Process
- condition: selection and not 1 of filter_*
  filter_cl_utility:
    Path|endswith: \CL_Utility.ps1
    ScriptBlockText|contains|all:
    - function Get-FreeSpace
    - SELECT * FROM Win32_LogicalDisk WHERE MediaType=12
  selection:
    ScriptBlockText|contains:
    - Get-WmiObject
    - gwmi
- condition: selection
  selection:
    ScriptBlockText|contains:
    - New-VM
    - Set-VMFirmware
    - Start-VM
- condition: all of selection*
  selection_encoded:
    ScriptBlockText|contains:
    - ' -enc '
    - ' -EncodedCommand '
    - ' -ec '
  selection_hidden:
    ScriptBlockText|contains:
    - ' -w hidden '
    - ' -window hidden '
    - ' -windowstyle hidden '
    - ' -w 1 '
  selection_noninteractive:
    ScriptBlockText|contains:
    - ' -noni '
    - ' -noninteractive '
- condition: 1 of selection_* and not 1 of filter_*
  filter_chocolatey:
    ScriptBlockText|contains:
    - (New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1
    - (New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1')
    - Write-ChocolateyWarning
  selection_convert_b64:
    ScriptBlockText|contains|all:
    - -nop
    - ' -w '
    - hidden
    - ' -c '
    - '[Convert]::FromBase64String'
  selection_enc_selection:
    ScriptBlockText|contains|all:
    - ' -w '
    - hidden
    - -ep
    - bypass
    - -Enc
  selection_iex_selection:
    ScriptBlockText|contains|all:
    - ' -w '
    - hidden
    - -noni
    - -nop
    - ' -c '
    - iex
    - New-Object
  selection_iex_webclient:
    ScriptBlockText|contains|all:
    - iex
    - New-Object
    - Net.WebClient
    - .Download
  selection_reg_selection:
    ScriptBlockText|contains|all:
    - powershell
    - reg
    - add
    - HKCU\software\microsoft\windows\currentversion\run
  selection_webclient_selection:
    ScriptBlockText|contains|all:
    - bypass
    - -noprofile
    - -windowstyle
    - hidden
    - new-object
    - system.net.webclient
    - .download
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Invoke-WebRequest
    - '-UserAgent '
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - New-Object
    - IO.FileStream
    - \\\\.\\
- condition: selection
  selection:
    ScriptBlockText|contains: '[Windows.Input.Keyboard]::IsKeyDown([System.Windows.Input.Key]::'
- condition: selection
  selection:
    ScriptBlockText|contains:
    - System.Reflection.Assembly.Load($
    - '[System.Reflection.Assembly]::Load($'
    - '[Reflection.Assembly]::Load($'
    - System.Reflection.AssemblyName
    - Reflection.Emit.AssemblyBuilderAccess
    - Reflection.Emit.CustomAttributeBuilder
    - Runtime.InteropServices.UnmanagedType
    - Runtime.InteropServices.DllImportAttribute
    - SuspendThread
    - rundll32
- condition: 1 of test_*
  test_3:
    ScriptBlockText|contains:
    - get-localgroup
    - Get-LocalGroupMember
  test_6:
    ScriptBlockText|contains|all:
    - Get-WMIObject
    - Win32_Group
- condition: selection
  selection:
    ScriptBlockText|contains:
    - Get-Inbox.ps1
    - Microsoft.Office.Interop.Outlook
    - Microsoft.Office.Interop.Outlook.olDefaultFolders
    - -comobject outlook.application
- condition: selection
  selection:
    ScriptBlockText|contains:
    - Remove-SmbShare
    - Remove-FileShare
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'Mount-DiskImage '
    - '-ImagePath '
- condition: selection
  selection:
    ScriptBlockText|contains:
    - System.DirectoryServices.Protocols.LdapDirectoryIdentifier
    - System.Net.NetworkCredential
    - System.DirectoryServices.Protocols.LdapConnection
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - New-PSDrive
    - '-psprovider '
    - filesystem
    - '-root '
    - \\\\
    - $
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - '[System.Net.HttpWebRequest]'
    - System.Net.Sockets.TcpListener
    - AcceptTcpClient
- condition: all of selection*
  selection_action:
    ScriptBlockText|contains:
    - 'Get-Service '
    - 'Get-ChildItem '
    - 'Get-Process '
  selection_redirect:
    ScriptBlockText|contains: '> $env:TEMP\'
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Remove-ADGroupMember
    - '-Identity '
    - '-Members '
- condition: all of selection_*
  selection_sddl_flag:
    ScriptBlockText|contains:
    - '-SecurityDescriptorSddl '
    - '-sd '
  selection_set_service:
    ScriptBlockText|contains:
    - ;;;IU
    - ;;;SU
    - ;;;BA
    - ;;;SY
    - ;;;WD
    ScriptBlockText|contains|all:
    - 'Set-Service '
    - D;;
- condition: selection
  selection:
    ScriptBlockText|contains:
    - 'Set-Alias '
    - 'New-Alias '
- condition: selection
  selection:
    ScriptBlockText|contains: get-smbshare
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - System.Net.Security.SslStream
    - Net.Security.RemoteCertificateValidationCallback
    - .AuthenticateAsClient
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Start-Process
    - '-PassThru '
    - '-FilePath '
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'Unblock-File '
    - '-Path '
- condition: 1 of selection_*
  selection_1:
    ScriptBlockText|contains|all:
    - Get-ItemProperty
    - 'Registry::'
    - HKEY_CURRENT_USER\Control Panel\Desktop\
    - WallPaper
  selection_2:
    ScriptBlockText|contains: SystemParametersInfo(20,0,*,3)
- condition: selection
  selection:
    ScriptBlockText|contains: Win32_PnPEntity
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Get-WmiObject
    - Win32_Shadowcopy
    - .Delete()
- condition: all of selection*
  selection_delete:
    ScriptBlockText|contains:
    - .Delete()
    - Remove-WmiObject
    - rwmi
    - Remove-CimInstance
    - rcim
  selection_get:
    ScriptBlockText|contains:
    - Get-WmiObject
    - gwmi
    - Get-CimInstance
    - gcim
  selection_shadowcopy:
    ScriptBlockText|contains: Win32_Shadowcopy
- condition: selection and not filter
  filter:
    ScriptBlockText|contains|all:
    - :\Program Files\Amazon\WorkSpacesConfig\Scripts\
    - $PSScriptRoot\Module\WorkspaceScriptModule\WorkspaceScriptModule
  selection:
    ScriptBlockText|contains|all:
    - powershell
    - WindowStyle
    - Hidden
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - Write-EventLog
    - '-RawData '
- condition: selection_4104
  selection_4104:
    ScriptBlockText|contains|all:
    - 'Compress-Archive '
    - ' -Path '
    - ' -DestinationPath '
    - $env:TEMP\
- condition: selection
  selection:
    ScriptBlockText|contains: SyncAppvPublishingServer.exe
- condition: all of selection_*
  selection_remove:
    ScriptBlockText|contains: Remove-MpPreference
  selection_tamper:
    ScriptBlockText|contains:
    - '-ControlledFolderAccessProtectedFolders '
    - '-AttackSurfaceReductionRules_Ids '
    - '-AttackSurfaceReductionRules_Actions '
    - '-CheckForSignaturesBeforeRunningScan '
- condition: all of selection_options_disabling_* or all of selection_other_default_actions_*
  selection_options_disabling_function:
    ScriptBlockText|contains:
    - -dbaf $true
    - -dbaf 1
    - -dbm $true
    - -dbm 1
    - -dips $true
    - -dips 1
    - -DisableArchiveScanning $true
    - -DisableArchiveScanning 1
    - -DisableBehaviorMonitoring $true
    - -DisableBehaviorMonitoring 1
    - -DisableBlockAtFirstSeen $true
    - -DisableBlockAtFirstSeen 1
    - -DisableIntrusionPreventionSystem $true
    - -DisableIntrusionPreventionSystem 1
    - -DisableIOAVProtection $true
    - -DisableIOAVProtection 1
    - -DisableRealtimeMonitoring $true
    - -DisableRealtimeMonitoring 1
    - -DisableRemovableDriveScanning $true
    - -DisableRemovableDriveScanning 1
    - -DisableScanningMappedNetworkDrivesForFullScan $true
    - -DisableScanningMappedNetworkDrivesForFullScan 1
    - -DisableScanningNetworkFiles $true
    - -DisableScanningNetworkFiles 1
    - -DisableScriptScanning $true
    - -DisableScriptScanning 1
    - -drdsc $true
    - -drdsc 1
    - -drtm $true
    - -drtm 1
    - -dscrptsc $true
    - -dscrptsc 1
    - -dsmndf $true
    - -dsmndf 1
    - -dsnf $true
    - -dsnf 1
    - -dss $true
    - -dss 1
  selection_options_disabling_preference:
    ScriptBlockText|contains: Set-MpPreference
  selection_other_default_actions_allow:
    ScriptBlockText|contains: Set-MpPreference
  selection_other_default_actions_func:
    ScriptBlockText|contains:
    - HighThreatDefaultAction Allow
    - htdefac Allow
    - LowThreatDefaultAction Allow
    - ltdefac Allow
    - ModerateThreatDefaultAction Allow
    - mtdefac Allow
    - SevereThreatDefaultAction Allow
    - stdefac Allow
- condition: selection and not filter
  filter:
    ScriptBlockText|contains:
    - ' 443 '
    - ' 80 '
  selection:
    ScriptBlockText|contains|all:
    - Test-NetConnection
    - '-ComputerName '
    - '-port '
- condition: selection_ioc
  selection_ioc:
    ScriptBlockText|contains:
    - .CreationTime =
    - .LastWriteTime =
    - .LastAccessTime =
    - '[IO.File]::SetCreationTime'
    - '[IO.File]::SetLastAccessTime'
    - '[IO.File]::SetLastWriteTime'
- condition: selection and not 1 of filter_*
  filter_chocolatey:
    ScriptBlockText|contains:
    - it will return true or false instead
    - The function also prevents `Get-ItemProperty` from failing
  filter_exchange:
    Path|endswith: \bin\servicecontrol.ps1
    Path|startswith: C:\Program Files\Microsoft\Exchange Server\
    ScriptBlockText|contains: '`r`n'
  selection:
  - ScriptBlockText|re: \w+`(\w+|-|.)`[\w+|\s]
  - ScriptBlockText|re: '"(\{\d\}){2,}"\s*-f'
  - ScriptBlockText|re: \$\{((e|n|v)*`(e|n|v)*)+:path\}|\$\{((e|n|v)*`(e|n|v)*)+:((p|a|t|h)*`(p|a|t|h)*)+\}|\$\{env:((p|a|t|h)*`(p|a|t|h)*)+\}
- condition: selection
  selection:
    ScriptBlockText|contains:
    - ' > '
    - ' | Select '
    - Out-File
    - Set-Content
    - Add-Content
    ScriptBlockText|contains|all:
    - 'Get-ADUser '
    - ' -Filter \*'
- condition: all of selection_*
  selection_add:
    ScriptBlockText|contains: Add-Content $profile
  selection_options:
    ScriptBlockText|contains:
    - '-Value "IEX '
    - -Value "Invoke-Expression
    - -Value "Invoke-WebRequest
    - -Value "Start-Process
    - '-Value ''IEX '
    - -Value 'Invoke-Expression
    - -Value 'Invoke-WebRequest
    - -Value 'Start-Process
- condition: selection
  selection:
    ScriptBlockText|contains:
    - '-SecurityDescriptorSddl '
    - '-sd '
    ScriptBlockText|contains|all:
    - 'Set-Service '
    - DCLCWPDTSD
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - '[Credentials]'
    - '[Veeam.Backup.Common.ProtectedStorage]::GetLocalString'
    - Invoke-Sqlcmd
    - Veeam Backup and Replication
- condition: selection and not filter
  filter:
    Path|startswith: C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\
  selection:
    ScriptBlockText|contains:
    - '[System.Net.WebRequest]::create'
    - 'curl '
    - Invoke-RestMethod
    - Invoke-WebRequest
    - 'iwr '
    - Net.WebClient
    - Resume-BitsTransfer
    - Start-BitsTransfer
    - 'wget '
    - WinHttp.WinHttpRequest
- condition: all of selection_*
  selection_class:
    ScriptBlockText|contains: Win32_NTEventlogFile
  selection_function:
    ScriptBlockText|contains:
    - .BackupEventlog(
    - .ChangeSecurityPermissions(
    - .ChangeSecurityPermissionsEx(
    - .ClearEventLog(
    - .Delete(
    - .DeleteEx(
    - .Rename(
    - .TakeOwnerShip(
    - .TakeOwnerShipEx(
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - 'Invoke-CimMethod '
    - '-ClassName '
    - 'Win32_Product '
    - '-MethodName '
    - .msi
- condition: all of selection*
  selection_args:
    ScriptBlockText|contains|all:
    - 'Set-NetFirewallProfile '
    - ' -Enabled '
    - ' False'
  selection_opt:
    ScriptBlockText|contains:
    - ' -All '
    - Public
    - Domain
    - Private
- condition: all of selection*
  selection:
    ScriptBlockText|contains: CurrentVersion\Winlogon
  selection2:
    ScriptBlockText|contains:
    - Set-ItemProperty
    - New-Item
- condition: all of selection*
  selection_args_exc:
    ScriptBlockText|contains:
    - ' -ExclusionPath '
    - ' -ExclusionExtension '
    - ' -ExclusionProcess '
    - ' -ExclusionIpAddress '
  selection_args_pref:
    ScriptBlockText|contains:
    - 'Add-MpPreference '
    - 'Set-MpPreference '
- condition: selection
  selection:
    ScriptBlockText|contains:
    - WMImplant
    - ' change_user '
    - ' gen_cli '
    - ' command_exec '
    - ' disable_wdigest '
    - ' disable_winrm '
    - ' enable_wdigest '
    - ' enable_winrm '
    - ' registry_mod '
    - ' remote_posh '
    - ' sched_job '
    - ' service_mod '
    - ' process_kill '
    - ' active_users '
    - ' basic_info '
    - ' power_off '
    - ' vacant_system '
    - ' logon_events '
- condition: selection_ioc
  selection_ioc:
  - ScriptBlockText|contains|all:
    - 'New-CimInstance '
    - '-Namespace root/subscription '
    - '-ClassName __EventFilter '
    - '-Property '
  - ScriptBlockText|contains|all:
    - 'New-CimInstance '
    - '-Namespace root/subscription '
    - '-ClassName CommandLineEventConsumer '
    - '-Property '
- condition: selection
  selection:
    ScriptBlockText|contains:
    - 'Get-WmiObject '
    - 'gwmi '
    ScriptBlockText|contains|all:
    - ' Win32_Service '
    - Name
    - DisplayName
    - PathName
    - StartMode
- condition: selection
  selection:
    ScriptBlockText|contains:
    - X509Enrollment.CBinaryConverter
    - 884e2002-217d-11da-b2a4-000e7bbb2b09
- condition: all of selection_*
  selection_exec:
    ScriptBlockText|contains:
    - 'IEX '
    - 'Invoke-Expression '
    - 'Invoke-Command '
    - ICM -
  selection_xml:
    ScriptBlockText|contains|all:
    - New-Object
    - System.Xml.XmlDocument
    - .Load
- condition: selection
  selection:
    CallTrace|contains: cmlua.dll
- condition: selection
  selection:
    CallTrace|re: ^C:\\Windows\\SYSTEM32\\ntdll\.dll\+[a-z0-9]{4,6}\|C:\\Windows\\System32\\KERNELBASE\.dll\+[a-z0-9]{4,6}\|UNKNOWN\([A-Z0-9]{16}\)$
    GrantedAccess:
    - '0x1028'
    - '0x1fffff'
- condition: selection and not 1 of filter_*
  filter_defender:
    SourceImage|endswith: \MsMpEng.exe
    SourceImage|startswith:
    - C:\ProgramData\Microsoft\Windows Defender\
    - C:\Program Files\Windows Defender\
    - C:\Program Files\Microsoft Security Client\MsMpEng.exe
  filter_defender_calltrace:
    CallTrace|contains:
    - '|c:\program files\windows defender\mprtp.dll'
    - '|c:\program files\windows defender\MpClient.dll'
  filter_defender_updates:
    CallTrace|contains|all:
    - '|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{'
    - '}\mpengine.dll+'
    GrantedAccess: '0x1418'
    SourceImage: C:\Windows\System32\svchost.exe
  filter_dropbox:
    GrantedAccess:
    - '0x410'
    - '0x1410'
    SourceImage|contains:
    - :\Windows\Temp\
    - \AppData\Local\Temp\
    SourceImage|endswith: .tmp\DropboxUpdate.exe
  filter_edge:
    SourceImage|endswith: \Installer\setup.exe
    SourceImage|startswith: C:\Program Files (x86)\Microsoft\Edge\Application\
  filter_exact:
    SourceImage:
    - C:\WINDOWS\system32\taskmgr.exe
    - C:\Windows\System32\perfmon.exe
  filter_explorer:
    GrantedAccess: '0x401'
    SourceImage|endswith: \explorer.exe
  filter_games:
    SourceImage|contains: \SteamLibrary\steamapps\
  filter_gaming_services:
    GrantedAccess:
    - '0x1410'
    - '0x410'
    SourceImage|endswith: \GamingServices.exe
    SourceImage|startswith: C:\Program Files\WindowsApps\
  filter_generic:
    GrantedAccess:
    - '0x1410'
    - '0x410'
    SourceImage|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_handle:
    GrantedAccess: '0x40'
    SourceImage|endswith:
    - \handle.exe
    - \handle64.exe
  filter_malwarebytes:
    GrantedAccess: '0x1410'
    SourceImage: C:\PROGRAMDATA\MALWAREBYTES\MBAMSERVICE\ctlrupdate\mbupdatr.exe
  filter_mrt:
    GrantedAccess:
    - '0x1410'
    - '0x1418'
    SourceImage: C:\Windows\system32\MRT.exe
  filter_msbuild:
    GrantedAccess: '0x1F3FFF'
    SourceImage|endswith: \MSBuild\Current\Bin\MSBuild.exe
    SourceImage|startswith: C:\Program Files\Microsoft Visual Studio\
  filter_nextron:
    GrantedAccess:
    - '0x40'
    - '0x1010'
    SourceImage|endswith:
    - \thor.exe
    - \thor64.exe
    - \aurora-agent.exe
    - \aurora-agent-64.exe
  filter_specific_granted_access_1:
    GrantedAccess:
    - '0x1410'
    - '0x410'
    - '0x40'
    SourceImage|endswith:
    - \PROCEXP64.EXE
    - \PROCEXP.EXE
    - C:\WINDOWS\system32\taskhostw.exe
    - \MBAMInstallerService.exe
  filter_specific_granted_access_2:
    GrantedAccess:
    - '0x1410'
    - '0x410'
    - '0x1f1fff'
    - '0x1f3fff'
    SourceImage:
    - C:\WINDOWS\system32\wbem\wmiprvse.exe
    - C:\Windows\syswow64\MsiExec.exe
    - C:\Windows\System32\msiexec.exe
  filter_specific_granted_access_3:
    GrantedAccess: '0x1000000'
    SourceImage:
    - C:\Windows\system32\wininit.exe
    - C:\Windows\System32\lsass.exe
  filter_svchost:
    GrantedAccess:
    - '0x100000'
    - '0x1410'
    SourceImage: C:\WINDOWS\system32\svchost.exe
  filter_vmwaretools:
    SourceImage|endswith: \vmtoolsd.exe
    SourceImage|startswith: C:\ProgramData\VMware\VMware Tools\
  filter_webex:
    GrantedAccess: '0x401'
    SourceImage|endswith: \AppData\Local\WebEx\WebexHost.exe
  selection:
    GrantedAccess|startswith:
    - '0x40'
    - '0x100000'
    - '0x1410'
    - '0x1438'
    - '0x143a'
    - '0x1418'
    - '0x1f0fff'
    - '0x1f1fff'
    - '0x1f2fff'
    - '0x1f3fff'
    TargetImage|endswith: \lsass.exe
- condition: selection and not 1 of falsepositive*
  falsepositive1:
    SourceImage: C:\Windows\Explorer.EXE
    TargetImage: C:\Program Files\Cylance\Desktop\CylanceUI.exe
  falsepositive10:
    SourceImage|endswith: \AppData\Local\Microsoft\Teams\current\Teams.exe
    TargetImage|endswith: \AppData\Local\Microsoft\Teams\current\Teams.exe
  falsepositive2:
    SourceImage|endswith: \MicrosoftEdgeUpdate.exe
    SourceImage|startswith: C:\Program Files (x86)\Microsoft\Temp\
    TargetImage: C:\Program Files (x86)\Microsoft\EdgeUpdate\MicrosoftEdgeUpdate.exe
  falsepositive3:
    SourceImage|endswith: vcredist_x64.exe
    TargetImage|endswith: vcredist_x64.exe
  falsepositive4:
    SourceImage|endswith: setup64.exe
    TargetImage: C:\Windows\system32\systeminfo.exe
  falsepositive5:
    SourceImage|endswith: AmazonSSMAgentSetup.exe
    TargetImage|endswith: AmazonSSMAgentSetup.exe
  falsepositive6:
    SourceImage|endswith: C:\Program Files\Mozilla Firefox\firefox.exe
    TargetImage|endswith: C:\Program Files\Mozilla Firefox\firefox.exe
  falsepositive7:
    SourceImage|endswith: \AppData\Local\Programs\Microsoft VS Code\Code.exe
    TargetImage|endswith: \AppData\Local\Programs\Microsoft VS Code\Code.exe
  falsepositive8:
    SourceImage|endswith: C:\Program Files\Google\Chrome\Application\chrome.exe
    TargetImage|endswith: C:\Program Files\Google\Chrome\Application\chrome.exe
  falsepositive9:
    SourceImage|endswith: C:\Program Files (x86)\Google\Update\GoogleUpdate.exe
    TargetImage|endswith: C:\Program Files (x86)\Google\Update\GoogleUpdate.exe
  falsepositive_kerneltrace_edge:
    Provider_Name: Microsoft-Windows-Kernel-Audit-API-Calls
  falsepositives11:
    SourceImage: C:\Windows\System32\backgroundTaskHost.exe
    TargetImage: C:\Windows\System32\backgroundTaskHost.exe
  falsepositives12:
    SourceImage: C:\Program Files (x86)\CCleaner Browser\Application\CCleanerBrowser.exe
    TargetImage: C:\Program Files (x86)\CCleaner Browser\Application\CCleanerBrowser.exe
  falsepositives13:
    TargetImage|contains: \AppData\Local\Discord\
    TargetImage|endswith: \Discord.exe
    TargetImage|startswith: C:\Users\
  falsepositives14:
    TargetImage: C:\WINDOWS\system32\AUDIODG.EXE
  falsepositives15:
    GrantedAccess: '0x1000'
    SourceImage|contains: \AppData\Local\yammerdesktop\app-
    SourceImage|endswith: \Yammer.exe
    SourceImage|startswith: C:\Users\
    TargetImage|contains: \AppData\Local\yammerdesktop\app-
    TargetImage|endswith: \Yammer.exe
    TargetImage|startswith: C:\Users\
  falsepositives_mixed:
    TargetImage|endswith: \Evernote\Evernote.exe
  selection:
    CallTrace|startswith: UNKNOWN
- condition: ( selection_1 and not 1 of filter_* ) or selection_calltrace
  filter_1:
    SourceImage|startswith:
    - C:\Program Files
    - C:\Windows\System32\
  filter_msdefender:
    SourceImage|endswith: \MsMpEng.exe
    SourceImage|startswith: C:\ProgramData\Microsoft\Windows Defender\Platform\
  selection_1:
    GrantedAccess: '0x1400'
    TargetImage: C:\Windows\Sysmon64.exe
  selection_calltrace:
    CallTrace: Ente
- call_trace:
    CallTrace|contains: '|UNKNOWN('
    CallTrace|endswith: )
    CallTrace|startswith: C:\Windows\System32\ntdll.dll+
  condition: selection and call_trace
  selection:
    GrantedAccess: '0x1440'
    TargetImage|endswith: \lsass.exe
- condition: selection and not 1 of filter_*
  filter_dotnet:
    SourceImage|endswith: \NGenTask.exe
    SourceImage|startswith:
    - C:\Windows\Microsoft.NET\Framework\v
    - C:\Windows\Microsoft.NET\Framework64\v
    TargetImage|startswith:
    - C:\Windows\Microsoft.NET\Framework\v
    - C:\Windows\Microsoft.NET\Framework64\v
  filter_generic:
  - SourceImage|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  - TargetImage|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  filter_githubdesktop:
    SourceImage|contains: \AppData\Local\GitHubDesktop\app-
    SourceImage|endswith:
    - \GitHubDesktop.exe
    - \resources\app\git\usr\bin\sh.exe
    SourceImage|startswith: C:\Users\
    TargetImage|contains: \AppData\Local\GitHubDesktop\app-
    TargetImage|startswith: C:\Users\
  filter_taskhost:
    SourceImage:
    - C:\WINDOWS\system32\taskhostw.exe
    - C:\Windows\system32\taskhost.exe
    TargetImage|endswith: \NGenTask.exe
    TargetImage|startswith:
    - C:\Windows\Microsoft.NET\Framework\v
    - C:\Windows\Microsoft.NET\Framework64\v
  filter_teams_to_update:
    SourceImage|endswith: \AppData\Local\Microsoft\Teams\stage\Teams.exe
    SourceImage|startswith: C:\Users\
    TargetImage|endswith: \AppData\Local\Microsoft\Teams\Update.exe
    TargetImage|startswith: C:\Users\
  filter_teams_update_regsvr32:
    SourceImage|endswith: \AppData\Local\Microsoft\Teams\Update.exe
    SourceImage|startswith: C:\Users\
    TargetImage: C:\WINDOWS\SysWOW64\regsvr32.exe
  filter_teams_update_to_teams:
    SourceImage|endswith: \AppData\Local\Microsoft\Teams\Update.exe
    SourceImage|startswith: C:\Users\
    TargetImage|endswith: \AppData\Local\Microsoft\Teams\stage\Teams.exe
  filter_thor:
    SourceImage|endswith: \thor64.exe
    SourceImage|startswith: C:\Windows\Temp\asgard2-agent\
  selection:
    CallTrace|contains: '|UNKNOWN('
    CallTrace|endswith: )
    CallTrace|startswith: C:\Windows\SYSTEM32\ntdll.dll+
    GrantedAccess: '0x1FFFFF'
- condition: selection and not 1 of filter_*
  filter_msbuild:
    CallTrace|contains:
    - Microsoft.Build.ni.dll
    - System.ni.dll
    SourceImage|endswith: \MSBuild\Current\Bin\MSBuild.exe
    SourceImage|startswith: C:\Program Files\Microsoft Visual Studio\
  selection:
    CallTrace|contains: UNKNOWN
    GrantedAccess: '0x1F3FFF'
    TargetImage|endswith: \WINDOWS\System32\svchost.exe
- condition: selection
  selection:
    CallTrace|contains|all:
    - C:\Windows\SYSTEM32\ntdll.dll+
    - '|C:\Windows\System32\KERNELBASE.dll+'
    - _ctypes.pyd+
    - python27.dll+
    GrantedAccess: '0x1FFFFF'
    TargetImage|endswith: \lsass.exe
- condition: selection
  selection:
    CallTrace|contains|all:
    - :\Windows\Microsoft.NET\Framework64\v2.
    - UNKNOWN
    SourceImage|endswith: \winword.exe
- condition: selection
  selection:
    CallTrace|contains: editionupgrademanagerobj.dll
- condition: selection
  selection:
    CallTrace|contains: comsvcs.dll
    SourceImage: C:\Windows\System32\rundll32.exe
    TargetImage|endswith: \lsass.exe
- condition: selection and not 1 of filter*
  filter_sysmon:
    SourceImage: C:\Windows\Sysmon64.exe
  filter_thor:
    CallTrace|contains|all:
    - '|C:\Windows\Temp\asgard2-agent\'
    - \thor\thor64.exe+
    - '|UNKNOWN('
    GrantedAccess: '0x103800'
  selection:
    CallTrace|contains:
    - dbghelp.dll
    - dbgcore.dll
    - ntdll.dll
    GrantedAccess|contains:
    - '0x1038'
    - '0x1438'
    - '0x143a'
    TargetImage|endswith: \lsass.exe
- condition: selection
  selection:
    GrantedAccess|endswith:
    - '10'
    - '30'
    - '50'
    - '70'
    - '90'
    - B0
    - D0
    - F0
    - '18'
    - '38'
    - '58'
    - '78'
    - '98'
    - B8
    - D8
    - F8
    - 1A
    - 3A
    - 5A
    - 7A
    - 9A
    - BA
    - DA
    - FA
    - '0x14C2'
    - FF
    SourceImage|endswith:
    - \TrolleyExpress.exe
    - \ProcessDump.exe
    - \dump64.exe
    TargetImage|endswith: \lsass.exe
- condition: selection
  selection:
    GrantedAccess|endswith:
    - '10'
    - '30'
    - '50'
    - '70'
    - '90'
    - B0
    - D0
    - F0
    - '18'
    - '38'
    - '58'
    - '78'
    - '98'
    - B8
    - D8
    - F8
    - 1A
    - 3A
    - 5A
    - 7A
    - 9A
    - BA
    - DA
    - FA
    - '0x14C2'
    - FF
    SourceImage|contains: dump
    TargetImage|endswith: \lsass.exe
- condition: selection
  selection:
    GrantedAccess: '0x1FFFFF'
    SourceImage|endswith: \WerFault.exe
    TargetImage|endswith: \lsass.exe
- combination1:
    CallTrace|contains|all:
    - '|UNKNOWN('
    - VBE7.DLL
  combination2:
    CallTrace|contains: '|UNKNOWN'
    SourceImage|contains: \Microsoft Office\
  condition: selection and 1 of combination*
  selection:
    GrantedAccess: '0x1FFFFF'
    TargetImage|endswith: \verclsid.exe
- condition: selection and not filter
  filter:
    GrantedAccess: '0x80000000'
  selection:
    SourceImage: C:\Windows\system32\wsmprovhost.exe
    TargetImage|endswith: \lsass.exe
- condition: selection
  selection:
    CallTrace|contains|all:
    - C:\Windows\SYSTEM32\ntdll.dll+
    - C:\Windows\System32\KERNELBASE.dll+
    - libffi-7.dll
    - _ctypes.pyd+
    - python3*.dll+
    GrantedAccess: '0x1FFFFF'
    TargetImage|endswith: \lsass.exe
- condition: selection and not 1 of filter*
  filter1:
    SourceImage:
    - C:\WINDOWS\system32\taskmgr.exe
    - C:\Program Files\Malwarebytes\Anti-Malware\MBAMService.exe
    - C:\PROGRAMDATA\MALWAREBYTES\MBAMSERVICE\ctlrupdate\mbupdatr.exe
    - C:\WINDOWS\system32\taskhostw.exe
    - C:\Program Files\Windows Defender\MsMpEng.exe
    - C:\Windows\SysWOW64\msiexec.exe
    - C:\Windows\System32\msiexec.exe
    - C:\Windows\System32\lsass.exe
    - C:\WINDOWS\System32\perfmon.exe
    - C:\WINDOWS\system32\wbem\wmiprvse.exe
    - C:\Windows\sysWOW64\wbem\wmiprvse.exe
    - C:\Program Files\Common Files\McAfee\MMSSHost\MMSSHOST.exe
  filter2:
    SourceImage|endswith: \MsMpEng.exe
    SourceImage|startswith: C:\ProgramData\Microsoft\Windows Defender\
  filter3:
    SourceImage|endswith: \GamingServices.exe
    SourceImage|startswith: C:\Program Files\WindowsApps\
  filter4:
    SourceImage|endswith:
    - \PROCEXP64.EXE
    - \PROCEXP.EXE
  filter5:
    SourceImage|endswith: \vmtoolsd.exe
    SourceImage|startswith: C:\ProgramData\VMware\VMware Tools\
  filter6:
    SourceImage|contains: Antivirus
    SourceImage|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_games:
    GrantedAccess:
    - '0x410'
    - '0x10'
    SourceImage|contains: \SteamLibrary\steamapps\
  filter_generic:
    SourceImage|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\WINDOWS\system32\
  filter_localappdata:
    SourceImage|contains|all:
    - C:\Users\
    - \AppData\Local\
    SourceImage|endswith:
    - \Microsoft VS Code\Code.exe
    - \software_reporter_tool.exe
    - \DropboxUpdate.exe
    - \MBAMInstallerService.exe
    - \WebEx\WebexHost.exe
    - \Programs\Microsoft VS Code\Code.exe
    - \JetBrains\Toolbox\bin\jetbrains-toolbox.exe
  filter_ms_products:
    GrantedAccess: '0x1410'
    SourceImage|contains|all:
    - \AppData\Local\Temp\
    - \vs_bootstrapper_
  filter_nextron:
    SourceImage|endswith:
    - \thor64.exe
    - \thor.exe
    - \aurora-agent-64.exe
    - \aurora-agent.exe
  filter_wer:
    SourceCommandLine: C:\WINDOWS\system32\wermgr.exe -upload
  filter_xampp:
    GrantedAccess: '0x410'
    SourceImage|endswith: \xampp-control.exe
  selection:
    GrantedAccess|endswith: '10'
    TargetImage|endswith: \lsass.exe
- condition: selection and not 1 of filter_*
  filter_ddvdatacollector:
    SourceImage|endswith: \MSBuild\Current\Bin\MSBuild.exe
    SourceImage|startswith: C:\Program Files\Microsoft Visual Studio\
    TargetImage: C:\Program Files\Dell\DellDataVault\DDVDataCollector.exe
  filter_dell_folders:
    CallTrace|startswith: C:\Windows\System32\ntdll.dll
    GrantedAccess: '0x1F3FFF'
    SourceImage|startswith:
    - C:\Program Files\Dell\
    - C:\Program Files (x86)\Dell\
    TargetImage|startswith:
    - C:\Program Files\Dell\
    - C:\Program Files (x86)\Dell\
  filter_dell_specifc:
    CallTrace|startswith: C:\Windows\System32\ntdll.dll
    GrantedAccess: '0x1F3FFF'
    SourceImage: C:\Program Files (x86)\Dell\UpdateService\ServiceShell.exe
    TargetImage: C:\Windows\Explorer.EXE
  filter_visual_studio:
    CallTrace|startswith: C:\Windows\System32\ntdll.dll
    SourceImage:
    - C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\PerfWatson2.exe
    - C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\Common7\IDE\PerfWatson2.exe
    TargetImage:
    - C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\devenv.exe
    - C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\Common7\IDE\devenv.exe
  filter_wmiprvese:
    CallTrace|contains: \System.ni.dll+
    CallTrace|startswith: C:\Windows\SYSTEM32\ntdll.dll
    SourceImage: C:\Windows\System32\Wbem\Wmiprvse.exe
    TargetImage: C:\Windows\system32\lsass.exe
  selection:
    CallTrace|contains: UNKNOWN
    GrantedAccess:
    - '0x147a'
    - '0x1f3fff'
- condition: selection and not 1 of filter_*
  filter_absolute:
    SourceImage:
    - C:\WINDOWS\system32\taskmgr.exe
    - C:\Program Files\Malwarebytes\Anti-Malware\MBAMService.exe
    - C:\PROGRAMDATA\MALWAREBYTES\MBAMSERVICE\ctlrupdate\mbupdatr.exe
    - C:\WINDOWS\system32\taskhostw.exe
    - C:\Program Files\Windows Defender\MsMpEng.exe
    - C:\Windows\SysWOW64\msiexec.exe
    - C:\Windows\System32\msiexec.exe
    - C:\Windows\System32\lsass.exe
    - C:\WINDOWS\System32\perfmon.exe
    - C:\Windows\System32\MRT.exe
    - C:\Program Files\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe
    - C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe
  filter_generic_av:
    SourceImage|contains: Antivirus
    SourceImage|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_mcafee:
    SourceImage: C:\Program Files\Common Files\McAfee\MMSSHost\MMSSHOST.exe
  filter_mrt:
    GrantedAccess: '0x1418'
    SourceImage: C:\WINDOWS\system32\MRT.exe
  filter_nextron:
    GrantedAccess: '0x1fffff'
    SourceImage|endswith:
    - \thor64.exe
    - \thor.exe
    SourceImage|startswith: C:\Windows\Temp\asgard2-agent\
  filter_vmwaretools:
    SourceImage|endswith: \vmtoolsd.exe
    SourceImage|startswith: C:\ProgramData\VMware\VMware Tools\
  filter_vscode:
    SourceImage|endswith: \AppData\Local\Programs\Microsoft VS Code\Code.exe
    SourceImage|startswith: C:\Users\
  filter_windefend_1:
    SourceImage|endswith: \MsMpEng.exe
    SourceImage|startswith: C:\ProgramData\Microsoft\Windows Defender\
  filter_windefend_2:
    CallTrace|contains|all:
    - '|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{'
    - '}\mpengine.dll+'
    GrantedAccess: '0x1418'
  filter_windefend_3:
    GrantedAccess: '0x1418'
    SourceImage: C:\Program Files\Microsoft Security Client\MsMpEng.exe
  selection:
    GrantedAccess|endswith:
    - '30'
    - '50'
    - '70'
    - '90'
    - B0
    - D0
    - F0
    - '18'
    - '38'
    - '58'
    - '78'
    - '98'
    - B8
    - D8
    - F8
    - 1A
    - 3A
    - 5A
    - 7A
    - 9A
    - BA
    - DA
    - FA
    - '0x14C2'
    TargetImage|endswith: \lsass.exe
- condition: selection and not 1 of filter_optional_*
  filter_optional_adobe_arm_helper:
    GrantedAccess: '0x1410'
    SourceImage|endswith: \AdobeARMHelper.exe
    SourceImage|startswith:
    - C:\Program Files\Common Files\Adobe\ARM\
    - C:\Program Files (x86)\Common Files\Adobe\ARM\
  filter_optional_avira:
    GrantedAccess: '0x1410'
    SourceImage|contains: \AppData\Local\Temp\is-
    SourceImage|endswith: .tmp\avira_system_speedup.tmp
  filter_optional_chrome_update:
    GrantedAccess:
    - '0x410'
    - '0x1410'
    SourceImage|endswith: .tmp\GoogleUpdate.exe
    SourceImage|startswith: C:\Program Files (x86)\Google\Temp\
  filter_optional_dropbox_1:
    GrantedAccess:
    - '0x410'
    - '0x1410'
    SourceImage|endswith: .tmp\DropboxUpdate.exe
    SourceImage|startswith: C:\Windows\Temp\
  filter_optional_dropbox_2:
    GrantedAccess: '0x1410'
    SourceImage|contains: \AppData\Local\Temp\
    SourceImage|endswith: .tmp\DropboxUpdate.exe
    SourceImage|startswith: C:\Users\
  filter_optional_dropbox_3:
    GrantedAccess: '0x1410'
    SourceImage|endswith: \DropboxUpdate.exe
    SourceImage|startswith:
    - C:\Program Files (x86)\Dropbox\
    - C:\Program Files\Dropbox\
  filter_optional_generic_appdata:
    GrantedAccess: '0x410'
    SourceImage|contains: \AppData\Local\
    SourceImage|endswith:
    - \Microsoft VS Code\Code.exe
    - \software_reporter_tool.exe
    - \DropboxUpdate.exe
    - \MBAMInstallerService.exe
    - \WebexMTA.exe
    - \WebEx\WebexHost.exe
    - \JetBrains\Toolbox\bin\jetbrains-toolbox.exe
    SourceImage|startswith: C:\Users\
  filter_optional_keybase:
    GrantedAccess: '0x1fffff'
    SourceImage|endswith: \AppData\Local\Keybase\keybase.exe
    SourceImage|startswith: C:\Users\
  filter_optional_ms_products:
    GrantedAccess: '0x1410'
    SourceImage|contains|all:
    - \AppData\Local\Temp\
    - \vs_bootstrapper_
    SourceImage|startswith: C:\Users\
  filter_optional_nextron:
    GrantedAccess:
    - '0x1fffff'
    - '0x1010'
    - '0x101010'
    SourceImage|endswith:
    - \thor64.exe
    - \thor.exe
    - \aurora-agent-64.exe
    - \aurora-agent.exe
    SourceImage|startswith:
    - C:\Windows\Temp\asgard2-agent\
    - C:\Windows\Temp\asgard2-agent-sc\
  filter_optional_viberpc_updater:
    GrantedAccess: '0x1fffff'
    SourceImage|contains: \AppData\Roaming\ViberPC\
    SourceImage|endswith: \updater.exe
    SourceImage|startswith: C:\Users\
    TargetImage|endswith: \winlogon.exe
  selection:
    GrantedAccess|endswith:
    - '10'
    - '30'
    - '50'
    - '70'
    - '90'
    - B0
    - D0
    - F0
    - '18'
    - '38'
    - '58'
    - '78'
    - '98'
    - B8
    - D8
    - F8
    - 1A
    - 3A
    - 5A
    - 7A
    - 9A
    - BA
    - DA
    - FA
    - '0x14C2'
    - FF
    SourceImage|contains:
    - \Temp\
    - \Users\Public\
    - \PerfLogs\
    - \AppData\
    - \Temporary
    TargetImage|endswith: \lsass.exe
- condition: selection
  selection:
    CallTrace|contains: seclogon.dll
    GrantedAccess: '0x14c0'
    SourceImage|endswith: \svchost.exe
    TargetImage|endswith: \lsass.exe
- condition: selection_process and selection_memory and not filter_trusted_process_access
  filter_trusted_process_access:
    SourceImage|endswith:
    - '*\services.exe'
    - '*\msiexec.exe'
  selection_memory:
    GrantedAccess: '0x143a'
  selection_process:
    TargetImage|endswith: \svchost.exe
- condition: selection
  selection:
    CallTrace|startswith: UNKNOWN(0000000000000000)|UNKNOWN(0000000000000000)|
    GrantedAccess: '0x1fffff'
    SourceImage|contains: :\Windows\SysWOW64\
- condition: all of selection_*
  selection_extension:
    CommandLine|contains:
    - .dmp
    - .dump
  selection_img:
  - Description|contains: 7-Zip
  - Image|endswith:
    - \7z.exe
    - \7zr.exe
    - \7za.exe
  - OriginalFileName:
    - 7z.exe
    - 7za.exe
- condition: all of selection_*
  selection_action:
    CommandLine|contains:
    - ' a '
    - ' u '
  selection_img:
  - Description|contains: 7-Zip
  - Image|endswith:
    - \7z.exe
    - \7zr.exe
    - \7za.exe
  - OriginalFileName:
    - 7z.exe
    - 7za.exe
  selection_password:
    CommandLine|contains: ' -p'
- condition: all of selection_*
  selection_img:
  - Description|contains: 7-Zip
  - Image|endswith:
    - \7z.exe
    - \7zr.exe
    - \7za.exe
  - OriginalFileName:
    - 7z.exe
    - 7za.exe
  selection_password:
    CommandLine|contains|all:
    - ' -p'
    - ' x '
    - ' -o'
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' -hang '
    - ' -pn '
    - ' -pmn '
    - ' -p '
    - ' -po '
    - ' -c '
    - ' -sc '
  selection_img:
  - Image|endswith: \adplus.exe
  - OriginalFileName: Adplus.exe
- condition: all of selection_* and not 1 of filter_*
  filter_intel:
    CommandLine: +R +H +S +A \\\*.cui
    ParentCommandLine: C:\\WINDOWS\\system32\\\*.bat
    ParentImage|endswith: \cmd.exe
  filter_msiexec:
    CommandLine|contains: '\desktop.ini '
  selection_cli:
    CommandLine|contains: ' +h '
  selection_img:
  - Image|endswith: \attrib.exe
  - OriginalFileName: ATTRIB.EXE
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' +s '
  selection_img:
  - Image|endswith: \attrib.exe
  - OriginalFileName: ATTRIB.EXE
- condition: all of selection* and not filter
  filter:
    CommandLine|contains|all:
    - \Windows\TEMP\
    - .exe
  selection_cli:
    CommandLine|contains: ' +s'
  selection_ext:
    CommandLine|contains:
    - .bat
    - .dll
    - .exe
    - .hta
    - .ps1
    - .vbe
    - .vbs
  selection_img:
  - Image|endswith: \attrib.exe
  - OriginalFileName: ATTRIB.EXE
  selection_paths:
    CommandLine|contains:
    - ' %'
    - \Users\Public\
    - \AppData\Local\
    - \ProgramData\
    - \Downloads\
    - \Windows\Temp\
- condition: selection
  selection:
    CommandLine|contains: interactive
    Image|endswith: \at.exe
- condition: selection
  selection:
    CommandLine|contains:
    - /logon:none
    - /system:none
    - /sam:none
    - /privilege:none
    - /object:none
    - /process:none
    - /policy:none
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - disable
    - clear
    - remove
    - restore
  selection_img:
  - Image|endswith: \auditpol.exe
  - OriginalFileName: AUDITPOL.EXE
- condition: all of selection_*
  selection_cli:
  - CommandLine|contains|all:
    - bootstatuspolicy
    - ignoreallfailures
  - CommandLine|contains|all:
    - recoveryenabled
    - 'no'
  selection_img:
  - Image|endswith: \bcdedit.exe
  - OriginalFileName: bcdedit.exe
  selection_set:
    CommandLine|contains: set
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - delete
    - deletevalue
    - import
    - safeboot
    - network
  selection_img:
  - Image|endswith: \bcdedit.exe
  - OriginalFileName: bcdedit.exe
- condition: selection_img and (selection_cmd or all of selection_cli_*)
  selection_cli_1:
    CommandLine|contains:
    - ' /create '
    - ' /addfile '
  selection_cli_2:
    CommandLine|contains: http
  selection_cmd:
    CommandLine|contains: ' /transfer '
  selection_img:
  - Image|endswith: \bitsadmin.exe
  - OriginalFileName: bitsadmin.exe
- condition: all of selection_* and not 1 of filter_*
  filter_seven_zip:
    CommandLine|contains: ://7-
  selection_extension:
    CommandLine|contains:
    - ://1
    - ://2
    - ://3
    - ://4
    - ://5
    - ://6
    - ://7
    - ://8
    - ://9
  selection_flags:
    CommandLine|contains:
    - ' /transfer '
    - ' /create '
    - ' /addfile '
  selection_img:
  - Image|endswith: \bitsadmin.exe
  - OriginalFileName: bitsadmin.exe
- condition: all of selection_*
  selection_domain:
    CommandLine|contains:
    - .ghostbin.co/
    - .hastebin.com
    - .paste.ee
    - anonfiles.com
    - cdn.discordapp.com/attachments/
    - ddns.net
    - gist.githubusercontent.com
    - mediafire.com
    - mega.nz
    - paste.ee
    - pastebin.com
    - pastebin.pl
    - pastetext.net
    - privatlab.com
    - privatlab.net
    - raw.githubusercontent.com
    - send.exploit.in
    - sendspace.com
    - storage.googleapis.com
    - transfer.sh
    - ufile.io
  selection_flags:
    CommandLine|contains:
    - ' /transfer '
    - ' /create '
    - ' /addfile '
  selection_img:
  - Image|endswith: \bitsadmin.exe
  - OriginalFileName: bitsadmin.exe
- condition: all of selection_*
  selection_extension:
    CommandLine|contains:
    - .7z
    - .asax
    - .ashx
    - .asmx
    - .asp
    - .aspx
    - .bat
    - .cfm
    - .cgi
    - .chm
    - .cmd
    - .dll
    - .gif
    - .jpeg
    - .jpg
    - .jsp
    - .jspx
    - .log
    - .png
    - .ps1
    - .psm1
    - .rar
    - .scf
    - .sct
    - .txt
    - .vbe
    - .vbs
    - .war
    - .wsf
    - .wsh
    - .xll
    - .zip
  selection_flags:
    CommandLine|contains:
    - ' /transfer '
    - ' /create '
    - ' /addfile '
  selection_img:
  - Image|endswith: \bitsadmin.exe
  - OriginalFileName: bitsadmin.exe
- condition: all of selection_*
  selection_flags:
    CommandLine|contains:
    - ' /transfer '
    - ' /create '
    - ' /addfile '
  selection_folder:
    CommandLine|contains:
    - :\Perflogs
    - :\ProgramData\
    - :\Temp\
    - :\Users\Public\
    - :\Windows\
    - \AppData\Local\Temp\
    - \AppData\Roaming\
    - \Desktop\
    - '%ProgramData%'
    - '%public%'
  selection_img:
  - Image|endswith: \bitsadmin.exe
  - OriginalFileName: bitsadmin.exe
- condition: all of selection_*
  selection_flags:
    CommandLine|contains:
    - ' /transfer '
    - ' /create '
    - ' /addfile '
  selection_folder:
    CommandLine|contains:
    - '%AppData%'
    - '%temp%'
    - '%tmp%'
    - \AppData\Local\
    - C:\Windows\Temp\
  selection_img:
  - Image|endswith: \bitsadmin.exe
  - OriginalFileName: bitsadmin.exe
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains:
    - '%COMSPEC%'
    - cmd.exe
    - regsvr32.exe
    CommandLine|contains|all:
    - bitsadmin
    - /SetNotifyCmdLine
  selection_2:
    CommandLine|contains:
    - 'http:'
    - 'https:'
    - 'ftp:'
    - 'ftps:'
    CommandLine|contains|all:
    - bitsadmin
    - /Addfile
- condition: selection
  selection:
    CommandLine|contains|all:
    - --remote-debugging-
    - --user-data-dir
    - --headless
- condition: selection
  selection:
    CommandLine|contains|all:
    - --headless
    - dump-dom
    - http
    Image|endswith:
    - \brave.exe
    - \chrome.exe
    - \msedge.exe
    - \opera.exe
    - \vivaldi.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - --load-extension=
    - \AppData\Local\
    Image|endswith:
    - \brave.exe
    - \chrome.exe
    - \msedge.exe
    - \opera.exe
    - \vivaldi.exe
    ParentImage|endswith:
    - \cmd.exe
    - \cscript.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \wscript.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - .exe http
    - msedge http
  selection_img:
  - Image|endswith: \msedge.exe
  - OriginalFileName: msedge.exe
- condition: 1 of selection_*
  selection_chromium_based:
    CommandLine|contains: ' --remote-debugging-'
  selection_firefox:
    CommandLine|contains: ' -start-debugger-server'
    Image|endswith: \firefox.exe
- condition: selection
  selection:
    Image|endswith:
    - \tor.exe
    - \Tor Browser\Browser\firefox.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - /add
    - root
  selection_img:
  - Image|endswith: \CertMgr.exe
  - OriginalFileName: CERTMGT.EXE
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' -LoadDLL '
    - ' /LoadDLL '
  selection_img:
  - Image|endswith: \certoc.exe
  - OriginalFileName: CertOC.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' -LoadDLL '
    - ' /LoadDLL '
  selection_img:
  - Image|endswith: \certoc.exe
  - OriginalFileName: CertOC.exe
  selection_paths:
    CommandLine|contains:
    - \Appdata\Local\Temp\
    - \Desktop\
    - \Downloads\
    - \Users\Public\
    - C:\Windows\Tasks\
    - C:\Windows\Temp\
- condition: all of selection_*
  selection_cli_add:
    CommandLine|contains:
    - /addstore
    - -addstore
  selection_cli_store:
    CommandLine|contains: root
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - '-decode '
    - '/decode '
    - '-decodehex '
    - '/decodehex '
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: all of selection_*
  selection_flags:
    CommandLine|contains:
    - 'urlcache '
    - 'verifyctl '
  selection_http:
    CommandLine|contains: http
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: all of selection_* and not 1 of filter_*
  filter_seven_zip:
    CommandLine|contains: ://7-
  selection_flags:
    CommandLine|contains:
    - 'urlcache '
    - 'verifyctl '
  selection_http:
    CommandLine|contains:
    - ://1
    - ://2
    - ://3
    - ://4
    - ://5
    - ://6
    - ://7
    - ://8
    - ://9
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: all of selection_*
  selection_flags:
    CommandLine|contains:
    - 'urlcache '
    - 'verifyctl '
  selection_http:
    CommandLine|contains:
    - .ghostbin.co/
    - .hastebin.com
    - .paste.ee
    - anonfiles.com
    - cdn.discordapp.com/attachments/
    - ddns.net
    - gist.githubusercontent.com
    - mediafire.com
    - mega.nz
    - paste.ee
    - pastebin.com
    - pastebin.pl
    - pastetext.net
    - privatlab.com
    - privatlab.net
    - raw.githubusercontent.com
    - send.exploit.in
    - sendspace.com
    - storage.googleapis.com
    - transfer.sh
    - ufile.io
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - -encode
    - /encode
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - -encode
    - /encode
  selection_extension:
    CommandLine|contains:
    - .acl
    - .bat
    - .files
    - .gif
    - .jpeg
    - .jpg
    - .mp3
    - .pdf
    - .png
    - .ppt
    - .tmp
    - .xls
    - .xml
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - -encode
    - /encode
  selection_extension:
    CommandLine|contains:
    - \AppData\Roaming\
    - \Desktop\
    - \Local\Temp\
    - \PerfLogs\
    - \Users\Public\
    - \Windows\Temp\
    - $Recycle.Bin
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - '-exportPFX '
    - '/exportPFX '
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - ' -syncwithWU '
    - ' \\\\'
  selection_img:
  - Image|endswith: \certutil.exe
  - OriginalFileName: CertUtil.exe
- condition: selection
  selection:
    CommandLine|endswith:
    - chcp
    - 'chcp '
    - 'chcp  '
    Image|endswith: \chcp.com
    ParentCommandLine|contains:
    - ' /c '
    - ' /r '
    - ' /k '
    ParentImage|endswith: \cmd.exe
- condition: selection
  selection:
    CommandLine|endswith:
    - ' 936'
    - ' 1258'
    Image|endswith: \chcp.com
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' /w:'
  selection_img:
  - OriginalFileName: CIPHER.EXE
  - Image|endswith: \cipher.exe
- condition: selection or ( renamed and not 1 of filter* )
  filter_empty:
    OriginalFileName: null
  filter_renamed:
    OriginalFileName|contains: CtxInstall
  renamed:
    Image|endswith: \TrolleyExpress.exe
  selection:
    CommandLine|contains:
    - \TrolleyExpress 7
    - \TrolleyExpress 8
    - \TrolleyExpress 9
    - \TrolleyExpress.exe 7
    - \TrolleyExpress.exe 8
    - \TrolleyExpress.exe 9
    - '\TrolleyExpress.exe -ma '
- condition: selection
  selection:
  - Image|endswith: \clip.exe
  - OriginalFileName: clip.exe
- condition: selection
  selection:
    CommandLine|contains:
    - ' --config '
    - ' --connector-id '
    CommandLine|contains|all:
    - ' tunnel '
    - 'cleanup '
- condition: selection
  selection:
    CommandLine|contains:
    - ' --config '
    - ' --credentials-contents '
    - ' --credentials-file '
    - ' --token '
    CommandLine|contains|all:
    - ' tunnel '
    - ' run '
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - ' /g'
    - ' /u'
    - ' /p'
  selection_img:
  - Image|endswith: \cmdkey.exe
  - OriginalFileName: cmdkey.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - ' /l'
    - ' -l'
  selection_img:
  - Image|endswith: \cmdkey.exe
  - OriginalFileName: cmdkey.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: assoc
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
- condition: all of selection_* and not filter
  filter:
    CommandLine|contains: .exe=exefile
  selection_cli:
    CommandLine|contains|all:
    - 'assoc '
    - exefile
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - .dmp
    - .dump
    CommandLine|contains|all:
    - 'copy '
    - ' \\\\'
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' /c '
    - 'curl '
    - http
    - -o
    - '&'
- condition: all of selection_*
  selection_del:
    CommandLine|contains:
    - 'del '
    - 'erase '
  selection_flags:
    CommandLine|contains:
    - ' /f'
    - ' /s'
    - ' /q'
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
- condition: all of selection_*
  selection_del:
    CommandLine|contains:
    - 'del '
    - 'erase '
  selection_extensions:
    CommandLine|contains:
    - \\\*.dll
    - \\\*.exe
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - 'dir '
    - ' /s'
    - ' /b'
- condition: selection
  selection:
    CommandLine|contains:
    - ^^
    - ^|^
    - ',;,'
    - ;;;;
    - ;; ;;
    - (,(,
    - '%COMSPEC:~'
    - ' c^m^d'
    - ^c^m^d
    - ' c^md'
    - ' cm^d'
    - ^cm^d
    - ' s^et '
    - ' s^e^t '
    - ' se^t '
- condition: selection
  selection:
    CommandLine|contains|all:
    - http
    - ://
    - '%AppData%'
    Image|endswith: \cmd.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - mklink
    - \osk.exe
    - \cmd.exe
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - mklink
    - HarddiskVolumeShadowCopy
- condition: all of selection_*
  selection_base:
    CommandLine|contains|all:
    - ' net use http'
    - '& start /b '
    - \DavWWWRoot\
  selection_ext:
    CommandLine|contains:
    - '.exe '
    - '.dll '
    - '.bat '
    - '.vbs '
    - '.ps1 '
  selection_img:
  - Image|contains: \cmd.exe
  - OriginalFileName: Cmd.EXE
- condition: 1 of selection* and not 1 of filter_*
  filter_fp:
  - CommandLine|contains: AppData\Local\Programs\Microsoft VS Code\resources\app\node_modules
  - CommandLine|endswith: cmd.exe/c .
  - CommandLine: cmd.exe /c
  filter_generic:
    CommandLine|contains:
    - 'cmd.exe /c '
    - 'cmd /c '
    - 'cmd.exe /k '
    - 'cmd /k '
    - 'cmd.exe /r '
    - 'cmd /r '
  selection1:
    CommandLine|contains:
    - cmd.exe/c
    - \cmd/c
    - '"cmd/c'
    - cmd.exe/k
    - \cmd/k
    - '"cmd/k'
    - cmd.exe/r
    - \cmd/r
    - '"cmd/r'
  selection2:
    CommandLine|contains:
    - /cwhoami
    - /cpowershell
    - /cschtasks
    - /cbitsadmin
    - /ccertutil
    - /kwhoami
    - /kpowershell
    - /kschtasks
    - /kbitsadmin
    - /kcertutil
  selection3:
    CommandLine|contains:
    - cmd.exe /c
    - cmd /c
    - cmd.exe /k
    - cmd /k
    - cmd.exe /r
    - cmd /r
- condition: selection
  selection:
    CommandLine|contains:
    - type %windir%\system32\ntdll.dll
    - type %systemroot%\system32\ntdll.dll
    - type c:\windows\system32\ntdll.dll
    - \\ntdll.dll > \\\\.\\pipe\\
- condition: all of selection_* and not 1 of filter_*
  filter_java:
    CommandLine|contains: \Tasktop\keycloak\bin\/../../jre\bin\java
  selection_flags:
  - ParentCommandLine|contains:
    - /c
    - /k
    - /r
  - CommandLine|contains:
    - /c
    - /k
    - /r
  selection_img:
  - ParentImage|endswith: \cmd.exe
  - Image|endswith: \cmd.exe
  - OriginalFileName: cmd.exe
  selection_path_traversal:
  - ParentCommandLine: /../../
  - CommandLine|contains: /../../
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' -n '
    - ' /n '
    CommandLine|contains|all:
    - ping
    - 'copy '
    - ' /y '
  selection_cmd:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
- condition: all of selection_*
  selection_all:
    CommandLine|contains|all:
    - ping
    - 'del '
  selection_count:
    CommandLine|contains:
    - ' -n '
    - ' /n '
  selection_del_param:
    CommandLine|contains:
    - ' /f '
    - ' -f '
    - ' /q '
    - ' -q '
  selection_nul:
    CommandLine|contains: Nul
- condition: all of selection_* and not 1 of filter_*
  filter_idm_extension:
    CommandLine|contains:
    - C:\Program Files (x86)\Internet Download Manager\IDMMsgHost.exe
    - chrome-extension://
    - \\.\pipe\chrome.nativeMessaging
  selection_cli:
    CommandLine|contains: '>'
  selection_cmd:
  - OriginalFileName: Cmd.Exe
  - Image|endswith: \cmd.exe
- condition: selection_img and 1 of selection_cli_*
  selection_cli_1:
    CommandLine|contains:
    - '> \Users\Public\'
    - '> %APPDATA%\'
    - '> %TEMP%\'
    - '> %TMP%\'
    - '> %USERPROFILE%\'
    - '> C:\Temp\'
    - '> C:\Users\Public\'
    - '> C:\Windows\Temp\'
    - '>\Users\Public\'
    - '>%APPDATA%\'
    - '>%TEMP%\'
    - '>%TMP%\'
    - '>%USERPROFILE%\'
    - '>C:\Temp\'
    - '>C:\Users\Public\'
    - '>C:\Windows\Temp\'
  selection_cli_2:
    CommandLine|contains:
    - ' >'
    - '">'
    - '''>'
    CommandLine|contains|all:
    - C:\Users\
    - \AppData\Local\
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
- condition: all of selection_*
  selection_flags:
    CommandLine|contains:
    - /s
    - /q
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
  selection_rmdir:
    CommandLine|contains: rmdir
- condition: selection
  selection:
    CommandLine|contains|all:
    - 'copy '
    - \\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: <
  selection_cmd:
  - OriginalFileName: Cmd.Exe
  - Image|endswith: \cmd.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - 'copy '
    - '/y '
    - C:\windows\system32\cmd.exe C:\windows\system32\sethc.exe
- condition: selection
  selection:
    CommandLine|contains:
    - sethc.exe
    - utilman.exe
    - osk.exe
    - Magnify.exe
    - Narrator.exe
    - DisplaySwitch.exe
    Image|endswith:
    - \cmd.exe
    - \cscript.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \wscript.exe
    - \wt.exe
    ParentImage|endswith: \winlogon.exe
- condition: selection
  selection:
    Image|endswith: \cmd.exe
    ParentImage|endswith:
    - \csrss.exe
    - \ctfmon.exe
    - \dllhost.exe
    - \epad.exe
    - \FlashPlayerUpdateService.exe
    - \GoogleUpdate.exe
    - \jucheck.exe
    - \jusched.exe
    - \LogonUI.exe
    - \lsass.exe
    - \regsvr32.exe
    - \SearchIndexer.exe
    - \SearchProtocolHost.exe
    - \SIHClient.exe
    - \sihost.exe
    - \slui.exe
    - \spoolsv.exe
    - \sppsvc.exe
    - \taskhostw.exe
    - \unsecapp.exe
    - \WerFault.exe
    - \wergmgr.exe
    - \wlanext.exe
    - \WUDFHost.exe
- condition: selection
  selection:
    ParentImage|endswith: \cmstp.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - conhost.exe
    - '0xffffffff'
    - -ForceV1
    IntegrityLevel: High
- condition: selection
  selection:
    CommandLine|contains: /../../
    ParentCommandLine|contains: conhost
- condition: selection and not 1 of filter_optional_*
  filter_optional_git:
    Image|endswith: \git.exe
    ParentCommandLine|contains:
    - ' show --textconv '
    - ' cat-file -s '
    Provider_Name: Microsoft-Windows-Kernel-Process
  filter_optional_git_show:
    CommandLine|contains:
    - ' show --textconv '
    - ' cat-file -s '
    ParentCommandLine|contains: C:\WINDOWS\system32\conhost.exe 0x4
  filter_optional_image_conhost:
    Image: C:\Windows\System32\conhost.exe
    ParentCommandLine|contains:
    - ' cat-file -s '
    - show --textconv
    Provider_Name: Microsoft-Windows-Kernel-Process
  filter_optional_image_conhost2:
    Image: C:\Windows\System32\conhost.exe
    ParentCommandLine:
    - \\\?\?\\C:\\WINDOWS\\system32\\conhost.exe 0x4
    - \\\?\?\\C:\\WINDOWS\\system32\\conhost.exe 0xffffffff -ForceV1
  filter_optional_image_git:
    Image: C:\Program Files\Git\mingw64\bin\git.exe
    ParentCommandLine:
    - \\\?\?\\C:\\WINDOWS\\system32\\conhost.exe 0xffffffff -ForceV1'
    - \\\?\?\\C:\\WINDOWS\\system32\\conhost.exe 0x4'
  filter_optional_provider:
    Provider_Name: SystemTraceProvider-Process
  selection:
    ParentImage|endswith: \conhost.exe
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_svchost:
    ParentCommandLine|contains:
    - -k apphost -s AppHostSvc
    - -k imgsvc
    - -k localService -p -s RemoteRegistry
    - -k LocalSystemNetworkRestricted -p -s NgcSvc
    - -k NetSvcs -p -s NcaSvc
    - -k netsvcs -p -s NetSetupSvc
    - -k netsvcs -p -s wlidsvc
    - -k NetworkService -p -s DoSvc
    - -k wsappx -p -s AppXSvc
    - -k wsappx -p -s ClipSVC
  filter_optional_dropbox:
    ParentCommandLine|contains:
    - C:\Program Files (x86)\Dropbox\Client\
    - C:\Program Files\Dropbox\Client\
  selection:
    Image|endswith: \conhost.exe
    ParentImage|endswith:
    - \explorer.exe
    - \lsass.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \services.exe
    - \smss.exe
    - \spoolsv.exe
    - \svchost.exe
    - \userinit.exe
    - \wininit.exe
    - \winlogon.exe
- condition: all of selection_reg_* or (selection_cpl and not 1 of filter_cpl_*)
  filter_cpl_igfx:
    CommandLine|contains|all:
    - 'regsvr32 '
    - ' /s '
    - igfxCPL.cpl
  filter_cpl_sys:
    CommandLine|contains:
    - \System32\
    - '%System%'
  selection_cpl:
    CommandLine|endswith: .cpl
  selection_reg_cli:
    CommandLine|contains|all:
    - add
    - CurrentVersion\Control Panel\CPLs
  selection_reg_img:
  - Image|endswith: \reg.exe
  - OriginalFileName: reg.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' -u '
    - ' --full '
    - ' -f '
    - ' --name '
    - '.dmp '
  selection_img:
  - Image|endswith: \createdump.exe
  - OriginalFileName: FX_VER_INTERNALNAME_STR
- condition: selection and not filter
  filter:
  - ParentImage|startswith: C:\Program Files
  - ParentImage|endswith:
    - \sdiagnhost.exe
    - \w3wp.exe
    - \choco.exe
  - ParentCommandLine|contains: \ProgramData\Microsoft\Windows Defender Advanced Threat
      Protection
  selection:
    CommandLine|contains:
    - \AppData\
    - \Windows\Temp\
    Image|endswith: \csc.exe
- condition: selection
  selection:
    Image|endswith: \csc.exe
    ParentImage|endswith:
    - \wscript.exe
    - \cscript.exe
    - \mshta.exe
- condition: all of selection*
  selection_cli:
    Company: Microsoft Corporation
  selection_img:
  - Image|endswith:
    - \csi.exe
    - \rcsi.exe
  - OriginalFileName:
    - csi.exe
    - rcsi.exe
- condition: selection
  selection:
    Image|endswith: \csi.exe
    OriginalFileName: csi.exe
    ParentImage|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \powershell_ise.exe
- condition: all of selection_* and not 1 of filter_*
  filter_import:
    CommandLine|contains: ' -i'
  selection_img:
  - Image|endswith: \csvde.exe
  - OriginalFileName: csvde.exe
  selection_remote:
    CommandLine|contains: ' -f'
- condition: all of selection_*
  selection_ext:
    CommandLine|endswith:
    - .ps1
    - .ps1'
    - .ps1"
    - .bat
    - .bat'
    - .bat"
    - .exe
    - .exe'
    - .exe"
    - .vbs
    - .vbs'
    - .vbs"
    - .vbe
    - .vbe'
    - .vbe"
    - .hta
    - .hta'
    - .hta"
    - .dll
    - .dll'
    - .dll"
    - .psm1
    - .psm1'
    - .psm1"
  selection_flag:
    CommandLine|contains:
    - ' -O'
    - --remote-name
    - --output
  selection_http:
    CommandLine|contains: http
  selection_img:
  - Image|endswith: \curl.exe
  - OriginalFileName: curl.exe
  selection_websites:
  - CommandLine|re: ://[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}
  - CommandLine|contains:
    - anonfiles.com
    - cdn.discordapp.com/attachments/
    - ddns.net
    - ghostbin.co/
    - gist.githubusercontent.com
    - hastebin.com
    - mediafire.com
    - mega.nz
    - paste.ee
    - pastebin.com
    - pastebin.pl
    - pastetext.net
    - privatlab.com
    - privatlab.net
    - raw.githubusercontent.com
    - send.exploit.in
    - sendspace.com
    - storage.googleapis.com
    - temp.sh
    - transfer.sh
    - ufile.io
- condition: all of selection_*
  selection_cli:
  - CommandLine|re: \s-k\s
  - CommandLine|contains: --insecure
  selection_img:
  - Image|endswith: \curl.exe
  - OriginalFileName: curl.exe
- condition: selection_curl and 1 of selection_susp_* and not 1 of filter_optional_*
  filter_optional_git_windows:
    CommandLine|contains|all:
    - '--silent --show-error --output '
    - gfw-httpget-
    - AppData
    Image: C:\Program Files\Git\mingw64\bin\curl.exe
    ParentImage: C:\Program Files\Git\usr\bin\sh.exe
  selection_curl:
  - Image|endswith: \curl.exe
  - Product: The curl executable
  selection_susp_extensions:
    CommandLine|endswith:
    - .dll
    - .gif
    - .jpeg
    - .jpg
    - .png
    - .temp
    - .tmp
    - .txt
    - .vbe
    - .vbs
  selection_susp_locations:
    CommandLine|contains:
    - '%AppData%'
    - '%Public%'
    - '%Temp%'
    - '%tmp%'
    - \AppData\
    - \Desktop\
    - \Temp\
    - \Users\Public\
    - C:\PerfLogs\
    - C:\ProgramData\
    - C:\Windows\Temp\
- condition: selection
  selection:
    CommandLine|contains: /lockscreenurl:http
    Image|endswith: \desktopimgdownldr.exe
    ParentImage|endswith: \desktopimgdownldr.exe
- condition: ( selection1 and not selection1_filter ) or selection_reg
  selection1:
    CommandLine|contains: ' /lockscreenurl:'
  selection1_filter:
    CommandLine|contains:
    - .jpg
    - .jpeg
    - .png
  selection_reg:
    CommandLine|contains|all:
    - reg delete
    - \PersonalizationCSP
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: /PhoneDeepLink
  selection_img:
  - Image|endswith: \deviceenroller.exe
  - OriginalFileName: deviceenroller.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' -t msi-install '
    - ' -i http'
- condition: selection
  selection:
    Image|endswith:
    - \calc.exe
    - \cmd.exe
    - \cscript.exe
    - \explorer.exe
    - \mshta.exe
    - \net.exe
    - \net1.exe
    - \nltest.exe
    - \notepad.exe
    - \powershell.exe
    - \pwsh.exe
    - \reg.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \schtasks.exe
    - \werfault.exe
    - \wscript.exe
    ParentImage|contains: \AppData\Local\Apps\2.0\
- condition: selection
  selection:
  - OriginalFileName: DirLister.exe
  - Image|endswith: \dirlister.exe
- condition: selection and not 1 of filter_main_*
  filter_main_null:
    CommandLine: null
  selection:
    CommandLine:
    - dllhost.exe
    - dllhost
    Image|endswith: \dllhost.exe
- condition: selection and not filter
  filter:
    Image|startswith: C:\Program Files\VMware\
  selection:
    Image|endswith: \VMwareXferlogs.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - /enumrecords
    - /enumzones
    - /ZonePrint
    - /info
  selection_img:
    Image|endswith: \dnscmd.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - /config
    - /serverlevelplugindll
    Image|endswith: \dnscmd.exe
- condition: selection
  selection:
  - Image|endswith: \iodine.exe
  - Image|contains: \dnscat2
- condition: selection and not filter
  filter:
    Image|endswith: \conhost.exe
  selection:
    ParentImage|endswith: \dns.exe
- condition: all of selection_*
  selection_img:
  - Image|endswith: driverquery.exe
  - OriginalFileName: drvqry.exe
  selection_parent:
  - ParentImage|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
    - \cscript.exe
    - \mshta.exe
  - ParentImage|contains:
    - \AppData\Local\
    - \Users\Public\
    - \Windows\Temp\
- condition: selection
  selection:
  - Image|endswith: driverquery.exe
  - OriginalFileName: drvqry.exe
- condition: all of selection_*
  selection_flag:
    CommandLine|contains: ' /G '
  selection_img:
  - Image|endswith: \dsacls.exe
  - OriginalFileName: DSACLS.EXE
  selection_permissions:
    CommandLine|contains:
    - GR
    - GE
    - GW
    - GA
    - WP
    - WD
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - '/user:'
    - '/passwd:'
  selection_img:
  - Image|endswith: \dsacls.exe
  - OriginalFileName: DSACLS.EXE
- condition: 1 of selection_*
  selection_dism:
    CommandLine|contains|all:
    - /Online
    - /Disable-Feature
    Image|endswith: \Dism.exe
  selection_dismhost:
    Image|endswith: \DismHost.exe
    ParentCommandLine|contains|all:
    - /Online
    - /Disable-Feature
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: trustedDomain
  selection_img:
  - Image|endswith: \dsquery.exe
  - OriginalFileName: dsquery.exe
- condition: 1 of selection*
  selection_obfuscated:
    CommandLine|contains|all:
    - syscall:::return
    - lkd(
  selection_plain:
    CommandLine|contains: lkd(0)
    Image|endswith: \dtrace.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' Full'
    - ' Mini'
    - ' WithHeap'
  selection_img:
  - Image|endswith:
    - \DumpMinitool.exe
    - \DumpMinitool.x86.exe
    - \DumpMinitool.arm64.exe
  - OriginalFileName:
    - DumpMinitool.exe
    - DumpMinitool.x86.exe
    - DumpMinitool.arm64.exe
- cmd_has_flags:
    CommandLine|contains:
    - ' Full'
    - ' Mini'
    - ' WithHeap'
  condition: selection and ( ( not filter_folder ) or susp_flags or ( cmd_has_flags
    and not filter_cmd_misses_flags ) )
  filter_cmd_misses_flags:
    CommandLine|contains: --dumpType
  filter_folder:
    Image|contains:
    - \Microsoft Visual Studio\
    - \Extensions\
  selection:
  - Image|endswith:
    - \DumpMinitool.exe
    - \DumpMinitool.x86.exe
    - \DumpMinitool.arm64.exe
  - OriginalFileName:
    - DumpMinitool.exe
    - DumpMinitool.x86.exe
    - DumpMinitool.arm64.exe
  susp_flags:
    CommandLine|contains: .txt
- condition: selection
  selection:
    CommandLine|contains|all:
    - esentutl
    - ' /p'
- condition: all of selection_esent_* or selection_susp_paths
  selection_esent_cli:
    CommandLine|contains:
    - vss
    - ' /m '
    - ' /y '
  selection_esent_img:
  - Image|endswith: \esentutl.exe
  - OriginalFileName: \esentutl.exe
  selection_susp_paths:
    CommandLine|contains:
    - \windows\ntds\ntds.dit
    - \config\sam
    - \config\security
    - '\config\system '
    - \repair\sam
    - \repair\system
    - \repair\security
    - \config\RegBack\sam
    - \config\RegBack\system
    - \config\RegBack\security
- condition: all of selection*
  selection_flag:
    CommandLine|contains:
    - /r
    - -r
  selection_img:
  - Image|endswith: \esentutl.exe
  - OriginalFileName: esentutl.exe
  selection_webcache:
    CommandLine|contains: \Windows\WebCache
- condition: selection
  selection:
    Image|endswith:
    - \plink.exe
    - \socat.exe
    - \stunnel.exe
    - \httptunnel.exe
- condition: selection and not 1 of filter_*
  filter_dell:
    CommandLine|contains: C:\ProgramData\Dell\UpdateService\Temp\
    ParentImage: C:\Program Files (x86)\Dell\UpdateService\ServiceShell.exe
  selection:
    CommandLine|contains:
    - .cab
    - '/F:'
    - '-F:'
    - C:\ProgramData\
    - C:\Public\
    - \AppData\Local\Temp\
    - \AppData\Roaming\Temp\
    Image|endswith: \expand.exe
- condition: selection
  selection:
  - CommandLine|contains: /factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}
  - CommandLine|contains|all:
    - explorer.exe
    - ' /root,'
- condition: selection
  selection:
    CommandLine|contains: explorer.exe
    Image|endswith: \explorer.exe
    ParentImage|endswith: \cmd.exe
- condition: selection and not 1 of filter_*
  filter_dc_logon:
  - ParentCommandLine: C:\Windows\system32\svchost.exe -k netsvcs -p -s Schedule
  - ParentImage: C:\Windows\System32\svchost.exe
  selection:
    CommandLine|contains: /NOUACCHECK
    Image|endswith: \explorer.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - cpassword
    - \sysvol\
    - .xml
  selection_img:
  - Image|endswith: \findstr.exe
  - OriginalFileName: FINDSTR.EXE
- condition: all of selection_*
  selection_cli:
    CommandLine|endswith: .lnk
  selection_img:
  - Image|endswith: \findstr.exe
  - OriginalFileName: FINDSTR.EXE
- condition: all of selection_findstr_* or selection_special
  selection_findstr_cli:
    CommandLine|contains: lsass
  selection_findstr_img:
  - Image|endswith: \findstr.exe
  - OriginalFileName: FINDSTR.EXE
  selection_special:
    CommandLine|contains:
    - ' /i "lsass'
    - ' /i lsass.exe'
    - findstr "lsass
    - findstr lsass
    - findstr.exe "lsass
    - findstr.exe lsass
- condition: all of selection_findstr_* or selection_special
  selection_findstr_cli:
    CommandLine|contains:
    - '"Everyone"'
    - '''Everyone'''
    - '"BUILTIN\\"'
    - '''BUILTIN\'''
  selection_findstr_img:
  - Image|endswith: \findstr.exe
  - OriginalFileName: FINDSTR.EXE
  selection_special:
    CommandLine|contains|all:
    - 'icacls '
    - 'findstr '
    - Everyone
- condition: all of selection_*
  selection_img:
  - Image|endswith: \findstr.exe
  - OriginalFileName: FINDSTR.EXE
  selection_parent_cli:
    ParentCommandLine|contains:
    - 'ipconfig '
    - tasklist
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' 385201'
  selection_img:
  - Image|endswith: \findstr.exe
  - OriginalFileName: FINDSTR.EXE
- condition: selection
  selection:
  - OriginalFileName: finger.exe
  - Image|endswith: \finger.exe
- condition: all of selection_* and not 1 of filter_*
  filter_avira:
    CommandLine|endswith: unload rtp_filesystem_filter
  selection_cli:
    CommandLine|contains: unload
  selection_img:
  - Image|endswith: \fltMC.exe
  - OriginalFileName: fltMC.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - unload
    - sysmon
  selection_img:
  - Image|endswith: \fltMC.exe
  - OriginalFileName: fltMC.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: drives
  selection_img:
  - Image|endswith: \fsutil.exe
  - OriginalFileName: fsutil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - 'behavior '
    - 'set '
    - SymlinkEvaluation
  selection_img:
  - Image|endswith: \fsutil.exe
  - OriginalFileName: fsutil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - deletejournal
    - createjournal
  selection_img:
  - Image|endswith: \fsutil.exe
  - OriginalFileName: fsutil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' clone '
    - 'git-remote-https '
  selection_img:
  - Image|endswith:
    - \git.exe
    - \git-remote-https.exe
  - OriginalFileName: git.exe
  selection_keyword:
    CommandLine|contains:
    - exploit
    - Vulns
    - vulnerability
    - RemoteCodeExecution
    - Invoke-
    - CVE-
    - poc-
    - ProofOfConcept
    - proxyshell
    - log4shell
    - eternalblue
    - eternal-blue
    - MS17-
- condition: selection and not 1 of filter_main_*
  filter_main_image_null:
    Image: null
  filter_main_known_legit:
  - Image|contains: \Google
  - Image|endswith:
    - \setup.exe
    - chrome_updater.exe
    - chrome_installer.exe
  selection:
    ParentImage|endswith: \GoogleUpdate.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: -passphrase
  selection_metadata:
  - Image|endswith: \gpg2.exe
  - Product: GNU Privacy Guard (GnuPG)
  - Company: g10 Code GmbH
  selection_paths:
    CommandLine|contains:
    - \AppData\Roaming\
    - C:\Perflogs\
    - C:\Windows\Temp\
    - C:\temp
- condition: selection
  selection:
    CommandLine|contains:
    - /z
    - /v
    Image|endswith: \gpresult.exe
- condition: selection and not 1 of filter*
  filter:
    CommandLine|contains: \Notepad++\notepad++.exe
    Image|endswith: \explorer.exe
  filter_null:
    CommandLine: null
  filter_parent:
    ParentImage|contains: \Notepad++\updater\
  selection:
    Image|endswith: \explorer.exe
    ParentImage|endswith: \gup.exe
- condition: all of selection* and not filter
  filter:
    ParentImage|endswith: \notepad++.exe
  selection_cli:
    CommandLine|contains|all:
    - ' -unzipTo '
    - http
  selection_img:
  - Image|endswith: \GUP.exe
  - OriginalFileName: gup.exe
- condition: selection and not 1 of filter_*
  filter_programfiles:
    Image|endswith:
    - \Program Files\Notepad++\updater\GUP.exe
    - \Program Files (x86)\Notepad++\updater\GUP.exe
  filter_user:
    Image|contains: \Users\
    Image|endswith:
    - \AppData\Local\Notepad++\updater\GUP.exe
    - \AppData\Roaming\Notepad++\updater\GUP.exe
  selection:
    Image|endswith: \GUP.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: .chm
  selection_img:
  - OriginalFileName: HH.exe
  - Image|endswith: \hh.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: http
  selection_img:
  - OriginalFileName: HH.exe
  - Image|endswith: \hh.exe
- condition: selection
  selection:
    Image|endswith:
    - \CertReq.exe
    - \CertUtil.exe
    - \cmd.exe
    - \cscript.exe
    - \installutil.exe
    - \MSbuild.exe
    - \MSHTA.EXE
    - \msiexec.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \schtasks.exe
    - \wmic.exe
    - \wscript.exe
    ParentImage|endswith: \hh.exe
- condition: all of selection_*
  selection_img:
  - OriginalFileName: HH.exe
  - Image|endswith: \hh.exe
  selection_paths:
    CommandLine|contains:
    - .application
    - \AppData\Local\Temp\
    - \Content.Outlook\
    - \Downloads\
    - \Users\Public\
    - \Windows\Temp\
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' --adcs '
    - ' --port '
- condition: 1 of selection_*
  selection_cli_1:
    CommandLine|contains:
    - ' -CollectionMethod All '
    - ' --CollectionMethods Session '
    - ' --Loop --Loopduration '
    - ' --PortScanTimeout '
    - '.exe -c All -d '
    - Invoke-Bloodhound
    - Get-BloodHoundData
  selection_cli_2:
    CommandLine|contains|all:
    - ' -JsonFolder '
    - ' -ZipFileName '
  selection_cli_3:
    CommandLine|contains|all:
    - ' DCOnly '
    - ' --NoSaveCache '
  selection_img:
  - Product|contains: SharpHound
  - Description|contains: SharpHound
  - Company|contains:
    - SpecterOps
    - evil corp
  - Image|contains:
    - \Bloodhound.exe
    - \SharpHound.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - rundll32.exe
    - .dll
    - StartNodeRelay
- condition: selection_img or all of selection_cli_*
  selection_cli_commands:
    CommandLine|contains:
    - '.exe cas '
    - '.exe find '
    - '.exe pkiobjects '
    - '.exe request '
    - '.exe download '
  selection_cli_options:
    CommandLine|contains:
    - ' /vulnerable'
    - ' /template:'
    - ' /altname:'
    - ' /domain:'
    - ' /path:'
    - ' /ca:'
  selection_img:
  - Image|endswith: \Certify.exe
  - OriginalFileName: Certify.exe
  - Description|contains: Certify
- condition: selection_img or all of selection_cli_*
  selection_cli_commands:
    CommandLine|contains:
    - ' auth '
    - ' find '
    - ' forge '
    - ' relay '
    - ' req '
    - ' shadow '
  selection_cli_flags:
    CommandLine|contains:
    - ' -bloodhound'
    - ' -ca-pfx '
    - ' -dc-ip '
    - ' -kirbi'
    - ' -old-bloodhound'
    - ' -pfx '
    - ' -target'
    - ' -username '
    - ' -vulnerable'
    - auth -pfx
    - shadow auto
    - shadow list
  selection_img:
  - Image|endswith: \Certipy.exe
  - OriginalFileName: Certipy.exe
  - Description|contains: Certipy
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - psinject
    - spawnas
    - make_token
    - remote-exec
    - rev2self
    - dcsync
    - logonpasswords
    - execute-assembly
    - getsystem
    CommandLine|startswith:
    - 'cmd '
    - cmd.exe
    - c:\windows\system32\cmd.exe
  selection_img:
  - OriginalFileName: Cmd.Exe
  - Image|endswith: \cmd.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - Invoke-UserHunter
    - Invoke-ShareFinder
    - Invoke-Kerberoast
    - Invoke-SMBAutoBrute
    - Invoke-Nightmare
    - zerologon
    - av_query
  selection_img:
  - OriginalFileName: Cmd.Exe
  - Image|endswith: \cmd.exe
- condition: all of selection*
  selection_params:
    CommandLine|contains: .dll
    CommandLine|endswith:
    - ' StartW'
    - ',StartW'
  selection_rundll:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
  - CommandLine|contains:
    - rundll32.exe
    - 'rundll32 '
- condition: 1 of selection_*
  selection_conhost_1:
    CommandLine|endswith: conhost.exe 0xffffffff -ForceV1
    ParentCommandLine|contains|all:
    - cmd.exe /C echo
    - ' > \\\\.\\pipe'
  selection_conhost_2:
    CommandLine|endswith: conhost.exe 0xffffffff -ForceV1
    ParentCommandLine|endswith: /C whoami
  selection_generic_1:
    CommandLine|endswith: cmd.exe /C whoami
    ParentImage|startswith: C:\Temp\
  selection_generic_2:
    CommandLine|contains|all:
    - cmd.exe /c echo
    - '> \\\\.\\pipe'
    ParentImage|endswith:
    - \runonce.exe
    - \dllhost.exe
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains:
    - -Command
    - -EncodedCommand
    CommandLine|contains|all:
    - -Sta
    - -Nop
    - -Window
    - Hidden
  selection_2:
    CommandLine|contains:
    - 'sv o (New-Object IO.MemorySteam);sv d '
    - mshta file.hta
    - GruntHTTP
    - -EncodedCommand cwB2ACAAbwAgA
- condition: 1 of selection_* or all of part_localauth*
  part_localauth_1:
    CommandLine|contains|all:
    - ' --local-auth'
    - ' -u '
    - ' -p '
  part_localauth_2:
    CommandLine|contains|all:
    - ' 10.'
    - ' 192.168.'
    - '/24 '
  selection_binary:
    Image|endswith: \crackmapexec.exe
  selection_execute:
    CommandLine|contains|all:
    - ' --local-auth'
    - ' -u '
    - ' -x '
  selection_hash:
    CommandLine|contains|all:
    - ' --local-auth'
    - ' -u '
    - ' -p '
    - ' -H ''NTHASH'''
  selection_module_mssql:
    CommandLine|contains|all:
    - ' mssql '
    - ' -u '
    - ' -p '
    - ' -M '
    - ' -d '
  selection_module_smb1:
    CommandLine|contains|all:
    - ' smb '
    - ' -u '
    - ' -H '
    - ' -M '
    - ' -o '
  selection_module_smb2:
    CommandLine|contains|all:
    - ' smb '
    - ' -u '
    - ' -p '
    - ' --local-auth'
  selection_special:
    CommandLine|contains: ' -M pe_inject '
- condition: selection
  selection:
    CommandLine|contains:
    - powershell.exe -exec bypass -noni -nop -w 1 -C "
    - 'powershell.exe -noni -nop -w 1 -enc '
    CommandLine|endswith:
    - cmd.exe /Q /c * 1> \\\\*\\*\\* 2>&1
    - cmd.exe /C * > \\\\*\\*\\* 2>&1
    - cmd.exe /C * > *\\Temp\\* 2>&1
- condition: 1 of selection*
  selection_lsass_dump1:
    CommandLine|contains:
    - 'cmd.exe /c '
    - 'cmd.exe /r '
    - 'cmd.exe /k '
    - 'cmd /c '
    - 'cmd /r '
    - 'cmd /k '
    CommandLine|contains|all:
    - 'tasklist /fi '
    - Imagename eq lsass.exe
    User|contains:
    - AUTHORI
    - AUTORI
  selection_lsass_dump2:
    CommandLine|contains|all:
    - do rundll32.exe C:\windows\System32\comsvcs.dll, MiniDump
    - \Windows\Temp\
    - ' full'
    - '%%B'
  selection_procdump:
    CommandLine|contains|all:
    - tasklist /v /fo csv
    - findstr /i "lsass"
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - join*split
    - ( $ShellId[1]+$ShellId[13]+'x')
    - ( $PSHome[*]+$PSHOME[*]+
    - ( $env:Public[13]+$env:Public[5]+'x')
    - ( $env:ComSpec[4,*,25]-Join'')
    - '[1,3]+''x''-Join'''')'
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: selection
  selection:
  - Image|endswith: \CreateMiniDump.exe
  - Imphash: 4a07f944a83e8a7c2525efa35dd30e2f
  - Hashes|contains: IMPHASH=4a07f944a83e8a7c2525efa35dd30e2f
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' /am51'
    - ' /password'
- condition: selection
  selection:
  - Hashes|contains: 09D278F9DE118EF09163C6140255C690
  - CommandLine|contains: Dumpert.dll
- condition: selection
  selection:
    CommandLine|contains:
    - ' -NoP -sta -NonI -W Hidden -Enc '
    - ' -noP -sta -w 1 -enc '
    - ' -NoP -NonI -W Hidden -enc '
    - ' -noP -sta -w 1 -enc'
    - ' -enc  SQB'
    - ' -nop -exec bypass -EncodedCommand '
- condition: selection
  selection:
    CommandLine|contains:
    - ' -NoP -NonI -w Hidden -c $x=$((gp HKCU:Software\Microsoft\Windows Update).Update)'
    - ' -NoP -NonI -c $x=$((gp HKCU:Software\Microsoft\Windows Update).Update);'
- condition: 1 of selection_*
  selection_mstsc:
    CommandLine|contains|all:
    - '-i '
    - '-u '
    - '-p '
    Image|endswith: \ruby.exe
- condition: selection
  selection:
  - Imphash:
    - bcca3c247b619dcd13c8cdff5f123932
    - 3a19059bd7688cb88e70005f18efc439
    - bf6223a49e45d99094406777eb6004ba
    - 0c106686a31bfe2ba931ae1cf6e9dbc6
    - 0d1447d4b3259b3c2a1d4cfb7ece13c3
    - 1b0369a1e06271833f78ffa70ffb4eaf
    - 4c1b52a19748428e51b14c278d0f58e3
    - 4d927a711f77d62cebd4f322cb57ec6f
    - 66ee036df5fc1004d9ed5e9a94a1086a
    - 672b13f4a0b6f27d29065123fe882dfc
    - 6bbd59cea665c4afcc2814c1327ec91f
    - 725bb81dc24214f6ecacc0cfb36ad30d
    - 9528a0e91e28fbb88ad433feabca2456
    - 9da6d5d77be11712527dcab86df449a3
    - a6e01bc1ab89f8d91d9eab72032aae88
    - b24c5eddaea4fe50c6a96a2a133521e4
    - d21bbc50dcc169d7b4d0f01962793154
    - fcc251cceae90d22c392215cc9a2d5d6
    - 23867a89c2b8fc733be6cf5ef902f2d1
    - a37ff327f8d48e8a4d2f757e1b6e70bc
    - f9a28c458284584a93b14216308d31bd
    - 6118619783fc175bc7ebecff0769b46e
    - 959a83047e80ab68b368fdb3f4c6e4ea
    - 563233bfa169acc7892451f71ad5850a
    - 87575cb7a0e0700eb37f2e3668671a08
    - 13f08707f759af6003837a150a371ba1
    - 1781f06048a7e58b323f0b9259be798b
    - 233f85f2d4bc9d6521a6caae11a1e7f5
    - 24af2584cbf4d60bbe5c6d1b31b3be6d
    - 632969ddf6dbf4e0f53424b75e4b91f2
    - 713c29b396b907ed71a72482759ed757
    - 749a7bb1f0b4c4455949c0b2bf7f9e9f
    - 8628b2608957a6b0c6330ac3de28ce2e
    - 8b114550386e31895dfab371e741123d
    - 94cb940a1a6b65bed4d5a8f849ce9793
    - 9d68781980370e00e0bd939ee5e6c141
    - b18a1401ff8f444056d29450fbc0a6ce
    - cb567f9498452721d77a451374955f5f
    - 730073214094cd328547bf1f72289752
    - 17b461a082950fc6332228572138b80c
    - dc25ee78e2ef4d36faa0badf1e7461c9
    - 819b19d53ca6736448f9325a85736792
    - 829da329ce140d873b4a8bde2cbfaa7e
    - c547f2e66061a8dffb6f5a3ff63c0a74
    - 0588081ab0e63ba785938467e1b10cca
    - 0d9ec08bac6c07d9987dfd0f1506587c
    - bc129092b71c89b4d4c8cdf8ea590b29
    - 4da924cf622d039d58bce71cdf05d242
    - e7a3a5c377e2d29324093377d7db1c66
    - 9a9dbec5c62f0380b4fa5fd31deffedf
    - af8a3976ad71e5d5fdfb67ddb8dadfce
    - 0c477898bbf137bbd6f2a54e3b805ff4
    - 0ca9f02b537bcea20d4ea5eb1a9fe338
    - 3ab3655e5a14d4eefc547f4781bf7f9e
    - e6f9d5152da699934b30daab206471f6
    - 3ad59991ccf1d67339b319b15a41b35d
    - ffdd59e0318b85a3e480874d9796d872
    - 0cf479628d7cc1ea25ec7998a92f5051
    - 07a2d4dcbd6cb2c6a45e6b101f0b6d51
    - d6d0f80386e1380d05cb78e871bc72b1
    - 38d9e015591bbfd4929e0d0f47fa0055
    - 0e2216679ca6e1094d63322e3412d650
    - ada161bf41b8e5e9132858cb54cab5fb
    - 2a1bc4913cd5ecb0434df07cb675b798
    - 11083e75553baae21dc89ce8f9a195e4
    - a23d29c9e566f2fa8ffbb79267f5df80
    - 4a07f944a83e8a7c2525efa35dd30e2f
    - 767637c23bb42cd5d7397cf58b0be688
    - 14c4e4c72ba075e9069ee67f39188ad8
    - 3c782813d4afce07bbfc5a9772acdbdc
    - 7d010c6bb6a3726f327f7e239166d127
    - 89159ba4dd04e4ce5559f132a9964eb3
    - 6f33f4a5fc42b8cec7314947bd13f30f
    - 5834ed4291bdeb928270428ebbaf7604
    - 5a8a8a43f25485e7ee1b201edcbc7a38
    - dc7d30b90b2d8abf664fbed2b1b59894
    - 41923ea1f824fe63ea5beb84db7a3e74
    - 3de09703c8e79ed2ca3f01074719906b
    - a53a02b997935fd8eedcb5f7abab9b9f
    - e96a73c7bf33a464c510ede582318bf2
    - 32089b8851bbf8bc2d014e9f37288c83
    - 09D278F9DE118EF09163C6140255C690
    - 03866661686829d806989e2fc5a72606
    - e57401fbdadcd4571ff385ab82bd5d6d
    - 84B763C45C0E4A3E7CA5548C710DB4EE
    - 19584675d94829987952432e018d5056
    - 330768a4f172e10acb6287b87289d83b
  - Hashes|contains:
    - IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932
    - IMPHASH=3A19059BD7688CB88E70005F18EFC439
    - IMPHASH=bf6223a49e45d99094406777eb6004ba
    - IMPHASH=0C106686A31BFE2BA931AE1CF6E9DBC6
    - IMPHASH=0D1447D4B3259B3C2A1D4CFB7ECE13C3
    - IMPHASH=1B0369A1E06271833F78FFA70FFB4EAF
    - IMPHASH=4C1B52A19748428E51B14C278D0F58E3
    - IMPHASH=4D927A711F77D62CEBD4F322CB57EC6F
    - IMPHASH=66EE036DF5FC1004D9ED5E9A94A1086A
    - IMPHASH=672B13F4A0B6F27D29065123FE882DFC
    - IMPHASH=6BBD59CEA665C4AFCC2814C1327EC91F
    - IMPHASH=725BB81DC24214F6ECACC0CFB36AD30D
    - IMPHASH=9528A0E91E28FBB88AD433FEABCA2456
    - IMPHASH=9DA6D5D77BE11712527DCAB86DF449A3
    - IMPHASH=A6E01BC1AB89F8D91D9EAB72032AAE88
    - IMPHASH=B24C5EDDAEA4FE50C6A96A2A133521E4
    - IMPHASH=D21BBC50DCC169D7B4D0F01962793154
    - IMPHASH=FCC251CCEAE90D22C392215CC9A2D5D6
    - IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1
    - IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC
    - IMPHASH=F9A28C458284584A93B14216308D31BD
    - IMPHASH=6118619783FC175BC7EBECFF0769B46E
    - IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA
    - IMPHASH=563233BFA169ACC7892451F71AD5850A
    - IMPHASH=87575CB7A0E0700EB37F2E3668671A08
    - IMPHASH=13F08707F759AF6003837A150A371BA1
    - IMPHASH=1781F06048A7E58B323F0B9259BE798B
    - IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5
    - IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D
    - IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2
    - IMPHASH=713C29B396B907ED71A72482759ED757
    - IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F
    - IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E
    - IMPHASH=8B114550386E31895DFAB371E741123D
    - IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793
    - IMPHASH=9D68781980370E00E0BD939EE5E6C141
    - IMPHASH=B18A1401FF8F444056D29450FBC0A6CE
    - IMPHASH=CB567F9498452721D77A451374955F5F
    - IMPHASH=730073214094CD328547BF1F72289752
    - IMPHASH=17B461A082950FC6332228572138B80C
    - IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9
    - IMPHASH=819B19D53CA6736448F9325A85736792
    - IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E
    - IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74
    - IMPHASH=0588081AB0E63BA785938467E1B10CCA
    - IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C
    - IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29
    - IMPHASH=4DA924CF622D039D58BCE71CDF05D242
    - IMPHASH=E7A3A5C377E2D29324093377D7DB1C66
    - IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF
    - IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE
    - IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4
    - IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338
    - IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E
    - IMPHASH=E6F9D5152DA699934B30DAAB206471F6
    - IMPHASH=3AD59991CCF1D67339B319B15A41B35D
    - IMPHASH=FFDD59E0318B85A3E480874D9796D872
    - IMPHASH=0CF479628D7CC1EA25EC7998A92F5051
    - IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51
    - IMPHASH=D6D0F80386E1380D05CB78E871BC72B1
    - IMPHASH=38D9E015591BBFD4929E0D0F47FA0055
    - IMPHASH=0E2216679CA6E1094D63322E3412D650
    - IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB
    - IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798
    - IMPHASH=11083E75553BAAE21DC89CE8F9A195E4
    - IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80
    - IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F
    - IMPHASH=767637C23BB42CD5D7397CF58B0BE688
    - IMPHASH=14C4E4C72BA075E9069EE67F39188AD8
    - IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC
    - IMPHASH=7D010C6BB6A3726F327F7E239166D127
    - IMPHASH=89159BA4DD04E4CE5559F132A9964EB3
    - IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F
    - IMPHASH=5834ED4291BDEB928270428EBBAF7604
    - IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38
    - IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894
    - IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74
    - IMPHASH=3DE09703C8E79ED2CA3F01074719906B
    - IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F
    - IMPHASH=E96A73C7BF33A464C510EDE582318BF2
    - IMPHASH=32089B8851BBF8BC2D014E9F37288C83
    - IMPHASH=09D278F9DE118EF09163C6140255C690
    - IMPHASH=03866661686829d806989e2fc5a72606
    - IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d
    - IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE
    - IMPHASH=19584675D94829987952432E018D5056
    - IMPHASH=330768A4F172E10ACB6287B87289D83B
- condition: selection
  selection:
    Company: Cube0x0
- condition: 1 of selection_*
  selection_img:
    Image|endswith: \gmer.exe
  selection_other:
  - md5: e9dc058440d321aa17d0600b3ca0ab04
  - sha1: 539c228b6b332f5aa523e5ce358c16647d8bbe57
  - sha256: e8a3e804a96c716a3e9b69195db6ffb0d33e2433af871e4d4e1eab3097237173
  selection_sysmon_hash:
    Hashes|contains:
    - MD5=E9DC058440D321AA17D0600B3CA0AB04
    - SHA1=539C228B6B332F5AA523E5CE358C16647D8BBE57
    - SHA256=E8A3E804A96C716A3E9B69195DB6FFB0D33E2433AF871E4D4E1EAB3097237173
- condition: 1 of selection_*
  selection_flags:
    CommandLine|contains:
    - .dmp
    - lsass
    - .obf
    - dump
    CommandLine|contains|all:
    - '--pid:'
    - '--outfile:'
  selection_loader_img:
    CommandLine|contains: '--pid:'
    Image|endswith: \loader.exe
  selection_loader_imphash:
  - Imphash:
    - 38d9e015591bbfd4929e0d0f47fa0055
    - 0e2216679ca6e1094d63322e3412d650
  - Hashes:
    - IMPHASH=38D9E015591BBFD4929E0D0F47FA0055
    - IMPHASH=0E2216679CA6E1094D63322E3412D650
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains|all:
    - '-a '
    - '-m 1000 '
    - '-r '
  selection_img:
    Image|endswith: \hashcat.exe
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains:
    - '.exe -tran '
    - '.exe -slave '
  selection_img:
    Image|endswith:
    - \htran.exe
    - \lcx.exe
- condition: selection
  selection:
    CommandLine|contains:
    - ^USER^
    - ^PASS^
    CommandLine|contains|all:
    - '-u '
    - '-p '
- condition: 1 of selection_*
  selection_atexec:
    CommandLine|contains|all:
    - cmd.exe
    - /C
    - Windows\Temp\
    - '&1'
    ParentCommandLine|contains:
    - svchost.exe -k netsvcs
    - taskeng.exe
  selection_other:
    CommandLine|contains|all:
    - cmd.exe
    - /Q
    - /c
    - \\\\127.0.0.1\\
    - '&1'
    ParentImage|endswith:
    - \wmiprvse.exe
    - \mmc.exe
    - \explorer.exe
    - \services.exe
- condition: selection
  selection:
  - Image|contains:
    - \goldenPac
    - \karmaSMB
    - \kintercept
    - \ntlmrelayx
    - \rpcdump
    - \samrdump
    - \secretsdump
    - \smbexec
    - \smbrelayx
    - \wmiexec
    - \wmipersist
  - Image|endswith:
    - \atexec_windows.exe
    - \dcomexec_windows.exe
    - \dpapi_windows.exe
    - \findDelegation_windows.exe
    - \GetADUsers_windows.exe
    - \GetNPUsers_windows.exe
    - \getPac_windows.exe
    - \getST_windows.exe
    - \getTGT_windows.exe
    - \GetUserSPNs_windows.exe
    - \ifmap_windows.exe
    - \mimikatz_windows.exe
    - \netview_windows.exe
    - \nmapAnswerMachine_windows.exe
    - \opdump_windows.exe
    - \psexec_windows.exe
    - \rdp_check_windows.exe
    - \sambaPipe_windows.exe
    - \smbclient_windows.exe
    - \smbserver_windows.exe
    - \sniffer_windows.exe
    - \sniff_windows.exe
    - \split_windows.exe
    - \ticketer_windows.exe
- condition: all of selection_commandline_* or 1 of selection_hash_*
  selection_commandline_exe:
    CommandLine|contains: impersonate.exe
  selection_commandline_opt:
    CommandLine|contains:
    - ' list '
    - ' exec '
    - ' adduser '
  selection_hash_ext:
  - md5: 9520714AB576B0ED01D1513691377D01
  - sha256: E81CC96E2118DC4FBFE5BAD1604E0AC7681960143E2101E1A024D52264BB0A8A
  - Imphash: 0A358FFC1697B7A07D0E817AC740DF62
  selection_hash_plain:
    Hashes|contains:
    - MD5=9520714AB576B0ED01D1513691377D01
    - SHA256=E81CC96E2118DC4FBFE5BAD1604E0AC7681960143E2101E1A024D52264BB0A8A
    - IMPHASH=0A358FFC1697B7A07D0E817AC740DF62
- condition: selection
  selection:
  - Image|endswith: \Inveigh.exe
  - OriginalFileName:
    - \Inveigh.exe
    - \Inveigh.dll
  - Description: Inveigh
  - CommandLine|contains:
    - ' -SpooferIP'
    - ' -ReplyToIPs '
    - ' -ReplyToDomains '
    - ' -ReplyToMACs '
    - ' -SnifferIP'
- condition: selection
  selection:
    CommandLine|contains:
    - /c
    - /r
    CommandLine|contains|all:
    - cmd
    - '&&'
    - 'clipboard]::'
    - -f
- condition: selection
  selection:
  - CommandLine|re: \$PSHome\[\s*\d{1,3}\s*\]\s*\+\s*\$PSHome\[
  - CommandLine|re: \$ShellId\[\s*\d{1,3}\s*\]\s*\+\s*\$ShellId\[
  - CommandLine|re: \$env:Public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:Public\[
  - CommandLine|re: \$env:ComSpec\[(\s*\d{1,3}\s*,){2}
  - CommandLine|re: \*mdr\*\W\s*\)\.Name
  - CommandLine|re: \$VerbosePreference\.ToString\(
  - CommandLine|re: \[String\]\s*\$VerbosePreference
- condition: all of selection_*
  selection_main:
    CommandLine|contains:
    - /c
    - /r
    CommandLine|contains|all:
    - cmd
    - powershell
  selection_other:
  - CommandLine|contains: noexit
  - CommandLine|contains|all:
    - input
    - $
- condition: selection
  selection:
    CommandLine|contains:
    - /c
    - /r
    CommandLine|contains|all:
    - cmd
    - '"set'
    - -f
- condition: selection
  selection:
    CommandLine|contains:
    - system.io.compression.deflatestream
    - system.io.streamreader
    - readtoend(
    CommandLine|contains|all:
    - new-object
    - text.encoding]::ascii
- condition: selection
  selection:
    CommandLine|contains:
    - environment
    - invoke
    - input
    CommandLine|contains|all:
    - set
    - '&&'
- condition: selection
  selection:
    CommandLine|contains:
    - clipboard
    - invoke
    - i`
    - n`
    - v`
    - o`
    - k`
    - e`
    CommandLine|contains|all:
    - echo
    - clip
    - '&&'
- condition: selection
  selection:
    CommandLine|contains|all:
    - set
    - '&&'
    - mshta
    - vbscript:createobject
    - .run
    - (window.close)
- condition: selection
  selection:
    CommandLine|contains:
    - '{0}'
    - '{1}'
    - '{2}'
    - '{3}'
    - '{4}'
    - '{5}'
    CommandLine|contains|all:
    - '&&set'
    - cmd
    - /c
    - -f
- condition: parent_selection and (1 of selection*)
  parent_selection:
    ParentCommandLine|endswith: .bat
    ParentImage|endswith: \cmd.exe
  selection1:
    CommandLine|contains|all:
    - powershell.exe
    - .bat.exe
    Image|endswith: \xcopy.exe
  selection2:
    CommandLine|contains|all:
    - pwsh.exe
    - .bat.exe
    Image|endswith: \xcopy.exe
  selection3:
    CommandLine|contains|all:
    - +s
    - +h
    - .bat.exe
    Image|endswith: \attrib.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - /q
    - /c
    - chcp
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
- condition: 1 of selection_*
  selection_cli_1:
    CommandLine|contains|all:
    - ' -spn '
    - ' -clsid '
    - ' -rbcd '
  selection_cli_2:
    CommandLine|contains|all:
    - shadowcred
    - clsid
    - spn
  selection_cli_3:
    CommandLine|contains|all:
    - 'spn '
    - 'session '
    - 'clsid '
  selection_img:
  - Image|endswith: \KrbRelay.exe
  - OriginalFileName: KrbRelay.exe
- condition: 1 of selection_*
  selection_cli_1:
    CommandLine|contains|all:
    - ' relay '
    - ' -Domain '
    - ' -ComputerName '
  selection_cli_2:
    CommandLine|contains|all:
    - ' krbscm '
    - ' -sc '
  selection_cli_3:
    CommandLine|contains|all:
    - ' spawn '
    - ' -d '
    - ' -cn '
    - ' -cp '
  selection_img:
  - Image|endswith: \KrbRelayUp.exe
  - OriginalFileName: KrbRelayUp.exe
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains|all:
    - .exe -i C:\
    - -o Windows\
  selection_hash_ext:
    Imphash:
    - E1742EE971D6549E8D4D81115F88F1FC
    - DD82066EFBA94D7556EF582F247C8BB5
  selection_hash_plain:
    Hashes|contains:
    - IMPHASH=E1742EE971D6549E8D4D81115F88F1FC
    - IMPHASH=DD82066EFBA94D7556EF582F247C8BB5
  selection_img:
    Image|endswith: \LocalPotato.exe
- condition: selection_img and 1 of selection_technique_* and not 1 of filter_*
  filter_defender:
    CommandLine|contains: MpCmdRun
  selection_img:
    ParentImage|endswith: \services.exe
  selection_technique_1:
    CommandLine|contains:
    - cmd
    - '%COMSPEC%'
    CommandLine|contains|all:
    - /c
    - echo
    - \pipe\
  selection_technique_2:
    CommandLine|contains|all:
    - rundll32
    - .dll,a
    - '/p:'
- condition: 1 of selection_*
  selection_function_names:
    CommandLine|contains:
    - ::aadcookie
    - ::detours
    - ::memssp
    - ::mflt
    - ::ncroutemon
    - ::ngcsign
    - ::printnightmare
    - ::skeleton
    - ::preshutdown
    - ::mstsc
    - ::multirdp
  selection_module_names:
    CommandLine|contains:
    - 'rpc::'
    - 'token::'
    - 'crypto::'
    - 'dpapi::'
    - 'sekurlsa::'
    - 'kerberos::'
    - 'lsadump::'
    - 'privilege::'
    - 'process::'
    - 'vault::'
  selection_tools_name:
    CommandLine|contains:
    - DumpCreds
    - mimikatz
- condition: 1 of selection_*
  selection_hash_values:
  - md5:
    - 228dd0c2e6287547e26ffbd973a40f14
    - 987b65cd9b9f4e9a1afd8f8b48cf64a7
  - sha1:
    - 5f1cbc3d99558307bc1250d084fa968521482025
    - 3fb89787cb97d902780da080545584d97fb1c2eb
  - sha256:
    - 2b214bddaab130c274de6204af6dba5aeec7433da99aa950022fa306421a6d32
    - 55f041bf4e78e9bfa6d4ee68be40e496ce3a1353e1ca4306598589e19802522c
  - Imphash:
    - 444d210cea1ff8112f256a4997eed7ff
    - 0479f44df47cfa2ef1ccc4416a538663
  selection_hashes:
    Hashes|contains:
    - SHA1=5F1CBC3D99558307BC1250D084FA968521482025
    - MD5=987B65CD9B9F4E9A1AFD8F8B48CF64A7
    - SHA256=2B214BDDAAB130C274DE6204AF6DBA5AEEC7433DA99AA950022FA306421A6D32
    - IMPHASH=444D210CEA1FF8112F256A4997EED7FF
    - SHA1=3FB89787CB97D902780DA080545584D97FB1C2EB
    - MD5=228DD0C2E6287547E26FFBD973A40F14
    - SHA256=55F041BF4E78E9BFA6D4EE68BE40E496CE3A1353E1CA4306598589E19802522C
    - IMPHASH=0479F44DF47CFA2EF1CCC4416A538663
  selection_image:
    Image|endswith:
    - \PCHunter64.exe
    - \PCHunter32.exe
  selection_pe:
  - OriginalFileName: PCHunter.exe
  - Description: Epoolsoft Windows Information View Tools
- condition: selection
  selection:
    CommandLine|contains:
    - /SC ONLOGON
    - /SC DAILY /ST
    - /SC ONIDLE
    - /SC HOURLY
    CommandLine|contains|all:
    - /Create
    - powershell.exe -NonI
    - /TN Updater /TR
    Image|endswith: \schtasks.exe
    ParentImage|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: selection
  selection:
  - Image|endswith:
    - \PowerTool.exe
    - \PowerTool64.exe
  - OriginalFileName: PowerTool.exe
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains:
    - xyz123456.exe
    - PurpleSharp
  selection_img:
  - Image|contains: \purplesharp
  - OriginalFileName: PurpleSharp.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - live
    - registry
    Image|endswith:
    - \pypykatz.exe
    - \python.exe
- condition: 1 of selection_*
  selection_cli:
    CommandLine:
    - ' -dhl'
    - ' --dump-hash-local'
    - ' -dhdc'
    - ' --dump-hash-domain-cached'
    - ' --dump-bitlocker'
    - ' -dhd '
    - ' --dump-hash-domain '
    - --ntds-file
  selection_img:
    Image|endswith: \QuarksPwDump.exe
- condition: selection
  selection:
    CommandLine|contains:
    - gthread-3.6.dll
    - \Windows\Temp\tmp.bat
    - sigcmm-2.4.dll
    Image|endswith:
    - \rundll32.exe
    - \cmd.exe
- condition: 1 of selection_* and not 1 of filter_*
  filter_hotpotatoes:
    Image|contains:
    - HotPotatoes6
    - HotPotatoes7
    - 'HotPotatoes '
  selection_juicypotato_enum:
    CommandLine|contains: .exe -c "{
    CommandLine|endswith: '}" -z'
  selection_pe:
    Image|contains:
    - PetitPotam
    - RottenPotato
    - HotPotato
    - JuicyPotato
    - \just_dce_
    - Juicy Potato
    - \temp\rot.exe
    - \Potato.exe
    - \SpoolSample.exe
    - \Responder.exe
    - \smbrelayx
    - \ntlmrelayx
    - \LocalPotato
  selection_script:
    CommandLine|contains:
    - Invoke-Tater
    - ' smbrelay'
    - ' ntlmrelay'
    - 'cme smb '
    - ' /ntlm:NTLMhash '
    - Invoke-PetitPotam
    - '.exe -t * -p '
- condition: selection
  selection:
  - Image|endswith: \Rubeus.exe
  - OriginalFileName: Rubeus.exe
  - Description: Rubeus
  - CommandLine|contains:
    - 'asreproast '
    - 'dump /service:krbtgt '
    - dump /luid:0x
    - 'kerberoast '
    - 'createnetonly /program:'
    - 'ptt /ticket:'
    - '/impersonateuser:'
    - 'renew /ticket:'
    - 'asktgt /user:'
    - 'harvest /interval:'
    - 's4u /user:'
    - 's4u /ticket:'
    - 'hash /password:'
    - 'golden /aes256:'
    - 'silver /user:'
- condition: selection
  selection:
  - Image|endswith: \SafetyKatz.exe
  - OriginalFileName: SafetyKatz.exe
  - Description: SafetyKatz
- condition: selection
  selection:
  - Company: SecurityXploded
  - Image|endswith: PasswordDump.exe
  - OriginalFileName|endswith: PasswordDump.exe
- condition: selection
  selection:
  - Image|endswith: \SelectMyParent.exe
  - CommandLine|contains:
    - PPID-spoof
    - ppid_spoof
    - spoof-ppid
    - spoof_ppid
    - ppidspoof
    - spoofppid
    - spoofedppid
    - ' -spawnto '
  - OriginalFileName|contains:
    - PPID-spoof
    - ppid_spoof
    - spoof-ppid
    - spoof_ppid
    - ppidspoof
    - spoofppid
    - spoofedppid
  - Description: SelectMyParent
  - Imphash:
    - 04d974875bd225f00902b4cad9af3fbc
    - a782af154c9e743ddf3f3eb2b8f3d16e
    - 89059503d7fbf470e68f7e63313da3ad
    - ca28337632625c8281ab8a130b3d6bad
  - Hashes|contains:
    - IMPHASH=04D974875BD225F00902B4CAD9AF3FBC
    - IMPHASH=A782AF154C9E743DDF3F3EB2B8F3D16E
    - IMPHASH=89059503D7FBF470E68F7E63313DA3AD
    - IMPHASH=CA28337632625C8281AB8A130B3D6BAD
- condition: 1 of selection_*
  selection_cli_1:
    CommandLine|contains:
    - ' -t schtask -c '
    - ' -t startupfolder -c '
  selection_cli_2:
    CommandLine|contains|all:
    - ' -t reg -c '
    - ' -m add'
  selection_cli_3:
    CommandLine|contains|all:
    - ' -t service -c '
    - ' -m add'
  selection_cli_4:
    CommandLine|contains|all:
    - ' -t schtask -c '
    - ' -m add'
  selection_img:
  - Image|endswith: \SharPersist.exe
  - Product: SharPersist
- condition: selection
  selection:
  - Image|endswith: \SharpEvtMute.exe
  - Description: SharpEvtMute
  - CommandLine|contains:
    - '--Filter "rule '
    - --Encoded --Filter \"
- condition: 1 of selection*
  selection_flags1:
    CommandLine|endswith:
    - ' /method:ntlm'
    - ' /method:kerb'
    - ' /method:nego'
    - ' /m:nego'
    - ' /m:ntlm'
    - ' /m:kerb'
  selection_name:
    Image|endswith: \SharpLdapWhoami.exe
  selection_pe:
  - OriginalFileName|contains: SharpLdapWhoami
  - Product: SharpLdapWhoami
- condition: selection
  selection:
  - Image|endswith: \SharpUp.exe
  - Description: SharpUp
  - CommandLine|contains:
    - HijackablePaths
    - UnquotedServicePath
    - ProcessDLLHijack
    - ModifiableServiceBinaries
    - ModifiableScheduledTask
    - DomainGPPPassword
    - CachedGPPPassword
- condition: selection
  selection:
  - OriginalFileName: SharpView.exe
  - Image|endswith: \SharpView.exe
  - CommandLine|contains:
    - Add-RemoteConnection
    - Convert-ADName
    - ConvertFrom-SID
    - ConvertFrom-UACValue
    - Convert-SidToName
    - Export-PowerViewCSV
    - Find-DomainObjectPropertyOutlier
    - Find-DomainProcess
    - Find-DomainShare
    - Find-DomainUserEvent
    - Find-DomainUserLocation
    - Find-ForeignGroup
    - Find-ForeignUser
    - Find-GPOComputerAdmin
    - Find-GPOLocation
    - Find-Interesting
    - Find-LocalAdminAccess
    - Find-ManagedSecurityGroups
    - Get-CachedRDPConnection
    - Get-DFSshare
    - Get-DomainComputer
    - Get-DomainController
    - Get-DomainDFSShare
    - Get-DomainDNSRecord
    - Get-DomainFileServer
    - Get-DomainForeign
    - Get-DomainGPO
    - Get-DomainGroup
    - Get-DomainGUIDMap
    - Get-DomainManagedSecurityGroup
    - Get-DomainObject
    - Get-DomainOU
    - Get-DomainPolicy
    - Get-DomainSID
    - Get-DomainSite
    - Get-DomainSPNTicket
    - Get-DomainSubnet
    - Get-DomainTrust
    - Get-DomainUserEvent
    - Get-ForestDomain
    - Get-ForestGlobalCatalog
    - Get-ForestTrust
    - Get-GptTmpl
    - Get-GroupsXML
    - Get-LastLoggedOn
    - Get-LoggedOnLocal
    - Get-NetComputer
    - Get-NetDomain
    - Get-NetFileServer
    - Get-NetForest
    - Get-NetGPO
    - Get-NetGroupMember
    - Get-NetLocalGroup
    - Get-NetLoggedon
    - Get-NetOU
    - Get-NetProcess
    - Get-NetRDPSession
    - Get-NetSession
    - Get-NetShare
    - Get-NetSite
    - Get-NetSubnet
    - Get-NetUser
    - Get-PathAcl
    - Get-PrincipalContext
    - Get-RegistryMountedDrive
    - Get-RegLoggedOn
    - Get-WMIRegCachedRDPConnection
    - Get-WMIRegLastLoggedOn
    - Get-WMIRegMountedDrive
    - Get-WMIRegProxy
    - Invoke-ACLScanner
    - Invoke-CheckLocalAdminAccess
    - Invoke-Kerberoast
    - Invoke-MapDomainTrust
    - Invoke-RevertToSelf
    - Invoke-Sharefinder
    - Invoke-UserImpersonation
    - Remove-DomainObjectAcl
    - Remove-RemoteConnection
    - Request-SPNTicket
    - Set-DomainObject
    - Test-AdminAccess
- condition: selection
  selection:
  - Image|endswith: \SharpChisel.exe
  - Product: SharpChisel
- condition: 1 of selection_*
  selection_cli:
  - CommandLine|contains|all:
    - ' user:'
    - ' binary:'
  - CommandLine|contains|all:
    - ' user:'
    - ' shellcode:'
  - CommandLine|contains:
    - ' technique:CreateProcessAsUserW'
    - ' technique:ImpersonateLoggedOnuser'
  selection_img:
  - Image|endswith: \SharpImpersonation.exe
  - OriginalFileName: SharpImpersonation.exe
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains|all:
    - '/user:'
    - '/pass:'
    - '/dcip:'
  selection_img:
  - Image|endswith: \SharpLDAPmonitor.exe
  - OriginalFileName: SharpLDAPmonitor.exe
- condition: selection
  selection:
    CommandLine|contains: -NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8
- condition: selection
  selection:
  - Image|endswith: \Stracciatella.exe
  - OriginalFileName: Stracciatella.exe
  - Description: Stracciatella
  - Hashes|contains:
    - SHA256=9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956
    - SHA256=fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a
  - sha256:
    - 9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956
    - fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a
- condition: 1 of selection_*
  selection_hash:
  - Hashes:
    - IMPHASH=22F4089EB8ABA31E1BB162C6D9BF72E5
    - IMPHASH=5123FA4C4384D431CD0D893EEB49BBEC
  - Imphash:
    - 22f4089eb8aba31e1bb162c6d9bf72e5
    - 5123fa4c4384d431cd0d893eeb49bbec
  selection_img:
    Image|endswith: \SysmonEOP.exe
- condition: selection
  selection:
  - OriginalFileName: TruffleSnout.exe
  - Image|endswith: \TruffleSnout.exe
- condition: 1 of selection_*
  selection_hashes_other:
    Imphash:
    - 767637c23bb42cd5d7397cf58b0be688
    - 14c4e4c72ba075e9069ee67f39188ad8
    - 3c782813d4afce07bbfc5a9772acdbdc
    - 7d010c6bb6a3726f327f7e239166d127
    - 89159ba4dd04e4ce5559f132a9964eb3
    - 6f33f4a5fc42b8cec7314947bd13f30f
    - 5834ed4291bdeb928270428ebbaf7604
    - 5a8a8a43f25485e7ee1b201edcbc7a38
    - dc7d30b90b2d8abf664fbed2b1b59894
    - 41923ea1f824fe63ea5beb84db7a3e74
    - 3de09703c8e79ed2ca3f01074719906b
  selection_hashes_sysmon:
    Hashes|contains:
    - IMPHASH=767637C23BB42CD5D7397CF58B0BE688
    - IMPHASH=14C4E4C72BA075E9069EE67F39188AD8
    - IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC
    - IMPHASH=7D010C6BB6A3726F327F7E239166D127
    - IMPHASH=89159BA4DD04E4CE5559F132A9964EB3
    - IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F
    - IMPHASH=5834ED4291BDEB928270428EBBAF7604
    - IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38
    - IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894
    - IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74
    - IMPHASH=3DE09703C8E79ED2CA3F01074719906B
  selection_img:
    Image|endswith:
    - \Akagi64.exe
    - \Akagi.exe
  selection_pe:
  - Product: UACMe
  - Company:
    - REvol Corp
    - APT 92
    - UG North
    - Hazardous Environments
    - CD Project Rekt
  - Description:
    - UACMe main module
    - Pentesting utility
  - OriginalFileName:
    - Akagi.exe
    - Akagi64.exe
- condition: 1 of selection_* and not filter
  filter:
    Image|endswith: \clussvc.exe
  selection_1:
  - Imphash:
    - a53a02b997935fd8eedcb5f7abab9b9f
    - e96a73c7bf33a464c510ede582318bf2
  - Hashes|contains:
    - IMPHASH=a53a02b997935fd8eedcb5f7abab9b9f
    - IMPHASH=e96a73c7bf33a464c510ede582318bf2
  selection_2:
    CommandLine|endswith: .exe -S
    ParentImage|endswith: \services.exe
- condition: 1 of selection_*
  selection_cli_dl:
    CommandLine|contains: https://github.com/carlospolop/PEASS-ng/releases/latest/download/
  selection_cli_option:
    CommandLine|contains:
    - ' applicationsinfo'
    - ' browserinfo'
    - ' eventsinfo'
    - ' fileanalysis'
    - ' filesinfo'
    - ' processinfo'
    - ' servicesinfo'
    - ' windowscreds'
  selection_cli_specific:
  - ParentCommandLine|endswith: ' -linpeas'
  - CommandLine|endswith: ' -linpeas'
  selection_img:
  - OriginalFileName: winPEAS.exe
  - Image|endswith:
    - \winPEASany.exe
    - \winPEASany_ofs.exe
    - \winPEASx64.exe
    - \winPEASx64_ofs.exe
    - \winPEASx86.exe
    - \winPEASx86_ofs.exe
- condition: selection
  selection:
    CommandLine|contains: -NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc
- condition: selection
  selection:
  - Image|endswith: \xordump.exe
  - CommandLine|contains:
    - ' -process lsass.exe '
    - ' -m comsvcs '
    - ' -m dbghelp '
    - ' -m dbgcore '
- condition: run or delete
  delete:
    CommandLine|contains|all:
    - /delete
    - Microsoft_Windows_Shell_ZipFolder:filename=
    - .zip
  run:
    CommandLine|contains|all:
    - /generic:Microsoft_Windows_Shell_ZipFolder:filename=
    - .zip
    - '/pass:'
    - '/user:'
- condition: 1 of selection_*
  selection_lower:
    CommandLine|contains:
    - "\u0430"
    - "\u0435"
    - "\u043E"
    - "\u0440"
    - "\u0441"
    - "\u0445"
    - "\u0455"
    - "\u0456"
    - "\u04CF"
    - "\u0458"
    - "\u04BB"
    - "\u0501"
    - "\u051B"
    - "\u051D"
    - "\u03BF"
  selection_upper:
    CommandLine|contains:
    - "\u0410"
    - "\u0412"
    - "\u0415"
    - "\u041A"
    - "\u041C"
    - "\u041D"
    - "\u041E"
    - "\u0420"
    - "\u0421"
    - "\u0422"
    - "\u0425"
    - "\u0405"
    - "\u0406"
    - "\u0408"
    - "\u04AE"
    - "\u04C0"
    - "\u050C"
    - "\u051A"
    - "\u051C"
    - "\u0391"
    - "\u0392"
    - "\u0395"
    - "\u0396"
    - "\u0397"
    - "\u0399"
    - "\u039A"
    - "\u039C"
    - "\u039D"
    - "\u039F"
    - "\u03A1"
    - "\u03A4"
    - "\u03A5"
    - "\u03A7"
- condition: selection
  selection:
    Image|endswith: \HOSTNAME.EXE
- condition: selection
  selection:
    Image|endswith: \gbb.exe
    ParentImage|endswith: \Hwp.exe
- condition: selection and not filter
  filter:
    CurrentDirectory|endswith: \hxtsr.exe
    CurrentDirectory|startswith: C:\program files\windowsapps\microsoft.windowscommunicationsapps_
  selection:
    Image: hxtsr.exe
- condition: all of selection*
  selection_cmd:
    CommandLine|contains|all:
    - C:\Users\
    - /deny
    - '*S-1-1-0:'
  selection_icacls:
  - OriginalFileName: iCACLS.EXE
  - Image|endswith: \icacls.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - set
    - config
    - section:httplogging
    - dontLog:true
  selection_img:
  - Image|endswith: \appcmd.exe
  - OriginalFileName: appcmd.exe
- condition: all of selection_base_* and (selection_standalone or all of selection_cmd_*)
  selection_base_list:
    CommandLine|contains: 'list '
  selection_base_name:
  - Image|endswith: \appcmd.exe
  - OriginalFileName: appcmd.exe
  selection_cmd_flags:
    CommandLine|contains:
    - ' /@t'
    - ' /text'
    - ' /show'
    - ' -@t'
    - ' -text'
    - ' -show'
  selection_cmd_grep:
    CommandLine|contains:
    - :\*
    - password
  selection_standalone:
    CommandLine|contains:
    - ' /config'
    - ' /xml'
    - ' -config'
    - ' -xml'
- condition: all of selection_* and not 1 of filter_*
  filter_iis_setup:
    ParentImage: C:\Windows\System32\inetsrv\iissetup.exe
  selection_cli:
    CommandLine|contains:
    - '/name:'
    - '-name:'
    CommandLine|contains|all:
    - install
    - module
  selection_img:
  - Image|endswith: \appcmd.exe
  - OriginalFileName: appcmd.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - set
    - config
    - section:system.webServer/rewrite/globalRules
    - 'commit:'
  selection_img:
  - Image|endswith: \appcmd.exe
  - OriginalFileName: appcmd.exe
- condition: all of selection*
  selection_args:
    CommandLine|contains|all:
    - connectionStrings
    - ' -pdf'
  selection_name:
  - Image|endswith: \aspnet_regiis.exe
  - OriginalFileName: aspnet_regiis.exe
- condition: selection_parent and 1 of selection_cli_*
  selection_cli_1:
    CommandLine|contains: appcmd.exe add module
  selection_cli_2:
    CommandLine|contains: ' system.enterpriseservices.internal.publish'
    Image|endswith: \powershell.exe
  selection_cli_3:
    CommandLine|contains|all:
    - gacutil
    - ' /I'
  selection_parent:
    ParentImage|endswith: \w3wp.exe
- condition: 1 of selection_*
  selection_child:
    ParentImage|endswith: \ImagingDevices.exe
  selection_parent:
    Image|endswith: \ImagingDevices.exe
    ParentImage|endswith:
    - \WmiPrvSE.exe
    - \svchost.exe
    - \dllhost.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - 'InfDefaultInstall.exe '
    - '.inf'
- condition: selection
  selection:
    CommandLine|contains|all:
    - '/logfile= '
    - /LogToConsole=false
    Image|contains: Microsoft.NET\Framework
    Image|endswith: \InstallUtil.exe
- condition: selection
  selection:
    Image|endswith:
    - \cmd.exe
    - \sh.exe
    - \bash.exe
    - \powershell.exe
    - \pwsh.exe
    - \schtasks.exe
    - \certutil.exe
    - \whoami.exe
    - \bitsadmin.exe
    - \wscript.exe
    - \cscript.exe
    - \scrcons.exe
    - \regsvr32.exe
    - \hh.exe
    - \wmic.exe
    - \mshta.exe
    - \rundll32.exe
    - \forfiles.exe
    - \scriptrunner.exe
    - \mftrace.exe
    - \AppVLP.exe
    - \systeminfo.exe
    - \reg.exe
    - \query.exe
    ParentImage|endswith: \keytool.exe
- condition: all of selection_* and not exclusion
  exclusion:
    CommandLine|contains:
    - address=127.0.0.1
    - address=localhost
  selection_jdwp_transport:
    CommandLine|contains: transport=dt_socket,address=
  selection_old_jvm_version:
    CommandLine|contains:
    - jre1.
    - jdk1.
- condition: selection
  selection:
    Image|endswith:
    - \sh.exe
    - \bash.exe
    - \powershell.exe
    - \pwsh.exe
    - \schtasks.exe
    - \certutil.exe
    - \whoami.exe
    - \bitsadmin.exe
    - \wscript.exe
    - \cscript.exe
    - \scrcons.exe
    - \regsvr32.exe
    - \hh.exe
    - \wmic.exe
    - \mshta.exe
    - \rundll32.exe
    - \forfiles.exe
    - \scriptrunner.exe
    - \mftrace.exe
    - \AppVLP.exe
    - \curl.exe
    - \systeminfo.exe
    - \net.exe
    - \net1.exe
    - \reg.exe
    - \query.exe
    ParentImage|endswith: \java.exe
- condition: selection and not filter
  filter:
    CommandLine|contains: build
    ParentImage|contains: build
  selection:
    Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    ParentImage|endswith: \java.exe
- condition: selection
  selection:
    ParentCommandLine|contains: SysAidServer
    ParentImage|endswith:
    - \java.exe
    - \javaw.exe
- condition: selection
  selection:
  - Image|endswith: \kd.exe
  - OriginalFileName: kd.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' /setcomputerpassword '
  selection_img:
  - Image|endswith: \ksetup.exe
  - OriginalFileName: ksetup.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' /ChangePassword '
  selection_img:
  - Image|endswith: \ksetup.exe
  - OriginalFileName: ksetup.exe
- condition: all of selection_* and not 1 of filter_*
  filter_import:
    CommandLine|contains: ' -i'
  selection_cmd:
    CommandLine|contains: -f
  selection_ldif:
  - Image|endswith: \ldifde.exe
  - OriginalFileName: ldifde.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - -i
    - -f
  selection_img:
  - Image|endswith: \ldifde.exe
  - OriginalFileName: ldifde.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' /r'
    - ' -r'
  selection_img:
    Image|endswith: \lodctr.exe
    OriginalFileName: LODCTR.EXE
- condition: all of selection*
  selection_action:
    CommandLine|contains:
    - 'stop '
    - 'delete '
  selection_img:
  - Image|endswith: \logman.exe
  - OriginalFileName: Logman.exe
  selection_service:
    CommandLine|contains:
    - Circular Kernel Context Logger
    - EventLog-
    - SYSMON TRACE
    - SysmonDnsEtwSession
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' -powershell'
    - ' -remediationScript'
  selection_img:
  - Image: \AgentExecutor.exe
  - OriginalFileName: AgentExecutor.exe
- condition: all of selection_* and not filter
  filter:
    CommandLine|contains:
    - C:\Windows\SysWOW64\WindowsPowerShell\v1.0\
    - C:\Windows\System32\WindowsPowerShell\v1.0\
  selection_cli:
    CommandLine|contains:
    - ' -powershell'
    - ' -remediationScript'
  selection_img:
  - Image|endswith: \AgentExecutor.exe
  - OriginalFileName: AgentExecutor.exe
- condition: selection and not filter
  filter:
    Image|endswith:
    - \msoasb.exe
    - \rundll32.exe
  selection:
    ParentImage|endswith: \appvlp.exe
- condition: selection
  selection:
    Image|contains|all:
    - C:\Windows\Microsoft.NET\Framework
    - aspnet_compiler.exe
- condition: selection and not 1 of filter*
  filter_git:
  - ParentCommandLine|contains:
    - C:\Program Files\Git\post-install.bat
    - C:\Program Files (x86)\Git\post-install.bat
    - echo /etc/post-install/*.post
  - CommandLine|contains: echo /etc/post-install/*.post
  selection:
    CommandLine|contains|all:
    - bash.exe
    - '-c '
- condition: selection
  selection:
    CommandLine|contains|all:
    - /popup
    - /nolicprompt
    Image|endswith: \bginfo.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - ' -c '
    - ' -cf '
  selection_img:
  - Image|endswith: \cdb.exe
  - OriginalFileName: CDB.Exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains: -GetCACAPS
  selection_img:
  - Image|endswith: \certoc.exe
  - OriginalFileName: CertOC.exe
- condition: selection
  selection:
    CommandLine|re: \{[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}\}
    Image|endswith: \xwizard.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - CL_Invocation.ps1
    - SyncInvoke
- condition: selection
  selection:
    CommandLine|contains:
    - \CL_LoadAssembly.ps1
    - 'LoadAssemblyFromPath '
- condition: selection
  selection:
    CommandLine|contains|all:
    - \CL_Mutexverifiers.ps1
    - 'runAfterCancelProcess '
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - '/vpn '
    - '/lan '
  selection_img:
  - Image|endswith: \cmdl32.exe
  - OriginalFileName: CMDL32.EXE
- condition: lolbas and remote
  lolbas:
  - CommandLine|contains: ConfigSecurityPolicy.exe
  - Image|endswith: \ConfigSecurityPolicy.exe
  - OriginalFileName: ConfigSecurityPolicy.exe
  remote:
    CommandLine|contains:
    - https://
    - http://
    - ftp://
- condition: selection and not filter
  filter:
    Image: C:\Windows\explorer.exe
  selection:
    ParentImage|endswith: \CustomShellHost.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - '/in:'
    - '/out:'
    - '/uri:'
  selection_img:
  - Image|endswith: \DataSvcUtil.exe
  - OriginalFileName: DataSvcUtil.exe
- condition: selection and not filter
  filter:
    CommandLine|contains: DesktopCentral_Agent\agent
  selection:
    Image|endswith: \dctask64.exe
- condition: selection
  selection:
    ParentImage|endswith: \defaultpack.exe
- condition: selection
  selection:
    Image|endswith: \DeviceCredentialDeployment.exe
- condition: selection
  selection:
    CommandLine|contains: LaunchForDeploy
    Image|endswith: \devtoolslauncher.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - diantz.exe
    - .cab
    CommandLine|re: :[^\\]
- condition: selection
  selection:
    CommandLine|contains|all:
    - diantz.exe
    - ' \\\\'
    - .cab
- condition: selection
  selection:
    CommandLine|contains:
    - /s
    - -s
    Image|endswith: \diskshadow.exe
- condition: selection and not filter
  filter:
    Image|startswith: C:\Windows\System32\
  selection:
    Image|endswith: \xwizard.exe
- condition: selection
  selection:
    Image|endswith: \dnx.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|endswith:
    - .dll
    - .csproj
  selection_img:
  - Image|endswith: \dotnet.exe
  - OriginalFileName: .NET Host
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: collect
  selection_img:
  - Image|endswith: \dotnet-dump.exe
  - OriginalFileName: dotnet-dump.dll
- condition: ( selection and not filter ) or ( selection and procdump_flags )
  filter:
    Image|contains: \Installer\Feedback\dump64.exe
  procdump_flags:
    CommandLine|contains:
    - ' -ma '
    - accepteula
  selection:
    Image|endswith: \dump64.exe
- condition: selection
  selection:
  - CommandLine|contains: Extexport.exe
  - Image|endswith: \Extexport.exe
  - OriginalFileName: extexport.exe
- condition: all of selection_*
  selection_archive:
    CommandLine|contains: .cab
  selection_lolbas:
  - CommandLine|contains: extrac32.exe
  - Image|endswith: \extrac32.exe
  - OriginalFileName: extrac32.exe
  selection_options:
    CommandLine|contains:
    - /C
    - /Y
    - ' \\\\'
- condition: selection
  selection:
    CommandLine|contains|all:
    - extrac32.exe
    - .cab
    CommandLine|re: :[^\\]
- condition: selection_findstr and (all of selection_cli_download* or all of selection_cli_creds*)
  selection_cli_creds_1:
    CommandLine|contains:
    - ' /s '
    - ' -s '
  selection_cli_creds_2:
    CommandLine|contains:
    - ' /i '
    - ' -i '
  selection_cli_download_1:
    CommandLine|contains:
    - ' /v '
    - ' -v '
  selection_cli_download_2:
    CommandLine|contains:
    - ' /l '
    - ' -l '
  selection_findstr:
  - CommandLine|contains: findstr
  - Image|endswith: findstr.exe
  - OriginalFileName: FINDSTR.EXE
- condition: all of selection*
  selection_cli_c:
    CommandLine|contains:
    - ' /c '
    - ' -c '
  selection_cli_m:
    CommandLine|contains:
    - ' /m '
    - ' -m '
  selection_cli_p:
    CommandLine|contains:
    - ' /p '
    - ' -p '
  selection_img:
  - Image|endswith: \forfiles.exe
  - OriginalFileName: forfiles.exe
- condition: selection and not 1 of filter*
  filter:
    CommandLine|contains:
    - /fs:FAT
    - /fs:exFAT
    - /fs:NTFS
    - /fs:UDF
    - /fs:ReFS
  selection:
    CommandLine|contains: '/fs:'
    Image|endswith: \format.com
- condition: selection
  selection:
  - Image|endswith: \fsianycpu.exe
  - OriginalFileName: fsianycpu.exe
  - Image|endswith: \fsi.exe
  - OriginalFileName: fsi.exe
- condition: selection_parent or all of selection_ftp_*
  selection_ftp_cli:
    CommandLine|contains: '-s:'
  selection_ftp_img:
  - Image|endswith: \ftp.exe
  - OriginalFileName: ftp.exe
  selection_parent:
    ParentImage|endswith: \ftp.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: gatherNetworkInfo.vbs
  selection_img:
  - Image|endswith:
    - \cscript.exe
    - \wscript.exe
  - OriginalFileName:
    - cscript.exe
    - wscript.exe
- condition: image_path and not filter
  filter:
    CommandLine|contains: gameplayapi.intel.com
    ParentImage|endswith:
    - \GfxDownloadWrapper.exe
    - \igfxEM.exe
  image_path:
    Image|endswith: \GfxDownloadWrapper.exe
- condition: all of selection_* and not 1 of filter_main_*
  filter_main_svchost:
    ParentCommandLine: C:\windows\system32\svchost.exe -k netsvcs -p -s gpsvc
  selection_cli:
    CommandLine|contains:
    - ' /logon'
    - ' /startup'
  selection_img:
  - Image|endswith: \gpscript.exe
  - OriginalFileName: GPSCRIPT.EXE
- condition: lolbin and not 1 of filter_*
  filter_correct:
    CurrentDirectory:
    - c:\windows\system32\
    - c:\windows\sysWOW64\
  filter_missing:
    CurrentDirectory: null
  lolbin:
  - Image|endswith: \ie4uinit.exe
  - OriginalFileName: IE4UINIT.EXE
- condition: lolbas and remote
  lolbas:
  - Image|endswith: \IEExec.exe
  - OriginalFileName: IEExec.exe
  remote:
    CommandLine|contains:
    - https://
    - http://
- condition: selection
  selection:
  - Image|endswith: \ilasm.exe
  - OriginalFileName: ilasm.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - http://
    - https://
    - ftp://
  selection_img:
  - Image|endswith: \InstallUtil.exe
  - OriginalFileName: InstallUtil.exe
- condition: selection
  selection:
    CommandLine|contains: .js
    Image|endswith: \jsc.exe
- condition: selection and not filter
  filter:
    ParentImage|endswith:
    - \kavremover.exe
    - \cleanapi.exe
  selection:
    CommandLine|contains: ' run run-cmd '
- condition: all of selection_*
  selection_flags:
    CommandLine|contains:
    - 'VsWherePath '
    - 'VsInstallationPath '
  selection_script:
    CommandLine|contains: Launch-VsDevShell.ps1
- condition: all of selection_wscript_* or (selection_parent and not selection_filter_cmd)
  selection_filter_cmd:
    Image|endswith: \cmd.exe
  selection_parent:
    ParentCommandLine|contains: manage-bde.wsf
    ParentImage|endswith:
    - \cscript.exe
    - \wscript.exe
  selection_wscript_cli:
    CommandLine|contains: manage-bde.wsf
  selection_wscript_img:
  - Image|endswith: \wscript.exe
  - OriginalFileName: wscript.exe
- condition: selection and not filter
  filter:
    ParentImage: C:\Windows\System32\AppVClient.exe
  selection:
    CommandLine|contains: ' /INJECTRUNNING '
- condition: all of selection* or parent
  parent:
    ParentImage|endswith: \mftrace.exe
  selection_cli:
    CommandLine|contains: '.exe '
    CommandLine|endswith: .exe
  selection_img:
  - Image|endswith: \mftrace.exe
  - OriginalFileName: mftrace.exe
- condition: all of selection*
  selection_binary:
  - Image|endswith: \mpiexec.exe
  - Imphash: d8b52ef6aaa3a81501bdfff9dbb96217
  - Hashes|contains: IMPHASH=d8b52ef6aaa3a81501bdfff9dbb96217
  selection_flags:
    CommandLine|contains:
    - ' /n 1 '
    - ' -n 1 '
- condition: selection
  selection:
    CommandLine|contains|all:
    - verb:sync
    - -source:RunCommand
    - -dest:runCommand
    Image|endswith: \msdeploy.exe
- condition: all of selection* and not filter
  filter:
    ParentImage|endswith: \pcwrun.exe
  selection_answer:
    CommandLine|contains:
    - ' -af '
    - ' /af '
  selection_cli:
    CommandLine|contains: \WINDOWS\diagnostics\index\PCWDiagnostic.xml
    Image|endswith: \msdt.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - http://
    - https://
    - ftp://
  selection_img:
  - Image|endswith: \MSOHTMED.exe
  - OriginalFileName: MsoHtmEd.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - http://
    - https://
    - ftp://
  selection_img:
  - Image|endswith: \MSPUB.exe
  - OriginalFileName: MSPUB.exe
- condition: selection and not 1 of filter_main_*
  filter_main_currentdirectory:
    CurrentDirectory|contains: C:\
  filter_main_empty:
    CurrentDirectory: ''
  filter_main_null:
    CurrentDirectory: null
  selection:
  - Image|endswith:
    - \rundll32.exe
    - \calc.exe
    - \mshta.exe
    - \cscript.exe
    - \wscript.exe
    - \regsvr32.exe
    - \installutil.exe
    - \cmstp.exe
  - OriginalFileName:
    - RUNDLL32.EXE
    - CALC.EXE
    - MSHTA.EXE
    - cscript.exe
    - wscript.exe
    - REGSVR32.EXE
    - installutil.exe
    - CMSTP.EXE
- condition: lolbas and not 1 of filter_*
  filter_correct:
    CurrentDirectory: C:\Program Files\Windows Defender\Offline\
  filter_missing:
    CurrentDirectory: null
  lolbas:
    Image|endswith: \OfflineScannerShell.exe
- condition: selection and not filter
  filter:
    Image|startswith: C:\Program Files\WindowsApps\Microsoft.WindowsTerminal
  selection:
  - OriginalFileName: OpenConsole.exe
  - Image|endswith: \OpenConsole.exe
- condition: selection
  selection:
    CommandLine|contains: /c
    Image|endswith: \OpenWith.exe
- condition: selection
  selection:
    CommandLine|contains: ' -a'
    Image|endswith: \pcalua.exe
- condition: selection
  selection:
    ParentImage|endswith: \pcwrun.exe
- condition: selection
  selection:
    CommandLine|contains: ../
    Image|endswith: \pcwrun.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - pcwutl
    - LaunchApplication
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: all of selection_*
  selection_cli:
    ParentCommandLine|contains:
    - '{ Invoke-Pester -EnableExit ;'
    - '{ Get-Help "'
  selection_module:
    ParentCommandLine|contains: \WindowsPowerShell\Modules\Pester\
    ParentImage|endswith:
    - \powershell.exe
    - \pwsh.exe
- cmd_execution:
    CommandLine|contains|all:
    - pester
    - ;
    Image|endswith: \cmd.exe
  condition: powershell_module or (cmd_execution and get_help)
  get_help:
    CommandLine|contains:
    - help
    - '?'
  powershell_module:
    CommandLine|contains|all:
    - Pester
    - Get-Help
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: all of selection* and not filter
  filter:
    CommandLine|contains:
    - C:\Windows\
    - C:\Program Files
  selection_cli:
    CommandLine|contains: .xbap
  selection_img:
  - Image|endswith: \presentationhost.exe
  - OriginalFileName: PresentationHost.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - http://
    - https://
    - ftp://
  selection_img:
  - Image|endswith: \presentationhost.exe
  - OriginalFileName: PresentationHost.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' -f'
    - .zip
    Image|endswith: \PrintBrm.exe
- condition: selection_img and 1 of selection_cli_*
  selection_cli_1:
    CommandLine|contains|all:
    - '"ms-word'
    - .docx"
  selection_cli_2:
    CommandLine|contains: ' http'
  selection_img:
  - Image|endswith: \protocolhandler.exe
  - OriginalFileName: ProtocolHandler.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - \pubprn.vbs
    - 'script:'
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - ' -d '
    - ' -p '
  selection_img:
  - Image|endswith: \rasautou.exe
  - OriginalFileName: rasdlui.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - \register_app.vbs
    - -register
- condition: selection
  selection:
  - Image|endswith: \remote.exe
  - OriginalFileName: remote.exe
- argument:
    CommandLine|contains:
    - /a
    - -a
  condition: selection and argument
  selection:
    Image|endswith: \replace.exe
- condition: selection
  selection:
    ParentImage|endswith: \runexehelper.exe
- condition: selection
  selection:
    CommandLine|contains: surfacecheck
    Image|endswith: \Runscripthelper.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains: ' -appvscript '
  selection_img:
  - Image|endswith: \ScriptRunner.exe
  - OriginalFileName: ScriptRunner.exe
- condition: all of selection*
  selection:
    Image|endswith: \choice
    ParentImage|endswith: \setres.exe
- condition: not system_utility and parent_is_settingsynchost
  parent_is_settingsynchost:
    ParentCommandLine|contains|all:
    - cmd.exe /c
    - RoamDiag.cmd
    - -outputpath
  system_utility:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
- condition: selection
  selection:
    CommandLine|contains:
    - ' -D ..'
    - ' -D C:\'
    Image|endswith: \sftp.exe
- condition: selection and not 1 of filter_*
  filter_visual_studio:
    ParentImage|contains: \VC\Tools\MSVC\
    ParentImage|startswith:
    - C:\Program Files\Microsoft Visual Studio\
    - C:\Program Files (x86)\Microsoft Visual Studio\
  selection:
    CommandLine|contains: LINK /
    Image|endswith: \link.exe
- condition: selection
  selection:
    ParentImage|endswith: \sigverif.exe
- condition: selection_img and (all of selection_download_* or selection_exec) and
    not 1 of filter_*
  filter_discord:
    CommandLine|contains|all:
    - C:\Users\
    - \AppData\Local\Discord\Update.exe
    - ' --processStart'
    - Discord.exe
  filter_github_desktop:
    CommandLine|contains:
    - --createShortcut
    - --processStartAndWait
    CommandLine|contains|all:
    - C:\Users\
    - \AppData\Local\GitHubDesktop\Update.exe
    - GitHubDesktop.exe
  filter_teams:
    CommandLine|contains:
    - --processStart
    - --createShortcut
    CommandLine|contains|all:
    - C:\Users\
    - \AppData\Local\Microsoft\Teams\Update.exe
    - Teams.exe
  filter_yammer:
    CommandLine|contains:
    - --processStart
    - --createShortcut
    CommandLine|contains|all:
    - C:\Users\
    - \AppData\Local\yammerdesktop\Update.exe
    - Yammer.exe
  selection_download_cli:
    CommandLine|contains:
    - ' --download '
    - ' --update '
    - ' --updateRollback='
  selection_download_http_keyword:
    CommandLine|contains: http
  selection_exec:
    CommandLine|contains:
    - --processStart
    - --processStartAndWait
    - --createShortcut
  selection_img:
    Image|endswith:
    - \squirrel.exe
    - \update.exe
- condition: selection_parent or all of selection_cli_*
  selection_cli_flags:
  - CommandLine|contains: ProxyCommand=
  - CommandLine|contains|all:
    - PermitLocalCommand
    - LocalCommand
  selection_cli_img:
    Image|endswith: \ssh.exe
  selection_parent:
    ParentImage: C:\Windows\System32\OpenSSH\sshd.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - ' -window '
    - .dll
  selection_img:
  - Image|endswith: \AccCheckConsole.exe
  - OriginalFileName: AccCheckConsole.exe
- condition: selection and not filter
  filter:
    CommandLine|contains:
    - animations
    - audiodescription
    - caretbrowsing
    - caretwidth
    - colorfiltering
    - cursorscheme
    - filterkeys
    - focusborderheight
    - focusborderwidth
    - highcontrast
    - keyboardcues
    - keyboardpref
    - magnifierpane
    - messageduration
    - minimumhitradius
    - mousekeys
    - Narrator
    - osk
    - overlappedcontent
    - showsounds
    - soundsentry
    - stickykeys
    - togglekeys
    - windowarranging
    - windowtracking
    - windowtrackingtimeout
    - windowtrackingzorder
  selection:
    CommandLine|contains: start
    Image|endswith: AtBroker.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - ' -Post '
    - ' -config '
    - ' http'
    - ' C:\windows\win.ini '
  selection_img:
  - Image|endswith: \certreq.exe
  - OriginalFileName: CertReq.exe
- condition: selection
  selection:
    CommandLine|contains:
    - -i
    - /install
    - -a
    - /add-driver
    - '.inf'
    Image|endswith: \pnputil.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains: ' -c '
  selection_img:
  - Image|endswith: \DXCap.exe
  - OriginalFileName: DXCap.exe
- condition: selection
  selection:
    CommandLine|contains:
    - grpconv.exe -o
    - grpconv -o
- condition: all of selection*
  selection1:
  - CommandLine|contains: MpCmdRun.exe
  - Description: Microsoft Malware Protection Command Line Utility
  selection2:
    CommandLine|contains|all:
    - DownloadFile
    - url
- condition: selection
  selection:
    CommandLine|contains:
    - '0x0110'
    - 0x01100:40
    Image|endswith: \sqldumper.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: '"n; '
  selection_img:
  - Image|endswith: \SyncAppvPublishingServer.exe
  - OriginalFileName: syncappvpublishingserver.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - \SyncAppvPublishingServer.vbs
    - ;
- condition: all of selection_* and not 1 of filter_*
  filter_msbuild1:
    CommandLine|contains: ' /ERRORREPORT:PROMPT '
  filter_msbuild2:
    ParentImage|endswith:
    - \Msbuild\Current\Bin\MSBuild.exe
    - \Msbuild\Current\Bin\amd64\MSBuild.exe
  selection_cli:
    CommandLine|contains:
    - ' /d '
    - ' /c '
  selection_img:
  - Image|endswith: \tracker.exe
  - Description: Tracker
- condition: selection
  selection:
  - Image|endswith: ttdinject.exe
  - OriginalFileName: TTDInject.EXE
- condition: selection
  selection:
    ParentImage|endswith: \tttracer.exe
- condition: 1 of selection_*
  selection_download:
    CommandLine|contains|all:
    - type \\\\
    - ' > '
  selection_upload:
    CommandLine|contains|all:
    - 'type '
    - ' > \\\\'
- condition: all of selection_*
  selection_cmd:
    CommandLine|contains: ' /HideWMP'
  selection_img:
  - Image|endswith: \unregmp2.exe
  - OriginalFileName: unregmp2.exe
- condition: selection
  selection:
    CommandLine|contains:
    - UtilityFunctions.ps1
    - 'RegSnapin '
- condition: selection
  selection:
  - Image|endswith: \VisualUiaVerifyNative.exe
  - OriginalFileName: VisualUiaVerifyNative.exe
- condition: selection
  selection:
    Image|endswith: \cvtres.exe
    ParentImage|endswith: \vbc.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - ' -p '
    - ' -a '
  selection_img:
  - Image|endswith: \VSIISExeLauncher.exe
  - OriginalFileName: VSIISExeLauncher.exe
- condition: selection
  selection:
  - Image|endswith: \wfc.exe
  - OriginalFileName: wfc.exe
- condition: selection_parent or (all of selection_child_* and not 1 of filter*)
  filter:
    ParentImage: C:\Windows\System32\winlogon.exe
  filter_null:
    ParentImage: '-'
  selection_child_cli:
    CommandLine|contains|all:
    - '-s '
    - '-f '
    - '-t '
    - '-m '
    - '-a '
    - '-u '
  selection_child_img:
  - Image|endswith: \wlrmdr.exe
  - OriginalFileName: WLRMNDR.EXE
  selection_parent:
    ParentImage|endswith: \wlrmdr.exe
- condition: selection
  selection:
  - Image|endswith: \Microsoft.Workflow.Compiler.exe
  - OriginalFileName: Microsoft.Workflow.Compiler.exe
- condition: all of selection_* and not filter
  filter:
    CommandLine|contains:
    - ' /UpdateDeploymentProvider UpdateDeploymentProvider.dll '
    - ' wuaueng.dll '
  selection_cli:
    CommandLine|contains|all:
    - UpdateDeploymentProvider
    - .dll
    - RunHandlerComServer
  selection_img:
  - Image|endswith: \wuauclt.exe
  - OriginalFileName: wuauclt.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains: '.vbs -register '
  selection_img:
  - Image|endswith:
    - \cscript.exe
    - \wscript.exe
  - OriginalFileName:
    - cscript.exe
    - wscript.exe
- condition: all of selection*
  selection_1:
    CommandLine|contains: \\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy
  selection_2:
    CommandLine|contains:
    - \\NTDS.dit
    - \\SYSTEM
    - \\SECURITY
    - C:\\tmp\\log
- condition: selection1 and selection2 and not falsepositive
  falsepositive:
    ParentImage|contains: \winzip
  selection1:
    CommandLine|contains:
    - C:\Users\
    - C:\ProgramData\
    Image|endswith:
    - \wscript.exe
    - \cscript.exe
  selection2:
    CommandLine|contains:
    - .jse
    - .vbe
    - .js
    - .vba
    - .vbs
- condition: selection
  selection:
    CommandLine|contains: -Embedding
    Image|endswith: \mmc.exe
    ParentImage|endswith: \svchost.exe
- condition: all of selection*
  selection1:
    ParentImage|endswith: \mmc.exe
  selection2:
  - Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
    - \cscript.exe
    - \sh.exe
    - \bash.exe
    - \reg.exe
    - \regsvr32.exe
  - Image|contains: \BITSADMIN
- condition: all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_wmiprvse:
    CommandLine|contains: C:\Windows\TEMP\
    CommandLine|endswith: .mof
    ParentImage: C:\Windows\System32\wbem\WmiPrvSE.exe
  filter_optional_null_parent:
    CommandLine|contains: C:\Windows\TEMP\
    CommandLine|endswith: .mof
  selection_case:
  - ParentImage|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \wsl.exe
    - \wscript.exe
    - \cscript.exe
  - CommandLine|contains:
    - \AppData\Local\Temp
    - \Users\Public\
    - \WINDOWS\Temp\
    - '%temp%'
    - '%tmp%'
    - '%appdata%'
  selection_img:
  - Image|endswith: \mofcomp.exe
  - OriginalFileName: mofcomp.exe
- condition: selection and not legit_path
  legit_path:
    Image|startswith:
    - C:\Program Files\Windows Defender\
    - C:\ProgramData\Microsoft\Windows Defender\Platform\
    - C:\Windows\winsxs\
    - C:\Program Files\Microsoft Security Client\MpCmdRun.exe
  selection:
    Image|endswith: \MpCmdRun.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - ' -RemoveDefinitions'
    - ' -All'
  selection_img:
  - Image|endswith: \MpCmdRun.exe
  - OriginalFileName: MpCmdRun.exe
- condition: selection and not filter_parent
  filter_parent:
    ParentImage|endswith:
    - \devenv.exe
    - \cmd.exe
    - \msbuild.exe
    - \python.exe
    - \explorer.exe
    - \nuget.exe
  selection:
  - Image|endswith: \MSBuild.exe
  - OriginalFileName: MSBuild.exe
- condition: selection_img and (selection_cmd_inline or all of selection_cmd_answerfile_*)
  selection_cmd_answerfile_flag:
    CommandLine|contains: ' PCWDiagnostic'
  selection_cmd_answerfile_param:
    CommandLine|contains:
    - ' /af '
    - ' -af '
  selection_cmd_inline:
    CommandLine|contains: IT_BrowseForFile=
  selection_img:
  - Image|endswith: \msdt.exe
  - OriginalFileName: msdt.exe
- condition: all of selection_*
  selection_cmd:
    CommandLine|contains:
    - ' /cab '
    - ' -cab '
  selection_img:
  - Image|endswith: \msdt.exe
  - OriginalFileName: msdt.exe
- condition: all of selection_*
  selection_msdt:
  - Image|endswith: \msdt.exe
  - OriginalFileName: msdt.exe
  selection_parent:
    ParentImage|endswith:
    - \cmd.exe
    - \cscript.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \schtasks.exe
    - \wmic.exe
    - \wscript.exe
    - \wsl.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - http://
    - https://
    - ftp://
  selection_img:
  - Image|endswith: \mshta.exe
  - OriginalFileName: MSHTA.EXE
- condition: selection
  selection:
    CommandLine|contains|all:
    - Wscript.
    - .Shell
    - .Run
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: javascript
  selection_img:
  - Image|endswith: \mshta.exe
  - OriginalFileName: MSHTA.EXE
- condition: selection
  selection:
    Image|endswith: \mshta.exe
    ParentImage|endswith: \svchost.exe
- condition: all of selection*
  selection_child:
  - Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
    - \cscript.exe
    - \sh.exe
    - \bash.exe
    - \reg.exe
    - \regsvr32.exe
    - \bitsadmin.exe
  - OriginalFileName:
    - Cmd.Exe
    - PowerShell.EXE
    - pwsh.dll
    - wscript.exe
    - cscript.exe
    - Bash.exe
    - reg.exe
    - REGSVR32.EXE
    - bitsadmin.exe
  selection_parent:
    ParentImage|endswith: \mshta.exe
- condition: selection
  selection:
    CommandLine|contains:
    - vbscript
    - .jpg
    - .png
    - .lnk
    - .xls
    - .files
    - .zip
    - .dll
    Image|endswith: \mshta.exe
- condition: all of selection_* or (selection_img and not filter_img)
  filter_img:
  - Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  - CommandLine|contains:
    - .htm
    - .hta
  - CommandLine|endswith:
    - mshta.exe
    - mshta
  selection_img:
  - Image|endswith: \mshta.exe
  - OriginalFileName: MSHTA.EXE
  selection_susp:
    CommandLine|contains:
    - \AppData\Local\
    - C:\ProgramData\
    - C:\Users\Public\
    - C:\Windows\Temp\
    ParentImage|endswith:
    - \cmd.exe
    - \cscript.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \wscript.exe
- condition: all of selection_*
  selection_dll:
    CommandLine|contains: .dll
  selection_flag:
    CommandLine|contains:
    - ' /z '
    - ' -z '
  selection_img:
  - Image|endswith: \msiexec.exe
  - OriginalFileName: \msiexec.exe
- condition: selection and not 1 of filter*
  filter_splunk_ufw:
    CommandLine|contains: C:\Program Files\SplunkUniversalForwarder\bin\
    Image|endswith: :\Windows\System32\cmd.exe
  filter_vs:
  - CommandLine|contains: \DismFoDInstall.cmd
  - ParentCommandLine|contains|all:
    - '\MsiExec.exe -Embedding '
    - Global\MSI0000
  selection:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \cmd.exe
    ParentCommandLine|contains|all:
    - MsiExec.exe
    - '-Embedding '
- condition: selection and not 1 of filter_*
  filter_apple:
    CommandLine|contains:
    - \MsiExec.exe" /Y "C:\Program Files\Bonjour\mdnsNSP.dll
    - \MsiExec.exe" /Y "C:\Program Files (x86)\Bonjour\mdnsNSP.dll
    - \MsiExec.exe" /Y "C:\Program Files (x86)\Apple Software Update\ScriptingObjectModel.dll
    - \MsiExec.exe" /Y "C:\Program Files (x86)\Apple Software Update\SoftwareUpdateAdmin.dll
    - \MsiExec.exe" /Y "C:\Windows\CCM\
    - \MsiExec.exe" /Y C:\Windows\CCM\
    - \MsiExec.exe" -Y "C:\Program Files\Bonjour\mdnsNSP.dll
    - \MsiExec.exe" -Y "C:\Program Files (x86)\Bonjour\mdnsNSP.dll
    - \MsiExec.exe" -Y "C:\Program Files (x86)\Apple Software Update\ScriptingObjectModel.dll
    - \MsiExec.exe" -Y "C:\Program Files (x86)\Apple Software Update\SoftwareUpdateAdmin.dll
    - \MsiExec.exe" -Y "C:\Windows\CCM\
    - \MsiExec.exe" -Y C:\Windows\CCM\
  selection:
    CommandLine|contains:
    - ' /y'
    - ' -y'
    Image|endswith: \msiexec.exe
- condition: all of selection_* and not 1 of filter_*
  filter_ccm:
    IntegrityLevel: System
    ParentImage: C:\Windows\CCM\Ccm32BitLauncher.exe
  filter_system_temp:
    ParentImage|startswith: C:\Windows\Temp\
  filter_user_temp:
    ParentImage|contains: \AppData\Local\Temp\
    ParentImage|startswith: C:\Users\
  selection_cli:
    CommandLine|contains:
    - /i
    - -i
    - /package
    - -package
    - /a
    - -a
    - /j
    - -j
  selection_img:
  - Image|endswith: \msiexec.exe
  - OriginalFileName: msiexec.exe
  selection_quiet:
    CommandLine|contains:
    - /q
    - -q
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - /i
    - -i
    - /package
    - -package
    - /a
    - -a
    - /j
    - -j
  selection_img:
  - Image|endswith: \msiexec.exe
  - OriginalFileName: msiexec.exe
  selection_quiet:
    CommandLine|contains:
    - /q
    - -q
  selection_remote:
    CommandLine|contains:
    - http
    - \\\\
- condition: selection and not filter
  filter:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  selection:
  - Image|endswith: \msiexec.exe
  - OriginalFileName: \msiexec.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' msiexec'
    - ://
- condition: selection
  selection:
    Image|endswith:
    - \arp.exe
    - \cmd.exe
    - \net.exe
    - \netstat.exe
    - \nslookup.exe
    - \route.exe
    - \schtasks.exe
    - \whoami.exe
    ParentCommandLine|endswith: msra.exe
    ParentImage|endswith: \msra.exe
- condition: selection_parent or (selection_image and not filter_image)
  filter_image:
    ParentImage|endswith: \sqlagent.exe
  selection_image:
  - Image|endswith: \sqlps.exe
  - OriginalFileName: sqlps.exe
  selection_parent:
    ParentImage|endswith: \sqlps.exe
- condition: selection and not filter
  filter:
    ParentImage|endswith: \smss.exe
  selection:
  - Image|endswith: \sqltoolsps.exe
  - ParentImage|endswith: \sqltoolsps.exe
  - OriginalFileName: \sqltoolsps.exe
- condition: selection and not 1 of filter_optional_*
  filter_optional_datev:
    CommandLine|startswith: '"C:\Windows\system32\cmd.exe" '
    Image: C:\Windows\System32\cmd.exe
    ParentImage|endswith: DATEV_DBENGINE\MSSQL\Binn\sqlservr.exe
    ParentImage|startswith: C:\Program Files\Microsoft SQL Server\
  selection:
    Image|endswith:
    - \bash.exe
    - \bitsadmin.exe
    - \cmd.exe
    - \netstat.exe
    - \nltest.exe
    - \ping.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \sh.exe
    - \systeminfo.exe
    - \tasklist.exe
    - \wsl.exe
    ParentImage|endswith: \sqlservr.exe
- condition: selection_parent and 1 of selection_child_*
  selection_child_1:
    CommandLine|contains:
    - '-ex '
    - bypass
    - cscript
    - DownloadString
    - http://
    - https://
    - mshta
    - regsvr32
    - rundll32
    - wscript
    - 'copy '
    Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \wsl.exe
    - \wt.exe
  selection_child_2:
    Image|endswith:
    - \net.exe
    - \net1.exe
    - \netstat.exe
    - \nltest.exe
    - \ping.exe
    - \tasklist.exe
    - \whoami.exe
  selection_parent:
    ParentCommandLine|contains: VEEAMSQL
    ParentImage|endswith: \sqlservr.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - noconsentprompt
    - 'shadow:'
- condition: all of selection_* and not 1 of filter_optional_*
  filter_optional_wsl:
    CommandLine|contains: C:\ProgramData\Microsoft\WSL\wslg.rdp
    ParentImage: C:\Windows\System32\lxss\wslhost.exe
  selection_cli:
    CommandLine|contains: ' /v:'
  selection_img:
  - Image|endswith: \mstsc.exe
  - OriginalFileName: mstsc.exe
- condition: all of selection_* and not 1 of filter_optional_*
  filter_optional_wsl:
    CommandLine|contains: C:\ProgramData\Microsoft\WSL\wslg.rdp
    ParentImage: C:\Windows\System32\lxss\wslhost.exe
  selection_cli:
    CommandLine|endswith:
    - .rdp
    - .rdp"
  selection_img:
  - Image|endswith: \mstsc.exe
  - OriginalFileName: mstsc.exe
- condition: all of selection_*
  selection_extension:
    CommandLine|endswith:
    - .rdp
    - .rdp"
  selection_img:
  - Image|endswith: \mstsc.exe
  - OriginalFileName: mstsc.exe
  selection_paths:
    CommandLine|contains:
    - :\Users\Public\
    - :\Windows\System32\spool\drivers\color
    - ':\Windows\System32\Tasks_Migrated '
    - :\Windows\Tasks\
    - :\Windows\Temp\
    - :\Windows\Tracing\
    - \AppData\Local\Temp\
    - \Downloads\
- condition: all of selection_*
  selection_img:
  - Image|endswith: \mstsc.exe
  - OriginalFileName: mstsc.exe
  selection_parent:
    ParentImage|endswith:
    - \brave.exe
    - \CCleanerBrowser.exe
    - \chrome.exe
    - \chromium.exe
    - \firefox.exe
    - \iexplore.exe
    - \microsoftedge.exe
    - \msedge.exe
    - \opera.exe
    - \vivaldi.exe
    - \whale.exe
    - \outlook.exe
- condition: all of selection_* and not 1 of filter_*
  filter_dropbox:
    CommandLine|contains:
    - \netsh.exe advfirewall firewall add rule name=Dropbox dir=in action=allow "program=C:\Program
      Files (x86)\Dropbox\Client\Dropbox.exe" enable=yes profile=Any
    - \netsh.exe advfirewall firewall add rule name=Dropbox dir=in action=allow "program=C:\Program
      Files\Dropbox\Client\Dropbox.exe" enable=yes profile=Any
  filter_thor:
    CommandLine|contains: advfirewall firewall show rule name=all
    ParentImage|endswith: \thor64.exe
    ParentImage|startswith: C:\Windows\Temp\asgard2-agent\
  selection_cli:
    CommandLine|contains|all:
    - ' firewall '
    - ' add '
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: all of selection_*
  selection_cli:
  - CommandLine|contains|all:
    - firewall
    - add
    - allowedprogram
  - CommandLine|contains|all:
    - advfirewall
    - firewall
    - add
    - rule
    - action=allow
    - program=
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
  selection_paths:
    CommandLine|contains:
    - '%Public%\'
    - '%TEMP%'
    - '%TMP%'
    - :\$Recycle.bin\
    - :\RECYCLER\
    - :\SystemVolumeInformation\
    - :\Temp\
    - :\Users\Default\
    - :\Users\Desktop\
    - :\Users\Public\
    - :\Windows\addins\
    - :\Windows\cursors\
    - :\Windows\debug\
    - :\Windows\drivers\
    - :\Windows\fonts\
    - :\Windows\help\
    - :\Windows\system32\tasks\
    - :\Windows\Tasks\
    - :\Windows\Temp\
    - \Downloads\
    - \Local Settings\Temporary Internet Files\
    - \Temporary Internet Files\Content.Outlook\
- condition: all of selection_*
  selection_cli_1:
    CommandLine|contains|all:
    - 'firewall '
    - 'add '
    - 'tcp '
    - '3389'
  selection_cli_2:
  - CommandLine|contains: portopening
  - CommandLine|contains|all:
    - advfirewall
    - rule
    - allow
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: all of selection_* and not filter_dropbox
  filter_dropbox:
    CommandLine|contains: name=Dropbox
    ParentImage|endswith: \Dropbox.exe
  selection_cli:
    CommandLine|contains|all:
    - firewall
    - 'delete '
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: selection_img and 1 of selection_cli_*
  selection_cli_1:
    CommandLine|contains|all:
    - firewall
    - set
    - opmode
    - disable
  selection_cli_2:
    CommandLine|contains|all:
    - advfirewall
    - set
    - state
    - 'off'
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - advfirewall
    - firewall
    - set
    - rule
    - group=
    - new
    - enable=Yes
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - 'config '
    - 'state '
    - 'rule '
    - name=all
    CommandLine|contains|all:
    - 'netsh '
    - 'show '
    - 'firewall '
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - ' firewall '
    - ' set '
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - add
    - helper
    Image|endswith: \netsh.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - trace
    - start
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: selection_img and 1 of selection_cli_*
  selection_cli_1:
    CommandLine|contains|all:
    - interface
    - portproxy
    - add
    - v4tov4
  selection_cli_2:
    CommandLine|contains|all:
    - 'i '
    - 'p '
    - 'a '
    - 'v '
  selection_cli_3:
    CommandLine|contains|all:
    - connectp
    - listena
    - c=
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - ' i'
    - ' p'
    - =3389
    - ' c'
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - wlan
    - ' s'
    - ' p'
    - ' k'
    - =clear
  selection_img:
  - Image|endswith: \netsh.exe
  - OriginalFileName: netsh.exe
- condition: 1 of selection_*
  selection_tshark:
    CommandLine|contains: -i
    Image|endswith: \tshark.exe
  selection_windump:
    Image|endswith: \windump.exe
- condition: all of selection_* and not filter
  filter:
    CommandLine|contains|all:
    - guest
    - /active no
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
  selection_user_option:
    CommandLine|contains: ' user '
  selection_username:
    CommandLine|contains:
    - " J\xE4rjestelm\xE4nvalvoja "
    - ' Rendszergazda '
    - " \u0410\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\
      \ "
    - ' Administrateur '
    - ' Administrador '
    - " Administrat\xF6r "
    - ' Administrator '
    - ' guest '
    - ' DefaultAccount '
    - " \"J\xE4rjestelm\xE4nvalvoja\" "
    - ' "Rendszergazda" '
    - " \"\u0410\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\
      \u0440\" "
    - ' "Administrateur" '
    - ' "Administrador" '
    - " \"Administrat\xF6r\" "
    - ' "Administrator" '
    - ' "guest" '
    - ' "DefaultAccount" '
    - " 'J\xE4rjestelm\xE4nvalvoja' "
    - ' ''Rendszergazda'' '
    - " '\u0410\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\
      ' "
    - ' ''Administrateur'' '
    - ' ''Administrador'' '
    - " 'Administrat\xF6r' "
    - ' ''Administrator'' '
    - ' ''guest'' '
    - ' ''DefaultAccount'' '
- condition: selection_img and ((all of selection_group_* and not filter_group_add)
    or all of selection_accounts_*)
  filter_group_add:
    CommandLine|contains: ' /add'
  selection_accounts_flags:
    CommandLine|contains: ' /do'
  selection_accounts_root:
    CommandLine|contains: ' accounts '
  selection_group_flags:
    CommandLine|contains:
    - domain admins
    - ' administrator'
    - ' administrateur'
    - enterprise admins
    - Exchange Trusted Subsystem
    - Remote Desktop Users
    - "Utilisateurs du Bureau \xE0 distance"
    - Usuarios de escritorio remoto
    - ' /do'
  selection_group_root:
    CommandLine|contains:
    - ' group '
    - ' localgroup '
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_*
  selection_cli:
  - CommandLine|endswith:
    - ' use'
    - ' sessions'
  - CommandLine|contains:
    - ' use '
    - ' sessions '
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_* and not filter
  filter:
    CommandLine|contains: \\\\
  selection_cli:
    CommandLine|contains: view
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - share
    - /delete
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' start '
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' stop '
  selection_img:
  - OriginalFileName:
    - net.exe
    - net1.exe
  - Image|endswith:
    - \net.exe
    - \net1.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' group'
    - ' localgroup'
    - ' user'
    - ' view'
    - ' share'
    - ' accounts'
    - ' stop '
    - ' start'
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - user
    - add
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - user
    - add
    - expires:never
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - ' use '
    - ' \\\\*\\*$'
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - ' use '
    - ' http'
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' use '
    - ' \\\\'
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_* and not 1 of filter*
  filter_empty:
    CommandLine|endswith: ' '
  selection_cli:
    CommandLine|contains|all:
    - ' use '
    - :*\\
    - /USER:* *
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: selection
  selection:
  - Image|endswith: \nltest.exe
  - OriginalFileName: nltestrk.exe
- condition: selection_nltest and 1 of selection_recon*
  selection_nltest:
  - Image|endswith: \nltest.exe
  - OriginalFileName: nltestrk.exe
  selection_recon1:
    CommandLine|contains|all:
    - /server
    - /query
  selection_recon2:
    CommandLine|contains:
    - '/dclist:'
    - /parentdomain
    - /domain_trusts
    - /all_trusts
    - /trusted_domains
    - /user
- action_reverse_shell:
    CommandLine|contains|all:
    - .exec(
    - net.socket
    - .connect
    - child_process
  condition: selection and 1 of action_*
  selection:
    CommandLine|contains:
    - ' -e '
    - ' --eval '
    Image|endswith: \node.exe
- condition: selection and not filter
  filter:
    CommandLine|contains: Adobe Creative Cloud Experience\js
  selection:
    Image|endswith: \Adobe Creative Cloud Experience\libs\node.exe
- condition: 1 of selection*
  selection_nslookup:
    CommandLine|contains|all:
    - nslookup
    - _ldap._tcp.dc._msdcs.
- condition: all of selection_*
  selection_cmd:
    CommandLine|contains:
    - ' -q=txt '
    - ' -querytype=txt '
    ParentImage|endswith:
    - \powershell.exe
    - \pwsh.exe
  selection_img:
  - Image|contains: \nslookup.exe
  - OriginalFileName: \nslookup.exe
- condition: all of selection_*
  selection_cli:
  - CommandLine|contains|all:
    - snapshot
    - 'mount '
  - CommandLine|contains|all:
    - ac
    - ' i'
    - ' ntds'
  selection_img:
  - Image|endswith: \ntdsutil.exe
  - OriginalFileName: ntdsutil.exe
- condition: selection
  selection:
    Image|endswith: \ntdsutil.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - 'INSTALLDRIVER '
    - .dll
  selection_img:
  - Image|endswith: \odbcconf.exe
  - OriginalFileName: odbcconf.exe
- condition: all of selection_* and not 1 of filter_main_*
  filter_main_dll_ext:
    CommandLine|contains: .dll
  selection_cli:
    CommandLine|contains: 'INSTALLDRIVER '
  selection_img:
  - Image|endswith: \odbcconf.exe
  - OriginalFileName: odbcconf.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - :\PerfLogs\
    - :\ProgramData\
    - :\Temp\
    - :\Users\Public\
    - :\Windows\Registration\CRMLog
    - :\Windows\System32\com\dmp\
    - :\Windows\System32\FxsTmp\
    - :\Windows\System32\Microsoft\Crypto\RSA\MachineKeys\
    - :\Windows\System32\spool\drivers\color\
    - :\Windows\System32\spool\PRINTERS\
    - :\Windows\System32\spool\SERVERS\
    - :\Windows\System32\Tasks_Migrated\
    - :\Windows\System32\Tasks\Microsoft\Windows\SyncCenter\
    - :\Windows\SysWOW64\com\dmp\
    - :\Windows\SysWOW64\FxsTmp\
    - :\Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System\
    - :\Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter\
    - :\Windows\Tasks\
    - :\Windows\Temp\
    - :\Windows\Tracing\
    - \AppData\Local\Temp\
    - \AppData\Roaming\
  selection_img:
  - Image|endswith: \odbcconf.exe
  - OriginalFileName: odbcconf.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - 'REGSVR '
    - .dll
  selection_img:
  - Image|endswith: \odbcconf.exe
  - OriginalFileName: odbcconf.exe
- condition: all of selection_* and not 1 of filter_main_*
  filter_main_dll_ext:
    CommandLine|contains: .dll
  selection_cli:
    CommandLine|contains: 'REGSVR '
  selection_img:
  - Image|endswith: \odbcconf.exe
  - OriginalFileName: odbcconf.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' -f '
    - ' /f '
  selection_img:
  - Image|endswith: \odbcconf.exe
  - OriginalFileName: odbcconf.exe
  selection_rsp_ext:
    CommandLine|contains: .rsp
- condition: all of selection_* and not 1 of filter_main_*
  filter_main_rsp_ext:
    CommandLine|contains: .rsp
  filter_main_runonce_odbc:
    CommandLine|contains: .exe /E /F "C:\WINDOWS\system32\odbcconf.tmp"
    Image: C:\Windows\System32\odbcconf.exe
    ParentImage: C:\Windows\System32\runonce.exe
  selection_cli:
    CommandLine|contains:
    - ' -f '
    - ' /f '
  selection_img:
  - Image|endswith: \odbcconf.exe
  - OriginalFileName: odbcconf.exe
- condition: selection
  selection:
    ParentImage|endswith: \odbcconf.exe
- condition: all of selection_*
  selection_http:
    CommandLine|contains:
    - http://
    - https://
  selection_img:
  - Image|endswith:
    - \EXCEL.EXE
    - \POWERPNT.EXE
    - \WINWORD.exe
  - OriginalFileName:
    - Excel.exe
    - POWERPNT.EXE
    - WinWord.exe
- condition: all of selection_* and not 1 of filter_main_*
  filter_main_dotx:
    CommandLine|endswith:
    - .dotx
    - .xltx
    - .potx
  selection_img:
  - Image|endswith:
    - \EXCEL.EXE
    - \POWERPNT.EXE
    - \WINWORD.exe
  - OriginalFileName:
    - Excel.exe
    - POWERPNT.EXE
    - WinWord.exe
  selection_parent:
    ParentImage|endswith:
    - \explorer.exe
    - \dopus.exe
  selection_trusted_location:
    CommandLine|contains:
    - \AppData\Roaming\Microsoft\Templates
    - \AppData\Roaming\Microsoft\Word\Startup\
    - \Microsoft Office (x86)\root\Templates\
    - \Microsoft Office (x86)\Templates\
    - \Microsoft Office\root\Templates\
    - \Microsoft Office\Templates\
- condition: selection_parent and 1 of selection_opt_* and not 1 of filter_*
  filter_onedrive:
    CommandLine|endswith: -Embedding
    Image|contains: \AppData\Local\Microsoft\OneDrive\
    Image|endswith: \FileCoAuth.exe
  filter_teams:
    CommandLine|endswith: -Embedding
    Image|endswith: \AppData\Local\Microsoft\Teams\current\Teams.exe
  selection_opt_explorer:
    CommandLine|contains:
    - .hta
    - .vb
    - .wsh
    - .js
    - .ps
    - .scr
    - .pif
    - .bat
    - .cmd
    Image|endswith: \explorer.exe
  selection_opt_img:
  - OriginalFileName:
    - bitsadmin.exe
    - CertOC.exe
    - CertUtil.exe
    - Cmd.Exe
    - CMSTP.EXE
    - cscript.exe
    - curl.exe
    - HH.exe
    - IEExec.exe
    - InstallUtil.exe
    - javaw.exe
    - Microsoft.Workflow.Compiler.exe
    - msdt.exe
    - MSHTA.EXE
    - msiexec.exe
    - Msxsl.exe
    - odbcconf.exe
    - pcalua.exe
    - PowerShell.EXE
    - RegAsm.exe
    - RegSvcs.exe
    - REGSVR32.exe
    - RUNDLL32.exe
    - schtasks.exe
    - ScriptRunner.exe
    - wmic.exe
    - WorkFolders.exe
    - wscript.exe
  - Image|endswith:
    - \AppVLP.exe
    - \bash.exe
    - \bitsadmin.exe
    - \certoc.exe
    - \certutil.exe
    - \cmd.exe
    - \cmstp.exe
    - \control.exe
    - \cscript.exe
    - \curl.exe
    - \forfiles.exe
    - \hh.exe
    - \ieexec.exe
    - \installutil.exe
    - \javaw.exe
    - \mftrace.exe
    - \Microsoft.Workflow.Compiler.exe
    - \msbuild.exe
    - \msdt.exe
    - \mshta.exe
    - \msidb.exe
    - \msiexec.exe
    - \msxsl.exe
    - \odbcconf.exe
    - \pcalua.exe
    - \powershell.exe
    - \pwsh.exe
    - \regasm.exe
    - \regsvcs.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \schtasks.exe
    - \scrcons.exe
    - \scriptrunner.exe
    - \sh.exe
    - \svchost.exe
    - \verclsid.exe
    - \wmic.exe
    - \workfolders.exe
    - \wscript.exe
  selection_opt_paths:
    Image|contains:
    - \AppData\
    - \Users\Public\
    - \ProgramData\
    - \Windows\Tasks\
    - \Windows\Temp\
    - \Windows\System32\Tasks\
  selection_parent:
    ParentImage|endswith: \onenote.exe
- condition: selection
  selection:
    CommandLine|contains: \Outlook\Security\EnableUnsafeClientMailRules
- condition: selection
  selection:
    Image|contains: \Temporary Internet Files\Content.Outlook\
- condition: selection
  selection:
    Image|endswith:
    - \AppVLP.exe
    - \bash.exe
    - \cmd.exe
    - \cscript.exe
    - \forfiles.exe
    - \hh.exe
    - \mftrace.exe
    - \msbuild.exe
    - \msdt.exe
    - \mshta.exe
    - \msiexec.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \schtasks.exe
    - \scrcons.exe
    - \scriptrunner.exe
    - \sh.exe
    - \svchost.exe
    - \wmic.exe
    - \wscript.exe
    ParentImage|endswith: \OUTLOOK.EXE
- condition: selection
  selection:
    Image|startswith: \\\\
    ParentImage|endswith: \outlook.exe
- condition: selection and not filter
  filter:
    Image|endswith: \Teams.exe
  selection:
    Image|endswith: .exe
    Image|startswith: C:\users\
    ParentImage|endswith:
    - \WINWORD.EXE
    - \EXCEL.EXE
    - \POWERPNT.exe
    - \MSPUB.exe
    - \VISIO.exe
    - \MSACCESS.exe
    - \EQNEDT32.exe
- condition: selection_parent and 1 of selection_child_*
  selection_child_processes:
  - OriginalFileName:
    - bitsadmin.exe
    - CertOC.exe
    - CertUtil.exe
    - Cmd.Exe
    - CMSTP.EXE
    - cscript.exe
    - curl.exe
    - HH.exe
    - IEExec.exe
    - InstallUtil.exe
    - javaw.exe
    - Microsoft.Workflow.Compiler.exe
    - msdt.exe
    - MSHTA.EXE
    - msiexec.exe
    - Msxsl.exe
    - odbcconf.exe
    - pcalua.exe
    - PowerShell.EXE
    - RegAsm.exe
    - RegSvcs.exe
    - REGSVR32.exe
    - RUNDLL32.exe
    - schtasks.exe
    - ScriptRunner.exe
    - wmic.exe
    - WorkFolders.exe
    - wscript.exe
  - Image|endswith:
    - \AppVLP.exe
    - \bash.exe
    - \bitsadmin.exe
    - \certoc.exe
    - \certutil.exe
    - \cmd.exe
    - \cmstp.exe
    - \control.exe
    - \cscript.exe
    - \curl.exe
    - \forfiles.exe
    - \hh.exe
    - \ieexec.exe
    - \installutil.exe
    - \javaw.exe
    - \mftrace.exe
    - \Microsoft.Workflow.Compiler.exe
    - \msbuild.exe
    - \msdt.exe
    - \mshta.exe
    - \msidb.exe
    - \msiexec.exe
    - \msxsl.exe
    - \odbcconf.exe
    - \pcalua.exe
    - \powershell.exe
    - \pwsh.exe
    - \regasm.exe
    - \regsvcs.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \schtasks.exe
    - \scrcons.exe
    - \scriptrunner.exe
    - \sh.exe
    - \svchost.exe
    - \verclsid.exe
    - \wmic.exe
    - \workfolders.exe
    - \wscript.exe
  selection_child_susp_paths:
    Image|contains:
    - \AppData\
    - \Users\Public\
    - \ProgramData\
    - \Windows\Tasks\
    - \Windows\Temp\
    - \Windows\System32\Tasks\
  selection_parent:
    ParentImage|endswith:
    - \EQNEDT32.EXE
    - \EXCEL.EXE
    - \MSACCESS.EXE
    - \MSPUB.exe
    - \ONENOTE.EXE
    - \POWERPNT.exe
    - \VISIO.exe
    - \WINWORD.EXE
    - \wordpad.exe
    - \wordview.exe
- condition: all of selection*
  selection:
    Image|endswith:
    - \winword.exe
    - \excel.exe
    - \powerpnt.exe
    - \msaccess.exe
    - \mspub.exe
    - \eqnedt32.exe
    - \visio.exe
    ParentImage|endswith: \svchost.exe
- condition: all of selection_*
  selection_dll:
    CommandLine|contains|all:
    - '/l '
    - .dll
  selection_img:
  - Image|endswith: \WINWORD.exe
  - OriginalFileName: WinWord.exe
- condition: selection
  selection:
  - Description: PDQ Deploy Console
  - Product: PDQ Deploy
  - Company: PDQ.com
  - OriginalFileName: PDQDeployConsole.exe
- condition: all of selection_*
  selection_parent:
    ParentImage|contains: PDQDeployRunner-
  selection_susp:
  - Image|endswith:
    - \wscript.exe
    - \cscript.exe
    - \rundll32.exe
    - \regsvr32.exe
    - \wmic.exe
    - \msiexec.exe
    - \mshta.exe
    - \csc.exe
    - \dllhost.exe
    - \certutil.exe
    - \scriptrunner.exe
    - \bash.exe
    - \wsl.exe
  - Image|contains:
    - C:\Users\Public\
    - C:\ProgramData\
    - C:\Windows\TEMP\
    - \AppData\Local\Temp
  - CommandLine|contains:
    - 'iex '
    - Invoke-
    - DownloadString
    - http
    - ' -enc '
    - ' -encodedcommand '
    - FromBase64String
    - ' -decode '
    - ' -w hidden'
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' -e'
  selection_img:
  - Image|endswith: \perl.exe
  - OriginalFileName: perl.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' -r'
  selection_img:
  - Image|endswith: \php.exe
  - OriginalFileName: php.exe
- condition: selection
  selection:
    CommandLine|contains: 0x
    Image|endswith: \ping.exe
- condition: selection
  selection:
  - Image|endswith: \pktmon.exe
  - OriginalFileName: PktMon.exe
- condition: selection
  selection:
    CommandLine|contains: ' -R '
    Description: Command-line SSH, Telnet, and Rlogin client
- condition: selection_a or all of selection_b*
  selection_a:
    CommandLine|contains: :127.0.0.1:3389
    Image|endswith: \plink.exe
  selection_b1:
    CommandLine|contains: :3389
    Image|endswith: \plink.exe
  selection_b2:
    CommandLine|contains:
    - ' -P 443'
    - ' -P 22'
- condition: all of selection_*
  selection_power:
  - Image|endswith: \powercfg.exe
  - OriginalFileName: PowerCfg.exe
  selection_standby:
  - CommandLine|contains|all:
    - '/setacvalueindex '
    - SCHEME_CURRENT
    - SUB_VIDEO
    - VIDEOCONLOCK
  - CommandLine|contains|all:
    - '-change '
    - -standby-timeout-
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - Add-AADInt
    - ConvertTo-AADInt
    - Disable-AADInt
    - Enable-AADInt
    - Export-AADInt
    - Get-AADInt
    - Grant-AADInt
    - Install-AADInt
    - Invoke-AADInt
    - Join-AADInt
    - New-AADInt
    - Open-AADInt
    - Read-AADInt
    - Register-AADInt
    - Remove-AADInt
    - Restore-AADInt
    - Search-AADInt
    - Send-AADInt
    - Set-AADInt
    - Start-AADInt
    - Update-AADInt
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.Exe
    - pwsh.dll
- condition: all of selection_*
  selection_cmdlet:
    CommandLine|contains:
    - 'Import-Module '
    - 'ipmo '
  selection_dll:
    CommandLine|contains: Microsoft.ActiveDirectory.Management.dll
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: all of selection_*
  selection_capa:
    CommandLine|contains: OpenSSH.
  selection_cmdlet:
    CommandLine|contains: Add-WindowsCapability
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains:
    - System.Management.Automation.AmsiUtils
    - amsiInitFailed
  selection_2:
    CommandLine|contains|all:
    - '[Ref].Assembly.GetType'
    - SetValue($null,$true)
    - NonPublic,Static
- condition: selection
  selection:
    CommandLine|contains:
    - if(0){{{0}}}' -f $(0 -as [char]) +
    - '#<NULL>'
- condition: selection
  selection:
    CommandLine|contains:
    - WindowsAudioDevice-Powershell-Cmdlet
    - Toggle-AudioDevice
    - 'Get-AudioDevice '
    - 'Set-AudioDevice '
    - 'Write-AudioDevice '
- condition: selection_img and (all of selection_cli_* or selection_standalone) and
    not 1 of filter_optional_*
  filter_optional_remote_signed:
    CommandLine|contains: ' -ExecutionPolicy remotesigned '
  selection_cli_content:
    CommandLine|contains:
    - ' JAB'
    - ' SUVYI'
    - ' SQBFAFgA'
    - ' aQBlAHgA'
    - ' aWV4I'
    - ' IAA'
    - ' IAB'
    - ' UwB'
    - ' cwB'
  selection_cli_enc:
    CommandLine|contains: ' -e'
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_standalone:
    CommandLine|contains:
    - '.exe -ENCOD '
    - ' BA^J e-'
- condition: selection
  selection:
  - CommandLine|base64offset|contains: ::FromBase64String
  - CommandLine|contains:
    - OgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcA
    - oAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnA
    - 6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZw
- condition: selection
  selection:
  - CommandLine|base64offset|contains:
    - IEX ([
    - iex ([
    - iex (New
    - IEX (New
    - IEX([
    - iex([
    - iex(New
    - IEX(New
    - IEX(('
    - iex(('
  - CommandLine|contains:
    - SQBFAFgAIAAoAFsA
    - kARQBYACAAKABbA
    - JAEUAWAAgACgAWw
    - aQBlAHgAIAAoAFsA
    - kAZQB4ACAAKABbA
    - pAGUAeAAgACgAWw
    - aQBlAHgAIAAoAE4AZQB3A
    - kAZQB4ACAAKABOAGUAdw
    - pAGUAeAAgACgATgBlAHcA
    - SQBFAFgAIAAoAE4AZQB3A
    - kARQBYACAAKABOAGUAdw
    - JAEUAWAAgACgATgBlAHcA
- condition: all of selection_*
  selection_cli_enc:
    CommandLine|contains: ' -e'
  selection_cli_invoke:
    CommandLine|contains:
    - SQBuAHYAbwBrAGUALQ
    - kAbgB2AG8AawBlAC0A
    - JAG4AdgBvAGsAZQAtA
    - SW52b2tlL
    - ludm9rZS
    - JbnZva2Ut
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: selection
  selection:
  - CommandLine|base64offset|contains:
    - 'Add-MpPreference '
    - 'Set-MpPreference '
    - 'add-mppreference '
    - 'set-mppreference '
  - CommandLine|contains:
    - QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA
    - EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA
    - BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA
    - UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA
    - MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA
    - TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA
    - YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA
    - EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA
    - hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA
    - cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA
    - MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA
    - zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA
- condition: selection
  selection:
    CommandLine|contains:
    - WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA
    - sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA
    - bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA
    - AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiAC
    - BbAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgAp
    - AWwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAK
    - WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAKQ
    - sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiACkA
    - bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgApA
    - WwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA
    - sAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA
    - bAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA
- condition: selection
  selection:
    CommandLine|contains:
    - OgA6ACgAIgBMACIAKwAiAG8AYQBkACIAKQ
    - oAOgAoACIATAAiACsAIgBvAGEAZAAiACkA
    - 6ADoAKAAiAEwAIgArACIAbwBhAGQAIgApA
    - OgA6ACgAIgBMAG8AIgArACIAYQBkACIAKQ
    - oAOgAoACIATABvACIAKwAiAGEAZAAiACkA
    - 6ADoAKAAiAEwAbwAiACsAIgBhAGQAIgApA
    - OgA6ACgAIgBMAG8AYQAiACsAIgBkACIAKQ
    - oAOgAoACIATABvAGEAIgArACIAZAAiACkA
    - 6ADoAKAAiAEwAbwBhACIAKwAiAGQAIgApA
    - OgA6ACgAJwBMACcAKwAnAG8AYQBkACcAKQ
    - oAOgAoACcATAAnACsAJwBvAGEAZAAnACkA
    - 6ADoAKAAnAEwAJwArACcAbwBhAGQAJwApA
    - OgA6ACgAJwBMAG8AJwArACcAYQBkACcAKQ
    - oAOgAoACcATABvACcAKwAnAGEAZAAnACkA
    - 6ADoAKAAnAEwAbwAnACsAJwBhAGQAJwApA
    - OgA6ACgAJwBMAG8AYQAnACsAJwBkACcAKQ
    - oAOgAoACcATABvAGEAJwArACcAZAAnACkA
    - 6ADoAKAAnAEwAbwBhACcAKwAnAGQAJwApA
- condition: selection_img and 1 of selection_cli_*
  selection_cli_loggedonuser:
    CommandLine|contains:
    - VwBpAG4AMwAyAF8ATABvAGcAZwBlAGQATwBuAFUAcwBlAHIA
    - cAaQBuADMAMgBfAEwAbwBnAGcAZQBkAE8AbgBVAHMAZQByA
    - XAGkAbgAzADIAXwBMAG8AZwBnAGUAZABPAG4AVQBzAGUAcg
    - V2luMzJfTG9nZ2VkT25Vc2Vy
    - dpbjMyX0xvZ2dlZE9uVXNlc
    - XaW4zMl9Mb2dnZWRPblVzZX
  selection_cli_process:
    CommandLine|contains:
    - VwBpAG4AMwAyAF8AUAByAG8AYwBlAHMAcw
    - cAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMA
    - XAGkAbgAzADIAXwBQAHIAbwBjAGUAcwBzA
    - V2luMzJfUHJvY2Vzc
    - dpbjMyX1Byb2Nlc3
    - XaW4zMl9Qcm9jZXNz
  selection_cli_scheduledJob:
    CommandLine|contains:
    - VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQASgBvAGIA
    - cAaQBuADMAMgBfAFMAYwBoAGUAZAB1AGwAZQBkAEoAbwBiA
    - XAGkAbgAzADIAXwBTAGMAaABlAGQAdQBsAGUAZABKAG8AYg
    - V2luMzJfU2NoZWR1bGVkSm9i
    - dpbjMyX1NjaGVkdWxlZEpvY
    - XaW4zMl9TY2hlZHVsZWRKb2
  selection_cli_shadowcopy:
    CommandLine|contains:
    - VwBpAG4AMwAyAF8AUwBoAGEAZABvAHcAYwBvAHAAeQ
    - cAaQBuADMAMgBfAFMAaABhAGQAbwB3AGMAbwBwAHkA
    - XAGkAbgAzADIAXwBTAGgAYQBkAG8AdwBjAG8AcAB5A
    - V2luMzJfU2hhZG93Y29we
    - dpbjMyX1NoYWRvd2NvcH
    - XaW4zMl9TaGFkb3djb3B5
  selection_cli_useraccount:
    CommandLine|contains:
    - VwBpAG4AMwAyAF8AVQBzAGUAcgBBAGMAYwBvAHUAbgB0A
    - cAaQBuADMAMgBfAFUAcwBlAHIAQQBjAGMAbwB1AG4AdA
    - XAGkAbgAzADIAXwBVAHMAZQByAEEAYwBjAG8AdQBuAHQA
    - V2luMzJfVXNlckFjY291bn
    - dpbjMyX1VzZXJBY2NvdW50
    - XaW4zMl9Vc2VyQWNjb3Vud
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ConvertTo-SecureString
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: all of selection_* and not 1 of filter_main_*
  filter_main_encoded_keyword:
    CommandLine|contains:
    - ' -EncodedCommand '
    - ' -enc '
  selection_cli:
    CommandLine|contains:
    - hctac
    - kaerb
    - dnammoc
    - ekovn
    - eliFd
    - rahc
    - etirw
    - golon
    - tninon
    - eddih
    - tpircS
    - ssecorp
    - llehsrewop
    - esnopser
    - daolnwod
    - tneilCbeW
    - tneilc
    - ptth
    - elifotevas
    - 46esab
    - htaPpmeTteG
    - tcejbO
    - maerts
    - hcaerof
    - retupmoc
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: all of selection_* and not 1 of filter_optional_*
  filter_optional_amazonSSM:
    ParentImage: C:\Program Files\Amazon\SSM\ssm-files-worker.exe
  filter_optional_defender_atp:
    CommandLine|contains:
    - new EventSource("Microsoft.Windows.Sense.Client.Management"
    - public static extern bool InstallELAMCertificateInfo(SafeFileHandle handle);
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_re:
  - CommandLine|re: .*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*\+.*
  - CommandLine|re: .*\{.*\{.*\{.*\{.*\{.*\{.*\{.*\{.*\{.*\{.*
  - CommandLine|re: .*\^.*\^.*\^.*\^.*\^.*
  - CommandLine|re: .*`.*`.*`.*`.*`.*
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' > '
    - ' | Select '
    - Out-File
    - Set-Content
    - Add-Content
    CommandLine|contains|all:
    - 'Get-ADComputer '
    - ' -Filter \*'
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: selection
  selection:
    CommandLine|contains|all:
    - New-Service
    - -BinaryPathName
- condition: selection
  selection:
    CommandLine|contains|all:
    - GZipStream
    - ::Decompress
- condition: all of selection_*
  selection_cli_dir:
    CommandLine|contains:
    - 'Get-ChildItem '
    - 'dir '
    - 'gci '
    - 'ls '
  selection_cli_gc:
    CommandLine|contains:
    - 'Get-Content '
    - 'gc '
    - 'cat '
    - 'type '
  selection_cli_specific:
    CommandLine|contains|all:
    - ' ^| '
    - \*.lnk
    - -Recurse
    - '-Skip '
  selection_img:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: all of selection* or encoded_command
  encoded_command:
    CommandLine|base64offset|contains:
    - 'DisableRealtimeMonitoring '
    - 'DisableIOAVProtection '
    - 'DisableBehaviorMonitoring '
    - 'DisableBlockAtFirstSeen '
    - 'disablerealtimemonitoring '
    - 'disableioavprotection '
    - 'disablebehaviormonitoring '
    - 'disableblockatfirstseen '
    CommandLine|contains:
    - RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA
    - QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA
    - EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA
    - RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA
    - QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA
    - EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA
    - RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA
    - QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA
    - EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA
    - RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA
    - QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA
    - EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA
    - ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA
    - QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA
    - kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA
    - ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA
    - QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA
    - kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA
    - ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA
    - QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA
    - kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA
    - ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA
    - QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA
    - kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA
  selection1:
    CommandLine|contains:
    - 'Add-MpPreference '
    - 'Set-MpPreference '
  selection2:
    CommandLine|contains:
    - 'DisableRealtimeMonitoring '
    - 'DisableIOAVProtection '
    - 'DisableBehaviorMonitoring '
    - 'DisableBlockAtFirstSeen '
  selection3:
    CommandLine|contains:
    - $true
    - ' 1 '
- condition: all of selection*
  selection1:
    CommandLine|contains:
    - 'Add-MpPreference '
    - 'Set-MpPreference '
  selection2:
    CommandLine|contains:
    - ' -ExclusionPath '
    - ' -ExclusionExtension '
    - ' -ExclusionProcess '
    - ' -ExclusionIpAddress '
- condition: all of selection_pwsh_* or (selection_sc_binary and 1 of selection_sc_tamper_*)
  selection_pwsh_binary:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_pwsh_cli:
    CommandLine|contains:
    - -DisableBehaviorMonitoring $true
    - -DisableRuntimeMonitoring $true
  selection_sc_binary:
  - Image|endswith: \sc.exe
  - OriginalFileName: sc.exe
  selection_sc_tamper_cmd_delete:
    CommandLine|contains|all:
    - delete
    - WinDefend
  selection_sc_tamper_cmd_disabled:
    CommandLine|contains|all:
    - config
    - WinDefend
    - start=disabled
  selection_sc_tamper_cmd_stop:
    CommandLine|contains|all:
    - stop
    - WinDefend
- condition: all of selection_*
  selection_args:
    CommandLine|contains|all:
    - 'Set-NetFirewallProfile '
    - ' -Enabled '
    - ' False'
  selection_name:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \powershell_ise.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_opt:
    CommandLine|contains:
    - ' -All '
    - Public
    - Domain
    - Private
- condition: 1 of selection*
  selection1:
    CommandLine|contains|all:
    - ' -name IEHarden '
    - ' -value 0 '
  selection2:
    CommandLine|contains|all:
    - ' -name DEPOff '
    - ' -value 1 '
  selection3:
    CommandLine|contains|all:
    - ' -name DisableFirstRunCustomize '
    - ' -value 2 '
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - Default.GetString
    - FromBase64String
    - Invoke-Expression
    - 'IEX '
    - Invoke-Command
    - 'ICM '
    - DownloadString
  selection_img:
  - Image|endswith:
    - \rundll32.exe
    - \regsvcs.exe
    - \InstallUtil.exe
    - \regasm.exe
  - OriginalFileName:
    - RUNDLL32.EXE
    - RegSvcs.exe
    - InstallUtil.exe
    - RegAsm.exe
- condition: selection
  selection:
    CommandLine|contains:
    - ' -version 2 '
    - ' -versio 2 '
    - ' -versi 2 '
    - ' -vers 2 '
    - ' -ver 2 '
    - ' -ve 2 '
    - ' -v 2 '
    Image|endswith: \powershell.exe
- condition: all of selection_*
  selection_1:
    CommandLine|contains: '[Type]::GetTypeFromCLSID('
  selection_2:
    CommandLine|contains:
    - 0002DF01-0000-0000-C000-000000000046
    - F6D90F16-9C73-11D3-B32E-00C04F990BB4
    - F5078F35-C551-11D3-89B9-0000F81FE221
    - 88d96a0a-f192-11d4-a65f-0040963251e5
    - AFBA6B42-5692-48EA-8141-DC517DCF0EF1
    - AFB40FFD-B609-40A3-9828-F88BBE11E4E3
    - 88d96a0b-f192-11d4-a65f-0040963251e5
    - 2087c2f4-2cef-4953-a8ab-66779b670495
    - 000209FF-0000-0000-C000-000000000046
    - 00024500-0000-0000-C000-000000000046
- condition: selection
  selection:
    CommandLine|contains:
    - .DownloadString(
    - .DownloadFile(
    - 'Invoke-WebRequest '
    - 'iwr '
- condition: selection
  selection:
    CommandLine|contains:
    - 'Invoke-WebRequest '
    - 'IWR '
    CommandLine|contains|all:
    - http
    - OutFile
    - .dll
- condition: all of selection_*
  selection_download:
    CommandLine|contains:
    - .DownloadString(
    - .DownloadFile(
    - 'Invoke-WebRequest '
    - 'iwr '
  selection_iex:
    CommandLine|contains:
    - ;iex $
    - '| IEX'
    - '|IEX '
    - I`E`X
    - I`EX
    - IE`X
    - 'iex '
    - IEX (
    - IEX(
    - Invoke-Expression
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - string(
    - file(
    CommandLine|contains|all:
    - new-object
    - net.webclient).
    - download
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: selection
  selection:
    CommandLine|contains|all:
    - Add-PSSnapin
    - Get-Recipient
    - -ExpandProperty
    - EmailAddresses
    - SmtpAddress
    - -hidetableheaders
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: all of selection_*
  selection_cmd:
    CommandLine|contains|all:
    - Enable-WindowsOptionalFeature
    - -Online
    - -FeatureName
  selection_feature:
    CommandLine|contains:
    - TelnetServer
    - Internet-Explorer-Optional-amd64
    - TFTP
    - SMB1Protocol
    - Client-ProjFS
    - Microsoft-Windows-Subsystem-Linux
- condition: selection and not 1 of filter_*
  filter_azure:
    ParentImage|contains:
    - C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\
    - \gc_worker.exe
  filter_encoding:
    CommandLine|contains: ' -Encoding '
  selection:
    CommandLine|contains:
    - ' -e '
    - ' -en '
    - ' -enc '
    - ' -enco'
    - ' -ec '
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: all of selection_* and not 1 of filter_*
  filter_gcworker:
    ParentImage|contains:
    - C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\
    - \gc_worker.exe
  selection_encoded:
    CommandLine|contains:
    - ' JAB'
    - ' SUVYI'
    - ' SQBFAFgA'
    - ' aWV4I'
    - ' IAB'
    - ' PAA'
    - ' aQBlAHgA'
  selection_flags:
    CommandLine|contains:
    - ' -e '
    - ' -en '
    - ' -enc '
    - ' -enco'
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.Exe
    - pwsh.dll
- condition: selection
  selection:
    CommandLine|contains:
    - IAAtAGIAeABvAHIAIAAwAHgA
    - AALQBiAHgAbwByACAAMAB4A
    - gAC0AYgB4AG8AcgAgADAAeA
    - AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg
    - AuAEkAbgB2AG8AawBlACgAKQAgAHwAI
    - ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC
    - AHsAMQB9AHsAMAB9ACIAIAAtAGYAI
    - B7ADEAfQB7ADAAfQAiACAALQBmAC
    - AewAxAH0AewAwAH0AIgAgAC0AZgAg
    - AHsAMAB9AHsAMwB9ACIAIAAtAGYAI
    - B7ADAAfQB7ADMAfQAiACAALQBmAC
    - AewAwAH0AewAzAH0AIgAgAC0AZgAg
    - AHsAMgB9AHsAMAB9ACIAIAAtAGYAI
    - B7ADIAfQB7ADAAfQAiACAALQBmAC
    - AewAyAH0AewAwAH0AIgAgAC0AZgAg
    - AHsAMQB9AHsAMAB9ACcAIAAtAGYAI
    - B7ADEAfQB7ADAAfQAnACAALQBmAC
    - AewAxAH0AewAwAH0AJwAgAC0AZgAg
    - AHsAMAB9AHsAMwB9ACcAIAAtAGYAI
    - B7ADAAfQB7ADMAfQAnACAALQBmAC
    - AewAwAH0AewAzAH0AJwAgAC0AZgAg
    - AHsAMgB9AHsAMAB9ACcAIAAtAGYAI
    - B7ADIAfQB7ADAAfQAnACAALQBmAC
    - AewAyAH0AewAwAH0AJwAgAC0AZgAg
- condition: selection_img and (all of selection_to_* or 1 of selection_gen_*)
  selection_gen_1:
    CommandLine|contains|all:
    - char
    - join
  selection_gen_2:
    CommandLine|contains|all:
    - split
    - join
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_to_1:
    CommandLine|contains:
    - ToInt
    - ToDecimal
    - ToByte
    - ToUint
    - ToSingle
    - ToSByte
  selection_to_2:
    CommandLine|contains:
    - ToChar
    - ToString
    - String
- condition: all of selection_*
  selection_exec:
    CommandLine|contains:
    - 'iex '
    - 'Invoke-Expression '
    - 'Invoke-Command '
    - 'icm '
  selection_raw:
    CommandLine|contains: ' -raw'
  selection_read:
    CommandLine|contains:
    - 'cat '
    - 'get-content '
    - 'type '
- condition: selection
  selection:
    CommandLine|contains:
    - 'Export-PfxCertificate '
    - 'Export-Certificate '
- condition: selection
  selection:
    CommandLine|contains: ::FromBase64String(
- condition: selection
  selection:
    CommandLine|contains|all:
    - FromBase64String
    - MemoryStream
    - H4sI
- condition: selection
  selection:
    CommandLine|contains:
    - Get-Process lsas
    - ps lsas
    - gps lsas
- condition: selection
  selection:
    CommandLine|contains: Get-Clipboard
- condition: all of selection_*
  selection_cmdlet:
    CommandLine|contains: 'Get-LocalGroupMember '
  selection_group:
    CommandLine|contains:
    - domain admins
    - ' administrator'
    - ' administrateur'
    - enterprise admins
    - Exchange Trusted Subsystem
    - Remote Desktop Users
    - "Utilisateurs du Bureau \xE0 distance"
    - Usuarios de escritorio remoto
- condition: all of selection_*
  selection_encoded:
    CommandLine|contains:
    - AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA
    - aXRzYWRtaW4gL3RyYW5zZmVy
    - IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA
    - JpdHNhZG1pbiAvdHJhbnNmZX
    - YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg
    - Yml0c2FkbWluIC90cmFuc2Zlc
    - AGMAaAB1AG4AawBfAHMAaQB6AGUA
    - JABjAGgAdQBuAGsAXwBzAGkAegBlA
    - JGNodW5rX3Npem
    - QAYwBoAHUAbgBrAF8AcwBpAHoAZQ
    - RjaHVua19zaXpl
    - Y2h1bmtfc2l6Z
    - AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A
    - kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg
    - lPLkNvbXByZXNzaW9u
    - SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA
    - SU8uQ29tcHJlc3Npb2
    - Ty5Db21wcmVzc2lvb
    - AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ
    - kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA
    - lPLk1lbW9yeVN0cmVhb
    - SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A
    - SU8uTWVtb3J5U3RyZWFt
    - Ty5NZW1vcnlTdHJlYW
    - 4ARwBlAHQAQwBoAHUAbgBrA
    - 5HZXRDaHVua
    - AEcAZQB0AEMAaAB1AG4Aaw
    - LgBHAGUAdABDAGgAdQBuAGsA
    - LkdldENodW5r
    - R2V0Q2h1bm
    - AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A
    - QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA
    - RIUkVBRF9JTkZPNj
    - SFJFQURfSU5GTzY0
    - VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA
    - VEhSRUFEX0lORk82N
    - AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA
    - cmVhdGVSZW1vdGVUaHJlYW
    - MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA
    - NyZWF0ZVJlbW90ZVRocmVhZ
    - Q3JlYXRlUmVtb3RlVGhyZWFk
    - QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA
    - 0AZQBtAG0AbwB2AGUA
    - 1lbW1vdm
    - AGUAbQBtAG8AdgBlA
    - bQBlAG0AbQBvAHYAZQ
    - bWVtbW92Z
    - ZW1tb3Zl
  selection_hidden:
    CommandLine|contains: ' hidden '
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: all of selection_*
  selection_cmdlet:
    CommandLine|contains:
    - '-SecurityDescriptorSddl '
    - '-sd '
  selection_img:
  - Image|endswith: \pwsh.exe
  - OriginalFileName: pwsh.dll
  selection_sddl:
    CommandLine|contains|all:
    - 'Set-Service '
    - DCLCWPDTSD
- condition: all of selection_combined* or selection_standalone
  selection_combined_1:
    CommandLine|contains:
    - ' | iex;'
    - ' | iex '
    - ' | iex}'
    - ' | IEX ;'
    - ' | IEX -Error'
    - ' | IEX (new'
    - ');IEX '
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  selection_combined_2:
    CommandLine|contains:
    - ::FromBase64String
    - '.GetString([System.Convert]::'
  selection_standalone:
    CommandLine|contains:
    - )|iex;$
    - );iex($
    - );iex $
    - ' | IEX | '
- condition: selection
  selection:
    CommandLine|contains:
    - \AppData\Local\Temp\
    - :\Windows\TEMP\
    - \Desktop\
    - \Downloads\
    - \Perflogs\
    - :\Users\Public\
    CommandLine|contains|all:
    - Import-Certificate
    - ' -FilePath '
    - Cert:\LocalMachine\Root
- condition: selection
  selection:
    CommandLine|contains:
    - Import-Module "$Env:Temp\
    - Import-Module '$Env:Temp\
    - Import-Module $Env:Temp\
    - Import-Module "$Env:Appdata\
    - Import-Module '$Env:Appdata\
    - Import-Module $Env:Appdata\
    - Import-Module C:\Users\Public\
    - ipmo "$Env:Temp\
    - ipmo '$Env:Temp\
    - ipmo $Env:Temp\
    - ipmo "$Env:Appdata\
    - ipmo '$Env:Appdata\
    - ipmo $Env:Appdata\
    - ipmo C:\Users\Public\
- condition: all of selection_*
  selection_cmdlet:
    CommandLine|contains:
    - 'Add-AppPackage '
    - 'Add-AppxPackage '
  selection_flag:
    CommandLine|contains: ' -AllowUnsigned'
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: 1 of selection_* and not 1 of filter_*
  filter_chocolatey:
    CommandLine|contains:
    - (New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1
    - Write-ChocolateyWarning
  selection_convert_b64:
    CommandLine|contains|all:
    - -nop
    - ' -w '
    - hidden
    - ' -c '
    - '[Convert]::FromBase64String'
  selection_enc:
    CommandLine|contains|all:
    - ' -w '
    - hidden
    - -ep
    - bypass
    - -Enc
  selection_iex:
    CommandLine|contains|all:
    - ' -w '
    - hidden
    - -noni
    - -nop
    - ' -c '
    - iex
    - New-Object
  selection_iex_webclient:
    CommandLine|contains|all:
    - iex
    - New-Object
    - Net.WebClient
    - .Download
  selection_reg:
    CommandLine|contains|all:
    - powershell
    - reg
    - add
    - \software\
  selection_webclient:
    CommandLine|contains|all:
    - bypass
    - -noprofile
    - -windowstyle
    - hidden
    - new-object
    - system.net.webclient
    - .download
- condition: all of selection_*
  selection_commands:
    CommandLine|contains:
    - 'curl '
    - Invoke-WebRequest
    - 'iwr '
    - 'wget '
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_ip:
    CommandLine|contains:
    - ://1
    - ://2
    - ://3
    - ://4
    - ://5
    - ://6
    - ://7
    - ://8
    - ://9
- condition: all of selection_*
  selection_commands:
    CommandLine|contains:
    - 'curl '
    - Invoke-WebRequest
    - 'iwr '
    - 'wget '
  selection_flags:
    CommandLine|contains:
    - ' -ur'
    - ' -o'
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_susp_locations:
    CommandLine|contains:
    - \AppData\
    - \Desktop\
    - \Temp\
    - \Users\Public\
    - '%AppData%'
    - '%Public%'
    - '%Temp%'
    - '%tmp%'
    - C:\Windows\
- condition: selection
  selection:
    CommandLine|contains|all:
    - New-MailboxExportRequest
    - ' -Mailbox '
    - ' -FilePath \\\\'
- condition: selection
  selection:
    CommandLine|contains:
    - Add-Exfiltration
    - Add-Persistence
    - Add-RegBackdoor
    - Add-RemoteRegBackdoor
    - Add-ScrnSaveBackdoor
    - Check-VM
    - ConvertTo-Rc4ByteStream
    - Decrypt-Hash
    - Disable-ADIDNSNode
    - Disable-MachineAccount
    - Do-Exfiltration
    - Enable-ADIDNSNode
    - Enable-MachineAccount
    - Enabled-DuplicateToken
    - Exploit-Jboss
    - Export-ADR
    - Export-ADRCSV
    - Export-ADRExcel
    - Export-ADRHTML
    - Export-ADRJSON
    - Export-ADRXML
    - Find-Fruit
    - Find-GPOLocation
    - Find-TrustedDocuments
    - Get-ADIDNS
    - Get-ApplicationHost
    - Get-ChromeDump
    - Get-ClipboardContents
    - Get-FoxDump
    - Get-GPPPassword
    - Get-IndexedItem
    - Get-KerberosAESKey
    - Get-Keystrokes
    - Get-LSASecret
    - Get-MachineAccountAttribute
    - Get-MachineAccountCreator
    - Get-PassHashes
    - Get-RegAlwaysInstallElevated
    - Get-RegAutoLogon
    - Get-RemoteBootKey
    - Get-RemoteCachedCredential
    - Get-RemoteLocalAccountHash
    - Get-RemoteLSAKey
    - Get-RemoteMachineAccountHash
    - Get-RemoteNLKMKey
    - Get-RickAstley
    - Get-Screenshot
    - Get-SecurityPackages
    - Get-ServiceFilePermission
    - Get-ServicePermission
    - Get-ServiceUnquoted
    - Get-SiteListPassword
    - Get-System
    - Get-TimedScreenshot
    - Get-UnattendedInstallFile
    - Get-Unconstrained
    - Get-USBKeystrokes
    - Get-VaultCredential
    - Get-VulnAutoRun
    - Get-VulnSchTask
    - Grant-ADIDNSPermission
    - Gupt-Backdoor
    - HTTP-Login
    - Install-ServiceBinary
    - Install-SSP
    - Invoke-ACLScanner
    - Invoke-ADRecon
    - Invoke-ADSBackdoor
    - Invoke-AgentSmith
    - Invoke-AllChecks
    - Invoke-ARPScan
    - Invoke-AzureHound
    - Invoke-BackdoorLNK
    - Invoke-BadPotato
    - Invoke-BetterSafetyKatz
    - Invoke-BypassUAC
    - Invoke-Carbuncle
    - Invoke-Certify
    - Invoke-ConPtyShell
    - Invoke-CredentialInjection
    - Invoke-DAFT
    - Invoke-DCSync
    - Invoke-DinvokeKatz
    - Invoke-DllInjection
    - Invoke-DNSUpdate
    - Invoke-DomainPasswordSpray
    - Invoke-DowngradeAccount
    - Invoke-EgressCheck
    - Invoke-Eyewitness
    - Invoke-FakeLogonScreen
    - Invoke-Farmer
    - Invoke-Get-RBCD-Threaded
    - Invoke-Gopher
    - Invoke-Grouper
    - Invoke-HandleKatz
    - Invoke-ImpersonatedProcess
    - Invoke-ImpersonateSystem
    - Invoke-InteractiveSystemPowerShell
    - Invoke-Internalmonologue
    - Invoke-Inveigh
    - Invoke-InveighRelay
    - Invoke-KrbRelay
    - Invoke-LdapSignCheck
    - Invoke-Lockless
    - Invoke-MalSCCM
    - Invoke-Mimikatz
    - Invoke-Mimikittenz
    - Invoke-MITM6
    - Invoke-NanoDump
    - Invoke-NetRipper
    - Invoke-Nightmare
    - Invoke-NinjaCopy
    - Invoke-OfficeScrape
    - Invoke-OxidResolver
    - Invoke-P0wnedshell
    - Invoke-Paranoia
    - Invoke-PortScan
    - Invoke-PoshRatHttp
    - Invoke-PostExfil
    - Invoke-PowerDump
    - Invoke-PowerShellTCP
    - Invoke-PowerShellWMI
    - Invoke-PPLDump
    - Invoke-PsExec
    - Invoke-PSInject
    - Invoke-PsUaCme
    - Invoke-ReflectivePEInjection
    - Invoke-ReverseDNSLookup
    - Invoke-Rubeus
    - Invoke-RunAs
    - Invoke-SafetyKatz
    - Invoke-SauronEye
    - Invoke-SCShell
    - Invoke-Seatbelt
    - Invoke-ServiceAbuse
    - Invoke-ShadowSpray
    - Invoke-Sharp
    - Invoke-Shellcode
    - Invoke-SMBScanner
    - Invoke-Snaffler
    - Invoke-Spoolsample
    - Invoke-SpraySinglePassword
    - Invoke-SSHCommand
    - Invoke-StandIn
    - Invoke-StickyNotesExtract
    - Invoke-SystemCommand
    - Invoke-Tasksbackdoor
    - Invoke-Tater
    - Invoke-Thunderfox
    - Invoke-ThunderStruck
    - Invoke-TokenManipulation
    - Invoke-Tokenvator
    - Invoke-TotalExec
    - Invoke-UrbanBishop
    - Invoke-UserHunter
    - Invoke-VoiceTroll
    - Invoke-Whisker
    - Invoke-WinEnum
    - Invoke-winPEAS
    - Invoke-WireTap
    - Invoke-WmiCommand
    - Invoke-WMIExec
    - Invoke-WScriptBypassUAC
    - Invoke-Zerologon
    - MailRaider
    - New-ADIDNSNode
    - New-DNSRecordArray
    - New-HoneyHash
    - New-InMemoryModule
    - New-MachineAccount
    - New-SOASerialNumberArray
    - Out-Minidump
    - Port-Scan
    - PowerBreach
    - 'powercat '
    - PowerUp
    - PowerView
    - Remove-ADIDNSNode
    - Remove-MachineAccount
    - Remove-Update
    - Rename-ADIDNSNode
    - Revoke-ADIDNSPermission
    - Set-ADIDNSNode
    - Set-MacAttribute
    - Set-MachineAccountAttribute
    - Set-Wallpaper
    - Show-TargetScreen
    - Start-CaptureServer
    - Start-WebcamRecorder
    - VolumeShadowCopyTools
- condition: selection
  selection:
    CommandLine|contains: Install-TransportAgent
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic:
    ParentImage|endswith:
    - C:\Windows\explorer.exe
    - C:\Windows\System32\CompatTelRunner.exe
    - C:\Windows\SysWOW64\explorer.exe
  filter_main_windows_update:
    ParentImage: C:\$WINDOWS.~BT\Sources\SetupHost.exe
  filter_optional_vscode:
    ParentCommandLine|contains: ' --ms-enable-electron-run-as-node '
    ParentImage|endswith: \AppData\Local\Programs\Microsoft VS Code\Code.exe
    ParentImage|startswith: C:\Users\
  selection:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: selection
  selection:
    CommandLine|contains: (WCHAR)0x
- condition: selection
  selection:
    CommandLine|contains:
    - -f C:\Users\Public
    - -f "C:\Users\Public
    - -f %Public%
    - -fi C:\Users\Public
    - -fi "C:\Users\Public
    - -fi %Public%
    - -fil C:\Users\Public
    - -fil "C:\Users\Public
    - -fil %Public%
    - -file C:\Users\Public
    - -file "C:\Users\Public
    - -file %Public%
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: selection
  selection:
    CommandLine|contains:
    - Invoke-ATHRemoteFXvGPUDisablementCommand
    - Invoke-ATHRemoteFXvGPUDisableme
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - ' Net.Sockets.TCPClient'
    - .GetStream(
    - .Write(
  selection_img:
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - Get-Content
    - -Stream
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    ParentImage|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: selection
  selection:
    CommandLine|re: \s-\s*<
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: all of selection*
  selection_1:
    CommandLine|contains|all:
    - \HarddiskVolumeShadowCopy
    - System32\config\sam
  selection_2:
    CommandLine|contains:
    - Copy-Item
    - cp $_.
    - cpi $_.
    - copy $_.
    - .File]::Copy(
- condition: selection and not 1 of filter_*
  filter_health_service:
    CurrentDirectory|contains: \Health Service State\
  selection:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    ParentImage|endswith:
    - \wscript.exe
    - \cscript.exe
- condition: all of selection_*
  selection_img:
  - Image|endswith: \pwsh.exe
  - OriginalFileName: pwsh.dll
  selection_sddl_flag:
    CommandLine|contains:
    - '-SecurityDescriptorSddl '
    - '-sd '
  selection_set_service:
    CommandLine|contains:
    - ;;;IU
    - ;;;SU
    - ;;;BA
    - ;;;SY
    - ;;;WD
    CommandLine|contains|all:
    - 'Set-Service '
    - D;;
- condition: all of selection_*
  selection_cmdlet:
    CommandLine|contains|all:
    - 'Set-Acl '
    - '-AclObject '
    - '-Path '
  selection_img:
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: all of selection_*
  selection_cmdlet:
    CommandLine|contains|all:
    - 'Set-Acl '
    - '-AclObject '
  selection_img:
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  selection_paths:
    CommandLine|contains:
    - -Path "C:\Windows
    - -Path 'C:\Windows
    - -Path %windir%
    - -Path $env:windir
  selection_permissions:
    CommandLine|contains:
    - FullControl
    - Allow
- condition: all of selection* and not filter
  filter:
    CommandLine|contains:
    - C:\Program Files
    - C:\ProgramData
    - \AppData\Roaming\Code\
  selection_level:
    CommandLine|contains:
    - Unrestricted
    - bypass
    - RemoteSigned
  selection_option:
    CommandLine|contains:
    - ' -executionpolicy '
    - ' -ep '
    - ' -exec '
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - Disabled
    - Manual
    CommandLine|contains|all:
    - Set-Service
    - -StartupType
  selection_img:
  - Image|endswith: \powershell.exe
  - OriginalFileName: PowerShell.EXE
- condition: all of selection*
  selection_delete:
    CommandLine|contains:
    - .Delete()
    - Remove-WmiObject
    - rwmi
    - Remove-CimInstance
    - rcim
  selection_get:
    CommandLine|contains:
    - Get-WmiObject
    - gwmi
    - Get-CimInstance
    - gcim
  selection_shadowcopy:
    CommandLine|contains: Win32_Shadowcopy
- condition: all of selection_* and not 1 of filter_*
  filter_msiexec:
    CommandLine|contains: $exserver=Get-ExchangeServer ([Environment]::MachineName)
      -ErrorVariable exerr 2> $null
    ParentImage: C:\Windows\System32\msiexec.exe
  selection_cli:
    CommandLine|contains: Add-PSSnapin
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_module:
    CommandLine|contains:
    - Microsoft.Exchange.Powershell.Snapin
    - Microsoft.Exchange.Management.PowerShell.SnapIn
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: 'Stop-Service '
  selection_sc_net_img:
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: selection and not 1 of filter_optional_*
  filter_optional_amazon:
    CommandLine|contains: \Program Files\Amazon\WorkspacesConfig\Scripts\
    ParentCommandLine|contains: \Program Files\Amazon\WorkspacesConfig\Scripts\
  selection:
    Image|endswith:
    - \bash.exe
    - \bitsadmin.exe
    - \certutil.exe
    - \cscript.exe
    - \forfiles.exe
    - \hh.exe
    - \mshta.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \schtasks.exe
    - \scrcons.exe
    - \scriptrunner.exe
    - \sh.exe
    - \wmic.exe
    - \wscript.exe
    ParentImage|endswith:
    - \powershell_ise.exe
    - \powershell.exe
    - \pwsh.exe
- condition: selection
  selection:
    CommandLine|contains:
    - IEX ((New-Object Net.WebClient).DownloadString
    - IEX (New-Object Net.WebClient).DownloadString
    - IEX((New-Object Net.WebClient).DownloadString
    - IEX(New-Object Net.WebClient).DownloadString
    - ' -command (New-Object System.Net.WebClient).DownloadFile('
    - ' -c (New-Object System.Net.WebClient).DownloadFile('
- condition: selection
  selection:
    CommandLine|contains:
    - ' -windowstyle h '
    - ' -windowstyl h'
    - ' -windowsty h'
    - ' -windowst h'
    - ' -windows h'
    - ' -windo h'
    - ' -wind h'
    - ' -win h'
    - ' -wi h'
    - ' -win h '
    - ' -win hi '
    - ' -win hid '
    - ' -win hidd '
    - ' -win hidde '
    - ' -NoPr '
    - ' -NoPro '
    - ' -NoProf '
    - ' -NoProfi '
    - ' -NoProfil '
    - ' -nonin '
    - ' -nonint '
    - ' -noninte '
    - ' -noninter '
    - ' -nonintera '
    - ' -noninterac '
    - ' -noninteract '
    - ' -noninteracti '
    - ' -noninteractiv '
    - ' -ec '
    - ' -encodedComman '
    - ' -encodedComma '
    - ' -encodedComm '
    - ' -encodedCom '
    - ' -encodedCo '
    - ' -encodedC '
    - ' -encoded '
    - ' -encode '
    - ' -encod '
    - ' -enco '
    - ' -en '
    - ' -executionpolic '
    - ' -executionpoli '
    - ' -executionpol '
    - ' -executionpo '
    - ' -executionp '
    - ' -execution bypass'
    - ' -executio bypass'
    - ' -executi bypass'
    - ' -execut bypass'
    - ' -execu bypass'
    - ' -exec bypass'
    - ' -exe bypass'
    - ' -ex bypass'
    - ' -ep bypass'
    - ' /windowstyle h '
    - ' /windowstyl h'
    - ' /windowsty h'
    - ' /windowst h'
    - ' /windows h'
    - ' /windo h'
    - ' /wind h'
    - ' /win h'
    - ' /wi h'
    - ' /win h '
    - ' /win hi '
    - ' /win hid '
    - ' /win hidd '
    - ' /win hidde '
    - ' /NoPr '
    - ' /NoPro '
    - ' /NoProf '
    - ' /NoProfi '
    - ' /NoProfil '
    - ' /nonin '
    - ' /nonint '
    - ' /noninte '
    - ' /noninter '
    - ' /nonintera '
    - ' /noninterac '
    - ' /noninteract '
    - ' /noninteracti '
    - ' /noninteractiv '
    - ' /ec '
    - ' /encodedComman '
    - ' /encodedComma '
    - ' /encodedComm '
    - ' /encodedCom '
    - ' /encodedCo '
    - ' /encodedC '
    - ' /encoded '
    - ' /encode '
    - ' /encod '
    - ' /enco '
    - ' /en '
    - ' /executionpolic '
    - ' /executionpoli '
    - ' /executionpol '
    - ' /executionpo '
    - ' /executionp '
    - ' /execution bypass'
    - ' /executio bypass'
    - ' /executi bypass'
    - ' /execut bypass'
    - ' /execu bypass'
    - ' /exec bypass'
    - ' /exe bypass'
    - ' /ex bypass'
    - ' /ep bypass'
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
- condition: all of selection_*
  selection_parent:
  - ParentImage|contains: tomcat
  - ParentImage|endswith:
    - \amigo.exe
    - \browser.exe
    - \chrome.exe
    - \firefox.exe
    - \httpd.exe
    - \iexplore.exe
    - \jbosssvc.exe
    - \microsoftedge.exe
    - \microsoftedgecp.exe
    - \MicrosoftEdgeSH.exe
    - \mshta.exe
    - \nginx.exe
    - \outlook.exe
    - \php-cgi.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \safari.exe
    - \services.exe
    - \sqlagent.exe
    - \sqlserver.exe
    - \sqlservr.exe
    - \vivaldi.exe
    - \w3wp.exe
  selection_powershell:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - CommandLine|contains:
    - /c powershell
    - /c pwsh
  - Description: Windows PowerShell
  - Product: PowerShell Core 6
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: all of selection*
  selection1:
    CommandLine|contains:
    - powershell.exe
    - \powershell
    - \pwsh
    - pwsh.exe
  selection2:
    CommandLine|contains:
    - Local\
    - Roaming\
    CommandLine|contains|all:
    - '/c '
    - \AppData\
- condition: selection
  selection:
    CommandLine|contains|all:
    - powershell
    - .DownloadFile
    - System.Net.WebClient
- condition: all of selection_*
  selection_remove:
    CommandLine|contains: Remove-MpPreference
  selection_tamper:
    CommandLine|contains:
    - '-ControlledFolderAccessProtectedFolders '
    - '-AttackSurfaceReductionRules_Ids '
    - '-AttackSurfaceReductionRules_Actions '
    - '-CheckForSignaturesBeforeRunningScan '
- condition: selection
  selection:
  - CommandLine|re: \w+`(\w+|-|.)`[\w+|\s]
  - CommandLine|re: '"(\{\d\})+"\s*-f'
  - CommandLine|re: \$\{((e|n|v)*`(e|n|v)*)+:path\}|\$\{((e|n|v)*`(e|n|v)*)+:((p|a|t|h)*`(p|a|t|h)*)+\}|\$\{env:((p|a|t|h)*`(p|a|t|h)*)+\}
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' > '
    - ' | Select '
    - Out-File
    - Set-Content
    - Add-Content
    CommandLine|contains|all:
    - 'Get-ADUser '
    - ' -Filter \*'
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: all of selection_*
  selection_encoded:
    CommandLine|contains:
    - TgBlAFQALgB3AEUAQg
    - 4AZQBUAC4AdwBFAEIA
    - OAGUAVAAuAHcARQBCA
    - bgBFAHQALgB3AGUAYg
    - 4ARQB0AC4AdwBlAGIA
    - uAEUAdAAuAHcAZQBiA
    - TgBFAHQALgB3AGUAYg
    - OAEUAdAAuAHcAZQBiA
    - bgBlAFQALgB3AGUAYg
    - 4AZQBUAC4AdwBlAGIA
    - uAGUAVAAuAHcAZQBiA
    - TgBlAFQALgB3AGUAYg
    - OAGUAVAAuAHcAZQBiA
    - bgBFAFQALgB3AGUAYg
    - 4ARQBUAC4AdwBlAGIA
    - uAEUAVAAuAHcAZQBiA
    - bgBlAHQALgBXAGUAYg
    - 4AZQB0AC4AVwBlAGIA
    - uAGUAdAAuAFcAZQBiA
    - bgBFAHQALgBXAGUAYg
    - 4ARQB0AC4AVwBlAGIA
    - uAEUAdAAuAFcAZQBiA
    - TgBFAHQALgBXAGUAYg
    - OAEUAdAAuAFcAZQBiA
    - bgBlAFQALgBXAGUAYg
    - 4AZQBUAC4AVwBlAGIA
    - uAGUAVAAuAFcAZQBiA
    - TgBlAFQALgBXAGUAYg
    - OAGUAVAAuAFcAZQBiA
    - bgBFAFQALgBXAGUAYg
    - 4ARQBUAC4AVwBlAGIA
    - uAEUAVAAuAFcAZQBiA
    - bgBlAHQALgB3AEUAYg
    - 4AZQB0AC4AdwBFAGIA
    - uAGUAdAAuAHcARQBiA
    - TgBlAHQALgB3AEUAYg
    - OAGUAdAAuAHcARQBiA
    - bgBFAHQALgB3AEUAYg
    - 4ARQB0AC4AdwBFAGIA
    - uAEUAdAAuAHcARQBiA
    - TgBFAHQALgB3AEUAYg
    - OAEUAdAAuAHcARQBiA
    - bgBlAFQALgB3AEUAYg
    - 4AZQBUAC4AdwBFAGIA
    - uAGUAVAAuAHcARQBiA
    - TgBlAFQALgB3AEUAYg
    - OAGUAVAAuAHcARQBiA
    - bgBFAFQALgB3AEUAYg
    - 4ARQBUAC4AdwBFAGIA
    - uAEUAVAAuAHcARQBiA
    - TgBFAFQALgB3AEUAYg
    - OAEUAVAAuAHcARQBiA
    - bgBlAHQALgBXAEUAYg
    - 4AZQB0AC4AVwBFAGIA
    - uAGUAdAAuAFcARQBiA
    - TgBlAHQALgBXAEUAYg
    - OAGUAdAAuAFcARQBiA
    - bgBFAHQALgBXAEUAYg
    - 4ARQB0AC4AVwBFAGIA
    - uAEUAdAAuAFcARQBiA
    - TgBFAHQALgBXAEUAYg
    - OAEUAdAAuAFcARQBiA
    - bgBlAFQALgBXAEUAYg
    - 4AZQBUAC4AVwBFAGIA
    - uAGUAVAAuAFcARQBiA
    - TgBlAFQALgBXAEUAYg
    - OAGUAVAAuAFcARQBiA
    - bgBFAFQALgBXAEUAYg
    - 4ARQBUAC4AVwBFAGIA
    - uAEUAVAAuAFcARQBiA
    - TgBFAFQALgBXAEUAYg
    - OAEUAVAAuAFcARQBiA
    - bgBlAHQALgB3AGUAQg
    - 4AZQB0AC4AdwBlAEIA
    - uAGUAdAAuAHcAZQBCA
    - TgBlAHQALgB3AGUAQg
    - OAGUAdAAuAHcAZQBCA
    - bgBFAHQALgB3AGUAQg
    - 4ARQB0AC4AdwBlAEIA
    - uAEUAdAAuAHcAZQBCA
    - TgBFAHQALgB3AGUAQg
    - OAEUAdAAuAHcAZQBCA
    - bgBlAFQALgB3AGUAQg
    - 4AZQBUAC4AdwBlAEIA
    - uAGUAVAAuAHcAZQBCA
    - TgBlAFQALgB3AGUAQg
    - OAGUAVAAuAHcAZQBCA
    - bgBFAFQALgB3AGUAQg
    - 4ARQBUAC4AdwBlAEIA
    - uAEUAVAAuAHcAZQBCA
    - TgBFAFQALgB3AGUAQg
    - OAEUAVAAuAHcAZQBCA
    - bgBlAHQALgBXAGUAQg
    - 4AZQB0AC4AVwBlAEIA
    - uAGUAdAAuAFcAZQBCA
    - TgBlAHQALgBXAGUAQg
    - OAGUAdAAuAFcAZQBCA
    - bgBFAHQALgBXAGUAQg
    - 4ARQB0AC4AVwBlAEIA
    - uAEUAdAAuAFcAZQBCA
    - TgBFAHQALgBXAGUAQg
    - OAEUAdAAuAFcAZQBCA
    - bgBlAFQALgBXAGUAQg
    - 4AZQBUAC4AVwBlAEIA
    - uAGUAVAAuAFcAZQBCA
    - TgBlAFQALgBXAGUAQg
    - OAGUAVAAuAFcAZQBCA
    - bgBFAFQALgBXAGUAQg
    - 4ARQBUAC4AVwBlAEIA
    - uAEUAVAAuAFcAZQBCA
    - TgBFAFQALgBXAGUAQg
    - OAEUAVAAuAFcAZQBCA
    - bgBlAHQALgB3AEUAQg
    - 4AZQB0AC4AdwBFAEIA
    - uAGUAdAAuAHcARQBCA
    - TgBlAHQALgB3AEUAQg
    - OAGUAdAAuAHcARQBCA
    - bgBFAHQALgB3AEUAQg
    - 4ARQB0AC4AdwBFAEIA
    - uAEUAdAAuAHcARQBCA
    - TgBFAHQALgB3AEUAQg
    - OAEUAdAAuAHcARQBCA
    - bgBlAFQALgB3AEUAQg
    - uAGUAVAAuAHcARQBCA
    - bgBFAFQALgB3AEUAQg
    - 4ARQBUAC4AdwBFAEIA
    - uAEUAVAAuAHcARQBCA
    - TgBFAFQALgB3AEUAQg
    - OAEUAVAAuAHcARQBCA
    - TgBlAHQALgBXAEUAQg
    - 4AZQB0AC4AVwBFAEIA
    - OAGUAdAAuAFcARQBCA
    - bgBFAHQALgBXAEUAQg
    - 4ARQB0AC4AVwBFAEIA
    - uAEUAdAAuAFcARQBCA
    - TgBFAHQALgBXAEUAQg
    - OAEUAdAAuAFcARQBCA
    - bgBlAFQALgBXAEUAQg
    - 4AZQBUAC4AVwBFAEIA
    - uAGUAVAAuAFcARQBCA
    - TgBlAFQALgBXAEUAQg
    - OAGUAVAAuAFcARQBCA
    - bgBFAFQALgBXAEUAQg
    - 4ARQBUAC4AVwBFAEIA
    - uAEUAVAAuAFcARQBCA
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: selection
  selection:
    CommandLine|contains:
    - X509Enrollment.CBinaryConverter
    - 884e2002-217d-11da-b2a4-000e7bbb2b09
- condition: all of selection_*
  selection_cli_other:
    CommandLine|contains:
    - ForEach
    - for(
    - 'for '
    - '-join '
    - -join'
    - -join"
    - -join`
    - ::Join
    - '[char]'
  selection_cli_xor:
    CommandLine|contains: bxor
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  - Description: Windows PowerShell
  - Product: PowerShell Core 6
- condition: selection
  selection:
    CommandLine|contains|all:
    - 'Compress-Archive '
    - ' -Path '
    - ' -DestinationPath '
    - $env:TEMP\
- condition: selection
  selection:
    ParentImage|endswith: \Microsoft.NodejsTools.PressAnyKey.exe
- condition: selection and not filter_print
  filter_print:
    CommandLine|contains: print.exe
  selection:
    CommandLine|contains|all:
    - /D
    - .exe
    CommandLine|startswith: print
    Image|endswith: \print.exe
- condition: selection
  selection:
    CommandLine|contains: /start
    Image|endswith: \Psr.exe
- condition: 1 of selection_*
  selection_img:
    Image|endswith: \3proxy.exe
  selection_params:
    CommandLine|contains: .exe -i127.0.0.1 -p
  selection_pe:
    Description: 3proxy - tiny proxy server
- condition: 1 of selection_*
  selection_enum_ad:
    CommandLine|contains: -sc admincountdmp
  selection_enum_exchange:
    CommandLine|contains: -sc exchaddresses
  selection_password:
    CommandLine|contains:
    - lockoutduration
    - lockoutthreshold
    - lockoutobservationwindow
    - maxpwdage
    - minpwdage
    - minpwdlength
    - pwdhistorylength
    - pwdproperties
- condition: selection
  selection:
    CommandLine|contains:
    - domainlist
    - trustdmp
    - dcmodes
    - adinfo
    - ' dclist '
    - computer_pwdnotreqd
    - objectcategory=
    - -subnets -f
    - name="Domain Admins"
    - '-sc u:'
    - domainncs
    - dompol
    - ' oudmp '
    - subnetdmp
    - gpodmp
    - fspdmp
    - users_noexpire
    - computers_active
    - computers_pwdnotreqd
- condition: selection
  selection:
  - OriginalFileName: AdvancedRun.exe
  - CommandLine|contains|all:
    - ' /EXEFilename '
    - ' /Run'
  - CommandLine|contains|all:
    - ' /WindowState 0'
    - ' /RunAs '
    - ' /CommandLine '
- condition: all of selection*
  selection:
    CommandLine|contains:
    - /EXEFilename
    - /CommandLine
  selection_runas:
  - CommandLine|contains:
    - ' /RunAs 8 '
    - ' /RunAs 4 '
    - ' /RunAs 10 '
    - ' /RunAs 11 '
  - CommandLine|endswith:
    - /RunAs 8
    - /RunAs 4
    - /RunAs 10
    - /RunAs 11
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains|all:
    - /portable
    - /lng
  selection_img:
  - Image|contains: \advanced_ip_scanner
  - OriginalFileName|contains: advanced_ip_scanner
  - Description|contains: Advanced IP Scanner
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains|all:
    - /portable
    - /lng
  selection_img:
  - Image|contains: \advanced_port_scanner
  - OriginalFileName|contains: advanced_port_scanner
  - Description|contains: Advanced Port Scanner
- condition: selection_img or all of selection_param*
  selection_img:
    Image|endswith: \chisel.exe
  selection_param1:
    CommandLine|contains:
    - 'exe client '
    - 'exe server '
  selection_param2:
    CommandLine|contains:
    - -socks5
    - -reverse
    - ' r:'
    - ':127.0.0.1:'
    - '-tls-skip-verify '
    - :socks
- condition: 1 of selection*
  selection1:
    Image|endswith: \SepRemovalToolNative_x64.exe
  selection2:
    CommandLine|contains: --uninstall
    Image|endswith: \CATClean.exe
  selection3:
    CommandLine|contains: -r
    Image|endswith: \NetInstaller.exe
  selection4:
    CommandLine|contains|all:
    - /uninstall
    - /enterprise
    Image|endswith: \WFPUnins.exe
- condition: selection
  selection:
  - Image|endswith: \Crassus.exe
  - OriginalFileName: Crassus.exe
  - Description|contains: Crassus
- condition: 1 of selection*
  selection:
    Image|endswith: \csexec.exe
  selection_pe:
    Description: csexec
- condition: selection
  selection:
  - Image|endswith: \DefenderCheck.exe
  - Description: DefenderCheck
- condition: selection
  selection:
  - Image|endswith: \ditsnap.exe
  - CommandLine|contains: ditsnap.exe
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains: \frpc.ini
  selection_hashes:
  - Hashes|contains:
    - MD5=7D9C233B8C9E3F0EA290D2B84593C842
    - SHA1=06DDC9280E1F1810677935A2477012960905942F
    - SHA256=57B0936B8D336D8E981C169466A15A5FD21A7D5A2C7DAF62D5E142EE860E387C
  - md5: 7d9c233b8c9e3f0ea290d2b84593c842
  - sha1: 06ddc9280e1f1810677935a2477012960905942f
  - sha256: 57b0936b8d336d8e981c169466a15a5fd21a7d5a2c7daf62d5e142ee860e387c
  selection_img:
    Image|endswith:
    - \frpc.exe
    - \frps.exe
- condition: 1 of selection*
  selection:
    Image|endswith: \iox.exe
  selection_commandline:
    CommandLine|contains:
    - '.exe fwd -l '
    - '.exe fwd -r '
    - '.exe proxy -l '
    - '.exe proxy -r '
  selection_hashes:
  - Hashes|contains:
    - MD5=9DB2D314DD3F704A02051EF5EA210993
    - SHA1=039130337E28A6623ECF9A0A3DA7D92C5964D8DD
    - SHA256=C6CF82919B809967D9D90EA73772A8AA1C1EB3BC59252D977500F64F1A0D6731
  - md5: 9db2d314dd3f704a02051ef5ea210993
  - sha1: 039130337e28a6623ecf9a0a3da7d92c5964d8dd
  - sha256: c6cf82919b809967d9d90ea73772a8aa1c1eb3bc59252d977500f64f1a0d6731
- condition: selection
  selection:
  - Product|contains: Mouse Lock
  - Company|contains: Misc314
  - CommandLine|contains: Mouse Lock_
- condition: 1 of selection_*
  selection_cmdline:
    CommandLine|contains:
    - ' -lvp '
    - ' -lvnp'
    - ' -l -v -p '
    - ' -lv -p '
    - ' -l --proxy-type http '
    - ' -vnl --exec '
    - ' -vnl -e '
    - ' --lua-exec '
    - ' --sh-exec '
  selection_img:
    Image|endswith:
    - \nc.exe
    - \ncat.exe
    - \netcat.exe
- condition: 1 of selection*
  selection1:
    CommandLine|contains:
    - ' tcp 139'
    - ' tcp 445'
    - ' tcp 3389'
    - ' tcp 5985'
    - ' tcp 5986'
  selection2:
    CommandLine|contains|all:
    - ' start '
    - --all
    - --config
    - .yml
  selection3:
    CommandLine|contains:
    - ' tcp '
    - ' http '
    - ' authtoken '
    Image|endswith: ngrok.exe
  selection4:
    CommandLine|contains:
    - '.exe authtoken '
    - .exe start --all
- condition: 1 of selection_*
  selection_hash:
  - md5: 2DD44C3C29D667F5C0EF5F9D7C7FFB8B
  - sha256: F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559
  - Imphash: C07FDDD21D123EA9B3A08EEF44AAAC45
  selection_hashes:
    Hashes|contains:
    - MD5=2DD44C3C29D667F5C0EF5F9D7C7FFB8B
    - SHA256=F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559
    - IMPHASH=C07FDDD21D123EA9B3A08EEF44AAAC45
  selection_name:
    Image|endswith: \nimgrab.exe
- combo_exec:
    CommandLine|contains:
    - ' exec '
    - ' exec2 '
  combo_exec_params:
    CommandLine|contains:
    - ' show '
    - ' hide '
  condition: 1 of selection_* or all of combo_*
  selection_cmd:
    CommandLine|contains:
    - ' execmd '
    - '.exe script '
    - '.exe shexec '
    - ' runinteractive '
  selection_org:
  - Image|endswith: \NirCmd.exe
  - OriginalFileName: NirCmd.exe
- condition: selection
  selection:
    CommandLine|contains: ' runassystem '
- condition: selection
  selection:
  - Image|endswith:
    - \nmap.exe
    - \zennmap.exe
  - OriginalFileName:
    - nmap.exe
    - zennmap.exe
- condition: 1 of selection_*
  selection_cli_1:
    CommandLine|contains|all:
    - ' -server='
    - ' -vkey='
    - ' -password='
  selection_cli_2:
    CommandLine|contains: ' -config=npc'
  selection_hashes:
  - Hashes|contains:
    - MD5=AE8ACF66BFE3A44148964048B826D005
    - SHA1=CEA49E9B9B67F3A13AD0BE1C2655293EA3C18181
    - SHA256=5A456283392FFCEEEACA3D3426C306EB470304637520D72FED1CC1FEBBBD6856
  - md5: ae8acf66bfe3a44148964048b826d005
  - sha1: cea49e9b9b67f3a13ad0be1c2655293ea3c18181
  - sha256: 5a456283392ffceeeaca3d3426c306eb470304637520d72fed1cc1febbbd6856
  selection_img:
    Image|endswith: \npc.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - '-U:S '
    - '-U:T '
    - '-U:E '
    - '-P:E '
    - '-M:S '
    - '-M:H '
    - '-U=S '
    - '-U=T '
    - '-U=E '
    - '-P=E '
    - '-M=S '
    - '-M=H '
    - -ShowWindowMode:Hide
  selection_img:
  - Image|endswith:
    - \NSudo.exe
    - \NSudoLC.exe
    - \NSudoLG.exe
  - OriginalFileName:
    - NSudo.exe
    - NSudoLC.exe
    - NSudoLG.exe
- condition: 1 of selection_*
  selection_hash_values:
  - md5:
    - 68f9b52895f4d34e74112f3129b3b00d
    - b365af317ae730a67c936f21432b9c71
  - sha1:
    - c5e2018bf7c0f314fed4fd7fe7e69fa2e648359e
    - a0bdfac3ce1880b32ff9b696458327ce352e3b1d
  - sha256:
    - d4a0fe56316a2c45b9ba9ac1005363309a3edc7acf9e4df64d326a0ff273e80f
    - bd2c2cf0631d881ed382817afcce2b093f4e412ffb170a719e2762f250abfea4
  - Imphash:
    - 04de0ad9c37eb7bd52043d2ecac958df
    - 3695333c60dedecdcaff1590409aa462
  selection_hashes:
    Hashes|contains:
    - MD5=68F9B52895F4D34E74112F3129B3B00D
    - MD5=B365AF317AE730A67C936F21432B9C71
    - SHA1=A0BDFAC3CE1880B32FF9B696458327CE352E3B1D
    - SHA1=C5E2018BF7C0F314FED4FD7FE7E69FA2E648359E
    - SHA256=D4A0FE56316A2C45B9BA9AC1005363309A3EDC7ACF9E4DF64D326A0FF273E80F
    - SHA256=BD2C2CF0631D881ED382817AFCCE2B093F4E412FFB170A719E2762F250ABFEA4
    - IMPHASH=3695333C60DEDECDCAFF1590409AA462
    - IMPHASH=04DE0AD9C37EB7BD52043D2ECAC958DF
  selection_image:
  - Image|contains: \ProcessHacker_
  - Image|endswith: \ProcessHacker.exe
  - OriginalFileName:
    - ProcessHacker.exe
    - Process Hacker
  - Description: Process Hacker
  - Product: Process Hacker
- condition: selection
  selection:
  - Description: Radmin Viewer
  - Product: Radmin Viewer
  - OriginalFileName: Radmin.exe
- condition: all of selection_*
  selection_attributes:
    CommandLine|contains:
    - OriginalFileName
    - CompanyName
    - FileDescription
    - ProductName
    - ProductVersion
    - LegalCopyright
  selection_flags:
    CommandLine|contains: --set-
  selection_img:
  - Image|endswith:
    - \rcedit-x64.exe
    - \rcedit-x86.exe
  - Description: Edit resources of exe
  - Product: rcedit
- condition: selection_specific_options or all of selection_rclone_*
  selection_rclone_cli:
    CommandLine|contains:
    - pass
    - user
    - copy
    - sync
    - config
    - lsd
    - remote
    - ls
    - mega
    - pcloud
    - ftp
    - ignore-existing
    - auto-confirm
    - transfers
    - multi-thread-streams
    - 'no-check-certificate '
  selection_rclone_img:
  - Image|endswith: \rclone.exe
  - Description: Rsync for cloud storage
  selection_specific_options:
    CommandLine|contains|all:
    - '--config '
    - '--no-check-certificate '
    - ' copy '
- condition: all of selection_*
  selection_account:
    CommandLine|contains:
    - ' /account=system '
    - ' /account=ti '
  selection_exec:
    CommandLine|contains: /exec=
- condition: selection_img or all of selection_group_*
  selection_group_list:
    CommandLine|contains:
    - ' -group=misc'
    - ' -group=remote'
    - ' -group=chromium'
    - ' -group=slack'
    - ' -group=system'
    - ' -group=user'
    - ' -group=all'
  selection_group_output:
    CommandLine|contains: ' -outputfile='
  selection_img:
  - Image|endswith: \Seatbelt.exe
  - OriginalFileName: Seatbelt.exe
  - Description: Seatbelt
  - CommandLine|contains:
    - ' DpapiMasterKeys'
    - ' InterestingProcesses'
    - ' InterestingFiles'
    - ' CertificateThumbprints'
    - ' ChromiumBookmarks'
    - ' ChromiumHistory'
    - ' ChromiumPresence'
    - ' CloudCredentials'
    - ' CredEnum'
    - ' CredGuard'
    - ' FirefoxHistory'
    - ' ProcessCreationEvents'
- condition: 1 of selection_*
  selection_hash_values:
  - md5: 19426363A37C03C3ED6FEDF57B6696EC
  - sha1: 8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC
  - sha256: 8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287
  - Imphash: B68908ADAEB5D662F87F2528AF318F12
  selection_hashes:
    Hashes|contains:
    - MD5=19426363A37C03C3ED6FEDF57B6696EC
    - SHA1=8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC
    - SHA256=8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287
    - IMPHASH=B68908ADAEB5D662F87F2528AF318F12
  selection_image:
  - Image|endswith: \SystemInformer.exe
  - OriginalFileName: SystemInformer.exe
  - Description: System Informer
  - Product: System Informer
- condition: selection
  selection:
  - Description: Web Browser Password Viewer
  - Image|endswith: \WebBrowserPassView.exe
- condition: 1 of selection_*
  selection_cli:
    CommandLine|contains:
    - -u System
    - -uSystem
    - -u TrustedInstaller
    - -uTrustedInstaller
    - ' --ti '
  selection_metadata:
  - Image|endswith: \wsudo.exe
  - OriginalFileName: wsudo.exe
  - Description: Windows sudo utility
  - ParentImage|endswith: \wsudo-bridge.exe
- condition: selection
  selection:
    CommandLine|contains: adidnsdump
    Image|endswith: \python.exe
- condition: all of selection_* and not 1 of filter_*
  filter_python:
    ParentCommandLine|contains: -E -s -m ensurepip -U --default-pip
    ParentImage|endswith: \python.exe
    ParentImage|startswith: C:\Program Files\Python
  filter_vscode:
    ParentImage|endswith: \AppData\Local\Programs\Microsoft VS Code\Code.exe
  selection_cli:
    CommandLine|contains: ' -c'
  selection_img:
  - OriginalFileName: python.exe
  - Image|endswith:
    - python.exe
    - python3.exe
    - python2.exe
- condition: selection_img and 1 of selection_cli_*
  selection_cli_1:
    CommandLine|contains|all:
    - import pty
    - .spawn(
  selection_cli_2:
    CommandLine|contains: from pty import spawn
  selection_img:
    Image|endswith:
    - python.exe
    - python3.exe
    - python2.exe
- condition: selection
  selection:
    CommandLine|contains:
    - session >
    - process >
    Image|endswith: :\Windows\System32\query.exe
- condition: selection_password and selection_other
  selection_other:
    CommandLine|contains:
    - ' -m'
    - ' a '
  selection_password:
    CommandLine|contains: ' -hp'
- condition: selection
  selection:
    CommandLine|contains: ' a '
    Image|endswith: \rar.exe
- condition: 1 of selection_opt_* and all of selection_cli_*
  selection_cli_flags:
    CommandLine|contains|all:
    - ' -hp'
    - ' -r '
  selection_cli_folders:
    CommandLine|contains:
    - ' C:\\\*.'
    - ' C:\\\\\*.'
    - ' C:\Users\Public\'
    - ' %public%'
    - ' C:\Windows\'
    - ' C:\PerfLogs\'
    - ' C:\Temp'
    - ' C:\$Recycle.bin\'
  selection_opt_1:
  - Image|endswith: \rar.exe
  - Description: Command line RAR
  selection_opt_2:
    CommandLine|contains:
    - '.exe a '
    - ' a -m'
- condition: selection
  selection:
    Image|endswith: rasdial.exe
- condition: all of selection_cli_* or (selection_img and selection_cli_dump)
  selection_cli_dump:
    CommandLine|contains:
    - fullmemdmp
    - /memdmp
    - -memdmp
  selection_cli_output:
    CommandLine|contains:
    - ' -o '
    - ' /o '
  selection_cli_process:
    CommandLine|contains:
    - ' -p '
    - ' /p '
  selection_img:
  - Image|endswith: \rdrleakdiag.exe
  - OriginalFileName: RdrLeakDiag.exe
- condition: all of selection_* or (selection_img and not 1 of filter_main_*)
  filter_main_dll:
    CommandLine|contains: .dll
  filter_main_no_cli:
    CommandLine|endswith:
    - \Regasm.exe"
    - \Regasm.exe
    - \Regsvcs.exe"
    - \Regsvcs.exe
  selection_dir:
    CommandLine|contains:
    - \Users\Public\
    - \AppData\Local\Temp\
    - \Desktop\
    - \Downloads\
    - \PerfLogs\
    - \Windows\Temp\
    - \Microsoft\Windows\Start Menu\Programs\Startup\
  selection_img:
  - Image|endswith:
    - \Regsvcs.exe
    - \Regasm.exe
  - OriginalFileName:
    - RegSvcs.exe
    - RegAsm.exe
- condition: all of selection_*
  selection_cli_1:
    CommandLine|contains:
    - ' /E '
    - ' -E '
  selection_cli_2:
    CommandLine|contains:
    - hklm
    - hkey_local_machine
  selection_cli_3:
    CommandLine|endswith:
    - \system
    - \sam
    - \security
  selection_img:
  - Image|endswith: \regedit.exe
  - OriginalFileName: REGEDIT.EXE
- condition: all of selection_* and not all of filter_*
  filter_1:
    CommandLine|contains:
    - hklm
    - hkey_local_machine
  filter_2:
    CommandLine|endswith:
    - \system
    - \sam
    - \security
  selection_cli:
    CommandLine|contains:
    - ' /E '
    - ' -E '
  selection_img:
  - Image|endswith: \regedit.exe
  - OriginalFileName: REGEDIT.EXE
- condition: all of selection_* and not all of filter_*
  filter_1:
    CommandLine|contains:
    - ' /e '
    - ' /a '
    - ' /c '
    - ' -e '
    - ' -a '
    - ' -c '
  filter_2:
    CommandLine|re: :[^ \\]
  selection_cli:
    CommandLine|contains:
    - ' /i '
    - ' /s '
    - .reg
  selection_img:
  - Image|endswith: \regedit.exe
  - OriginalFileName: REGEDIT.EXE
- condition: all of selection_* and not filter
  filter:
    CommandLine|contains:
    - ' /e '
    - ' /a '
    - ' /c '
    - ' -e '
    - ' -a '
    - ' -c '
  selection_cli:
    CommandLine|contains:
    - ' /i '
    - .reg
    CommandLine|re: :[^ \\]
  selection_img:
  - Image|endswith: \regedit.exe
  - OriginalFileName: REGEDIT.EXE
- condition: selection
  selection:
    Image|endswith: \regedit.exe
    ParentImage|endswith:
    - \TrustedInstaller.exe
    - \ProcessHacker.exe
- condition: all of selection_*
  selection_img:
  - Image|endswith: \regini.exe
  - OriginalFileName: REGINI.EXE
  selection_re:
    CommandLine|re: :[^ \\]
- condition: selection and not filter
  filter:
    CommandLine|re: :[^ \\]
  selection:
  - Image|endswith: \regini.exe
  - OriginalFileName: REGINI.EXE
- condition: selection
  selection:
    CommandLine|contains|all:
    - -path
    - dll
    Image|endswith: \register-cimprovider.exe
- condition: selection
  selection:
    CommandLine|contains:
    - \Software\SimonTatham\PuTTY\Sessions
    - \Software\\SimonTatham\PuTTY\SshHostKeys\
    - \Software\Mobatek\MobaXterm\
    - \Software\WOW6432Node\Radmin\v3.0\Server\Parameters\Radmin
    - \Software\Aerofox\FoxmailPreview
    - \Software\Aerofox\Foxmail\V3.1
    - \Software\IncrediMail\Identities
    - \Software\Qualcomm\Eudora\CommandLine
    - \Software\RimArts\B2\Settings
    - \Software\OpenVPN-GUI\configs
    - \Software\Martin Prikryl\WinSCP 2\Sessions
    - \Software\FTPWare\COREFTP\Sites
    - \Software\DownloadManager\Passwords
    - \Software\OpenSSH\Agent\Keys
    - \Software\TightVNC\Server
    - \Software\ORL\WinVNC3\Password
    - \Software\RealVNC\WinVNC4
- condition: all of selection*
  selection1:
    CommandLine|contains: \CurrentVersion\Image File Execution Options\
  selection2:
    CommandLine|contains:
    - sethc.exe
    - utilman.exe
    - osk.exe
    - magnify.exe
    - narrator.exe
    - displayswitch.exe
    - atbroker.exe
    - HelpPane.exe
- condition: selection
  selection:
    CommandLine|contains: UserInitMprLogonScript
- condition: selection
  selection:
    CommandLine|contains|all:
    - \System\CurrentControlSet\Services\
    - \NetworkProvider
- condition: selection
  selection:
    CommandLine|contains:
    - \ImagePath
    - \FailureCommand
    - \ServiceDll
    CommandLine|contains|all:
    - ControlSet
    - services
    IntegrityLevel: Medium
- condition: all of selection_*
  selection_path:
    CommandLine|contains:
    - \ShellIds\Microsoft.PowerShell\ExecutionPolicy
    - \Policies\Microsoft\Windows\PowerShell\ExecutionPolicy
  selection_values:
    CommandLine|contains:
    - Bypass
    - RemoteSigned
    - Unrestricted
- condition: selection
  selection:
    CommandLine|contains: \Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths
- condition: selection and not 1 of filter_main_*
  filter_main_flag:
    CommandLine|contains:
    - ' /n '
    - ' -n '
  selection:
    CommandLine|contains:
    - ' /i:'
    - ' -i:'
    Image|endswith: \regsvr32.exe
- condition: all of selection_*
  selection_img:
  - Image|endswith: \regsvr32.exe
  - OriginalFileName: REGSVR32.EXE
  selection_ip:
    CommandLine|contains:
    - ' /i:http://1'
    - ' /i:http://2'
    - ' /i:http://3'
    - ' /i:http://4'
    - ' /i:http://5'
    - ' /i:http://6'
    - ' /i:http://7'
    - ' /i:http://8'
    - ' /i:http://9'
    - ' /i:https://1'
    - ' /i:https://2'
    - ' /i:https://3'
    - ' /i:https://4'
    - ' /i:https://5'
    - ' /i:https://6'
    - ' /i:https://7'
    - ' /i:https://8'
    - ' /i:https://9'
    - ' -i:http://1'
    - ' -i:http://2'
    - ' -i:http://3'
    - ' -i:http://4'
    - ' -i:http://5'
    - ' -i:http://6'
    - ' -i:http://7'
    - ' -i:http://8'
    - ' -i:http://9'
    - ' -i:https://1'
    - ' -i:https://2'
    - ' -i:https://3'
    - ' -i:https://4'
    - ' -i:https://5'
    - ' -i:https://6'
    - ' -i:https://7'
    - ' -i:https://8'
    - ' -i:https://9'
- condition: all of selection_*
  selection_flag:
    CommandLine|contains:
    - ' /i'
    - ' -i'
  selection_img:
  - Image|endswith: \regsvr32.exe
  - OriginalFileName: REGSVR32.EXE
  selection_protocol:
    CommandLine|contains:
    - ftp
    - http
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' \\\\'
  selection_img:
  - Image|endswith: \regsvr32.exe
  - OriginalFileName: \REGSVR32.EXE
- condition: selection and not 1 of filter_main_*
  filter_main_werfault:
    CommandLine|contains: ' -u -p '
    Image|endswith: \werfault.exe
  selection:
    Image|endswith:
    - \calc.exe
    - \cscript.exe
    - \explorer.exe
    - \mshta.exe
    - \net.exe
    - \net1.exe
    - \nltest.exe
    - \notepad.exe
    - \powershell.exe
    - \pwsh.exe
    - \reg.exe
    - \schtasks.exe
    - \werfault.exe
    - \wscript.exe
    ParentImage|endswith: \regsvr32.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - :\ProgramData\
    - :\Temp\
    - :\Users\Public\
    - :\Windows\Temp\
    - \AppData\Local\Temp\
    - \AppData\Roaming\
  selection_img:
  - Image|endswith: \regsvr32.exe
  - OriginalFileName: REGSVR32.EXE
- condition: selection_img and (selection_path_1 or (selection_path_2 and not selection_exclude_known_dirs))
    and not 1 of filter_main_*
  filter_main_empty:
    CommandLine: ''
  filter_main_null:
    CommandLine: null
  selection_exclude_known_dirs:
    CommandLine|contains:
    - C:\Program Files (x86)\
    - C:\Program Files\
    - C:\ProgramData\
    - C:\Users\
    - ' C:\Windows\'
    - ' "C:\Windows\'
    - ' ''C:\Windows\'
  selection_img:
  - Image|endswith: \regsvr32.exe
  - OriginalFileName: REGSVR32.EXE
  selection_path_1:
    CommandLine|contains:
    - :\PerfLogs\
    - :\Temp\
    - \Windows\Registration\CRMLog
    - \Windows\System32\com\dmp\
    - \Windows\System32\FxsTmp\
    - \Windows\System32\Microsoft\Crypto\RSA\MachineKeys\
    - \Windows\System32\spool\drivers\color\
    - \Windows\System32\spool\PRINTERS\
    - \Windows\System32\spool\SERVERS\
    - \Windows\System32\Tasks_Migrated\
    - \Windows\System32\Tasks\Microsoft\Windows\SyncCenter\
    - \Windows\SysWOW64\com\dmp\
    - \Windows\SysWOW64\FxsTmp\
    - \Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System\
    - \Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter\
    - \Windows\Tasks\
    - \Windows\Tracing\
  selection_path_2:
    CommandLine|contains:
    - ' "C:\'
    - ' C:\'
    - ' ''C:\'
    - D:\
- condition: all of selection_*
  selection_cli:
    CommandLine|endswith:
    - .bin
    - .bmp
    - .cr2
    - .dat
    - .eps
    - .gif
    - .ico
    - .jpeg
    - .jpg
    - .nef
    - .orf
    - .png
    - .raw
    - .sr2
    - .temp
    - .tif
    - .tiff
    - .tmp
    - .rtf
    - .txt
  selection_img:
  - Image|endswith: \regsvr32.exe
  - OriginalFileName: REGSVR32.EXE
- condition: selection and not 1 of filter_main_*
  filter_main_rpcproxy:
    CommandLine|endswith: ' /s C:\Windows\System32\RpcProxy\RpcProxy.dll'
    ParentImage: C:\Windows\System32\cmd.exe
  selection:
    Image|endswith: \regsvr32.exe
    ParentImage|endswith:
    - \cmd.exe
    - \cscript.exe
    - \mshta.exe
    - \powershell_ise.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_empty_4688:
    CommandLine: ''
  filter_main_legit_ext:
    CommandLine|contains:
    - .ax
    - .cpl
    - .dll
    - .ocx
  filter_main_null_4688:
    CommandLine: null
  filter_optional_avg:
    CommandLine|contains: .bav
  filter_optional_pascal:
    CommandLine|contains: .ppl
  selection:
  - Image|endswith: \regsvr32.exe
  - OriginalFileName: REGSVR32.EXE
- condition: selection
  selection:
    CommandLine|contains|all:
    - reg
    - ' ADD '
    - Software\Microsoft\Windows\CurrentVersion\Run
- condition: all of selection*
  selection_flag:
    CommandLine|contains:
    - ' copy '
    - ' add '
  selection_img:
  - Image|endswith: reg.exe
  - OriginalFileName: reg.exe
  selection_safeboot:
    CommandLine|contains: \SYSTEM\CurrentControlSet\Control\SafeBoot
- condition: selection
  selection:
    CommandLine|contains:
    - EnableBDEWithNoTPM
    - UseAdvancedStartup
    - UseTPM
    - UseTPMKey
    - UseTPMKeyPIN
    - RecoveryKeyMessageSource
    - UseTPMPIN
    - RecoveryKeyMessage
    CommandLine|contains|all:
    - REG
    - ADD
    - \SOFTWARE\Policies\Microsoft\FVE
    - /v
    - /f
- condition: selection_cmdline
  selection_cmdline:
    CommandLine|contains|all:
    - HKLM\SYSTEM\CurrentControlSet\Control\Lsa
    - scecli\0*
    - reg add
- condition: selection
  selection:
    CommandLine|contains:
    - SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths
    - SOFTWARE\Microsoft\Microsoft Antimalware\Exclusions\Paths
    CommandLine|contains|all:
    - 'ADD '
    - '/t '
    - 'REG_DWORD '
    - '/v '
    - '/d '
    - '0'
    Image|endswith: \reg.exe
- condition: all of selection_*
  selection_delete:
    CommandLine|contains|all:
    - ' delete '
    - \SYSTEM\CurrentControlSet\Control\SafeBoot
  selection_img:
  - Image|endswith: reg.exe
  - OriginalFileName: reg.exe
- condition: all of selection_*
  selection_delete:
    CommandLine|contains: ' delete '
  selection_img:
  - Image|endswith: reg.exe
  - OriginalFileName: reg.exe
  selection_key:
    CommandLine|contains: \SYSTEM\CurrentControlSet\services\
- condition: all of selection_*
  selection_1:
    CommandLine|contains: add
    Image|endswith: \reg.exe
  selection_2:
    CommandLine|contains:
    - \software\Microsoft\Windows\CurrentVersion\Run
    - \software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit
    - \software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell
    - \software\Microsoft\Windows NT\CurrentVersion\Windows
    - \software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
    - \system\CurrentControlSet\Control\SafeBoot\AlternateShell
- condition: selection_reg_add and 1 of selection_cli_*
  selection_cli_reg_start:
    CommandLine|contains:
    - \AppIDSvc
    - \MsMpSvc
    - \NisSrv
    - \SecurityHealthService
    - \Sense
    - \UsoSvc
    - \WdBoot
    - \WdFilter
    - \WdNisDrv
    - \WdNisSvc
    - \WinDefend
    - \wscsvc
    - \wuauserv
    CommandLine|contains|all:
    - d 4
    - v Start
  selection_reg_add:
    CommandLine|contains|all:
    - reg
    - add
- condition: all of selection_*
  selection_cli_flag:
    CommandLine|contains:
    - save
    - export
    - "\u02E2ave"
    - "e\u02E3port"
  selection_cli_hive:
    CommandLine|contains:
    - \system
    - \sam
    - \security
    - "\\\u02E2ystem"
    - "\\sy\u02E2tem"
    - "\\\u02E2y\u02E2tem"
    - "\\\u02E2am"
    - "\\\u02E2ecurity"
  selection_cli_hklm:
    CommandLine|contains:
    - hklm
    - "hk\u02EAm"
    - hkey_local_machine
    - "hkey_\u02EAocal_machine"
    - "hkey_loca\u02EA_machine"
    - "hkey_\u02EAoca\u02EA_machine"
  selection_img:
  - Image|endswith: \reg.exe
  - OriginalFileName: reg.exe
- condition: reg and hive
  hive:
  - CommandLine|contains|all:
    - '/f '
    - HKLM
  - CommandLine|contains|all:
    - '/f '
    - HKCU
  - CommandLine|contains: HKCU\Software\SimonTatham\PuTTY\Sessions
  reg:
    CommandLine|contains|all:
    - ' query '
    - '/t '
    - REG_SZ
    - /s
    Image|endswith: \reg.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' import '
  selection_img:
  - Image|endswith: \reg.exe
  - OriginalFileName: reg.exe
  selection_paths:
    CommandLine|contains:
    - C:\Users\
    - '%temp%'
    - '%tmp%'
    - '%appdata%'
    - \AppData\Local\Temp\
    - C:\Windows\Temp\
    - C:\ProgramData\
- condition: selection
  selection:
    CommandLine|contains|all:
    - \System\CurrentControlSet\Control\Lsa\
    - DisableRestrictedAdmin
    - ' 1'
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: SYSTEM\CurrentControlSet\Control\Lsa
    CommandLine|contains|all:
    - ' add '
    - ' /d 0'
    - ' /v RunAsPPL '
  selection_img:
  - Image|endswith: \reg.exe
  - OriginalFileName: reg.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - SOFTWARE\Microsoft\Cryptography
    - '/v '
    - MachineGuid
    Image|endswith: \reg.exe
- condition: all of selection_*
  selection_key:
    CommandLine|contains:
    - GroupPolicyRefreshTimeDC
    - GroupPolicyRefreshTimeOffsetDC
    - GroupPolicyRefreshTime
    - GroupPolicyRefreshTimeOffset
    - EnableSmartScreen
    - ShellSmartScreenLevel
  selection_path:
    CommandLine|contains: \SOFTWARE\Policies\Microsoft\Windows\System
  selection_reg:
  - Image|endswith: \reg.exe
  - OriginalFileName: reg.exe
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains|all:
    - reg
    - add
    - hkcu\software\classes\ms-settings\shell\open\command
    - '/ve '
    - /d
  selection_2:
    CommandLine|contains|all:
    - reg
    - add
    - hkcu\software\classes\ms-settings\shell\open\command
    - /v
    - DelegateExecute
  selection_3:
    CommandLine|contains|all:
    - reg
    - delete
    - hkcu\software\classes\ms-settings
- condition: all of selection_*
  selection_flag:
    CommandLine|contains: query
  selection_img:
  - Image|endswith: \reg.exe
  - OriginalFileName: reg.exe
  selection_key:
    CommandLine|contains:
    - currentVersion\windows
    - winlogon\
    - currentVersion\shellServiceObjectDelayLoad
    - currentVersion\run
    - currentVersion\policies\explorer\run
    - currentcontrolset\services
- condition: all of selection_main_* and 1 of selection_values_*
  selection_main_cli:
    CommandLine|contains|all:
    - ' add '
    - \CurrentControlSet\Control\Terminal Server
    - REG_DWORD
    - ' /f'
  selection_main_img:
  - Image|endswith: \reg.exe
  - OriginalFileName: reg.exe
  selection_values_1:
    CommandLine|contains|all:
    - Licensing Core
    - EnableConcurrentSessions
  selection_values_2:
    CommandLine|contains:
    - WinStations\RDP-Tcp
    - MaxInstanceCount
    - fEnableWinStation
    - TSUserEnabled
    - TSEnabled
    - TSAppCompat
    - IdleWinStationPoolCount
    - TSAdvertise
    - AllowTSConnections
    - fSingleSessionPerUser
    - fDenyTSConnections
- condition: selection_reg and 1 of selection_option_*
  selection_option_1:
    CommandLine|contains|all:
    - /v ScreenSaveActive
    - /t REG_SZ
    - /d 1
    - /f
  selection_option_2:
    CommandLine|contains|all:
    - /v ScreenSaveTimeout
    - /t REG_SZ
    - '/d '
    - /f
  selection_option_3:
    CommandLine|contains|all:
    - /v ScreenSaverIsSecure
    - /t REG_SZ
    - /d 0
    - /f
  selection_option_4:
    CommandLine|contains|all:
    - /v SCRNSAVE.EXE
    - /t REG_SZ
    - '/d '
    - .scr
    - /f
  selection_reg:
    CommandLine|contains:
    - HKEY_CURRENT_USER\Control Panel\Desktop
    - HKCU\Control Panel\Desktop
    Image|endswith: \reg.exe
- condition: all of selection*
  selection:
    CommandLine|contains|all:
    - 'add '
    - SYSTEM\CurrentControlSet\Services\
    - ' ImagePath '
    Image|endswith: \reg.exe
  selection_value:
    CommandLine|contains:
    - ' /d '
    - ' -d '
- condition: selection
  selection:
    CommandLine|contains|all:
    - query
    - \software\
    - /v
    - svcversion
    Image|endswith: \reg.exe
- condition: all of selection_*
  selection_path:
    CommandLine|contains:
    - \AppDataLow\Software\Microsoft\
    - \Policies\Microsoft\Windows\OOBE
    - \Policies\Microsoft\Windows NT\CurrentVersion\Winlogon
    - \SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon
    - \CurrentControlSet\Control\SecurityProviders\WDigest
    - \Microsoft\Windows Defender\
  selection_reg:
  - Image|endswith: \reg.exe
  - OriginalFileName: reg.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - reg
    - ' add '
    - \Services\VSS\Diag
    - /d Disabled
- condition: all of selection_root_* and 1 of selection_dword_*
  selection_dword_0:
    CommandLine|contains:
    - DisallowExploitProtectionOverride
    - EnableControlledFolderAccess
    - MpEnablePus
    - PUAProtection
    - SpynetReporting
    - SubmitSamplesConsent
    - TamperProtection
    CommandLine|contains|all:
    - ' add '
    - d 0
  selection_dword_1:
    CommandLine|contains:
    - DisableAntiSpyware
    - DisableAntiSpywareRealtimeProtection
    - DisableAntiVirus
    - DisableArchiveScanning
    - DisableBehaviorMonitoring
    - DisableBlockAtFirstSeen
    - DisableConfig
    - DisableEnhancedNotifications
    - DisableIntrusionPreventionSystem
    - DisableIOAVProtection
    - DisableOnAccessProtection
    - DisablePrivacyMode
    - DisableRealtimeMonitoring
    - DisableRoutinelyTakingAction
    - DisableScanOnRealtimeEnable
    - DisableScriptScanning
    - Notification_Suppress
    - SignatureDisableUpdateOnStartupWithoutEngine
    CommandLine|contains|all:
    - ' add '
    - d 1
  selection_root_img:
  - Image|endswith: \reg.exe
  - OriginalFileName: reg.exe
  selection_root_path:
    CommandLine|contains:
    - SOFTWARE\Microsoft\Windows Defender\
    - SOFTWARE\Policies\Microsoft\Windows Defender Security Center
    - SOFTWARE\Policies\Microsoft\Windows Defender\
- condition: selection
  selection:
    CommandLine|contains:
    - storage
    - storagedevicepolicies
    CommandLine|contains|all:
    - reg add
    - \system\currentcontrolset\control
    - write protection
    - '0'
- condition: selection
  selection:
  - Product: UltraViewer
  - Company: DucFabulous Co,ltd
  - OriginalFileName: UltraViewer_Desktop.exe
- condition: selection
  selection:
  - Image|endswith: \AnyDesk.exe
  - Description: AnyDesk
  - Product: AnyDesk
  - Company: AnyDesk Software GmbH
- condition: selection
  selection:
    CommandLine|contains|all:
    - '/c '
    - 'echo '
    - .exe --set-password
- condition: selection
  selection:
    CommandLine|contains|all:
    - --install
    - --start-with-win
    - --silent
- condition: selection and not filter
  filter:
    Image|contains:
    - \AppData\
    - Program Files (x86)\AnyDesk
    - Program Files\AnyDesk
  selection:
  - Image|endswith: \AnyDesk.exe
  - Description: AnyDesk
  - Product: AnyDesk
  - Company: AnyDesk Software GmbH
- condition: selection
  selection:
  - Description: GoTo Opener
  - Product: GoTo Opener
  - Company: LogMeIn, Inc.
- condition: selection
  selection:
  - Description: LMIGuardianSvc
  - Product: LMIGuardianSvc
  - Company: LogMeIn, Inc.
- condition: selection
  selection:
  - Description: NetSupport Client Configurator
  - Product: NetSupport Remote Control
  - Company: NetSupport Ltd
  - OriginalFileName: PCICFGUI.EXE
- condition: selection and not filter
  filter:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  selection:
  - Image|endswith: \client32.exe
  - Product|contains: NetSupport Remote Control
  - OriginalFileName|contains: client32.exe
  - Imphash: a9d50692e95b79723f3e76fcf70d023e
  - Hashes|contains: IMPHASH=a9d50692e95b79723f3e76fcf70d023e
- condition: selection and not filter
  filter:
    Image|startswith:
    - C:\Program Files\Remote Utilities
    - C:\Program Files (x86)\Remote Utilities
  selection:
  - Image|endswith:
    - \rutserv.exe
    - \rfusclient.exe
  - Product: Remote Utilities
- condition: selection
  selection:
  - Description: ScreenConnect Service
  - Product: ScreenConnect
  - Company: ScreenConnect Software
- condition: selection
  selection:
    CommandLine|contains|all:
    - e=Access&
    - y=Guest&
    - '&p='
    - '&c='
    - '&k='
- condition: selection
  selection:
    Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    ParentImage|endswith: ScreenConnect.ClientService.exe
- condition: 1 of selection_*
  selection_time:
    CommandLine|contains: time
    Image|endswith:
    - \net.exe
    - \net1.exe
  selection_w32tm:
    CommandLine|contains: tz
    Image|endswith: \w32tm.exe
- condition: 1 of selection* and not filter
  filter:
    Image|endswith: \AdFind.exe
  selection_1:
    CommandLine|contains:
    - domainlist
    - trustdmp
    - dcmodes
    - adinfo
    - ' dclist '
    - computer_pwdnotreqd
    - objectcategory=
    - -subnets -f
    - name="Domain Admins"
    - '-sc u:'
    - domainncs
    - dompol
    - ' oudmp '
    - subnetdmp
    - gpodmp
    - fspdmp
    - users_noexpire
    - computers_active
    - computers_pwdnotreqd
  selection_2:
  - Imphash:
    - bca5675746d13a1f246e2da3c2217492
    - 53e117a96057eaf19c41380d0e87f1c2
  - Hashes|contains:
    - IMPHASH=BCA5675746D13A1F246E2DA3C2217492
    - IMPHASH=53E117A96057EAF19C41380D0E87F1C2
  selection_3:
    OriginalFileName: AdFind.exe
- condition: selection and not filter
  filter:
  - Image|endswith:
    - \AutoHotkey.exe
    - \AutoHotkey32.exe
    - \AutoHotkey32_UIA.exe
    - \AutoHotkey64.exe
    - \AutoHotkey64_UIA.exe
    - \AutoHotkeyA32.exe
    - \AutoHotkeyA32_UIA.exe
    - \AutoHotkeyU32.exe
    - \AutoHotkeyU32_UIA.exe
    - \AutoHotkeyU64.exe
    - \AutoHotkeyU64_UIA.exe
  - Image|contains: \AutoHotkey
  selection:
  - Product|contains: AutoHotkey
  - Description|contains: AutoHotkey
  - OriginalFileName:
    - AutoHotkey.exe
    - AutoHotkey.rc
- condition: 1 of selection_* and not 1 of filter_main_*
  filter_main_legit_name:
    Image|contains: AutoIt
  selection_1:
    CommandLine|contains:
    - ' /AutoIt3ExecuteScript'
    - ' /ErrorStdOut'
  selection_2:
  - Imphash:
    - fdc554b3a8683918d731685855683ddf
    - cd30a61b60b3d60cecdb034c8c83c290
  - Hashes|contains:
    - IMPHASH=FDC554B3A8683918D731685855683DDF
    - IMPHASH=CD30A61B60B3D60CECDB034C8C83C290
  selection_3:
    OriginalFileName:
    - AutoIt3.exe
    - AutoIt2.exe
- condition: selection and not filter
  filter:
    Image|endswith:
    - \cmd.exe
    - \conhost.exe
    - \7z.exe
    - \WinRAR.exe
    - \wevtutil.exe
    - \net.exe
    - \net1.exe
    - \netsh.exe
    - \InstallUtil.exe
  selection:
    OriginalFileName:
    - Cmd.Exe
    - CONHOST.EXE
    - 7z.exe
    - WinRAR.exe
    - wevtutil.exe
    - net.exe
    - net1.exe
    - netsh.exe
    - InstallUtil.exe
- condition: selection and not filter
  filter:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \powershell_ise.exe
    - \psexec.exe
    - \psexec64.exe
    - \PSEXESVC.exe
    - \cscript.exe
    - \wscript.exe
    - \mshta.exe
    - \regsvr32.exe
    - \wmic.exe
    - \certutil.exe
    - \rundll32.exe
    - \cmstp.exe
    - \msiexec.exe
    - \reg.exe
  selection:
  - Description: Execute processes remotely
  - Product: Sysinternals PsExec
  - Description|startswith:
    - Windows PowerShell
    - pwsh
  - OriginalFileName:
    - powershell.exe
    - pwsh.dll
    - powershell_ise.exe
    - psexec.exe
    - psexec.c
    - psexesvc.exe
    - cscript.exe
    - wscript.exe
    - mshta.exe
    - regsvr32.exe
    - wmic.exe
    - certutil.exe
    - rundll32.exe
    - cmstp.exe
    - msiexec.exe
    - reg.exe
- condition: selection and not 1 of filter_*
  filter_realbrowsercore:
    Image|endswith: \BrowserCore.exe
  selection:
    OriginalFileName: BrowserCore.exe
- condition: 1 of selection_* and not filter
  filter:
    Image|endswith: \createdump.exe
  selection_cli:
  - CommandLine|contains|all:
    - ' -u '
    - ' -f '
    - .dmp
  - CommandLine|contains|all:
    - ' --full '
    - ' --name '
    - .dmp
  selection_pe:
    OriginalFileName: FX_VER_INTERNALNAME_STR
- condition: selection and not filter
  filter:
    Image|endswith: \dctask64.exe
  selection:
    Hashes|contains: 6834B1B94E49701D77CCB3C0895E1AFD
- condition: selection_original and not filter_img
  filter_img:
    Image|endswith: \ftp.exe
  selection_original:
    OriginalFileName: ftp.exe
- condition: selection and not filter
  filter:
    Image|endswith: \jusched.exe
  selection:
    Description:
    - Java Update Scheduler
    - Java(TM) Update Scheduler
- condition: selection and not filter
  filter:
    Image|endswith:
    - \mavinject32.exe
    - \mavinject64.exe
  selection:
    OriginalFileName:
    - mavinject32.exe
    - mavinject64.exe
- condition: selection and not filter
  filter:
    Image|endswith: \megasync.exe
  selection:
    OriginalFileName: megasync.exe
- condition: selection and not filter
  filter:
    Image|endswith: \msdt.exe
  selection:
    OriginalFileName: msdt.exe
- condition: selection and not filter
  filter:
    Image|endswith: \client32.exe
  selection:
  - Product|contains: NetSupport Remote Control
  - OriginalFileName|contains: client32.exe
  - Imphash: a9d50692e95b79723f3e76fcf70d023e
  - Hashes|contains: IMPHASH=A9D50692E95B79723F3E76FCF70D023E
- condition: selection and not filter
  filter:
    Image|endswith:
    - \EXCEL.exe
    - \MSACCESS.exe
    - \ONENOTE.EXE
    - \POWERPNT.EXE
    - \WINWORD.exe
  selection:
  - OriginalFileName:
    - Excel.exe
    - MSACCESS.EXE
    - OneNote.exe
    - POWERPNT.EXE
    - WinWord.exe
  - Description:
    - Microsoft Access
    - Microsoft Excel
    - Microsoft OneNote
    - Microsoft PowerPoint
    - Microsoft Word
- condition: selection and not filter
  filter:
  - Image|endswith: \paexec.exe
  - Image|startswith: C:\Windows\PAExec-
  selection:
  - Description: PAExec Application
  - OriginalFileName: PAExec.exe
  - Product|contains: PAExec
  - Imphash:
    - 11D40A7B7876288F919AB819CC2D9802
    - 6444f8a34e99b8f7d9647de66aabe516
    - dfd6aa3f7b2b1035b76b718f1ddc689f
    - 1a6cca4d5460b1710a12dea39e4a592c
  - Hashes|contains:
    - IMPHASH=11D40A7B7876288F919AB819CC2D9802
    - IMPHASH=6444f8a34e99b8f7d9647de66aabe516
    - IMPHASH=dfd6aa3f7b2b1035b76b718f1ddc689f
    - IMPHASH=1a6cca4d5460b1710a12dea39e4a592c
- condition: selection and not filter
  filter:
    Image|endswith: \plink.exe
  selection:
  - OriginalFileName: Plink
  - CommandLine|contains|all:
    - ' -l forward'
    - ' -P '
    - ' -R '
- condition: selection and not 1 of filter_main_*
  filter_main_legit_name:
    Image|endswith: \Microsoft.NodejsTools.PressAnyKey.exe
  selection:
    OriginalFileName: Microsoft.NodejsTools.PressAnyKey.exe
- condition: selection and not filter
  filter:
    Image|endswith: \rundll32.exe
  selection:
    CommandLine|contains: DllRegisterServer
- condition: selection and not filter
  filter:
    Image|endswith:
    - \rutserv.exe
    - \rfusclient.exe
  selection:
    Product: Remote Utilities
- condition: selection and not filter
  filter:
    Image|endswith: \Dbgview.exe
    OriginalFileName: Dbgview.exe
  selection:
    Product: Sysinternals DebugView
- condition: (selection_org or all of selection_args_*) and not filter
  filter:
    Image|endswith:
    - \procdump.exe
    - \procdump64.exe
  selection_args_ma:
    CommandLine|contains:
    - ' -ma '
    - ' /ma '
  selection_args_other:
    CommandLine|contains:
    - ' -accepteula '
    - ' /accepteula '
  selection_org:
    OriginalFileName: procdump
- condition: selection and not filter
  filter:
    Image: C:\Windows\PSEXESVC.exe
  selection:
    OriginalFileName: psexesvc.exe
- condition: selection and not filter
  filter:
    Image|endswith:
    - \sdelete.exe
    - \sdelete64.exe
  selection:
    OriginalFileName: sdelete.exe
- condition: selection and not 1 of filter_*
  filter_rename:
    Image|endswith: vmnat.exe
  selection:
    OriginalFileName: vmnat.exe
- condition: selection and not filter
  filter:
    Image|endswith: \whoami.exe
  selection:
    OriginalFileName: whoami.exe
- condition: use_rpcping and remote_server and ntlm_auth
  ntlm_auth:
  - CommandLine|contains|all:
    - -u
    - NTLM
  - CommandLine|contains|all:
    - /u
    - NTLM
  - CommandLine|contains|all:
    - -t
    - ncacn_np
  - CommandLine|contains|all:
    - /t
    - ncacn_np
  remote_server:
    CommandLine|contains:
    - -s
    - /s
  use_rpcping:
    Image|endswith: \rpcping.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' -e'
  selection_img:
  - Image|endswith: \ruby.exe
  - OriginalFileName: ruby.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|re: '[Rr][Uu][Nn][Dd][Ll][Ll]32(\.[Ee][Xx][Ee])? \S+?\w:\S+?:'
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: all of selection_*
  selection_cli_dll:
    CommandLine|contains: advpack
  selection_cli_ordinal:
  - CommandLine|contains|all:
    - '#+'
    - '12'
  - CommandLine|contains: '#-'
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
  - CommandLine|contains: rundll32
- condition: all of selection_* and not 1 of filter_*
  filter_edge:
    CommandLine|contains|all:
    - EDGEHTML.dll
    - '#141'
  filter_vsbuild_dll:
    CommandLine|contains:
    - \FileTracker32.dll,#1
    - \FileTracker32.dll",#1
    - \FileTracker64.dll,#1
    - \FileTracker64.dll",#1
    ParentImage|contains:
    - \Msbuild\Current\Bin\
    - \VC\Tools\MSVC\
    - \Tracker.exe
  selection_cli:
    CommandLine|contains:
    - ',#'
    - ', #'
    - '.dll #'
    - '.ocx #'
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: selection and not 1 of filter_*
  filter_avira:
    CommandLine|contains|all:
    - C:\Windows\Installer\MSI
    - .tmp
    - zzzzInvokeManagedCustomActionOutOfProc
    - Avira.OE.Setup
  filter_edge_update:
    ParentCommandLine|contains: \setup.exe" --install-archive="C:\Users\
    ParentImage|contains: \AppData\Local\Microsoft\EdgeUpdate\Install\{
    ParentImage|endswith: \setup.exe
    ParentImage|startswith: C:\Users\
  filter_empty:
    CommandLine: null
  filter_generic:
  - CommandLine|contains: .dll
  - CommandLine: ''
  filter_iexplore:
    CommandLine|contains: .cpl
    ParentImage|endswith: :\Program Files\Internet Explorer\iexplore.exe
  filter_localserver_fp:
    CommandLine|contains: ' -localserver '
  filter_mcafee:
  - ParentCommandLine|startswith: 'C:\Windows\system32\rundll32.exe" "C:\Program Files\McAfee\MSC\mcmscins.dll",DllUninstallFunction '
  - CommandLine|startswith: C:\Windows\system32\rundll32.exe" /uninstall /longpath
      "C:\Program Files\McAfee\MSC\mscrem.inf
  filter_msiexec_system32:
    ParentCommandLine|startswith: C:\Windows\system32\MsiExec.exe -Embedding
    ParentImage|endswith: :\Windows\System32\msiexec.exe
  filter_msiexec_syswow64:
    ParentCommandLine|startswith: C:\Windows\syswow64\MsiExec.exe -Embedding
    ParentImage|endswith: :\Windows\SysWOW64\msiexec.exe
  filter_parent_null:
    CommandLine|startswith: C:\Windows\system32\rundll32.exe C:\Windows\system32\inetcpl.cpl,ClearMyTracksByProcess
  filter_splunk_ufw:
    ParentCommandLine|contains: ' C:\Program Files\SplunkUniversalForwarder\'
    ParentImage|endswith: :\Windows\System32\cmd.exe
  selection:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: selection
  selection:
    CommandLine|contains|all:
    - rundll32.exe
    - Execute
    - RegRead
    - window.close
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: InstallScreenSaver
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: 1 of selection*
  selection1:
    CommandLine|contains|all:
    - rundll32
    - javascript
    - ..\..\mshtml,RunHTMLApplication
  selection2:
    CommandLine|contains: ;files.write();GetObject("script
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - keymgr
    - KRShowKeyMgr
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: selection
  selection:
    CommandLine|contains|all:
    - \..\
    - mshtml
    - RunHTMLApplication
- condition: selection and not 1 of filter*
  filter1:
    ParentImage|endswith: \svchost.exe
  filter2:
    ParentImage|contains:
    - \AppData\Local\
    - \Microsoft\Edge\
  selection:
    CommandLine|endswith: \rundll32.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - spoolss
    - srvsvc
    - /print/pipe/
    CommandLine|contains|all:
    - C:\windows\system32\davclnt.dll,DavSetCookie
    - http
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - '#+'
    - '#-'
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
  - CommandLine|contains: rundll32
- condition: all of selection_* and not filter
  filter:
  - CommandLine|contains: ' C:\Windows\System32\'
  - CommandLine|endswith: ' -localserver 22d8c27b-47a1-48d1-ad08-7da7abd79617'
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
  selection_parent:
    ParentImage|endswith: \explorer.exe
- condition: (selection_img and 1 of selection_cli_*) or selection_generic
  selection_cli_1:
    CommandLine|contains:
    - '#-'
    - '#+'
    - '#24'
    - '24 '
    - MiniDump
    CommandLine|contains|all:
    - comsvcs
    - full
  selection_generic:
    CommandLine|contains:
    - ' #'
    - ',#'
    - ', #'
    CommandLine|contains|all:
    - '24'
    - comsvcs
    - full
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
  - CommandLine|contains: rundll32
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - '-sta '
    - '-localserver '
    CommandLine|contains|all:
    - '{'
    - '}'
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: selection
  selection:
  - Image|contains:
    - :\RECYCLER\
    - :\SystemVolumeInformation\
  - Image|startswith:
    - C:\Windows\Tasks\
    - C:\Windows\debug\
    - C:\Windows\fonts\
    - C:\Windows\help\
    - C:\Windows\drivers\
    - C:\Windows\addins\
    - C:\Windows\cursors\
    - C:\Windows\system32\tasks\
- condition: all of selection*
  selection1:
    CommandLine|contains: rundll32
  selection2:
    CommandLine|contains:
    - mshtml,RunHTMLApplication
    - mshtml,#135
  selection3:
    CommandLine|contains:
    - 'javascript:'
    - 'vbscript:'
- condition: selection
  selection:
    Image|endswith: \runonce.exe
    ParentCommandLine|contains|all:
    - setupapi.dll
    - InstallHinfSection
    ParentImage|endswith: \rundll32.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - '%AppData%'
    - '%LocalAppData%'
    - '%Temp%'
    - '%tmp%'
    - \AppData\
    - \Temp\
    - \Users\Public\
    CommandLine|contains|all:
    - shell32.dll
    - Control_RunDLL
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: RunDll_ShellExecuteW
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: selection and not filter
  filter:
    ParentCommandLine|contains: \shell32.dll,Control_RunDLL
  selection:
    Image|endswith: \explorer.exe
    ParentImage|endswith: \rundll32.exe
- condition: selection and not 1 of filter_main_*
  filter_main_parent_cpl:
    CommandLine|contains|all:
    - Shell32.dll
    - Control_RunDLL
    - .cpl
    ParentCommandLine|contains: .cpl
    ParentImage: C:\Windows\System32\control.exe
  filter_main_screensaver:
    CommandLine|contains: shell32.dll,Control_RunDLL desk.cpl,screensaver,@screensaver
  filter_main_startmenu:
    CommandLine|endswith: .cpl",
    CommandLine|startswith: '"C:\Windows\system32\rundll32.exe" Shell32.dll,Control_RunDLL
      "C:\Windows\System32\'
    ParentImage: C:\Windows\System32\control.exe
  selection:
  - CommandLine|contains|all:
    - 'javascript:'
    - .RegisterXLL
  - CommandLine|contains|all:
    - url.dll
    - OpenURL
  - CommandLine|contains|all:
    - url.dll
    - OpenURLA
  - CommandLine|contains|all:
    - url.dll
    - FileProtocolHandler
  - CommandLine|contains|all:
    - zipfldr.dll
    - RouteTheCall
  - CommandLine|contains|all:
    - shell32.dll
    - Control_RunDLL
  - CommandLine|contains|all:
    - shell32.dll
    - ShellExec_RunDLL
  - CommandLine|contains|all:
    - mshtml.dll
    - PrintHTML
  - CommandLine|contains|all:
    - advpack.dll
    - LaunchINFSection
  - CommandLine|contains|all:
    - advpack.dll
    - RegisterOCX
  - CommandLine|contains|all:
    - ieadvpack.dll
    - LaunchINFSection
  - CommandLine|contains|all:
    - ieadvpack.dll
    - RegisterOCX
  - CommandLine|contains|all:
    - ieframe.dll
    - OpenURL
  - CommandLine|contains|all:
    - shdocvw.dll
    - OpenURL
  - CommandLine|contains|all:
    - syssetup.dll
    - SetupInfObjectInstallAction
  - CommandLine|contains|all:
    - setupapi.dll
    - InstallHinfSection
  - CommandLine|contains|all:
    - pcwutl.dll
    - LaunchApplication
  - CommandLine|contains|all:
    - dfshim.dll
    - ShOpenVerbApplication
  - CommandLine|contains|all:
    - dfshim.dll
    - ShOpenVerbShortcut
  - CommandLine|contains|all:
    - scrobj.dll
    - GenerateTypeLib
    - http
  - CommandLine|contains|all:
    - shimgvw.dll
    - ImageView_Fullscreen
    - http
  - CommandLine|contains|all:
    - comsvcs.dll
    - MiniDump
- condition: all of selection_* and not filter
  filter:
    CommandLine|contains: Shell32.dll
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
  selection_parent:
    ParentImage|endswith: \System32\control.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - .bmp
    - .cr2
    - .eps
    - .gif
    - .ico
    - .jpeg
    - .jpg
    - .nef
    - .orf
    - .png
    - .raw
    - .sr2
    - .tif
    - .tiff
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.exe
- condition: all of selection_*
  selection_openasrundll:
    CommandLine|contains: ShellExec_RunDLL
  selection_suspcli:
    CommandLine|contains:
    - regsvr32
    - msiexec
    - \Users\Public\
    - odbcconf
    - \Desktop\
    - \Temp\
    - Invoke-
    - iex
    - comspec
- condition: ( selection1a and selection1b ) or ( selection2a and selection2b )
  selection1a:
    CommandLine|contains|all:
    - rundll32
    - apphelp.dll
  selection1b:
    CommandLine|contains:
    - ShimFlushCache
    - '#250'
  selection2a:
    CommandLine|contains|all:
    - rundll32
    - kernel32.dll
  selection2b:
    CommandLine|contains:
    - BaseFlushAppcompatCache
    - '#46'
- condition: all of selection*
  selection1:
    CommandLine|contains: rundll32.exe
  selection2:
    CommandLine|contains:
    - .sys,
    - '.sys '
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' \\\\'
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
  - CommandLine|contains: rundll32
- condition: all of selection_*
  selection_call_cli:
    CommandLine|contains: user32.dll,
  selection_call_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
  selection_call_parent:
    ParentImage|endswith: \cmd.exe
  selection_function:
    CommandLine|contains: LockWorkStation
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: C:\windows\system32\davclnt.dll,DavSetCookie
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: selection and not 1 of filter_*
  filter_local_ips:
    CommandLine|contains:
    - ://10.
    - ://192.168.
    - ://172.16.
    - ://172.17.
    - ://172.18.
    - ://172.19.
    - ://172.20.
    - ://172.21.
    - ://172.22.
    - ://172.23.
    - ://172.24.
    - ://172.25.
    - ://172.26.
    - ://172.27.
    - ://172.28.
    - ://172.29.
    - ://172.30.
    - ://172.31.
    - ://127.
    - ://169.254.
  selection:
    CommandLine|contains: C:\windows\system32\davclnt.dll,DavSetCookie
    CommandLine|re: ://\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}
    Image|endswith: \rundll32.exe
    ParentCommandLine|contains: -s WebClient
    ParentImage|endswith: \svchost.exe
- condition: selection
  selection:
    CommandLine:
    - rundll32.exe
    - rundll32
- condition: all of selection_*
  selection_cli:
  - CommandLine|contains: /AlternateShellStartup
  - CommandLine|endswith: /r
  selection_img:
  - Image|endswith: \runonce.exe
  - Description: Run Once Wrapper
- condition: selection and not filter
  filter:
    CommandLine|contains: /TN TVInstallRestore
    Image|endswith: \schtasks.exe
    ParentImage|contains|all:
    - \AppData\Local\Temp\
    - TeamViewer_.exe
  selection:
    CommandLine|contains:
    - NT AUT
    - ' SYSTEM '
    CommandLine|contains|all:
    - /Create
    - /RU
    - /TR
    - C:\Users\
    - \AppData\Local\
    Image|endswith: \schtasks.exe
- condition: all of selection_*
  selection_schtasks:
    CommandLine|contains|all:
    - ' /Change '
    - ' /TN '
    Image|endswith: \schtasks.exe
  selection_susp_images:
    CommandLine|contains:
    - regsvr32
    - rundll32
    - 'cmd /c '
    - 'cmd /k '
    - 'cmd /r '
    - 'cmd.exe /c '
    - 'cmd.exe /k '
    - 'cmd.exe /r '
    - powershell
    - mshta
    - wscript
    - cscript
    - certutil
    - bitsadmin
    - bash.exe
    - 'bash '
    - scrcons
    - 'wmic '
    - wmic.exe
    - forfiles
    - scriptrunner
    - hh.exe
    - 'hh '
  selection_susp_locations:
    CommandLine|contains:
    - \AppData\Local\Temp
    - \AppData\Roaming\
    - \Users\Public\
    - \WINDOWS\Temp\
    - \Desktop\
    - \Downloads\
    - \Temporary Internet
    - C:\ProgramData\
    - C:\Perflogs\
    - '%ProgramData%'
    - '%appdata%'
    - '%comspec%'
    - '%localappdata%'
- condition: selection and not filter
  filter:
    User|contains:
    - AUTHORI
    - AUTORI
  selection:
    CommandLine|contains: ' /create '
    Image|endswith: \schtasks.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' /create '
    - ' /sc once '
    - \Temp\
    Image|endswith: \schtasks.exe
- condition: all of schtasks_*
  schtasks_exe:
    CommandLine|contains:
    - \Windows\SystemRestore\SR
    - \Windows\Windows Defender\
    - \Windows\BitLocker
    - \Windows\WindowsBackup\
    - \Windows\WindowsUpdate\
    - \Windows\UpdateOrchestrator\
    - \Windows\ExploitGuard
    CommandLine|contains|all:
    - /delete
    - /tn
    Image|endswith: \schtasks.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - ' /delete '
    - /tn \*
    - ' /f'
    Image|endswith: \schtasks.exe
- condition: all of schtasks_*
  schtasks_exe:
    CommandLine|contains:
    - \Windows\SystemRestore\SR
    - \Windows\Windows Defender\
    - \Windows\BitLocker
    - \Windows\WindowsBackup\
    - \Windows\WindowsUpdate\
    - \Windows\UpdateOrchestrator\
    - \Windows\ExploitGuard
    CommandLine|contains|all:
    - /Change
    - /TN
    - /disable
    Image|endswith: \schtasks.exe
- condition: ( all of selection1* or all of selection2* ) and not 1 of filter*
  filter_avira_install:
    CommandLine|contains|all:
    - /Create /Xml "C:\Users\
    - \AppData\Local\Temp\.CR.
    - Avira_Security_Installation.xml
  filter_avira_other:
    CommandLine|contains:
    - .tmp\UpdateFallbackTask.xml
    - .tmp\WatchdogServiceControlManagerTimeout.xml
    - .tmp\SystrayAutostart.xml
    - .tmp\MaintenanceTask.xml
    CommandLine|contains|all:
    - /Create /F /TN
    - '/Xml '
    - \AppData\Local\Temp\is-
    - Avira_
  filter_klite_codec:
    CommandLine|contains|all:
    - \AppData\Local\Temp\
    - '/Create /TN "klcp_update" /XML '
    - \klcp_update_task.xml
  filter_mixed:
  - CommandLine|contains:
    - update_task.xml
    - /Create /TN TVInstallRestore /TR
  - ParentCommandLine|contains: unattended.ini
  selection1_all_folders:
    CommandLine|contains:
    - '%AppData%'
    - \AppData\Local\
    - \AppData\Roaming\
    - '%Public%'
    - \Users\Public
    - C:\Windows\Temp
    - C:\Perflogs
  selection1_create:
    CommandLine|contains: ' /create '
    Image|endswith: \schtasks.exe
  selection2_parent:
    ParentCommandLine|endswith: \svchost.exe -k netsvcs -p -s Schedule
  selection2_some_folders:
    CommandLine|contains:
    - '%Public%'
    - \Users\Public
    - C:\Windows\Temp
    - C:\Perflogs
- condition: all of selection_*
  selection_all_folders:
    CommandLine|contains:
    - C:\ProgramData\
    - '%ProgramData%'
  selection_command:
    CommandLine|contains:
    - powershell
    - pwsh
    - 'cmd /c '
    - 'cmd /k '
    - 'cmd /r '
    - 'cmd.exe /c '
    - 'cmd.exe /k '
    - 'cmd.exe /r '
  selection_create:
    CommandLine|contains: ' /create '
  selection_img:
  - Image|endswith: \schtasks.exe
  - OriginalFileName: schtasks.exe
- condition: all of selection_*
  selection_end:
    CommandLine|contains:
    - '}"'
    - '}'''
    - '} '
  selection_img:
    CommandLine|contains: '/Create '
    Image|endswith: \schtasks.exe
  selection_tn:
    CommandLine|contains:
    - /TN "{
    - /TN '{
    - /TN {
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - wscript
    - vbscript
    - cscript
    - 'wmic '
    - wmic.exe
    - regsvr32.exe
    - powershell
    - \AppData\
  selection_img:
  - Image|contains: \schtasks.exe
  - OriginalFileName: schtasks.exe
  selection_time:
    CommandLine|contains|all:
    - once
    - 00:00
- condition: selection and not 1 of filter*
  filter:
    CommandLine|contains:
    - update_task.xml
    - unattended.ini
  selection:
    CommandLine|contains: '/Create '
    Image|endswith: \schtasks.exe
    ParentImage|contains:
    - \AppData\Local\
    - \AppData\Roaming\
    - \Temporary Internet
    - \Users\Public\
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - 'run '
    - \Application Experience\Microsoft Compatibility Appraiser
  selection_img:
  - Image|endswith: \schtasks.exe
  - OriginalFileName: schtasks.exe
- condition: selection
  selection:
    CommandLine|endswith:
    - ' -windowstyle hidden'
    - ' -w hidden'
    - ' -ep bypass'
    - ' -noni'
    ParentCommandLine|contains|all:
    - -k netsvcs
    - -s Schedule
    ParentImage: C:\WINDOWS\System32\svchost.exe
- condition: all of selection_* and not 1 of filter_*
  filter_main_encoding:
    CommandLine|contains:
    - FromBase64String
    - encodedcommand
  selection_cli_create:
    CommandLine|contains: /Create
  selection_cli_get:
    CommandLine|contains:
    - Get-ItemProperty
    - ' gp '
  selection_cli_hive:
    CommandLine|contains:
    - 'HKCU:'
    - 'HKLM:'
    - 'registry::'
    - HKEY_
  selection_img:
  - Image|endswith: \schtasks.exe
  - OriginalFileName: schtasks.exe
- condition: all of selection_*
  selection_cli_create:
    CommandLine|contains: /Create
  selection_cli_encoding:
    CommandLine|contains:
    - FromBase64String
    - encodedcommand
  selection_cli_get:
    CommandLine|contains:
    - Get-ItemProperty
    - ' gp '
  selection_cli_hive:
    CommandLine|contains:
    - 'HKCU:'
    - 'HKLM:'
    - 'registry::'
    - HKEY_
  selection_img:
  - Image|endswith: \schtasks.exe
  - OriginalFileName: schtasks.exe
- condition: all of selection_* and not 1 of filter_*
  filter_privs:
    CommandLine|contains:
    - NT AUT
    - ' SYSTEM'
    - HIGHEST
  selection_img:
  - Image|endswith: \schtasks.exe
  - OriginalFileName: schtasks.exe
  selection_time:
    CommandLine|contains:
    - ' ONLOGON '
    - ' ONSTART '
    - ' ONCE '
    - ' ONIDLE '
- condition: all of selection_*
  selection_img:
  - Image|endswith: \schtasks.exe
  - OriginalFileName: schtasks.exe
  selection_privs:
    CommandLine|contains:
    - NT AUT
    - ' SYSTEM'
    - HIGHEST
  selection_time:
    CommandLine|contains:
    - ' ONLOGON '
    - ' ONSTART '
    - ' ONCE '
    - ' ONIDLE '
- condition: all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_extension_xml:
    CommandLine|contains: .xml
  filter_main_rundll32:
    ParentCommandLine|contains|all:
    - :\WINDOWS\Installer\MSI
    - .tmp,zzzzInvokeManagedCustomActionOutOfProc
    ParentImage|endswith: \rundll32.exe
  filter_main_system_process:
    IntegrityLevel: System
  filter_optional_third_party:
    ParentImage|endswith:
    - :\ProgramData\OEM\UpgradeTool\CareCenter_*\BUnzip\Setup_msi.exe
    - :\Program Files\Axis Communications\AXIS Camera Station\SetupActions.exe
    - :\Program Files\Axis Communications\AXIS Device Manager\AdmSetupActions.exe
    - :\Program Files (x86)\Zemana\AntiMalware\AntiMalware.exe
    - :\Program Files\Dell\SupportAssist\pcdrcui.exe
  selection_cli_create:
    CommandLine|contains:
    - /create
    - -create
  selection_cli_xml:
    CommandLine|contains:
    - /xml
    - -xml
  selection_img:
  - Image|endswith: \schtasks.exe
  - OriginalFileName: schtasks.exe
- condition: selection_schtasks and ( all of selection_pattern_* or selection_uncommon
    or all of selection_anomaly_* )
  selection_anomaly_1:
    CommandLine|contains|all:
    - \AppData\
    - '%AppData%'
    - '%Temp%'
    - '%tmp%'
    - C:\Windows\Temp\
  selection_anomaly_2:
    CommandLine|contains|all:
    - /xml C:\Users\
    - cscript
    - curl
    - wscript
  selection_pattern_1:
    CommandLine|contains:
    - '/sc minute '
    - '/ru system '
  selection_pattern_2:
    CommandLine|contains:
    - cmd /c
    - cmd /k
    - cmd /r
    - 'cmd.exe /c '
    - 'cmd.exe /k '
    - 'cmd.exe /r '
  selection_schtasks:
    CommandLine|contains: '/Create '
    Image|endswith: \schtasks.exe
  selection_uncommon:
    CommandLine|contains:
    - ' -decode '
    - ' -enc '
    - ' -w hidden '
    - ' bypass '
    - ' IEX'
    - .DownloadData
    - .DownloadFile
    - .DownloadString
    - '/c start /min '
    - FromBase64String
    - mshta http
    - mshta.exe http
- condition: all of selection_* and not 1 of filter_*
  filter_avira:
    CommandLine|contains:
    - '/Create /F /RU System /SC WEEKLY /TN AviraSystemSpeedupVerify /TR '
    - C:\Program Files (x86)\Avira\System Speedup\setup\avira_speedup_setup.exe
    - /VERIFY /VERYSILENT /NOSTART /NODOTNET /NORESTART" /RL HIGHEST
  filter_teamviewer:
    CommandLine|contains: /TN TVInstallRestore
    Image|endswith: \schtasks.exe
    ParentImage|contains|all:
    - \AppData\Local\Temp\
    - TeamViewer_.exe
  selection_root:
    CommandLine|contains:
    - ' /change '
    - ' /create '
    Image|endswith: \schtasks.exe
  selection_run:
    CommandLine|contains: '/ru '
  selection_user:
    CommandLine|contains:
    - NT AUT
    - ' SYSTEM '
- condition: selection
  selection:
    Image|endswith:
    - \svchost.exe
    - \dllhost.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
    - \cscript.exe
    - \schtasks.exe
    - \regsvr32.exe
    - \mshta.exe
    - \rundll32.exe
    - \msiexec.exe
    - \msbuild.exe
    ParentImage|endswith: \scrcons.exe
- condition: scbynonadmin and 1 of selection_*
  scbynonadmin:
    Image|endswith: \sc.exe
    IntegrityLevel: Medium
  selection_binpath:
    CommandLine|contains|all:
    - config
    - binPath
  selection_failure:
    CommandLine|contains|all:
    - failure
    - command
- condition: selection
  selection:
    CommandLine|contains|all:
    - create
    - binPath
    Image|endswith: \sc.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - disabled
    - demand
    CommandLine|contains|all:
    - ' config '
    - start
  selection_img:
  - Image|endswith: \sc.exe
  - OriginalFileName: sc.exe
- condition: selection
  selection:
    CommandLine|contains:
    - create
    - config
    CommandLine|contains|all:
    - binPath
    - type
    - kernel
    Image|endswith: \sc.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' query'
  selection_img:
    Image|endswith: \sc.exe
    OriginalFileName|endswith: sc.exe
- condition: all of selection_*
  selection_sc:
  - Image|endswith: \sc.exe
  - OriginalFileName: sc.exe
  selection_sdset:
    CommandLine|contains|all:
    - sdset
    - A;
  selection_trustee:
    CommandLine|contains:
    - ;IU
    - ;SU
    - ;BA
    - ;SY
    - ;WD
- condition: all of selection_*
  selection_sc:
  - Image|endswith: \sc.exe
  - OriginalFileName: sc.exe
  selection_sdset:
    CommandLine|contains|all:
    - sdset
    - D;
  selection_trustee:
    CommandLine|contains:
    - ;IU
    - ;SU
    - ;BA
    - ;SY
    - ;WD
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - sdset
    - DCLCWPDTSD
  selection_img:
  - Image|endswith: \sc.exe
  - OriginalFileName: sc.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: sdset
  selection_img:
  - Image|endswith: \sc.exe
  - OriginalFileName: sc.exe
- condition: selection
  selection:
    CommandLine|contains:
    - powershell
    - 'cmd '
    - mshta
    - wscript
    - cscript
    - rundll32
    - svchost
    - dllhost
    - cmd.exe /c
    - cmd.exe /k
    - cmd.exe /r
    - cmd /c
    - cmd /k
    - cmd /r
    - C:\Users\Public
    - \Downloads\
    - \Desktop\
    - \Microsoft\Windows\Start Menu\Programs\Startup\
    - C:\Windows\TEMP\
    - \AppData\Local\Temp
    CommandLine|contains|all:
    - config
    - binPath
    Image|endswith: \sc.exe
- condition: selection_sc or all of selection_reg_*
  selection_reg_ext:
    CommandLine|contains:
    - .sh
    - .exe
    - .dll
    - .bin$
    - .bat
    - .cmd
    - .js
    - .msh$
    - .reg$
    - .scr
    - .ps
    - .vb
    - .jar
    - .pl
  selection_reg_img:
  - CommandLine|contains|all:
    - 'reg '
    - 'add '
    - FailureCommand
  - CommandLine|contains|all:
    - 'reg '
    - 'add '
    - ImagePath
  selection_sc:
  - CommandLine|contains|all:
    - 'sc '
    - 'config '
    - binpath=
  - CommandLine|contains|all:
    - 'sc '
    - failure
    - command=
- condition: all of selection_* and not 1 of filter_*
  filter_kaspersky:
    CommandLine:
    - sc  stop KSCWebConsoleMessageQueue
    - sc  stop LGHUBUpdaterService
    User|contains:
    - AUTHORI
    - AUTORI
  selection_cli:
    CommandLine|contains: ' stop '
  selection_img:
  - OriginalFileName: sc.exe
  - Image|endswith: \sc.exe
- condition: selection and not filter
  filter:
    CommandLine|contains: iisexpressshim.sdb
  selection:
    CommandLine|contains: .sdb
    Image|endswith: \sdbinst.exe
- condition: selection
  selection:
    ParentImage|endswith: \sdclt.exe
- condition: selection
  selection:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \cmd.exe
    - \mshta.exe
    - \cscript.exe
    - \wscript.exe
    - \taskkill.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \calc.exe
    ParentImage|endswith: \sdiagnhost.exe
- condition: selection_img and (1 of selection_flags_*)
  selection_flags_configure:
    CommandLine|contains|all:
    - /configure
    - /db
  selection_flags_discovery:
    CommandLine|contains|all:
    - /export
    - /cfg
  selection_img:
  - Image|endswith: \secedit.exe
  - OriginalFileName: SeCEdit
- condition: selection
  selection:
    Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
    - \cscript.exe
    - \sh.exe
    - \bash.exe
    - \schtasks.exe
    - \regsvr32.exe
    - \wmic.exe
    - \mshta.exe
    - \rundll32.exe
    - \msiexec.exe
    - \forfiles.exe
    - \scriptrunner.exe
    ParentImage|endswith: \Serv-U.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: -q
  selection_pe:
  - Image|endswith: \setspn.exe
  - OriginalFileName: setspn.exe
  - Description|contains|all:
    - Query or reset the computer
    - SPN attribute
- condition: selection
  selection:
    CommandLine|contains:
    - '/r '
    - '/s '
    Image|endswith: \shutdown.exe
- condition: selection
  selection:
    CommandLine|contains: /l
    Image|endswith: \shutdown.exe
- condition: selection and not 1 of filter_main_*
  filter_main_rundll32:
    CommandLine|contains: ' shell32.dll,Control_RunDLL '
    Image|endswith: \rundll32.exe
  selection:
    ParentImage|endswith: \SndVol.exe
- condition: selection
  selection:
    CommandLine|contains: /FILE
    Image|endswith: \SoundRecorder.exe
- condition: selection
  selection:
    CommandLine|endswith: splwow64.exe
    Image|endswith: \splwow64.exe
- condition: spoolsv and ( suspicious_unrestricted or (suspicious_net and not suspicious_net_filter)
    or (suspicious_cmd and not suspicious_cmd_filter) or (suspicious_netsh and not
    suspicious_netsh_filter) or (suspicious_powershell and not suspicious_powershell_filter)
    or all of suspicious_rundll32_* )
  spoolsv:
    IntegrityLevel: System
    ParentImage|endswith: \spoolsv.exe
  suspicious_cmd:
    Image|endswith: \cmd.exe
  suspicious_cmd_filter:
    CommandLine|contains:
    - .spl
    - route add
    - program files
  suspicious_net:
    Image|endswith:
    - \net.exe
    - \net1.exe
  suspicious_net_filter:
    CommandLine|contains: start
  suspicious_netsh:
    Image|endswith: \netsh.exe
  suspicious_netsh_filter:
    CommandLine|contains:
    - add portopening
    - rule name
  suspicious_powershell:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  suspicious_powershell_filter:
    CommandLine|contains: .spl
  suspicious_rundll32_cli:
    CommandLine|endswith: rundll32.exe
  suspicious_rundll32_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
  suspicious_unrestricted:
    Image|endswith:
    - \gpupdate.exe
    - \whoami.exe
    - \nltest.exe
    - \taskkill.exe
    - \wmic.exe
    - \taskmgr.exe
    - \sc.exe
    - \findstr.exe
    - \curl.exe
    - \wget.exe
    - \certutil.exe
    - \bitsadmin.exe
    - \accesschk.exe
    - \wevtutil.exe
    - \bcdedit.exe
    - \fsutil.exe
    - \cipher.exe
    - \schtasks.exe
    - \write.exe
    - \wuauclt.exe
    - \systeminfo.exe
    - \reg.exe
    - \query.exe
- condition: all of selection_*
  selection_db:
    CommandLine|contains:
    - BackupRepositories
    - Backups
    - Credentials
    - HostCreds
    - SmbFileShares
    - Ssh_creds
    - VSphereInfo
  selection_sql:
    CommandLine|contains|all:
    - VeeamBackup
    - 'From '
    Image|endswith: \sqlcmd.exe
- condition: all of selection_*
  selection_query:
    CommandLine|contains|all:
    - SELECT
    - TOP
    - '[VeeamBackup].[dbo].[Credentials]'
  selection_tools:
    Image|endswith: \sqlcmd.exe
- condition: all of selection_*
  selection_chromium:
    CommandLine|contains:
    - \User Data\
    - \Opera Software\
    - \ChromiumViewer\
  selection_data:
    CommandLine|contains:
    - Login Data
    - Cookies
    - Web Data
    - History
    - Bookmarks
  selection_sql:
  - Product: SQLite
  - Image|endswith:
    - \sqlite.exe
    - \sqlite3.exe
- condition: all of selection_*
  selection_firefox:
    CommandLine|contains:
    - cookies.sqlite
    - places.sqlite
  selection_sql:
  - Product: SQLite
  - Image|endswith:
    - \sqlite.exe
    - \sqlite3.exe
- condition: selection
  selection:
    CommandLine|contains: ' -R '
    Image|endswith: \ssh.exe
- condition: selection
  selection:
    CommandLine|contains: :3389
    Image|endswith: \ssh.exe
- condition: selection and not filter
  filter:
    ParentImage|startswith:
    - c:\windows\system32\
    - c:\windows\syswow64\
  selection:
    Image|endswith:
    - \schtasks.exe
    - \systeminfo.exe
    - \fltmc.exe
    ParentImage|endswith: \stordiag.exe
- condition: selection
  selection:
    Image|endswith:
    - \ntvdm.exe
    - \csrstub.exe
- condition: all of selection_* and not filter
  filter:
    CommandLine|contains|all:
    - ' route '
    - ' ADD '
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \cmd.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
    - Cmd.Exe
  selection_parent:
    ParentImage|endswith:
    - \winlogon.exe
    - \services.exe
    - \lsass.exe
    - \csrss.exe
    - \smss.exe
    - \wininit.exe
    - \spoolsv.exe
    - \searchindexer.exe
    User|contains:
    - AUTHORI
    - AUTORI
- condition: all of selection_*
  selection_group:
    CommandLine|contains:
    - ' administrators '
    - ' administrateur'
  selection_main:
  - CommandLine|contains|all:
    - 'localgroup '
    - ' /add'
  - CommandLine|contains|all:
    - 'Add-LocalGroupMember '
    - ' -Group '
- condition: all of selection_*
  selection_group:
    CommandLine|contains:
    - Remote Desktop Users
    - "Utilisateurs du Bureau \xE0 distance"
    - Usuarios de escritorio remoto
  selection_main:
  - CommandLine|contains|all:
    - 'localgroup '
    - ' /add'
  - CommandLine|contains|all:
    - 'Add-LocalGroupMember '
    - ' -Group '
- condition: selection_stream and (1 of selection_tools_*)
  selection_stream:
    CommandLine|contains: 'txt:'
  selection_tools_esentutl:
    CommandLine|contains|all:
    - 'esentutl '
    - ' /y '
    - ' /d '
    - ' /o '
  selection_tools_makecab:
    CommandLine|contains|all:
    - 'makecab '
    - .cab
  selection_tools_reg:
    CommandLine|contains|all:
    - 'reg '
    - ' export '
  selection_tools_regedit:
    CommandLine|contains|all:
    - 'regedit '
    - ' /E '
  selection_tools_type:
    CommandLine|contains|all:
    - 'type '
    - ' > '
- condition: 1 of selection_image_* and selection_user and not 1 of filter_*
  filter_avast:
    ParentImage|startswith:
    - C:\Program Files\Avast Software\
    - C:\Program Files (x86)\Avast Software\
  filter_avira:
    ParentImage|startswith: C:\ProgramData\Avira\
  filter_google_update:
    ParentImage|startswith:
    - C:\Program Files\Google\Update\
    - C:\Program Files (x86)\Google\Update\
  filter_installer:
    ParentImage: C:\Windows\System32\services.exe
  filter_repair:
  - CommandLine|endswith: \system32\msiexec.exe /V
  - ParentCommandLine|endswith: \system32\msiexec.exe /V
  filter_sophos:
    ParentImage|startswith: C:\ProgramData\Sophos\
  selection_image_1:
    Image|contains|all:
    - \Windows\Installer\
    - msi
    Image|endswith: tmp
  selection_image_2:
    Image|endswith: \msiexec.exe
    IntegrityLevel: System
  selection_user:
    User|contains:
    - AUTHORI
    - AUTORI
- condition: selection_parent and 1 of selection_susp_*
  selection_parent:
    ParentImage|contains: C:\Program Files\WindowsApps\
  selection_susp_cli:
    CommandLine|contains:
    - cmd /c
    - Invoke-
    - Base64
  selection_susp_img:
    Image|endswith:
    - \poweshell.exe
    - \pwsh.exe
    - \rundll32.exe
    - \regsvr32.exe
    - \mshta.exe
    - \cscript.exe
    - \wscript.exe
- condition: selection and not filter
  filter:
    CommandLine|contains: immersivecontrolpanel
  selection:
    CommandLine|contains: .SettingContent-ms
- condition: selection
  selection:
    Image|endswith:
    - \isoburn.exe
    - \PowerISO.exe
    - \ImgBurn.exe
    ParentImage|endswith:
    - \Winrar.exe
    - \7zFM.exe
    - \peazip.exe
- condition: selection_ext and 1 of selection_other_*
  selection_ext:
    CommandLine|contains:
    - .files
    - .docx
    - .xls
    - .xlsx
    - .ppt
    - .pptx
    - .rtf
    - .pdf
    - .txt
  selection_other_dir:
    CommandLine|contains|all:
    - 'dir '
    - ' /b '
    - ' /s '
  selection_other_findstr:
    CommandLine|contains:
    - ' /e '
    - ' /si '
    OriginalFileName: FINDSTR.EXE
- condition: 1 of selection* and not 1 of filter*
  filter_edge_update:
    ParentCommandLine|contains: \setup.exe" --install-archive="C:\Users\
    ParentImage|contains: \AppData\Local\Microsoft\EdgeUpdate\Install\{
    ParentImage|endswith: \setup.exe
    ParentImage|startswith: C:\Users\
  selection1:
    CommandLine|endswith: WerFault.exe
    Image|endswith: \WerFault.exe
  selection2:
    CommandLine|endswith: rundll32.exe
    Image|endswith: \rundll32.exe
  selection3:
    CommandLine|endswith: regsvcs.exe
    Image|endswith: \regsvcs.exe
  selection4:
    CommandLine|endswith: regasm.exe
    Image|endswith: \regasm.exe
  selection5:
    CommandLine|endswith: regsvr32.exe
    Image|endswith: \regsvr32.exe
- condition: selection_1 or ( selection_2 and not filter_2 )
  filter_2:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  selection_1:
    CommandLine|contains: '\calc.exe '
  selection_2:
    Image|endswith: \calc.exe
- condition: selection and not 1 of filter_*
  filter_rundll32:
    CommandLine|contains: DavSetCookie
    Image|endswith: \rundll32.exe
  selection:
    IntegrityLevel: System
    ParentUser|contains:
    - AUTHORI
    - AUTORI
    ParentUser|endswith:
    - \NETWORK SERVICE
    - \LOCAL SERVICE
    User|contains:
    - AUTHORI
    - AUTORI
    User|endswith:
    - \SYSTEM
    - "\\Syst\xE8me"
    - "\\\u0421\u0418\u0421\u0422\u0415\u041C\u0410"
- condition: selection
  selection:
    CommandLine|contains:
    - h^t^t^p
    - h"t"t"p
- condition: 1 of selection_*
  selection_other:
    CommandLine|contains:
    - "\xE2"
    - "\u20AC"
    - "\xA3"
    - "\xAF"
    - "\xAE"
    - "\xB5"
    - "\xB6"
  selection_spacing_modifiers:
    CommandLine|contains:
    - "\u02E3"
    - "\u02EA"
    - "\u02E2"
  selection_unicode_hyphens:
    CommandLine|contains:
    - "\u2015"
    - "\u2014"
  selection_unicode_slashes:
    CommandLine|contains:
    - "\u2215"
    - "\u2044"
- condition: 1 of selection_* and not 1 of filter_optional_*
  filter_optional_citrix:
    CommandLine|contains: \Citrix\Virtual Smart Card\Citrix.Authentication.VirtualSmartcard.Launcher.exe\..\
  filter_optional_google_drive:
    CommandLine|contains: \Google\Drive\googledrivesync.exe\..\
  selection_1:
    CommandLine|contains:
    - \..\Windows\
    - \..\System32\
    - \..\..\
    Image|contains: \Windows\
  selection_2:
    CommandLine|contains: .exe\..\
- condition: selection and not falsepositive
  falsepositive:
    ParentImage|startswith: C:\Program
  selection:
    CommandLine|contains:
    - ' -p'
    - ' -ta'
    - ' -tb'
    - ' -sdel'
    - ' -dw'
    - ' -hp'
    OriginalFileName:
    - 7z*.exe
    - '*rar.exe'
    - '*Command*Line*RAR*'
- condition: all of selection_*
  selection_cmd:
  - CommandLine|contains:
    - copy-item
    - 'copy '
    - 'cpi '
    - ' cp '
    - 'move '
    - move-item
    - ' mi '
    - ' mv '
  - Image|endswith:
    - \xcopy.exe
    - \robocopy.exe
  - OriginalFileName:
    - XCOPY.EXE
    - robocopy.exe
  selection_path:
    CommandLine|contains:
    - \Opera Software\Opera Stable\
    - \Mozilla\Firefox\Profiles
    - \Microsoft\Edge\User Data\
    - \Google\Chrome\User Data\
- condition: selection_target and (selection_other_tools or all of selection_cmd_*
    or all of selection_pwsh_*)
  selection_cmd_cli:
    CommandLine|contains: copy
  selection_cmd_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
  selection_other_tools:
  - Image|endswith:
    - \robocopy.exe
    - \xcopy.exe
  - OriginalFileName:
    - robocopy.exe
    - XCOPY.EXE
  selection_pwsh_cli:
    CommandLine|contains:
    - copy-item
    - 'copy '
    - 'cpi '
    - ' cp '
    - 'move '
    - move-item
    - ' mi '
    - ' mv '
  selection_pwsh_img:
  - Image|contains:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_target:
  - CommandLine|contains|all:
    - \\\\
    - $
  - CommandLine|contains: \Sysvol\
- condition: 1 of selection* and target
  selection_cmd:
    CommandLine|contains: 'copy '
    Image|endswith: \cmd.exe
  selection_other:
  - Image|endswith:
    - \robocopy.exe
    - \xcopy.exe
  - OriginalFileName:
    - robocopy.exe
    - XCOPY.EXE
  selection_pwsh:
    CommandLine|contains:
    - copy-item
    - ' copy '
    - 'cpi '
    - ' cp '
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  target:
    CommandLine|contains:
    - \System32
    - \SysWOW64
- condition: selection and not filter
  filter:
    CommandLine|contains:
    - ' pool.c '
    - ' pool.o '
    - gcc -
  selection:
    CommandLine|contains:
    - ' --cpu-priority='
    - --donate-level=0
    - ' -o pool.'
    - ' --nicehash'
    - ' --algo=rx/0 '
    - stratum+tcp://
    - stratum+udp://
    - LS1kb25hdGUtbGV2ZWw9
    - 0tZG9uYXRlLWxldmVsP
    - tLWRvbmF0ZS1sZXZlbD
    - c3RyYXR1bSt0Y3A6Ly
    - N0cmF0dW0rdGNwOi8v
    - zdHJhdHVtK3RjcDovL
    - c3RyYXR1bSt1ZHA6Ly
    - N0cmF0dW0rdWRwOi8v
    - zdHJhdHVtK3VkcDovL
- condition: (selection_iwr or all of selection_curl*) and payloads
  payloads:
  - CommandLine|contains:
    - ToBase64String
    - whoami
    - nltest
    - ifconfig
    - hostname
    - net view
    - qprocess
    - netstat
    - systeminfo
    - tasklist
    - sc query
  - CommandLine|contains|all:
    - 'type '
    - ' > '
    - ' C:\'
  selection_curl:
    CommandLine|contains: --ur
    Image|endswith: \curl.exe
  selection_curl_data:
    CommandLine|contains:
    - ' -d '
    - ' --data '
  selection_iwr:
    CommandLine|contains:
    - Invoke-WebRequest
    - 'iwr '
    - 'wget '
    - 'curl '
    CommandLine|contains|all:
    - ' -ur'
    - ' -me'
    - ' -b'
    - ' POST '
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \cmd.exe
- condition: 1 of selection*
  selection1:
    CommandLine|contains|all:
    - 'taskkill '
    - RaccineSettings.exe
  selection2:
    CommandLine|contains|all:
    - reg.exe
    - delete
    - Raccine Tray
  selection3:
    CommandLine|contains|all:
    - schtasks
    - /DELETE
    - Raccine Rules Updater
- condition: selection
  selection:
    CommandLine|contains:
    - .files.exe
    - .docx.exe
    - .xls.exe
    - .xlsx.exe
    - .ppt.exe
    - .pptx.exe
    - .rtf.exe
    - .pdf.exe
    - .txt.exe
    - '      .exe'
    - ______.exe
    - .files.js
    - .docx.js
    - .xls.js
    - .xlsx.js
    - .ppt.js
    - .pptx.js
    - .rtf.js
    - .pdf.js
    - .txt.js
    Image|endswith:
    - .files.exe
    - .docx.exe
    - .xls.exe
    - .xlsx.exe
    - .ppt.exe
    - .pptx.exe
    - .rtf.exe
    - .pdf.exe
    - .txt.exe
    - '      .exe'
    - ______.exe
    - .files.js
    - .docx.js
    - .xls.js
    - .xlsx.js
    - .ppt.js
    - .pptx.js
    - .rtf.js
    - .pdf.js
    - .txt.js
- condition: selection
  selection:
  - ParentImage|endswith:
    - .files.lnk
    - .docx.lnk
    - .xls.lnk
    - .xlsx.lnk
    - .ppt.lnk
    - .pptx.lnk
    - .rtf.lnk
    - .pdf.lnk
    - .txt.lnk
    - .files.js
    - .docx.js
    - .xls.js
    - .xlsx.js
    - .ppt.js
    - .pptx.js
    - .rtf.js
    - .pdf.js
    - .txt.js
  - ParentCommandLine|contains:
    - .files.lnk
    - .docx.lnk
    - .xls.lnk
    - .xlsx.lnk
    - .ppt.lnk
    - .pptx.lnk
    - .rtf.lnk
    - .pdf.lnk
    - .txt.lnk
    - .files.js
    - .docx.js
    - .xls.js
    - .xlsx.js
    - .ppt.js
    - .pptx.js
    - .rtf.js
    - .pdf.js
    - .txt.js
- condition: all of selection_*
  selection_domains:
    CommandLine|contains:
    - https://attachment.outlook.live.net/owa/
    - https://onenoteonlinesync.onenote.com/onenoteonlinesync/
  selection_download:
  - Image|endswith:
    - \curl.exe
    - \wget.exe
  - CommandLine|contains:
    - Invoke-WebRequest
    - 'iwr '
    - 'curl '
    - 'wget '
    - Start-BitsTransfer
    - .DownloadFile(
    - .DownloadString(
- condition: 1 of selection*
  selection:
    Image|endswith: \DumpStack.log
  selection_download:
    CommandLine|contains: ' -o DumpStack.log'
- condition: all of selection_*
  selection_img:
  - Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - Cmd.Exe
    - PowerShell.EXE
    - pwsh.dll
  selection_parent:
    ParentImage|contains|all:
    - \Windows\Installer\
    - msi
    ParentImage|endswith: tmp
- condition: selection and not filter
  filter:
    CommandLine|contains: \NVSMI\nvidia-smi.exe
    ParentImage|endswith: \Discord.exe
  selection:
    Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \cscript.exe
    - \wscript.exe
    - \mshta.exe
    ParentImage|endswith:
    - \Teams.exe
    - \slack.exe
    - \discord.exe
- condition: all of selection_* and not 1 of filter_*
  filter_asgard:
    CommandLine|startswith: C:\WINDOWS\system32\cmd.exe /c "
    CurrentDirectory|contains: C:\WINDOWS\Temp\asgard2-agent\
  filter_citrix:
    Image|endswith: \cmd.exe
    ParentImage|endswith: \CitrixReceiverUpdater.exe
    ParentImage|startswith: C:\Windows\SysWOW64\config\systemprofile\Citrix\UpdaterBinaries\
  filter_compattelrunner:
    ParentCommandLine|startswith: C:\Windows\system32\CompatTelRunner.exe -m:appraiser.dll
      -f:DoScheduledTelemetryRun
    ParentImage|endswith: \CompatTelRunner.exe
    ParentImage|startswith: C:\Windows\WinSxS\
  filter_dell_update:
    Image|endswith: \cmd.exe
    ParentCommandLine|contains: C:\ProgramData\Dell\UpdateService\
    ParentImage|endswith: \invcol.exe
    ParentImage|startswith: C:\Windows\Temp
  filter_empty_parent_1:
    CommandLine: 'powershell.exe -ExecutionPolicy Restricted -Command Write-Host ''Final
      result: 1'';'
  filter_empty_parent_2:
    CommandLine|contains: /d /c C:\Windows\system32\silcollector.cmd
    Image|endswith: \cmd.exe
  filter_empty_parent_3:
    CommandLine|endswith:
    - cmd.exe /c btool server list replication_port --no-log
    - cmd.exe /c btool server list general --no-log
    Image|endswith: \cmd.exe
  filter_empty_parent_4:
    CommandLine|contains: C:\Windows\system32\reg.exe query hklm\software\microsoft\windows\softwareinventorylogging
      /v collectionstate /reg:64
    Image|endswith: \cmd.exe
  filter_empty_parent_5:
    CommandLine: C:\Windows\system32\cmd.exe /c PAUSE
    Image: C:\Windows\System32\cmd.exe
  filter_generic:
    Image|endswith:
    - \cmd.exe
    - \powershell.exe
    ParentImage|startswith:
    - C:\Windows\System32\
    - C:\Program Files (x86)\
    - C:\Program Files\
  filter_ibm_spectrumprotect:
    CommandLine|contains: C:\IBM\SpectrumProtect\webserver\scripts\
    ParentImage|startswith: C:\IBM\SpectrumProtect\webserver\scripts\
  filter_manageengine:
    Image|endswith: \cmd.exe
    ParentImage: C:\ManageEngine\ADManager Plus\pgsql\bin\postgres.exe
  filter_msiexec:
    CommandLine|contains: \RegisterMicrosoftUpdate.ps1
    ParentCommandLine|startswith: C:\Windows\syswow64\MsiExec.exe -Embedding
    ParentImage: C:\Windows\SysWOW64\msiexec.exe
  selection_shell:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \cmd.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
    - Cmd.Exe
  selection_user:
    LogonId: '0x3e7'
    User|contains:
    - AUTHORI
    - AUTORI
- condition: selection
  selection:
    CommandLine|contains|all:
    - powershell
    - .lnk
    Image: C:\Windows\System32\cmd.exe
    ParentImage: C:\Windows\explorer.exe
- condition: selection
  selection:
    CommandLine|contains:
    - COMPlus_ETWEnabled
    - COMPlus_ETWFlags
- condition: 1 of selection*
  selection_clear_1:
    CommandLine|contains|all:
    - cl
    - /Trace
  selection_clear_2:
    CommandLine|contains|all:
    - clear-log
    - /Trace
  selection_disable_1:
    CommandLine|contains|all:
    - sl
    - /e:false
  selection_disable_2:
    CommandLine|contains|all:
    - set-log
    - /e:false
  selection_disable_3:
    CommandLine|contains|all:
    - logman
    - update
    - trace
    - --p
    - -ets
  selection_pwsh_remove:
    CommandLine|contains: Remove-EtwTraceProvider
  selection_pwsh_set:
    CommandLine|contains|all:
    - Set-EtwTraceProvider
    - '0x11'
- condition: 1 of selection_* and not 1 of filter_*
  filter_msiexec:
    CommandLine|contains: ' sl '
    ParentImage:
    - C:\Windows\SysWOW64\msiexec.exe
    - C:\Windows\System32\msiexec.exe
  selection_other_ps:
    CommandLine|contains:
    - 'Clear-EventLog '
    - 'Remove-EventLog '
    - 'Limit-EventLog '
    - 'Clear-WinEvent '
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  selection_other_wmi:
    CommandLine|contains: ClearEventLog
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \wmic.exe
  selection_wevtutil:
    CommandLine|contains:
    - 'clear-log '
    - ' cl '
    - 'set-log '
    - ' sl '
    - 'lfn:'
    Image|endswith: \wevtutil.exe
- condition: all of selection_* and not 1 of filter*
  filter:
    Image|contains|all:
    - \{
    - '}\'
  filter_driver_inst:
    Image: C:\Windows\System32\drvinst.exe
  filter_null:
    Image: null
  selection_folder:
    CommandLine|contains:
    - \AppData\Roaming\
    - \AppData\Local\Temp\
  selection_guid:
    CommandLine|contains|all:
    - \{
    - '}\'
- condition: selection
  selection:
    CommandLine|contains:
    - powershell
    - 'cmd.exe /c '
    - 'cmd.exe /r '
    - 'cmd.exe /k '
    - 'cmd /c '
    - 'cmd /r '
    - 'cmd /k '
    - wscript.exe
    - cscript.exe
    - bitsadmin
    - certutil
    - mshta.exe
    ParentImage|startswith: C:\Users\Public\
- condition: selection and not 1 of filter_*
  filter_citrix:
    Image|endswith: \CitrixReceiverUpdater.exe
    Image|startswith: C:\Windows\SysWOW64\config\systemprofile\Citrix\UpdaterBinaries\
  filter_ibm:
    Image|startswith: C:\Users\Public\IBM\ClientSolutions\Start_Programs\
  selection:
  - Image|contains:
    - \$Recycle.bin\
    - \config\systemprofile\
    - \Intel\Logs\
    - \RSA\MachineKeys\
    - \Users\All Users\
    - \Users\Default\
    - \Users\NetworkService\
    - \Users\Public\
    - \Windows\addins\
    - \Windows\debug\
    - \Windows\Fonts\
    - \Windows\Help\
    - \Windows\IME\
    - \Windows\Media\
    - \Windows\repair\
    - \Windows\security\
    - \Windows\System32\Tasks\
    - \Windows\Tasks\
  - Image|startswith: C:\Perflogs\
- condition: selection and not filter
  filter:
    Image|contains:
    - bin\
    - \Tools\
    - \SMSComponent\
    ParentImage|endswith: \services.exe
  selection:
    Image|contains:
    - \wwwroot\
    - \wmpub\
    - \htdocs\
- condition: (selection1 or selection2 or selection3) and folder
  folder:
    Image|contains: \Downloads\
  selection1:
    Description: \?
    FileVersion: \?
  selection2:
    Description: \?
    Product: \?
  selection3:
    Company: \?
    Description: \?
- condition: 1 of selection* and not 1 of filter*
  filter_grant:
    CommandLine|contains|all:
    - 'ICACLS C:\ProgramData\dynatrace\gateway\config\config.properties /grant :r '
    - S-1-5-19:F
  filter_programs:
  - CommandLine|contains: \AppData\Local\Programs\Microsoft VS Code
  - ParentImage|endswith: \Microsoft VS Code\Code.exe
  filter_reset:
    CommandLine|endswith: ICACLS C:\ProgramData\dynatrace\gateway\config\connectivity.history
      /reset
  selection1:
    CommandLine|contains:
    - /grant
    - /setowner
    - /inheritance:r
    Image|endswith:
    - \cacls.exe
    - \icacls.exe
    - \net.exe
    - \net1.exe
  selection2:
    CommandLine|contains: -r
    Image|endswith: \attrib.exe
  selection3:
    Image|endswith: \takeown.exe
- condition: selection and not filter
  filter:
    Image|endswith:
    - \cscript.exe
    - \wscript.exe
  selection:
    CommandLine|contains: gatherNetworkInfo.vbs
- condition: all of selection_*
  selection_1:
    CommandLine|contains:
    - echo
    - copy
    - type
    - file createnew
    - cacls
  selection_2:
    CommandLine|contains: C:\Windows\Fonts\
  selection_3:
    CommandLine|contains:
    - .sh
    - .exe
    - .dll
    - .bin
    - .bat
    - .cmd
    - .js
    - .msh
    - .reg
    - .scr
    - .ps
    - .vb
    - .jar
    - .pl
    - '.inf'
    - .cpl
    - .hta
    - .msi
    - .vbs
- condition: not image_absolute_path and not 1 of filter*
  filter_4688:
  - Image:
    - System
    - Registry
    - MemCompression
    - vmmem
  - CommandLine:
    - Registry
    - MemCompression
    - vmmem
  filter_empty:
    Image:
    - '-'
    - ''
  filter_null:
    Image: null
  image_absolute_path:
    Image|contains: \
- condition: selection
  selection:
    CommandLine|contains:
    - TVqQAAMAAAAEAAAA
    - TVpQAAIAAAAEAA8A
    - TVqAAAEAAAAEABAA
    - TVoAAAAAAAAAAAAA
    - TVpTAQEAAAAEAAAA
- condition: selection and not 1 of filter_*
  filter_mpcmdrun:
    CommandLine|contains: GetLoadLibraryWAddress32
    Image|endswith: \MpCmdRun.exe
  selection:
    CommandLine|contains:
    - AddSecurityPackage
    - AdjustTokenPrivileges
    - Advapi32
    - CloseHandle
    - CreateProcessWithToken
    - CreatePseudoConsole
    - CreateRemoteThread
    - CreateThread
    - CreateUserThread
    - DangerousGetHandle
    - DuplicateTokenEx
    - EnumerateSecurityPackages
    - FreeHGlobal
    - FreeLibrary
    - GetDelegateForFunctionPointer
    - GetLogonSessionData
    - GetModuleHandle
    - GetProcAddress
    - GetProcessHandle
    - GetTokenInformation
    - ImpersonateLoggedOnUser
    - kernel32
    - LoadLibrary
    - memcpy
    - MiniDumpWriteDump
    - ntdll
    - OpenDesktop
    - OpenProcess
    - OpenProcessToken
    - OpenThreadToken
    - OpenWindowStation
    - PtrToString
    - QueueUserApc
    - ReadProcessMemory
    - RevertToSelf
    - RtlCreateUserThread
    - secur32
    - SetThreadToken
    - VirtualAlloc
    - VirtualFree
    - VirtualProtect
    - WaitForSingleObject
    - WriteInt32
    - WriteProcessMemory
    - ZeroFreeGlobalAllocUnicode
- condition: (selection_cmd and not filter_cmd) or (selection_net and not filter_net)
    or 1 of selection_other_*
  filter_cmd:
    CommandLine|contains: ' rmdir '
  filter_net:
    CommandLine|contains:
    - /domain
    - /add
    - /delete
    - /active
    - /expires
    - /passwordreq
    - /scriptpath
    - /times
    - /workstations
  selection_cmd:
    CommandLine|contains|all:
    - ' /c'
    - 'dir '
    - \Users\
    Image|endswith: \cmd.exe
  selection_net:
    CommandLine|contains: user
    Image|endswith:
    - \net.exe
    - \net1.exe
  selection_other_cmdkey:
    CommandLine|contains: ' /l'
    Image|endswith: \cmdkey.exe
  selection_other_img:
    Image|endswith:
    - \whoami.exe
    - \quser.exe
    - \qwinsta.exe
  selection_other_wmi:
    CommandLine|contains|all:
    - useraccount
    - get
    Image|endswith: \wmic.exe
- condition: all of selection_* and not 1 of filter_*
  filter_drive_path:
    CommandLine|contains:
    - ' C:\\'
    - ' ''C:\'
    - ' "C:\\'
  filter_env_vars:
    CommandLine|contains: '%'
  filter_unc_paths:
    CommandLine|contains: ' \\\\'
  selection_drive_path:
    CommandLine|contains: :\
  selection_exetensions:
    CommandLine|contains:
    - .js
    - .vbs
    - .vbe
  selection_lolbin:
    Image|endswith:
    - \wscript.exe
    - \cscript.exe
- condition: selection
  selection:
    Image|endswith: \Windows\System32\lsass.exe
    ParentImage|endswith: \Windows\System32\lsass.exe
- condition: selection and not filter
  filter:
    Image|endswith: \werfault.exe
  selection:
    CommandLine|contains|all:
    - lsass
    - .dmp
- condition: selection and not 1 of filter_*
  filter_net:
    CommandLine|contains: ' stop'
    Image|endswith:
    - \net.exe
    - \net1.exe
  selection:
    Image|endswith:
    - \powershell.exe
    - \sh.exe
    - \bash.exe
    - \pwsh.exe
    - \schtasks.exe
    - \certutil.exe
    - \whoami.exe
    - \bitsadmin.exe
    - \wscript.exe
    - \cscript.exe
    - \scrcons.exe
    - \wmic.exe
    - \mshta.exe
    - \forfiles.exe
    - \mftrace.exe
    - \AppVLP.exe
    - \curl.exe
    - \notepad.exe
    - \systeminfo.exe
    - \net.exe
    - \net1.exe
    - \reg.exe
    - \query.exe
    ParentImage|contains|all:
    - \ManageEngine\ServiceDesk\
    - \java.exe
- condition: selection
  selection:
    CommandLine|contains:
    - ipconfig /all
    - netsh interface show interface
    - arp -a
    - nbtstat -n
    - net config
    - route print
- condition: all of selection_*
  selection_loop:
    CommandLine|contains:
    - 'for '
    - 'foreach '
  selection_tools:
    CommandLine|contains:
    - nslookup
    - ping
- condition: not known_image_extension and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_com:
    Image|endswith: .com
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  filter_main_deleted:
    Image|startswith: C:\$Extend\$Deleted\
  filter_main_driver_store:
    Image|startswith: C:\Windows\System32\DriverStore\FileRepository\
  filter_main_image:
    Image:
    - System
    - Registry
    - MemCompression
    - vmmem
  filter_main_msi_installers:
    Image|startswith: C:\Windows\Installer\MSI
  filter_main_msi_rollbackfiles:
    Image|endswith:
    - .rbf
    - .rbs
    Image|startswith: C:\Config.Msi\
  filter_main_windows_helper:
    Image|startswith: C:\Windows\Temp\Helper\
    ParentImage|startswith: C:\Windows\Temp\
  filter_optional_avira:
    ParentImage|startswith: C:\ProgramData\Avira\
  filter_optional_dell_dock:
    ParentImage|endswith: \TBT_Dock_Firmware\GetDockVer32W.exe
    ParentImage|startswith: C:\Windows\Temp\
  filter_optional_docker:
    Image|endswith: com.docker.service
    ParentImage: C:\Windows\System32\services.exe
  filter_optional_emc_networker:
    Image:
    - C:\Program Files\EMC NetWorker\Management\GST\apache\cgi-bin\update_jnlp.cgi
    - C:\Program Files (x86)\EMC NetWorker\Management\GST\apache\cgi-bin\update_jnlp.cgi
  filter_optional_empty:
    Image:
    - '-'
    - ''
  filter_optional_firefox_crashreporter:
    Image|startswith: C:\Program Files\Mozilla Firefox\tobedeleted\
  filter_optional_libreoffice:
    Image|endswith: \program\soffice.bin
  filter_optional_lzma_exe:
    Image|endswith: \LZMA_EXE
  filter_optional_myq_server:
    Image:
    - C:\Program Files (x86)\MyQ\Server\pcltool.dll
    - C:\Program Files\MyQ\Server\pcltool.dll
  filter_optional_null:
    Image: null
  filter_optional_nvidia:
    Image|contains: NVIDIA\NvBackend\
    Image|endswith: .dat
  filter_optional_office_c2r:
    CommandLine|contains|all:
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe
    - /update UPDATEORCHESTRATOR displaylevel=False
    Image|startswith: C:\$Extend\$Deleted\
    ParentImage: C:\Windows\UUS\amd64\MoUsoCoreWorker.exe
  filter_optional_visualstudio:
    Image|endswith: .com
    Image|startswith:
    - C:\Program Files\Microsoft Visual Studio\
    - C:\Program Files (x86)\Microsoft Visual Studio
  filter_optional_vscode:
    Image|contains|all:
    - C:\Users\
    - \AppData\
    - .tmp
    - CodeSetup
  filter_optional_winpakpro:
    Image|endswith: .ngn
    Image|startswith:
    - C:\Program Files (x86)\WINPAKPRO\
    - C:\Program Files\WINPAKPRO\
  filter_optional_winscp:
    Image|endswith: \WinSCP.com
  filter_optional_wsl:
    Image|contains|all:
    - \AppData\Local\Packages\
    - \LocalState\rootfs\
  known_image_extension:
    Image|endswith:
    - .exe
    - .tmp
    - .scr
- condition: (reg or powershell) and select_data
  powershell:
    CommandLine|contains:
    - powershell
    - set-itemproperty
    - ' sp '
    - new-itemproperty
  reg:
    CommandLine|contains|all:
    - 'reg '
    - add
  select_data:
    CommandLine|contains:
    - ImagePath
    - FailureCommand
    - ServiceDLL
    CommandLine|contains|all:
    - ControlSet
    - Services
    IntegrityLevel: Medium
- condition: 1 of selection* or all of set1*
  selection_oneliner_1:
    CommandLine|contains|all:
    - ac i ntds
    - create full
  selection_onliner_2:
    CommandLine|contains|all:
    - '/c copy '
    - \windows\ntds\ntds.dit
  selection_onliner_3:
    CommandLine|contains|all:
    - activate instance ntds
    - create full
  selection_powershell:
    CommandLine|contains|all:
    - powershell
    - ntds.dit
  selection_tool:
  - Image|endswith:
    - \NTDSDump.exe
    - \NTDSDumpEx.exe
  - CommandLine|contains|all:
    - ntds.dit
    - system.hiv
  - CommandLine|contains: NTDSgrab.ps1
  set1_selection_image_folder:
  - ParentImage|contains:
    - \apache
    - \tomcat
    - \AppData\
    - \Temp\
    - \Public\
    - \PerfLogs\
  - Image|contains:
    - \apache
    - \tomcat
    - \AppData\
    - \Temp\
    - \Public\
    - \PerfLogs\
  set1_selection_ntds_dit:
    CommandLine|contains: ntds.dit
- condition: all of selection_*
  selection_class:
    CommandLine|contains: Win32_NTEventlogFile
  selection_function:
    CommandLine|contains:
    - .BackupEventlog(
    - .ChangeSecurityPermissions(
    - .ChangeSecurityPermissionsEx(
    - .ClearEventLog(
    - .Delete(
    - .DeleteEx(
    - .Rename(
    - .TakeOwnerShip(
    - .TakeOwnerShipEx(
- condition: selection and not filter
  filter:
  - ParentImage:
    - C:\Windows\System32\Dism.exe
    - C:\Windows\System32\cleanmgr.exe
    - C:\Program Files\GPSoftware\Directory Opus\dopus.exe
  - ParentImage|endswith:
    - \WebEx\WebexHost.exe
    - \thor\thor64.exe
    - \veam.backup.shell.exe
    - \winget.exe
    - \Everything\Everything.exe
  - ParentImage|contains: \AppData\Local\Temp\WinGet\
  - CommandLine|contains:
    - \appdata\local\webex\webex64\meetings\wbxreport.exe
    - C:\Program Files\Git\post-install.bat
    - C:\Program Files\Git\cmd\scalar.exe
  selection:
    CommandLine|contains:
    - ~1\
    - ~2\
- condition: selection and not 1 of filter*
  filter1:
  - ParentImage:
    - C:\Windows\System32\Dism.exe
    - C:\Windows\System32\cleanmgr.exe
  - ParentImage|endswith:
    - \WebEx\WebexHost.exe
    - \thor\thor64.exe
  - Product: InstallShield (R)
  - Description: InstallShield (R) Setup Engine
  - Company: InstallShield Software Corporation
  filter_installers:
  - Image|contains|all:
    - \AppData\
    - \Temp\
  - Image|endswith:
    - ~1\unzip.exe
    - ~1\7zG.exe
  selection:
    Image|contains:
    - ~1\
    - ~2\
- condition: selection and not filter
  filter:
  - ParentImage|endswith:
    - \WebEx\WebexHost.exe
    - \thor\thor64.exe
  - CommandLine|contains: C:\xampp\vcredist\VCREDI~1.EXE
  selection:
    CommandLine|contains:
    - ~1.exe
    - ~1.bat
    - ~1.msi
    - ~1.vbe
    - ~1.vbs
    - ~1.dll
    - ~1.ps1
    - ~1.js
    - ~1.hta
    - ~2.exe
    - ~2.bat
    - ~2.msi
    - ~2.vbe
    - ~2.vbs
    - ~2.dll
    - ~2.ps1
    - ~2.js
    - ~2.hta
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_generic_parent:
    ParentImage: C:\Windows\explorer.exe
  filter_optional_thor:
    ParentImage|endswith: \thor\thor64.exe
  filter_optional_vcred:
    Image|endswith: \VCREDI~1.EXE
  filter_optional_webex:
    ParentImage|endswith: \WebEx\WebexHost.exe
  filter_optional_winzip:
    Image: C:\PROGRA~1\WinZip\WZPREL~1.EXE
  selection:
    Image|contains:
    - ~1.bat
    - ~1.dll
    - ~1.exe
    - ~1.hta
    - ~1.js
    - ~1.msi
    - ~1.ps1
    - ~1.tmp
    - ~1.vbe
    - ~1.vbs
    - ~2.bat
    - ~2.dll
    - ~2.exe
    - ~2.hta
    - ~2.js
    - ~2.msi
    - ~2.ps1
    - ~2.tmp
    - ~2.vbe
    - ~2.vbs
- condition: all of selection*
  selection_img:
    CommandLine|contains:
    - Invoke-WebRequest
    - 'iwr '
    - 'wget '
    - 'curl '
    - DownloadFile
    - DownloadString
  selection_ip:
  - CommandLine|contains:
    - //0x
    - .0x
    - .00x
  - CommandLine|contains|all:
    - http://%
    - '%2e'
- condition: all of selection*
  selection_img:
    Image|endswith:
    - \ping.exe
    - \arp.exe
  selection_ip:
  - CommandLine|contains: ' 0x'
  - CommandLine|re: ' [0-9]{7,13}'
- condition: selection
  selection:
    CommandLine|contains:
    - eyJ0eXAiOi
    - ' eyJ0eX'
    - ' "eyJ0eX"'
    - ' ''eyJ0eX'''
- condition: selection or ( selection_special and not 1 of filter_* )
  filter_null:
    Image: null
  filter_special:
    Image|endswith:
    - \WerFault.exe
    - \wermgr.exe
    - \conhost.exe
    - \mmc.exe
    - \win32calc.exe
    - \notepad.exe
  selection:
    ParentImage|endswith:
    - \minesweeper.exe
    - \winver.exe
    - \bitsadmin.exe
  selection_special:
    ParentImage|endswith:
    - \csrss.exe
    - \certutil.exe
    - \eventvwr.exe
    - \calc.exe
    - \notepad.exe
- condition: selection_ext and (all of selection_cmd_* or all of selection_pwsh_*
    or selection_findstr)
  selection_cmd_cli:
    CommandLine|contains: 'dir '
  selection_cmd_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
  selection_ext:
    CommandLine|contains:
    - .key
    - .pgp
    - .gpg
    - .ppk
    - .p12
    - .pem
    - .pfx
    - .cer
    - .p7b
    - .asc
  selection_findstr:
  - Image|endswith: \findstr.exe
  - OriginalFileName: FINDSTR.EXE
  selection_pwsh_cli:
    CommandLine|contains: 'Get-ChildItem '
  selection_pwsh_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: all of selection*
  selection_command:
    CommandLine|contains:
    - ' -c cmd'
    - ' -c "cmd'
    - ' -c powershell'
    - ' -c "powershell'
    - ' --command cmd'
    - ' --command powershell'
    - ' -c whoami'
    - ' -c wscript'
    - ' -c cscript'
  selection_user:
    CommandLine|contains:
    - ' -u system '
    - ' --user system '
    - ' -u NT'
    - ' -u "NT'
    - ' -u ''NT'
    - ' --system '
    - ' -u administrator '
- condition: all of selection*
  selection_args:
    CommandLine|contains|all:
    - echo
    - '>'
    - \\\\.\\pipe\\
  selection_name:
  - Image|endswith:
    - \cmd.exe
    - \powershell.exe
  - OriginalFileName:
    - Cmd.Exe
    - PowerShell.EXE
- condition: selection and not 1 of filter_*
  filter_msmpeng:
    ParentImage|contains:
    - \Windows Defender\
    - \Microsoft Security Client\
    ParentImage|endswith: \MsMpEng.exe
  filter_null:
  - ParentImage: null
  - ParentImage: '-'
  filter_sys:
  - ParentImage|endswith:
    - \SavService.exe
    - \ngen.exe
  - ParentImage|contains:
    - \System32\
    - \SysWOW64\
  selection:
    Image|endswith:
    - \svchost.exe
    - \taskhost.exe
    - \lsm.exe
    - \lsass.exe
    - \services.exe
    - \lsaiso.exe
    - \csrss.exe
    - \wininit.exe
    - \winlogon.exe
- condition: 1 of selection*
  selection_commandline:
    CommandLine|contains:
    - inject.ps1
    - Invoke-CVE
    - pupy.ps1
    - payload.ps1
    - beacon.ps1
    - PowerView.ps1
    - bypass.ps1
    - obfuscated.ps1
    - obfusc.ps1
    - obfus.ps1
    - obfs.ps1
    - evil.ps1
    - MiniDogz.ps1
    - _enc.ps1
    - \shell.ps1
    - \rshell.ps1
    - revshell.ps1
    - \av.ps1
    - \av_test.ps1
    - adrecon.ps1
    - mimikatz.ps1
    - \PowerUp_
    - powerup.ps1
    - \Temp\a.ps1
    - \Temp\p.ps1
    - \Temp\1.ps1
    - Hound.ps1
    - encode.ps1
    - powercat.ps1
  selection_image:
  - Image|contains:
    - \CVE-202
    - \CVE202
  - Image|endswith:
    - \poc.exe
    - \artifact.exe
    - \artifact64.exe
    - \artifact_protected.exe
    - \artifact32.exe
    - \artifact32big.exe
    - obfuscated.exe
    - obfusc.exe
    - \meterpreter
- condition: all of selection*
  selection_image:
  - Image|endswith:
    - \tree.com
    - \WMIC.exe
    - \doskey.exe
    - \sc.exe
  - OriginalFileName:
    - wmic.exe
    - DOSKEY.EXE
    - sc.exe
  selection_redirect:
    ParentCommandLine|contains:
    - ' > %TEMP%\'
    - ' > %TMP%\'
- condition: selection
  selection:
    Image|contains:
    - :\RECYCLERS.BIN\
    - :\RECYCLER.BIN\
    - :\RECYCLE.BIN\
- condition: all of selection_*
  selection_redirect:
    CommandLine|contains: '>'
  selection_share:
  - \\\\127.0.0.1\\admin$\\
  - \\\\localhost\\admin$\\
- condition: all of selection*
  selection:
    CommandLine|contains: :3389
  selection_opt:
    CommandLine|contains:
    - ' -L '
    - ' -P '
    - ' -R '
    - ' -pw '
    - ' -ssh '
- condition: selection
  selection:
    CommandLine|contains: "\u202E"
- condition: 1 of selection_proc_* and 1 of selection_folders_*
  selection_folders_1:
    CommandLine|contains:
    - :\Perflogs\
    - :\Users\Public\
    - \AppData\Local\Temp
    - \AppData\Roaming\Temp
    - \Temporary Internet
    - \Windows\Temp
  selection_folders_2:
  - CommandLine|contains|all:
    - :\Users\
    - \Favorites\
  - CommandLine|contains|all:
    - :\Users\
    - \Favourites\
  - CommandLine|contains|all:
    - :\Users\
    - \Contacts\
  selection_proc_flags:
    CommandLine|contains:
    - ' -ep bypass '
    - ' -ExecutionPolicy bypass '
    - ' -w hidden '
    - '/e:javascript '
    - '/e:Jscript '
    - '/e:vbscript '
  selection_proc_image:
    Image|endswith:
    - \cscript.exe
    - \mshta.exe
    - \wscript.exe
  selection_proc_original:
    OriginalFileName:
    - cscript.exe
    - mshta.exe
    - wscript.exe
- condition: selection and not filter
  filter:
    CommandLine|contains:
    - ' >'
    - Out-File
    - ConvertTo-Json
    - -WindowStyle hidden -Verb runAs
    - \Windows\system32\config\systemprofile\AppData\Local\Temp\Amazon\EC2-Windows\
  selection:
    CommandLine|contains:
    - \Windows\Temp
    - \Temporary Internet
    - \AppData\Local\Temp
    - \AppData\Roaming\Temp
    - '%TEMP%'
    - '%TMP%'
    - '%LocalAppData%\Temp'
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \mshta.exe
    - \wscript.exe
    - \cscript.exe
- condition: 1 of selection* and susp_binpath
  selection_posh:
    CommandLine|contains|all:
    - New-Service
    - -BinaryPathName
  selection_sc:
    CommandLine|contains|all:
    - create
    - binPath=
    Image|endswith: \sc.exe
  susp_binpath:
    CommandLine|contains:
    - powershell
    - mshta
    - wscript
    - cscript
    - svchost
    - dllhost
    - 'cmd '
    - cmd.exe /c
    - cmd.exe /k
    - cmd.exe /r
    - rundll32
    - C:\Users\Public
    - \Downloads\
    - \Desktop\
    - \Microsoft\Windows\Start Menu\Programs\Startup\
    - C:\Windows\TEMP\
    - \AppData\Local\Temp
- condition: selection
  selection:
    Image|contains:
    - \Users\Public\
    - \$Recycle.bin
    - \Users\All Users\
    - \Users\Default\
    - \Users\Contacts\
    - \Users\Searches\
    - C:\Perflogs\
    - \config\systemprofile\
    - \Windows\Fonts\
    - \Windows\IME\
    - \Windows\addins\
    ParentImage|endswith:
    - \services.exe
    - \svchost.exe
- condition: selection_services and (all of selection_net_* or all of selection_pwsh_*
    or all of selection_sc_*)
  selection_net_cli:
    CommandLine|contains: ' stop '
  selection_net_img:
  - OriginalFileName:
    - net.exe
    - net1.exe
  - Image|endswith:
    - \net.exe
    - \net1.exe
  selection_pwsh_cli:
    CommandLine|contains:
    - 'Stop-Service '
    - 'Remove-Service '
  selection_pwsh_img:
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  selection_sc_cli:
    CommandLine|contains:
    - ' stop '
    - ' delete '
    - ' pause '
  selection_sc_img:
  - OriginalFileName: sc.exe
  - Image|endswith: \sc.exe
  selection_services:
    CommandLine|contains:
    - 143Svc
    - Acronis VSS Provider
    - AcronisAgent
    - AcrSch2Svc
    - Antivirus
    - ARSM
    - aswBcc
    - Avast Business Console Client Antivirus Service
    - avast! Antivirus
    - AVG Antivirus
    - avgAdminClient
    - AvgAdminServer
    - AVP1
    - BackupExec
    - bedbg
    - BITS
    - BrokerInfrastructure
    - Client Agent 7.60
    - Core Browsing Protection
    - Core Mail Protection
    - Core Scanning Server
    - DCAgent
    - EhttpSr
    - ekrn
    - Enterprise Client Service
    - epag
    - EPIntegrationService
    - EPProtectedService
    - EPRedline
    - EPSecurityService
    - EPUpdateService
    - EraserSvc11710
    - EsgShKernel
    - ESHASRV
    - FA_Scheduler
    - FirebirdGuardianDefaultInstance
    - FirebirdServerDefaultInstance
    - HealthTLService
    - HISSQLFDLauncherSSHAREPOINIT
    - hmpalertsvc
    - HMS
    - IISAdmin
    - IMANSVC
    - IMAP4Svc
    - KAVFS
    - KAVFSGT
    - kavfsslp
    - klbackupdisk
    - klbackupflt
    - klflt
    - klhk
    - KLIF
    - klim6
    - klkbdflt
    - klmouflt
    - klnagent
    - klpd
    - kltap
    - KSDE1.0.0
    - LogProcessorService
    - M8EndpointAgent
    - macmnsvc
    - masvc
    - MBAMService
    - MBCloudEA
    - MBEndpointAgent
    - McAfeeDLPAgentService
    - McAfeeEngineService
    - MCAFEEEVENTPARSERSRV
    - McAfeeFramework
    - MCAFEETOMCATSRV530
    - McShield
    - McTaskManager
    - mfefire
    - mfemms
    - mfevto
    - mfevtp
    - mfewc
    - MMS
    - mozyprobackup
    - MsDtsServer
    - MSExchange
    - msftesq1SPROO
    - msftesql$PROD
    - MSOLAP$SQL_2008
    - MSOLAP$SYSTEM_BGC
    - MSOLAP$TPS
    - MSOLAP$TPSAMA
    - MSOLAPSTPS
    - MSOLAPSTPSAMA
    - mssecflt
    - MSSQ!I.SPROFXENGAGEMEHT
    - MSSQ0SHAREPOINT
    - MSSQ0SOPHOS
    - MSSQL
    - MySQL
    - NanoServiceMain
    - NetMsmqActivator
    - ntrtscan
    - ofcservice
    - Online Protection System
    - OracleClientCache80
    - PandaAetherAgent
    - PccNTUpd
    - PDVFSService
    - POP3Svc
    - POVFSService
    - PSUAService
    - Quick Update Service
    - RepairService
    - ReportServer
    - ReportServer$
    - RESvc
    - RpcEptMapper
    - sacsvr
    - SamSs
    - SAVAdminService
    - SAVService
    - ScSecSvc
    - SDRSVC
    - sense
    - SentinelAgent
    - SentinelHelperService
    - SepMasterService
    - ShMonitor
    - Smcinst
    - SmcService
    - SMTPSvc
    - SNAC
    - SntpService
    - Sophos
    - SQ1SafeOLRService
    - SQL Backups
    - SQL Server
    - SQLAgent
    - SQLBrowser
    - SQLsafe
    - SQLSERVERAGENT
    - SQLTELEMETRY
    - SQLWriter
    - SSISTELEMETRY130
    - SstpSvc
    - svcGenericHost
    - swc_service
    - swi_filter
    - swi_service
    - swi_update
    - Symantec
    - Telemetryserver
    - ThreatLockerService
    - TMBMServer
    - TmCCSF
    - TmFilter
    - TMiCRCScanService
    - tmlisten
    - TMLWCSService
    - TmPfw
    - TmPreFilter
    - TmProxy
    - TMSmartRelayService
    - tmusa
    - Trend Micro Deep Security Manager
    - TrueKey
    - UI0Detect
    - UTODetect
    - Veeam
    - VeemaDep/oySvc
    - Veritas System Recovery
    - VSApiNt
    - VSS
    - W3Svc
    - wbengine
    - WdNisSvc
    - WeanClOudSve
    - Weems JY
    - WinDefend
    - wozyprobackup
    - WRSVC
    - Zoolz 2 Service
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - shadow
    - create
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \wmic.exe
    - \vssadmin.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
    - wmic.exe
    - VSSADMIN.EXE
- condition: (all of selection1*) or (all of selection2*) or (all of selection3*)
  selection1_cli:
    CommandLine|contains|all:
    - shadow
    - delete
  selection1_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \wmic.exe
    - \vssadmin.exe
    - \diskshadow.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
    - wmic.exe
    - VSSADMIN.EXE
    - diskshadow.exe
  selection2_cli:
    CommandLine|contains|all:
    - delete
    - catalog
    - quiet
  selection2_img:
  - Image|endswith: \wbadmin.exe
  - OriginalFileName: WBADMIN.EXE
  selection3_cli:
    CommandLine|contains:
    - unbounded
    - /MaxSize=
    CommandLine|contains|all:
    - resize
    - shadowstorage
  selection3_img:
  - Image|endswith: \vssadmin.exe
  - OriginalFileName: VSSADMIN.EXE
- condition: selection and not 1 of filter_*
  filter_amazon:
    ParentCommandLine|contains:
    - \Program Files\Amazon\WorkSpacesConfig\Scripts\setup-scheduledtask.ps1
    - \Program Files\Amazon\WorkSpacesConfig\Scripts\set-selfhealing.ps1
    - \Program Files\Amazon\WorkSpacesConfig\Scripts\check-workspacehealth.ps1
    - \nessus_
  filter_ccmcache:
    CurrentDirectory|contains: \ccmcache\
  filter_nessus:
    CommandLine|contains: \nessus_
  filter_sccm_install:
    CommandLine|contains|all:
    - C:\MEM_Configmgr_
    - \SMSSETUP\BIN\
    - \autorun.hta
    - '{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}'
    Image|endswith: \mshta.exe
    ParentCommandLine|contains|all:
    - C:\MEM_Configmgr_
    - \splash.hta
    - '{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}'
    ParentImage|endswith: \mshta.exe
  selection:
    Image|endswith:
    - \schtasks.exe
    - \nslookup.exe
    - \certutil.exe
    - \bitsadmin.exe
    - \mshta.exe
    ParentImage|endswith:
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \rundll32.exe
    - \cscript.exe
    - \wscript.exe
    - \wmiprvse.exe
    - \regsvr32.exe
- condition: sysnative
  sysnative:
    CommandLine|startswith: C:\Windows\Sysnative\
- condition: selection and not 1 of filter_*
  filter_generic:
  - Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  - Image|contains: \SystemRoot\System32\
  - Image:
    - C:\Windows\explorer.exe
    - C:\Program Files\PowerShell\7\pwsh.exe
  filter_wsl_windowsapps:
    Image|endswith: \wsl.exe
    Image|startswith: C:\Program Files\WindowsApps\MicrosoftCorporationII.WindowsSubsystemForLinux
  selection:
    Image|endswith:
    - \svchost.exe
    - \rundll32.exe
    - \services.exe
    - \powershell.exe
    - \powershell_ise.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \spoolsv.exe
    - \lsass.exe
    - \smss.exe
    - \csrss.exe
    - \conhost.exe
    - \wininit.exe
    - \lsm.exe
    - \winlogon.exe
    - \explorer.exe
    - \taskhost.exe
    - \Taskmgr.exe
    - \sihost.exe
    - \RuntimeBroker.exe
    - \smartscreen.exe
    - \dllhost.exe
    - \audiodg.exe
    - \wlanext.exe
    - \dashost.exe
    - \schtasks.exe
    - \cscript.exe
    - \wscript.exe
    - \wsl.exe
    - \bitsadmin.exe
    - \atbroker.exe
    - \bcdedit.exe
    - \certutil.exe
    - \certreq.exe
    - \cmstp.exe
    - \consent.exe
    - \defrag.exe
    - \dism.exe
    - \dllhst3g.exe
    - \eventvwr.exe
    - \msiexec.exe
    - \runonce.exe
    - \winver.exe
    - \logonui.exe
    - \userinit.exe
    - \dwm.exe
    - \LsaIso.exe
    - \ntoskrnl.exe
    - \wsmprovhost.exe
    - \dfrgui.exe
- condition: all of selection* and not 1 of filter_*
  filter_config_mgr:
    ParentImage|startswith: C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\
  filter_java:
    CommandLine|contains: ' -ma '
    Image|endswith: \bin\jp2launcher.exe
    Image|startswith: C:\Program Files (x86)\Java\
    ParentImage|endswith: \bin\javaws.exe
    ParentImage|startswith: C:\Program Files (x86)\Java\
  filter_ping:
    CommandLine: ping 127.0.0.1 -n 5
  filter_vs:
    Image|endswith: \PING.EXE
    ParentCommandLine|contains: \DismFoDInstall.cmd
  selection:
    IntegrityLevel: System
    User|contains:
    - AUTHORI
    - AUTORI
  selection_special:
  - Image|endswith:
    - \calc.exe
    - \wscript.exe
    - \cscript.exe
    - \hh.exe
    - \mshta.exe
    - \forfiles.exe
    - \ping.exe
  - CommandLine|contains:
    - ' -NoP '
    - ' -W Hidden '
    - ' -decode '
    - ' /decode '
    - ' /urlcache '
    - ' -urlcache '
    - ' -e* JAB'
    - ' -e* SUVYI'
    - ' -e* SQBFAFgA'
    - ' -e* aWV4I'
    - ' -e* IAB'
    - ' -e* PAA'
    - ' -e* aQBlAHgA'
    - vssadmin delete shadows
    - reg SAVE HKLM
    - ' -ma '
    - Microsoft\Windows\CurrentVersion\Run
    - .downloadstring(
    - .downloadfile(
    - ' /ticket:'
    - 'dpapi::'
    - event::clear
    - event::drop
    - id::modify
    - 'kerberos::'
    - 'lsadump::'
    - 'misc::'
    - 'privilege::'
    - 'rpc::'
    - 'sekurlsa::'
    - 'sid::'
    - 'token::'
    - vault::cred
    - vault::list
    - ' p::d '
    - ;iex(
    - MiniDump
    - 'net user '
- condition: selection
  selection:
    CommandLine|contains|all:
    - \SYSVOL\
    - \policies\
- condition: all of selection*
  selection1:
    CommandLine|contains:
    - 'echo '
    - 'copy '
    - 'type '
    - file createnew
  selection2:
    CommandLine|contains:
    - ' C:\Windows\System32\Tasks\'
    - ' C:\Windows\SysWow64\Tasks\'
- condition: selection and not 1 of filter*
  filter1:
    CommandLine|contains: \netlogon\
  filter2:
  - Image|endswith: \explorer.exe
  - OriginalFileName: explorer.exe
  selection:
    ParentImage|endswith: \userinit.exe
- condition: selection
  selection:
  - Image|endswith: \te.exe
  - ParentImage|endswith: \te.exe
  - OriginalFileName: \te.exe
- condition: selection and not (reduction1 or reduction2)
  reduction1:
    Image|endswith: \vsimmersiveactivatehelper*.exe
  reduction2:
    Image|endswith: \devenv.exe
  selection:
    ParentImage|endswith: \vsjitdebugger.exe
- condition: selection
  selection:
    CommandLine|contains:
    - Asd123.aaaa
    - password123
    - '123456789'
    - P@ssw0rd!
- condition: selection
  selection:
    CommandLine|contains:
    - '[System.Net.WebRequest]::create'
    - 'curl '
    - Invoke-RestMethod
    - Invoke-WebRequest
    - 'iwr '
    - Net.WebClient
    - Resume-BitsTransfer
    - Start-BitsTransfer
    - 'wget '
    - WinHttp.WinHttpRequest
- condition: selection
  selection:
    CommandLine|contains: .exe whoami
- condition: selection and not filter
  filter:
    Image: C:\Windows\System32\control.exe
  selection:
    Image|endswith: \control.exe
    ParentImage|endswith: \WorkFolders.exe
- condition: selection and not filter
  filter:
  - ParentImage|endswith:
    - \rpcnet.exe
    - \rpcnetp.exe
  - CommandLine: null
  selection:
    CommandLine|endswith: svchost.exe
    Image|endswith: \svchost.exe
- condition: selection and not 1 of filter*
  filter:
    ParentImage|endswith:
    - \services.exe
    - \MsMpEng.exe
    - \Mrt.exe
    - \rpcnet.exe
    - \ngen.exe
    - \TiWorker.exe
  filter_emptysysmon:
    ParentImage: '-'
  filter_null1:
    ParentImage: null
  filter_null2:
    ParentImage: ''
  selection:
    Image|endswith: \svchost.exe
- condition: selection and not 1 of filter_*
  filter_img:
    Image|endswith:
    - \rdpclip.exe
    - :\Windows\System32\csrss.exe
    - :\Windows\System32\wininit.exe
    - :\Windows\System32\winlogon.exe
  filter_null:
    Image: null
  selection:
    ParentCommandLine|contains|all:
    - \svchost.exe
    - termsvcs
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - 'uwcqv '
    - 'kwsu '
    - 'qwsu '
    - 'uwdqs '
  selection_img:
  - Product|endswith: AccessChk
  - Description|contains: Reports effective permissions
  - Image|endswith:
    - \accesschk.exe
    - \accesschk64.exe
  - OriginalFileName: accesschk.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: snapshot
  selection_img:
  - Image|endswith: \ADExplorer.exe
  - OriginalFileName: AdExp
- condition: all of selection_*
  selection_flag:
    CommandLine|contains: snapshot
  selection_img:
  - Image|endswith: \ADExplorer.exe
  - OriginalFileName: AdExp
  selection_paths:
    CommandLine|contains:
    - \Downloads\
    - \Users\Public\
    - \AppData\
    - \Windows\Temp\
- condition: selection
  selection:
    CommandLine|contains:
    - ' -accepteula'
    - ' /accepteula'
- condition: selection
  selection:
  - Image|endswith:
    - \livekd.exe
    - \livekd64.exe
  - OriginalFileName: livekd.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - ' /m'
    - ' -m'
  selection_img:
  - Image|endswith:
    - \livekd.exe
    - \livekd64.exe
  - OriginalFileName: livekd.exe
- condition: selection
  selection:
    Image|endswith:
    - \procdump.exe
    - \procdump64.exe
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains:
    - copy procdump
    - move procdump
  selection_2:
    CommandLine|contains:
    - 2.dmp
    - lsass
    - out.dmp
    CommandLine|contains|all:
    - 'copy '
    - '.dmp '
  selection_3:
    CommandLine|contains:
    - copy lsass.exe_
    - move lsass.exe_
- condition: all of selection*
  selection_flags:
    CommandLine|contains:
    - ' -ma '
    - ' /ma '
  selection_process:
    CommandLine|contains: ' ls'
- condition: selection
  selection:
  - Image|endswith: \psexec.exe
  - OriginalFileName: psexec.c
- condition: all of selection_*
  selection_other:
    CommandLine|contains:
    - psexec
    - paexec
    - accepteula
  selection_sys:
    CommandLine|contains:
    - ' -s cmd'
    - ' /s cmd'
    - ' -s -i cmd'
    - ' /s /i cmd'
    - ' /s -i cmd'
    - ' -s /i cmd'
    - ' -i -s cmd'
    - ' /i /s cmd'
    - ' -i /s cmd'
    - ' /i -s cmd'
    - ' -s pwsh'
    - ' /s pwsh'
    - ' -s -i pwsh'
    - ' /s /i pwsh'
    - ' /s -i pwsh'
    - ' -s /i pwsh'
    - ' -i -s pwsh'
    - ' /i /s pwsh'
    - ' -i /s pwsh'
    - ' /i -s pwsh'
    - ' -s powershell'
    - ' /s powershell'
    - ' -s -i powershell'
    - ' /s /i powershell'
    - ' /s -i powershell'
    - ' -s /i powershell'
    - ' -i -s powershell'
    - ' /i /s powershell'
    - ' -i /s powershell'
    - ' /i -s powershell'
- condition: selection
  selection:
    CommandLine|contains|all:
    - accepteula
    - ' -u '
    - ' -p '
    - ' \\\\'
- condition: selection
  selection:
  - Image: C:\Windows\PSEXESVC.exe
  - OriginalFileName: psexesvc.exe
- condition: selection
  selection:
    ParentImage: C:\Windows\PSEXESVC.exe
    User|contains:
    - AUTHORI
    - AUTORI
- condition: all of selection_*
  selection_cli_eventlog:
    CommandLine|contains:
    - ' security'
    - ' application'
    - ' system'
  selection_cli_flags:
    CommandLine|contains:
    - ' -d'
    - ' /d'
    - ' -x'
    - ' /x'
    - ' -s'
    - ' /s'
    - ' -c'
    - ' /c'
    - ' -g'
    - ' /g'
  selection_img:
  - OriginalFileName: psloglist.exe
  - Image|endswith:
    - \psloglist.exe
    - \psloglist64.exe
- condition: selection
  selection:
  - OriginalFileName: psservice.exe
  - Image|endswith:
    - \PsService.exe
    - \PsService64.exe
- condition: selection
  selection:
  - OriginalFileName: pssuspend.exe
  - Image|endswith:
    - \pssuspend.exe
    - \pssuspend64.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: msmpeng.exe
  selection_img:
  - OriginalFileName: pssuspend.exe
  - Image|endswith:
    - \pssuspend.exe
    - \pssuspend64.exe
- condition: selection and not filter
  filter:
    CommandLine|contains:
    - ' -h'
    - ' -c'
    - ' -z'
    - ' /\?'
  selection:
    OriginalFileName: sdelete.exe
- condition: 1 of selection_flags_* and not filter
  filter:
    CommandLine|contains:
    - paexec
    - PsExec
    - accepteula
  selection_flags_1:
    CommandLine|contains:
    - ' -s cmd'
    - ' /s cmd'
    - ' -s -i cmd'
    - ' /s /i cmd'
    - ' /s -i cmd'
    - ' -s /i cmd'
    - ' -i -s cmd'
    - ' /i /s cmd'
    - ' -i /s cmd'
    - ' /i -s cmd'
    - ' -s pwsh'
    - ' /s pwsh'
    - ' -s -i pwsh'
    - ' /s /i pwsh'
    - ' /s -i pwsh'
    - ' -s /i pwsh'
    - ' -i -s pwsh'
    - ' /i /s pwsh'
    - ' -i /s pwsh'
    - ' /i -s pwsh'
    - ' -s powershell'
    - ' /s powershell'
    - ' -s -i powershell'
    - ' /s /i powershell'
    - ' /s -i powershell'
    - ' -s /i powershell'
    - ' -i -s powershell'
    - ' /i /s powershell'
    - ' -i /s powershell'
    - ' /i -s powershell'
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - -c
    - /c
  selection_pe:
  - Image|endswith:
    - \Sysmon64.exe
    - \Sysmon.exe
  - Description: System activity monitor
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - -u
    - /u
  selection_pe:
  - Image|endswith:
    - \Sysmon64.exe
    - \Sysmon.exe
  - Description: System activity monitor
- condition: selection_exe and not 1 of filter*
  filter_empty:
    Company: null
  filter_valid:
    Company:
    - Sysinternals - www.sysinternals.com
    - Sysinternals
  selection_exe:
    Image|endswith:
    - \accesschk.exe
    - \accesschk64.exe
    - \AccessEnum.exe
    - \ADExplorer.exe
    - \ADExplorer64.exe
    - \ADInsight.exe
    - \ADInsight64.exe
    - \adrestore.exe
    - \adrestore64.exe
    - \Autologon.exe
    - \Autologon64.exe
    - \Autoruns.exe
    - \Autoruns64.exe
    - \autorunsc.exe
    - \autorunsc64.exe
    - \Bginfo.exe
    - \Bginfo64.exe
    - \Cacheset.exe
    - \Cacheset64.exe
    - \Clockres.exe
    - \Clockres64.exe
    - \Contig.exe
    - \Contig64.exe
    - \Coreinfo.exe
    - \Coreinfo64.exe
    - \CPUSTRES.EXE
    - \CPUSTRES64.EXE
    - \ctrl2cap.exe
    - \Dbgview.exe
    - \dbgview64.exe
    - \Desktops.exe
    - \Desktops64.exe
    - \disk2vhd.exe
    - \disk2vhd64.exe
    - \diskext.exe
    - \diskext64.exe
    - \Diskmon.exe
    - \Diskmon64.exe
    - \DiskView.exe
    - \DiskView64.exe
    - \du.exe
    - \du64.exe
    - \efsdump.exe
    - \FindLinks.exe
    - \FindLinks64.exe
    - \handle.exe
    - \handle64.exe
    - \hex2dec.exe
    - \hex2dec64.exe
    - \junction.exe
    - \junction64.exe
    - \ldmdump.exe
    - \listdlls.exe
    - \listdlls64.exe
    - \livekd.exe
    - \livekd64.exe
    - \loadOrd.exe
    - \loadOrd64.exe
    - \loadOrdC.exe
    - \loadOrdC64.exe
    - \logonsessions.exe
    - \logonsessions64.exe
    - \movefile.exe
    - \movefile64.exe
    - \notmyfault.exe
    - \notmyfault64.exe
    - \notmyfaultc.exe
    - \notmyfaultc64.exe
    - \ntfsinfo.exe
    - \ntfsinfo64.exe
    - \pendmoves.exe
    - \pendmoves64.exe
    - \pipelist.exe
    - \pipelist64.exe
    - \portmon.exe
    - \procdump.exe
    - \procdump64.exe
    - \procexp.exe
    - \procexp64.exe
    - \Procmon.exe
    - \Procmon64.exe
    - \psExec.exe
    - \psExec64.exe
    - \psfile.exe
    - \psfile64.exe
    - \psGetsid.exe
    - \psGetsid64.exe
    - \psInfo.exe
    - \psInfo64.exe
    - \pskill.exe
    - \pskill64.exe
    - \pslist.exe
    - \pslist64.exe
    - \psLoggedon.exe
    - \psLoggedon64.exe
    - \psloglist.exe
    - \psloglist64.exe
    - \pspasswd.exe
    - \pspasswd64.exe
    - \psping.exe
    - \psping64.exe
    - \psService.exe
    - \psService64.exe
    - \psshutdown.exe
    - \psshutdown64.exe
    - \pssuspend.exe
    - \pssuspend64.exe
    - \RAMMap.exe
    - \RDCMan.exe
    - \RegDelNull.exe
    - \RegDelNull64.exe
    - \regjump.exe
    - \ru.exe
    - \ru64.exe
    - \sdelete.exe
    - \sdelete64.exe
    - \ShareEnum.exe
    - \ShareEnum64.exe
    - \shellRunas.exe
    - \sigcheck.exe
    - \sigcheck64.exe
    - \streams.exe
    - \streams64.exe
    - \strings.exe
    - \strings64.exe
    - \sync.exe
    - \sync64.exe
    - \Sysmon.exe
    - \Sysmon64.exe
    - \tcpvcon.exe
    - \tcpvcon64.exe
    - \tcpview.exe
    - \tcpview64.exe
    - \Testlimit.exe
    - \Testlimit64.exe
    - \vmmap.exe
    - \vmmap64.exe
    - \Volumeid.exe
    - \Volumeid64.exe
    - \whois.exe
    - \whois64.exe
    - \Winobj.exe
    - \Winobj64.exe
    - \ZoomIt.exe
    - \ZoomIt64.exe
- condition: selection
  selection:
    CommandLine|contains: \AppData\
    Image|endswith: \sysprep.exe
- condition: selection
  selection:
  - Image|endswith: \systeminfo.exe
  - OriginalFileName: sysinfo.exe
- condition: all of selection_*
  selection_flag:
    CommandLine|contains: TurnOnDeveloperFeatures
  selection_img:
  - Image|endswith: \SystemSettingsAdminFlows.exe
  - OriginalFileName: SystemSettingsAdminFlows.EXE
  selection_options:
    CommandLine|contains:
    - DeveloperUnlock
    - EnableSideloading
- condition: selection
  selection:
    CommandLine|contains|all:
    - '/f '
    - /r
    Image|endswith: \takeown.exe
- condition: selection and not 1 of filter_*
  filter_avast:
    Image:
    - C:\Program Files\Avast Software\SecureLine VPN\tapinstall.exe
    - C:\Program Files (x86)\Avast Software\SecureLine VPN\tapinstall.exe
  filter_openvpn:
    Image|startswith: C:\Program Files\OpenVPN Connect\drivers\tap\
  filter_protonvpn:
    Image|startswith: C:\Program Files (x86)\Proton Technologies\ProtonVPNTap\installer\
  selection:
    Image|endswith: \tapinstall.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - ' /f'
    - ' /im '
  selection_img:
  - Image|endswith: \taskkill.exe
  - OriginalFileName: taskkill.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - taskkill
    - ' /F '
    - ' /IM '
    - ccSvcHst.exe
- condition: selection
  selection:
  - CommandLine|contains: tasklist
  - Image|endswith: \tasklist.exe
  - OriginalFileName: tasklist.exe
- condition: selection
  selection:
    Image|endswith: \taskmgr.exe
    User|contains:
    - AUTHORI
    - AUTORI
- condition: selection and not filter
  filter:
    Image|endswith:
    - \resmon.exe
    - \mmc.exe
    - \taskmgr.exe
  selection:
    ParentImage|endswith: \taskmgr.exe
- condition: selection and not filter
  filter:
    Image|endswith: \Microsoft\Teams\current\Teams.exe
  selection:
    CommandLine|contains:
    - \Microsoft\Teams\Cookies
    - \Microsoft\Teams\Local Storage\leveldb
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: create
  selection_img:
    Image|endswith: \tpmvscmgr.exe
    OriginalFileName: TpmVscMgr.exe
- condition: selection
  selection:
    Image|endswith: \tscon.exe
    User|contains:
    - AUTHORI
    - AUTORI
- condition: selection
  selection:
    CommandLine|contains: ' /dest:rdp-tcp#'
- condition: all of selection_*
  selection_img:
  - Image|endswith: \tscon.exe
  - OriginalFileName: tscon.exe
  selection_integrity:
    IntegrityLevel: SYSTEM
- condition: selection
  selection:
    Image|endswith: \changepk.exe
    IntegrityLevel:
    - High
    - System
    ParentImage|endswith: \slui.exe
- condition: selection
  selection:
    CommandLine|endswith: '"\system32\cleanmgr.exe /autoclean /d C:'
    IntegrityLevel:
    - High
    - System
    ParentCommandLine: C:\Windows\system32\svchost.exe -k netsvcs -p -s Schedule
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - /s
    - -s
    - /au
    - -au
    - /ni
    - -ni
  selection_img:
  - Image|endswith: \cmstp.exe
  - OriginalFileName: CMSTP.EXE
- condition: selection
  selection:
    IntegrityLevel:
    - High
    - System
    ParentCommandLine|contains:
    - ' /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}'
    - ' /Processid:{3E000D72-A845-4CD9-BD83-80C07C3B881F}'
    - ' /Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}'
    - ' /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}'
    - ' /Processid:{E9495B87-D950-4AB5-87A5-FF6D70BF3E90}'
    ParentImage|endswith: \DllHost.exe
- condition: selection and not filter
  filter:
    ParentImage|contains:
    - :\Windows\System32
    - :\Program Files
  selection:
    Image: C:\Windows\System32\ComputerDefaults.exe
    IntegrityLevel:
    - High
    - System
- condition: selection
  selection:
    Image|endswith: \werfault.exe
    IntegrityLevel:
    - High
    - System
    ParentImage|endswith: \consent.exe
- condition: selection
  selection:
    IntegrityLevel:
    - High
    - System
    ParentImage|contains|all:
    - C:\Users\
    - \AppData\Local\Temp\
    - \DismHost.exe
- condition: selection and not filter
  filter:
    Image|endswith:
    - \mmc.exe
    - :\Windows\SysWOW64\WerFault.exe
    - :\Windows\System32\WerFault.exe
  selection:
    ParentImage|endswith: \eventvwr.exe
- condition: all of selection_*
  selection_path:
    CommandLine|contains:
    - \Event Viewer\RecentViews
    - \EventV~1\RecentViews
  selection_redirect:
    CommandLine|contains: '>'
- condition: selection
  selection:
    ParentImage|endswith: \fodhelper.exe
- condition: selection and not filter
  filter:
    Image|endswith: \WerFault.exe
  selection:
    ParentCommandLine|contains: WF.msc
    ParentImage|endswith: \mmc.exe
- condition: selection and not filter
  filter:
  - Image|endswith: \WerFault.exe
  - OriginalFileName: WerFault.exe
  selection:
    ParentCommandLine|contains:
    - /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}
    - /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}
    ParentImage|endswith: \dllhost.exe
- condition: selection
  selection:
    IntegrityLevel:
    - High
    - System
    ParentCommandLine|contains: ' /Processid:{12C21EA7-2EB8-4B55-9249-AC243DA8C666}'
    ParentImage|endswith: \DllHost.exe
- condition: selection
  selection:
    Image|contains: \AppData\Local\Temp\
    Image|endswith: consent.exe
    IntegrityLevel:
    - High
    - System
    ParentImage|endswith: \ieinstal.exe
- condition: selection
  selection:
    CommandLine: '"C:\Windows\system32\msconfig.exe" -5'
    IntegrityLevel:
    - High
    - System
    ParentImage|endswith: \AppData\Local\Temp\pkgmgr.exe
- condition: 1 of selection*
  selection1:
    CommandLine|endswith: \AppData\Local\Temp\update.msu
    CommandLine|startswith: '"C:\Windows\system32\wusa.exe"  /quiet C:\Users\'
    IntegrityLevel:
    - High
    - System
  selection2:
    CommandLine|contains|all:
    - C:\Users\
    - \AppData\Local\Temp\
    - \dismhost.exe {
    Image|endswith: \DismHost.exe
    IntegrityLevel:
    - High
    - System
    ParentCommandLine: '"C:\Windows\system32\dism.exe" /online /quiet /norestart /add-package
      /packagepath:"C:\Windows\system32\pe386" /ignorecheck'
- condition: selection
  selection:
    Image|endswith: \dism.exe
    IntegrityLevel:
    - High
    - System
    ParentImage|endswith: \pkgmgr.exe
- condition: selection
  selection:
    Image|endswith: sdclt.exe
    IntegrityLevel: High
- condition: selection
  selection:
    Image|contains: C:\Windows \System32\
- condition: selection
  selection:
    IntegrityLevel:
    - High
    - System
    ParentCommandLine|contains: C:\Windows \system32\winsat.exe
    ParentImage|endswith: \AppData\Local\Temp\system32\winsat.exe
- condition: 1 of selection*
  selection1:
    Image: C:\Program Files\Windows Media Player\osk.exe
    IntegrityLevel:
    - High
    - System
  selection2:
    Image: C:\Windows\System32\cmd.exe
    IntegrityLevel:
    - High
    - System
    ParentCommandLine: '"C:\Windows\system32\mmc.exe" "C:\Windows\system32\eventvwr.msc"
      /s'
- condition: selection and not filter
  filter:
  - Image|endswith: \conhost.exe
  - OriginalFileName: CONHOST.EXE
  selection:
    ParentImage|endswith: \wsreset.exe
- condition: selection
  selection:
    Image|endswith: \wsreset.exe
    IntegrityLevel:
    - High
    - System
- condition: selection
  selection:
  - Description: VNCViewer
  - Product: UltraVNC VNCViewer
  - Company: UltraVNC
  - OriginalFileName: VNCViewer.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - '-autoreconnect '
    - '-connect '
    - '-id:'
- condition: selection
  selection:
    CommandLine|contains|all:
    - \WindowsSensor.exe
    - ' /uninstall'
    - ' /quiet'
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_explorer:
    Image: C:\WINDOWS\explorer.exe
  filter_optional_citrix:
    Image|endswith: \Citrix\System32\icast.exe
  filter_optional_image_null:
    Image: null
  filter_optional_logonscripts:
    CommandLine|contains:
    - netlogon.bat
    - UsrLogon.cmd
  filter_optional_proquota:
    Image:
    - C:\Windows\System32\proquota.exe
    - C:\Windows\SysWOW64\proquota.exe
  filter_optional_windows_core:
    CommandLine: PowerShell.exe
  selection:
    ParentImage|endswith: \userinit.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains: '/listcreds:'
  selection_img:
  - Image|endswith: \VaultCmd.exe
  - OriginalFileName: VAULTCMD.EXE
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - /S
    - /C
  selection_img:
  - Image|endswith: \verclsid.exe
  - OriginalFileName: verclsid.exe
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains:
    - VBoxRT.dll,RTR3Init
    - VBoxC.dll
    - VBoxDrv.sys
  selection_2:
    CommandLine|contains:
    - startvm
    - controlvm
- condition: selection
  selection:
    CommandLine|contains|all:
    - driver
    - executeinf
    Image|endswith: \VBoxDrvInst.exe
- condition: all of selection* and not 1 of filter_main_*
  filter_main_empty:
    CommandLine: ''
    Image|endswith: \cmd.exe
  filter_main_null:
    CommandLine: null
    Image|endswith: \cmd.exe
  filter_main_vmwaretools_script:
    CommandLine|contains:
    - \VMware\VMware Tools\poweron-vm-default.bat
    - \VMware\VMware Tools\poweroff-vm-default.bat
    - \VMware\VMware Tools\resume-vm-default.bat
    - \VMware\VMware Tools\suspend-vm-default.bat
    Image|endswith: \cmd.exe
  selection_img:
  - Image|endswith:
    - \cmd.exe
    - \cscript.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \wscript.exe
  - OriginalFileName:
    - Cmd.Exe
    - cscript.exe
    - MSHTA.EXE
    - PowerShell.EXE
    - pwsh.dll
    - REGSVR32.EXE
    - RUNDLL32.EXE
    - wscript.exe
  selection_parent:
    ParentImage|endswith: \vmtoolsd.exe
- condition: selection_parent and 1 of selection_children_*
  selection_children_cli:
    CommandLine|contains:
    - Invoke-Expressions
    - IEX
    - Invoke-Command
    - ICM
    - DownloadString
    - rundll32
    - regsvr32
    - wscript
    - cscript
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \cmd.exe
  selection_children_images:
    Image|endswith:
    - \calc.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \cscript.exe
    - \wscript.exe
  selection_children_paths:
    Image|contains:
    - C:\Users\Public\
    - C:\Windows\Temp\
    - C:\Temp\
  selection_parent:
    ParentImage|endswith: \code.exe
- condition: selection and not filter
  filter:
    CommandLine|contains: Microsoft.VisualStudio.LiveShare.Agent.
  selection:
    CommandLine|contains: --agentExtensionPath
    Image|endswith: \vsls-agent.exe
- condition: all of selection_*
  selection_cmd:
    CommandLine|contains|all:
    - /stripchart
    - '/computer:'
    - '/period:'
    - /dataonly
    - '/samples:'
  selection_w32tm:
  - Image|endswith: \w32tm.exe
  - OriginalFileName: w32time.dll
- condition: selection and not filter
  filter:
    Image|startswith:
    - C:\Windows\WinSxS\
    - C:\Program Files\Windows Mail\
    - C:\Program Files (x86)\Windows Mail\
  selection:
    Image|endswith:
    - \wab.exe
    - \wabmig.exe
- condition: 1 of selection_*
  selection_child:
    ParentImage|endswith:
    - \wab.exe
    - \wabmig.exe
  selection_parent:
    Image|endswith:
    - \wab.exe
    - \wabmig.exe
    ParentImage|endswith:
    - \WmiPrvSE.exe
    - \svchost.exe
    - \dllhost.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - 'delete '
    - 'systemstatebackup '
    - -keepVersions:0
  selection_img:
  - Image|endswith: \wbadmin.exe
  - OriginalFileName: WBADMIN.EXE
- condition: all of selection*
  selection_cmdline:
    CommandLine|contains:
    - '&ipconfig&echo'
    - '&quser&echo'
    - '&whoami&echo'
    - '&c:&echo'
    - '&cd&echo'
    - '&dir&echo'
    - '&echo [E]'
    - '&echo [S]'
  selection_origin:
  - Image|endswith: \w3wp.exe
  - ParentImage|endswith: \w3wp.exe
- condition: 1 of selection* and 1 of susp*
  selection_webserver_characteristics_tomcat1:
    ParentImage|contains:
    - -tomcat-
    - \tomcat
    ParentImage|endswith:
    - \java.exe
    - \javaw.exe
  selection_webserver_characteristics_tomcat2:
    CommandLine|contains:
    - catalina.jar
    - CATALINA_HOME
    ParentImage|endswith:
    - \java.exe
    - \javaw.exe
  selection_webserver_image:
    ParentImage|endswith:
    - \w3wp.exe
    - \php-cgi.exe
    - \nginx.exe
    - \httpd.exe
    - \caddy.exe
    - \ws_tomcatservice.exe
  susp_change_dir:
    CommandLine|contains:
    - '&cd&echo'
    - 'cd /d '
  susp_misc_discovery_binaries:
  - Image|endswith:
    - \whoami.exe
    - \systeminfo.exe
    - \quser.exe
    - \ipconfig.exe
    - \pathping.exe
    - \tracert.exe
    - \netstat.exe
    - \schtasks.exe
    - \vssadmin.exe
    - \wevtutil.exe
    - \tasklist.exe
  - OriginalFileName:
    - whoami.exe
    - sysinfo.exe
    - quser.exe
    - ipconfig.exe
    - pathping.exe
    - tracert.exe
    - netstat.exe
    - schtasks.exe
    - VSSADMIN.EXE
    - wevtutil.exe
    - tasklist.exe
  susp_misc_discovery_commands:
    CommandLine|contains:
    - ' Test-NetConnection '
    - dir \
  susp_net_utility:
    CommandLine|contains:
    - ' user '
    - ' use '
    - ' group '
    OriginalFileName:
    - net.exe
    - net1.exe
  susp_ping_utility:
    CommandLine|contains: ' -n '
    OriginalFileName: ping.exe
  susp_wmic_utility:
    CommandLine|contains: ' /node:'
    OriginalFileName: wmic.exe
- condition: 1 of selection_webserver* and 1 of selection_child*
  selection_child_1:
    CommandLine|contains|all:
    - rundll32
    - comsvcs
  selection_child_2:
    CommandLine|contains|all:
    - ' -hp'
    - ' a '
    - ' -m'
  selection_child_3:
    CommandLine|contains|all:
    - net
    - ' user '
    - ' /add'
  selection_child_4:
    CommandLine|contains|all:
    - net
    - ' localgroup '
    - ' administrators '
    - /add
  selection_child_5:
    Image|endswith:
    - \ntdsutil.exe
    - \ldifde.exe
    - \adfind.exe
    - \procdump.exe
    - \Nanodump.exe
    - \vssadmin.exe
    - \fsutil.exe
  selection_child_6:
    CommandLine|contains:
    - ' -NoP '
    - ' -W Hidden '
    - ' -decode '
    - ' /decode '
    - 'reg save '
    - .downloadstring(
    - .downloadfile(
    - FromBase64String
    - ' /ticket:'
    - ' sekurlsa'
    - .dmp full
    - process call create
    - whoami /priv
  selection_webserver_characteristics_tomcat1:
    ParentImage|contains:
    - -tomcat-
    - \tomcat
    ParentImage|endswith:
    - \java.exe
    - \javaw.exe
  selection_webserver_characteristics_tomcat2:
    CommandLine|contains:
    - catalina.jar
    - CATALINA_HOME
    ParentImage|endswith:
    - \java.exe
    - \javaw.exe
  selection_webserver_image:
    ParentImage|endswith:
    - \w3wp.exe
    - \php-cgi.exe
    - \nginx.exe
    - \httpd.exe
    - \caddy.exe
    - \ws_tomcatservice.exe
- condition: 1 of selection* and recon
  recon:
    CommandLine|contains:
    - perl --help
    - python --help
    - python -h
    - python3 --help
    - python3 -h
    - wget --help
    - perl -h
  selection_webserver_characteristics_tomcat1:
    ParentImage|contains:
    - -tomcat-
    - \tomcat
    ParentImage|endswith:
    - \java.exe
    - \javaw.exe
  selection_webserver_characteristics_tomcat2:
    CommandLine|contains:
    - catalina.jar
    - CATALINA_HOME
    ParentImage|endswith:
    - \java.exe
    - \javaw.exe
  selection_webserver_image:
    ParentImage|endswith:
    - \w3wp.exe
    - \php-cgi.exe
    - \nginx.exe
    - \httpd.exe
    - \caddy.exe
    - \ws_tomcatservice.exe
- anomaly_children:
    Image|endswith:
    - \cmd.exe
    - \cscript.exe
    - \sh.exe
    - \bash.exe
    - \powershell.exe
    - \powershell_ise.exe
    - \pwsh.exe
    - \bitsadmin.exe
    - \arp.exe
    - \at.exe
    - \certutil.exe
    - \dsget.exe
    - \dsquery.exe
    - \find.exe
    - \findstr.exe
    - \fsutil.exe
    - \hostname.exe
    - \ipconfig.exe
    - \nbtstat.exe
    - \net.exe
    - \net1.exe
    - \netdom.exe
    - \netsh.exe
    - \netstat.exe
    - \nltest.exe
    - \nslookup.exe
    - \ntdutil.exe
    - \pathping.exe
    - \ping.exe
    - \qprocess.exe
    - \query.exe
    - \qwinsta.exe
    - \reg.exe
    - \rundll32.exe
    - \sc.exe
    - \schtasks.exe
    - \systeminfo.exe
    - \tasklist.exe
    - \tracert.exe
    - \ver.exe
    - \vssadmin.exe
    - \wevtutil.exe
    - \whoami.exe
    - \wmic.exe
    - \wscript.exe
    - \wusa.exe
  condition: 1 of selection* and anomaly_children and not 1 of false_positive*
  false_positive1:
    CommandLine|endswith: Windows\system32\cmd.exe /c C:\ManageEngine\ADManager "Plus\ES\bin\elasticsearch.bat
      -Enode.name=RMP-NODE1 -pelasticsearch-pid.txt
  false_positive2:
    CommandLine|contains|all:
    - sc query
    - ADManager Plus
  selection_webserver_characteristics_tomcat1:
    ParentImage|contains:
    - -tomcat-
    - \tomcat
    ParentImage|endswith:
    - \java.exe
    - \javaw.exe
  selection_webserver_characteristics_tomcat2:
    ParentCommandLine|contains:
    - catalina.jar
    - CATALINA_HOME
    - catalina.home
    ParentImage|endswith:
    - \java.exe
    - \javaw.exe
  selection_webserver_image:
    ParentImage|endswith:
    - \w3wp.exe
    - \php.exe
    - \php-cgi.exe
    - \nginx.exe
    - \httpd.exe
    - \caddy.exe
    - \ws_TomcatService.exe
    - \tomcat.exe
    - \UMWorkerProcess.exe
- condition: all of selection_* and not 1 of filter_*
  filter_lsass:
    ParentImage: C:\Windows\System32\lsass.exe
  selection_cli:
    CommandLine|contains|all:
    - ' -u -p '
    - ' -ip '
    - ' -s '
    ParentUser|contains:
    - AUTHORI
    - AUTORI
    User|contains:
    - AUTHORI
    - AUTORI
  selection_img:
  - Image|endswith: \Werfault.exe
  - OriginalFileName: WerFault.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: ' -pr '
  selection_img:
  - Image|endswith: \WerFault.exe
  - OriginalFileName: WerFault.exe
- condition: 1 of selection_susp* or (selection_img and not filter_img_location)
  filter_img_location:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  selection_img:
    Image|endswith: \wermgr.exe
  selection_susp_parent:
    Image|endswith:
    - \nslookup.exe
    - \ipconfig.exe
    - \net.exe
    - \net1.exe
    - \whoami.exe
    - \netstat.exe
    - \systeminfo.exe
    - \cmd.exe
    - \powershell.exe
    ParentImage|endswith: \wermgr.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' qe '
    - ' query-events '
    Image|endswith: \wevtutil.exe
  selection_logs:
    CommandLine|contains:
    - Microsoft-Windows-TerminalServices-LocalSessionManager/Operational
    - Microsoft-Windows-Terminal-Services-RemoteConnectionManager/Operational
    - Security
- condition: all of where_*
  where_exe:
  - Image|endswith: \where.exe
  - OriginalFileName: where.exe
  where_opt:
    CommandLine|contains:
    - places.sqlite
    - cookies.sqlite
    - formhistory.sqlite
    - logins.json
    - key4.db
    - key3.db
    - sessionstore.jsonlz4
    - History
    - Bookmarks
    - Cookies
    - Login Data
- condition: selection
  selection:
  - Image|endswith: \whoami.exe
  - OriginalFileName: whoami.exe
- condition: all of selection_*
  selection_img:
  - OriginalFileName: whoami.exe
  - Image|endswith: \whoami.exe
  selection_user:
    User|contains:
    - AUTHORI
    - AUTORI
    - TrustedInstaller
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' /groups'
    - ' -groups'
  selection_img:
  - Image|endswith: \whoami.exe
  - OriginalFileName: whoami.exe
- condition: selection and not 1 of filter_*
  filter_generic:
    ParentImage|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \powershell_ise.exe
  filter_ms_monitoring_agent:
    ParentImage: C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe
  filter_parent_empty:
    ParentImage: ''
  filter_parent_null:
    ParentImage: null
  selection:
  - Image|endswith: \whoami.exe
  - OriginalFileName: whoami.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - ' /priv'
    - ' -priv'
  selection_img:
  - Image|endswith: \whoami.exe
  - OriginalFileName: whoami.exe
- condition: all of selection_main_* or selection_special
  selection_main_cli:
    CommandLine|contains:
    - ' -all'
    - ' /all'
    - ' /FO CSV'
    - ' -FO CSV'
  selection_main_img:
  - Image|endswith: \whoami.exe
  - OriginalFileName: whoami.exe
  selection_special:
    CommandLine|contains|all:
    - whoami
    - '>'
- condition: all of selection_* and not 1 of filter_*
  filter_builtin_visual_studio_shell:
    CommandLine|contains|all:
    - Import-Module
    - Microsoft.VisualStudio.DevShell.dll
    - Enter-VsDevShell
  filter_open_settings:
    CommandLine|contains|all:
    - \AppData\Local\Packages\Microsoft.WindowsTerminal_
    - \LocalState\settings.json
  filter_vsdevcmd:
    CommandLine|contains|all:
    - C:\Program Files\Microsoft Visual Studio\
    - \Common7\Tools\VsDevCmd.bat
  selection_parent:
    ParentImage|endswith:
    - \WindowsTerminal.exe
    - \wt.exe
  selection_susp:
  - Image|endswith:
    - \rundll32.exe
    - \regsvr32.exe
    - \certutil.exe
    - \cscript.exe
    - \wscript.exe
    - \csc.exe
  - Image|contains:
    - C:\Users\Public\
    - \Downloads\
    - \Desktop\
    - \AppData\Local\Temp\
    - \Windows\TEMP\
  - CommandLine|contains:
    - ' iex '
    - ' icm'
    - Invoke-
    - 'Import-Module '
    - 'ipmo '
    - DownloadString(
    - ' /c '
    - ' /k '
    - ' /r '
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - 'source '
    - 'add '
  selection_img:
  - Image|endswith: \winget.exe
  - OriginalFileName: winget.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - 'source '
    - 'add '
    - http://
  selection_img:
  - Image|endswith: \winget.exe
  - OriginalFileName: winget.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - 'source '
    - 'add '
  selection_img:
  - Image|endswith: \winget.exe
  - OriginalFileName: winget.exe
  selection_source_direct_ip:
    CommandLine|re: ://\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}
- condition: all of selection_*
  selection_img:
  - Image|endswith: \winget.exe
  - OriginalFileName: winget.exe
  selection_install_flag:
    CommandLine|contains:
    - install
    - ' add '
  selection_manifest_flag:
    CommandLine|contains:
    - '-m '
    - --manifest
- condition: all of selection_*
  selection_extension:
    CommandLine|contains:
    - .dmp
    - .dump
  selection_img:
  - Image|endswith:
    - \rar.exe
    - \winrar.exe
  - Description: Command line RAR
- condition: selection and not filter
  filter:
    Image|contains:
    - \WinRAR
    - C:\Windows\Temp
    - \UnRAR.exe
  selection:
  - Image|endswith:
    - \rar.exe
    - \winrar.exe
  - Description: Command line RAR
- condition: contains_winrm and (contains_format_pretty_arg and not image_from_system_folder)
  contains_format_pretty_arg:
    CommandLine|contains:
    - format:pretty
    - format:"pretty"
    - format:"text"
    - format:text
  contains_winrm:
    CommandLine|contains: winrm
  image_from_system_folder:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - winrm
    - invoke Create wmicimv2/Win32_
    - -r:http
  selection_img:
  - Image|endswith: \cscript.exe
  - OriginalFileName: cscript.exe
- condition: selection
  selection:
  - Image|endswith: \wsmprovhost.exe
  - ParentImage|endswith: \wsmprovhost.exe
- condition: selection
  selection:
    Image|endswith:
    - \cmd.exe
    - \sh.exe
    - \bash.exe
    - \powershell.exe
    - \pwsh.exe
    - \wsl.exe
    - \schtasks.exe
    - \certutil.exe
    - \whoami.exe
    - \bitsadmin.exe
    ParentImage|endswith: \wsmprovhost.exe
- condition: all of selection*
  selection_other:
    CommandLine|contains:
    - ' -min '
    - ' -a '
  selection_password:
    CommandLine|contains: -s"
  selection_winzip:
    CommandLine|contains:
    - winzip.exe
    - winzip64.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - ActiveScriptEventConsumer
    - ' CREATE '
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: /Namespace:\\\\root\\Microsoft\\Windows\\Defender
  selection_img:
  - OriginalFileName: wmic.exe
  - Image|endswith: \WMIC.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - process
    - call
    - create
  selection_img:
  - Image|endswith: \wmic.exe
  - OriginalFileName: wmic.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: computersystem
  selection_img:
  - Image|endswith: \wmic.exe
  - OriginalFileName: wmic.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: csproduct
  selection_img:
  - Image|endswith: \wmic.exe
  - OriginalFileName: wmic.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains: ' group'
  selection_img:
  - Image|endswith: \wmic.exe
  - OriginalFileName: wmic.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains: ' qfe'
  selection_img:
  - OriginalFileName: wmic.exe
  - Image|endswith: \WMIC.exe
- condition: all of selection* and not filter
  filter:
    CommandLine|contains|all:
    - call
    - create
  selection_cli:
    CommandLine|contains: process
  selection_img:
  - Image|endswith: \WMIC.exe
  - OriginalFileName: wmic.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: Product
  selection_img:
  - Image|endswith: \wmic.exe
  - OriginalFileName: wmic.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - AntiVirusProduct
    - FirewallProduct
  selection_img:
  - Image|endswith: \wmic.exe
  - OriginalFileName: wmic.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: service
  selection_img:
  - Image|endswith: \WMIC.exe
  - OriginalFileName: wmic.exe
- condition: all of selection_*
  selection_commands:
    CommandLine|contains:
    - baseboard get product
    - baseboard get version
    - bios get SMBIOSBIOSVersion
    - cpu get name
    - DISKDRIVE get Caption
    - LOGICALDISK get Name,Size,FreeSpace
    - MEMPHYSICAL get MaxCapacity
    - OS get Caption,OSArchitecture,Version
    - path win32_VideoController get DriverVersion
    - path win32_VideoController get name
    - path win32_VideoController get VideoModeDescription
  selection_wmic:
  - Description: WMI Commandline Utility
  - OriginalFileName: wmic.exe
  - Image|endswith: \WMIC.exe
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - ' service get '
    - name,displayname,pathname,startmode
  selection_img:
  - OriginalFileName: wmic.exe
  - Image|endswith: \WMIC.exe
- condition: all of selection_* and not 1 of filter_*
  filter_localhost:
    CommandLine|contains:
    - '/node:127.0.0.1 '
    - '/node:localhost '
  selection_cli:
    CommandLine|contains: '/node:'
  selection_img:
  - Image|endswith: \WMIC.exe
  - OriginalFileName: wmic.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - stopservice
    - startservice
    CommandLine|contains|all:
    - ' service '
    - ' call '
  selection_img:
  - OriginalFileName: wmic.exe
  - Image|endswith: \WMIC.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains|all:
    - 'format:'
    - http
  selection_pe:
  - Image|endswith: \wmic.exe
  - OriginalFileName: wmic.exe
  - Imphash:
    - 1B1A3F43BF37B5BFE60751F2EE2F326E
    - 37777A96245A3C74EB217308F3546F4C
    - 9D87C9D67CE724033C0B40CC4CA1B206
  - Hashes|contains:
    - IMPHASH=1B1A3F43BF37B5BFE60751F2EE2F326E
    - IMPHASH=37777A96245A3C74EB217308F3546F4C
    - IMPHASH=9D87C9D67CE724033C0B40CC4CA1B206
- condition: all of selection_*
  selection_parent:
    ParentImage|endswith:
    - \WINWORD.EXE
    - \EXCEL.EXE
    - \POWERPNT.exe
    - \MSPUB.exe
    - \VISIO.exe
    - \MSACCESS.EXE
    - \EQNEDT32.EXE
    - \ONENOTE.EXE
    - \wordpad.exe
    - \wordview.exe
  selection_wmic_cli:
    CommandLine|contains:
    - regsvr32
    - rundll32
    - msiexec
    - mshta
    - verclsid
    - wscript
    - cscript
    CommandLine|contains|all:
    - process
    - create
    - call
  selection_wmic_img:
  - Image|endswith: \wbem\WMIC.exe
  - OriginalFileName: wmic.exe
- condition: selection
  selection:
    CommandLine|contains:
    - rundll32
    - bitsadmin
    - regsvr32
    - 'cmd.exe /c '
    - 'cmd.exe /k '
    - 'cmd.exe /r '
    - 'cmd /c '
    - 'cmd /k '
    - 'cmd /r '
    - powershell
    - pwsh
    - certutil
    - cscript
    - wscript
    - mshta
    - \Users\Public\
    - \Windows\Temp\
    - \AppData\Local\
    - '%temp%'
    - '%tmp%'
    - '%ProgramData%'
    - '%appdata%'
    - '%comspec%'
    - '%localappdata%'
    CommandLine|contains|all:
    - 'process '
    - 'call '
    - 'create '
- condition: all of selection*
  selection_cli:
    CommandLine|contains:
    - call
    - uninstall
  selection_img:
  - Image|endswith: \WMIC.exe
  - OriginalFileName: wmic.exe
- condition: 1 of selection_cli_* and selection_product
  selection_cli_1:
    CommandLine|contains|all:
    - wmic
    - 'product where '
    - call
    - uninstall
    - /nointeractive
  selection_cli_2:
    CommandLine|contains:
    - call delete
    - call terminate
    CommandLine|contains|all:
    - wmic
    - 'caption like '
  selection_cli_3:
    CommandLine|contains|all:
    - 'process '
    - 'where '
    - delete
  selection_product:
    CommandLine|contains:
    - '%carbon%'
    - '%cylance%'
    - '%endpoint%'
    - '%eset%'
    - '%malware%'
    - '%Sophos%'
    - '%symantec%'
    - Antivirus
    - 'AVG '
    - Carbon Black
    - CarbonBlack
    - Cb Defense Sensor 64-bit
    - Crowdstrike Sensor
    - 'Cylance '
    - Dell Threat Defense
    - DLP Endpoint
    - Endpoint Detection
    - Endpoint Protection
    - Endpoint Security
    - Endpoint Sensor
    - ESET File Security
    - LogRhythm System Monitor Service
    - Malwarebytes
    - McAfee Agent
    - Microsoft Security Client
    - Sophos Anti-Virus
    - Sophos AutoUpdate
    - Sophos Credential Store
    - Sophos Management Console
    - Sophos Management Database
    - Sophos Management Server
    - Sophos Remote Management System
    - Sophos Update Manager
    - Threat Protection
    - VirusScan
    - Webroot SecureAnywhere
    - Windows Defender
- condition: (selection_wmic and not false_positives) or selection_msxsl
  false_positives:
    CommandLine|contains:
    - Format:List
    - Format:htable
    - Format:hform
    - Format:table
    - Format:mof
    - Format:value
    - Format:rawxml
    - Format:xml
    - Format:csv
  selection_msxsl:
    Image|endswith: \msxsl.exe
  selection_wmic:
    CommandLine|contains:
    - /format
    - -format
    Image|endswith: \wmic.exe
- condition: selection and not 1 of filter_*
  filter_logonid:
    LogonId:
    - '0x3e7'
    - 'null'
  filter_null:
    LogonId: null
  filter_system_user:
    User|contains:
    - AUTHORI
    - AUTORI
  filter_werfault:
    Image|endswith: \WerFault.exe
  filter_wmiprvse:
    Image|endswith: \WmiPrvSE.exe
  selection:
    ParentImage|endswith: \WmiPrvSe.exe
- condition: all of selection_*
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  selection_parent:
    ParentImage|endswith: \WmiPrvSE.exe
- condition: selection_parent and 1 of selection_children_* and not 1 of filter_*
  filter_werfault:
    Image|endswith: \WerFault.exe
  filter_wmiprvse:
    Image|endswith: \WmiPrvSE.exe
  selection_children_1:
    Image|endswith:
    - \certutil.exe
    - \cscript.exe
    - \mshta.exe
    - \msiexec.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \verclsid.exe
    - \wscript.exe
  selection_children_2:
    CommandLine|contains:
    - cscript
    - mshta
    - powershell
    - pwsh
    - regsvr32
    - rundll32
    - wscript
    Image|endswith: \cmd.exe
  selection_parent:
    ParentImage|endswith: \wbem\WmiPrvSE.exe
- condition: selection and not 1 of filter_*
  filter_conhost:
    Image: C:\Windows\System32\conhost.exe
  filter_oleconverter:
    Image|endswith: \Bin\OleConverter.exe
    Image|startswith: C:\Program Files\Microsoft\Exchange Server\
  selection:
    ParentImage|endswith: \EdgeTransport.exe
- condition: selection
  selection:
    Image: C:\WINDOWS\system32\wbem\scrcons.exe
    ParentImage: C:\Windows\System32\svchost.exe
- condition: selection
  selection:
    Image: C:\Windows\System32\wpbbin.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - .js
    - .jse
    - .vba
    - .vbe
    - .vbs
    - .wsf
  selection_img:
  - OriginalFileName:
    - wscript.exe
    - cscript.exe
  - Image|endswith:
    - \wscript.exe
    - \cscript.exe
- condition: selection_parent and (selection_cli_script_main and 1 of selection_cli_script_option_*)
  selection_cli_script_main:
    Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
  selection_cli_script_option_mshta:
    CommandLine|contains|all:
    - mshta
    - http
  selection_cli_script_option_other:
    CommandLine|contains:
    - rundll32
    - regsvr32
    - msiexec
  selection_parent:
    ParentImage|endswith:
    - \wscript.exe
    - \cscript.exe
- condition: all of selection_*
  selection_extension:
    CommandLine|contains:
    - .csv
    - .dat
    - .files
    - .gif
    - .jpeg
    - .jpg
    - .png
    - .ppt
    - .txt
    - .xls
    - .xml
  selection_img:
  - OriginalFileName:
    - wscript.exe
    - cscript.exe
  - Image|endswith:
    - \wscript.exe
    - \cscript.exe
- condition: selection_parent and 1 of selection_children_*
  selection_children_images:
    Image|endswith:
    - \powershell.exe
    - \pwsh.exe
    - \cmd.exe
    - \calc.exe
  selection_children_paths:
    Image|contains:
    - \AppData\Local\Temp\
    - C:\Users\Public\
    - C:\Windows\Temp\
    - C:\Temp\
    - \Downloads\
    - \Desktop\
  selection_parent:
    ParentImage|endswith:
    - \wsl.exe
    - \wslhost.exe
- condition: all of selection_* and not 1 of filter_main_*
  filter_main_kill:
    CommandLine|contains|all:
    - ' -d '
    - ' -e kill '
    ParentImage|endswith: \cmd.exe
  selection_cli:
    CommandLine|contains:
    - ' -e '
    - ' --exec'
    - ' --system'
    - ' --shell-type '
    - ' /mnt/c'
    - ' --user root'
    - ' -u root'
    - --debug-shell
  selection_img:
  - Image|endswith: \wsl.exe
  - OriginalFileName: wsl.exe
- condition: selection
  selection:
    CurrentDirectory|contains: \\\\wsl.localhost
    Image|re: '[a-zA-Z]:\\'
- condition: all of selection* and not filter
  filter:
    CommandLine|contains:
    - ' /ClassId '
    - ' wuaueng.dll '
  selection_cli:
    CommandLine|contains|all:
    - /UpdateDeploymentProvider
    - /RunHandlerComServer
    - .dll
  selection_img:
  - Image|endswith: \wuauclt.exe
  - OriginalFileName: wuauclt.exe
- condition: all of selection*
  selection_cli:
    CommandLine|endswith: \Wuauclt.exe
  selection_img:
  - Image|endswith: \Wuauclt.exe
  - OriginalFileName: Wuauclt.exe
- condition: selection
  selection:
    CommandLine|contains: '/extract:'
    Image|endswith: \wusa.exe
- condition: all of selection_*
  selection_paths:
    CommandLine|contains:
    - C:\Users\Public\
    - \Desktop\
    - \Downloads\
    - \Appdata\Local\Temp\
    - \Windows\Temp\
    - \PerfLogs\
  selection_root:
    CommandLine|contains: '/extract:'
    Image|endswith: \wusa.exe
- condition: not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_floppy:
    Device|contains: floppy
  filter_main_generic:
    Image|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
    - C:\Windows\System32\
    - C:\Windows\SystemApps\
    - C:\Windows\WinSxS\
    - C:\Windows\servicing\
    - C:\Windows\CCM\
    - C:\Windows\uus\
  filter_main_microsoft_appdata:
    Image|contains|all:
    - C:\Users\
    - \AppData\
    - \Microsoft\
  filter_main_setuphost:
    Image: C:\$WINDOWS.~BT\Sources\SetupHost.exe
  filter_main_specific:
    Image: C:\Windows\explorer.exe
  filter_main_ssd_nvme:
    Image|endswith:
    - \HostMetadata\NVMEHostmetadata.exe
    - \Executables\SSDUpdate.exe
    Image|startswith: C:\Windows\Temp\
  filter_main_system_images:
    Image:
    - System
    - Registry
  filter_main_windefender:
    Image|endswith: \MsMpEng.exe
    Image|startswith: C:\ProgramData\Microsoft\Windows Defender\Platform\
  filter_main_windows_update_box:
    Image|endswith: \WindowsUpdateBox.exe
    Image|startswith: C:\Windows\SoftwareDistribution\Download
  filter_optional_Keybase:
    Image|endswith: C:\Users\
    Image|startswith: \AppData\Local\Keybase\upd.exe
  filter_optional_github_desktop:
    Image|contains: \AppData\Local\GitHubDesktop\app-
    Image|endswith: \resources\app\git\mingw64\bin\git.exe
    Image|startswith: C:\Users\
  filter_optional_nextron:
    Image|endswith: \thor.exe
    Image|startswith: C:\Windows\Temp\asgard2-agent\
- condition: selection
  selection:
    EventType: CreateKey
    TargetObject|contains: \software\NetWire
- condition: selection and not filter
  filter:
    TargetObject|contains:
    - \SOFTWARE\AppDataLow\Software\Microsoft\Internet Explorer\
    - \SOFTWARE\AppDataLow\Software\Microsoft\RepService\
    - \SOFTWARE\AppDataLow\Software\Microsoft\IME\
    - \SOFTWARE\AppDataLow\Software\Microsoft\Edge\
  selection:
    EventType: CreateKey
    TargetObject|contains: \Software\AppDataLow\Software\Microsoft\
- condition: selection and not filter
  filter:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Program Files\
    - C:\Program Files (x86)\
  selection:
    EventType: CreateKey
    TargetObject|contains:
    - \SOFTWARE\Microsoft\AMSI\Providers\
    - \SOFTWARE\WOW6432Node\Microsoft\AMSI\Providers\
- condition: selection and not 1 of filter_*
  filter_svchost:
    Image: C:\WINDOWS\system32\svchost.exe
  selection:
    EventType: CreateKey
    TargetObject|contains|all:
    - HKU\
    - Classes\CLSID\
    - \TreatAs
- condition: selection and not filter
  filter:
    TargetObject|endswith:
    - \Active Setup Temp Folders
    - \BranchCache
    - \Content Indexer Cleaner
    - \D3D Shader Cache
    - \Delivery Optimization Files
    - \Device Driver Packages
    - \Diagnostic Data Viewer database files
    - \Downloaded Program Files
    - \DownloadsFolder
    - \Feedback Hub Archive log files
    - \Internet Cache Files
    - \Language Pack
    - \Microsoft Office Temp Files
    - \Offline Pages Files
    - \Old ChkDsk Files
    - \Previous Installations
    - \Recycle Bin
    - \RetailDemo Offline Content
    - \Setup Log Files
    - \System error memory dump files
    - \System error minidump files
    - \Temporary Files
    - \Temporary Setup Files
    - \Temporary Sync Files
    - \Thumbnail Cache
    - \Update Cleanup
    - \Upgrade Discarded Files
    - \User file versions
    - \Windows Defender
    - \Windows Error Reporting Files
    - \Windows ESD installation files
    - \Windows Upgrade Log Files
  selection:
    EventType: CreateKey
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\
- condition: selection
  selection:
    EventType: CreateKey
    TargetObject|contains: UserInitMprLogonScript
- condition: selection
  selection:
    EventType: CreateKey
    TargetObject|endswith: \EulaAccepted
- condition: selection and not filter
  filter:
    Image|endswith:
    - \ADExplorer.exe
    - \ADExplorer64.exe
    - \handle.exe
    - \handle64.exe
    - \livekd.exe
    - \livekd64.exe
    - \procdump.exe
    - \procdump64.exe
    - \procexp.exe
    - \procexp64.exe
    - \PsExec.exe
    - \PsExec64.exe
    - \PsLoggedon.exe
    - \PsLoggedon64.exe
    - \psloglist.exe
    - \psloglist64.exe
    - \pspasswd.exe
    - \pspasswd64.exe
    - \PsPing.exe
    - \PsPing64.exe
    - \PsService.exe
    - \PsService64.exe
    - \sdelete.exe
  selection:
    EventType: CreateKey
    TargetObject|contains:
    - \Active Directory Explorer
    - \Handle
    - \LiveKd
    - \ProcDump
    - \Process Explorer
    - \PsExec
    - \PsLoggedon
    - \PsLoglist
    - \PsPasswd
    - \PsPing
    - \PsService
    - \SDelete
    TargetObject|endswith: \EulaAccepted
- condition: selection
  selection:
    EventType: CreateKey
    TargetObject|contains:
    - \Active Directory Explorer
    - \Handle
    - \LiveKd
    - \Process Explorer
    - \ProcDump
    - \PsExec
    - \PsLoglist
    - \PsPasswd
    - \SDelete
    - \Sysinternals
    TargetObject|endswith: \EulaAccepted
- condition: selection
  selection:
    EventType: DeleteValue
    TargetObject|contains: SOFTWARE\Microsoft\Windows Defender\Windows Defender Exploit
      Guard\Controlled Folder Access\ProtectedFolders
- condition: 1 of selection*
  selection1:
    EventType: DeleteValue
    TargetObject|contains: \Microsoft\Terminal Server Client\Default\MRU
  selection2:
    EventType: DeleteKey
    TargetObject|contains: \Microsoft\Terminal Server Client\Servers\
- condition: selection
  selection:
    EventType: DeleteKey
    TargetObject|endswith:
    - '{2781761E-28E0-4109-99FE-B9D127C57AFE}'
    - '{A7C452EF-8E9F-42EB-9F2B-245613CA0DC9}'
- condition: selection and not 1 of filter_*
  filter_dropbox:
    Image|endswith: \Dropbox.exe
    TargetObject|contains: \Dropbox.
  filter_everything:
    Image|endswith: \Everything.exe
    TargetObject|contains: \Everything.
  filter_integrator:
    Image: C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe
  filter_java:
    Image|endswith: \installer.exe
    Image|startswith: C:\Program Files (x86)\Java\
    TargetObject|contains: \Classes\WOW6432Node\CLSID\{4299124F-F2C3-41b4-9C73-9236B2AD0E8F}
  filter_office:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith:
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\
  filter_opera:
    Image|endswith: \installer.exe
    Image|startswith:
    - C:\Program Files\Opera\
    - C:\Program Files (x86)\Opera\
  filter_peazip:
    Image|contains: peazip
    TargetObject|contains: \PeaZip.
  filter_svchost:
    Image: C:\Windows\system32\svchost.exe
  filter_uninstallers:
    Image|startswith: C:\Windows\Installer\MSI
  filter_wireshark:
    Image|endswith: \AppData\Local\Temp\Wireshark_uninstaller.exe
    TargetObject|contains: \wireshark-capture-file\
  selection:
    EventType: DeleteKey
    TargetObject|endswith: \shell\open\command
- condition: selection
  selection:
    EventType: DeleteKey
    TargetObject|contains|all:
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\
    - Index
- condition: selection
  selection:
    EventType: DeleteKey
    TargetObject|contains|all:
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\
    - SD
- condition: selection
  selection:
    Image|endswith: \lsass.exe
    TargetObject|contains: \SAM\SAM\Domains\Account\Users\Names\
    TargetObject|endswith: $
- condition: selection
  selection:
    TargetObject: HKCU\Software\Microsoft\Windows\CurrentVersion\Run\ntkd
- condition: 1 of selection*
  selection_hkcu:
    TargetObject|contains:
    - Classes\AppXc52346ec40fb4061ad96be0e6cb7d16a\
    - Classes\AppX3bbba44c6cae4d9695755183472171e2\
    - Classes\CLSID\{E3517E26-8E93-458D-A6DF-8030BC80528B}\
    - Classes\CLSID\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\Model
    TargetObject|startswith: HKCU\
  selection_ioc1:
    TargetObject: HKCU\SOFTWARE\Classes\CLSID\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\Model
  selection_ioc2:
    TargetObject|contains:
    - AppXbf13d4ea2945444d8b13e2121cb6b663\
    - AppX70162486c7554f7f80f481985d67586d\
    - AppX37cc7fdccd644b4f85f4b22d5a3f105a\
    TargetObject|endswith:
    - Application
    - DefaultIcon
    TargetObject|startswith:
    - HKCU\SOFTWARE\App\
    - HKLM\SOFTWARE\App\
- condition: selection
  selection:
    TargetObject|endswith:
    - SOFTWARE\Microsoft\Windows\CurrentVersion\UMe
    - SOFTWARE\Microsoft\Windows\CurrentVersion\UT
- condition: selection
  selection:
    TargetObject|contains: \SYSTEM\CurrentControlSet\services\null\Instance
- condition: selection
  selection:
    TargetObject|endswith: \AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\Shell\open\command
- condition: selection
  selection:
    TargetObject|contains: \cmmgr32.exe
- condition: selection
  selection:
  - EventType: CreateKey
    TargetObject: HKLM\SYSTEM\CurrentControlSet\Control\MiniNt
  - NewName: HKLM\SYSTEM\CurrentControlSet\Control\MiniNt
- condition: selection
  selection:
    TargetObject|endswith: \IsCredGuardEnabled
- condition: selection and not filter
  filter:
    TargetObject|contains: System\CurrentControlSet\Services\VSS\Start
  selection:
    Image|endswith: esentutl.exe
    TargetObject|contains: System\CurrentControlSet\Services\VSS
- condition: selection
  selection:
    TargetObject|contains: Services\WCESERVICE\Start
- condition: selection1 or selection2
  selection1:
    TargetObject|contains: \Services\HybridConnectionManager
  selection2:
    Details|contains: Microsoft.HybridConnectionManager.Listener.exe
    EventType: SetValue
- condition: selection
  selection:
    TargetObject|endswith: \Software\firm\soft\Name
- condition: selection
  selection:
    EventID:
    - 12
    - 13
    TargetObject|contains: SYSTEM\
    TargetObject|endswith: \services\localNETService
- condition: selection
  selection:
  - TargetObject:
    - HKLM\HARDWARE\{804423C2-F490-4ac3-BFA5-13DEDE63A71A}
    - HKLM\HARDWARE\{A5124AF5-DF23-49bf-B0ED-A18ED3DEA027}
    - HKLM\HARDWARE\{2DB80286-1784-48b5-A751-B6ED1F490303}
  - TargetObject|startswith: HKLM\SYSTEM\Setup\PrintResponsor\
- condition: selection or selection_alt or (selection_print and selection_kiwi)
  selection:
    TargetObject|contains:
    - \Control\Print\Environments\Windows x64\Drivers\Version-3\QMS 810\
    - \Control\Print\Environments\Windows x64\Drivers\Version-3\mimikatz
  selection_alt:
    TargetObject|contains|all:
    - legitprinter
    - \Control\Print\Environments\Windows
  selection_kiwi:
    TargetObject|contains:
    - Gentil Kiwi
    - mimikatz printer
    - Kiwi Legit Printer
  selection_print:
    TargetObject|contains:
    - \Control\Print\Environments
    - \CurrentVersion\Print\Printers
- condition: selection and not filter
  filter:
    Image|endswith:
    - \rundll32.exe
    - \explorer.exe
  selection:
    TargetObject|endswith: \Control Panel\Desktop\SCRNSAVE.EXE
- condition: 1 of selection*
  selection1:
    EventType: DeleteValue
    TargetObject|endswith: \AppXypsaf9f1qserqevf0sws76dx4k9a5206\Shell\open\command\DelegateExecute
  selection2:
    TargetObject|endswith: \AppXypsaf9f1qserqevf0sws76dx4k9a5206\Shell\open\command\(Default)
- condition: selection
  selection:
    TargetObject|contains|all:
    - SYSTEM\
    - ControlSet
    - \Control\Lsa
    TargetObject|endswith:
    - \lmcompatibilitylevel
    - \NtlmMinClientSec
    - \RestrictSendingNTLMTraffic
- condition: selection
  selection:
  - TargetObject: HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls
  - NewName: HKLM\SYSTEM\CurentControlSet\Control\Session Manager\AppCertDlls
- condition: selection and not filter
  filter:
    Details: (Empty)
  selection:
  - TargetObject|endswith:
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_Dlls
    - \SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_Dlls
  - NewName|endswith:
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_Dlls
    - \SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_Dlls
- condition: selection_registry
  selection_registry:
    TargetObject:
    - HKCU\Software\Microsoft\Office test\Special\Perf
    - HKLM\Software\Microsoft\Office test\Special\Perf
- condition: selection
  selection:
    TargetObject|contains: \Security\Trusted Documents\TrustRecords
- condition: 1 of selection_*
  selection_create:
    EventType: RenameKey
    NewName|contains: \CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\open
  selection_set:
    EventType: SetValue
    TargetObject|contains: \CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\open\command\(Default)
- condition: selection_registry
  selection_registry:
    TargetObject: HKLM\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4\tcp
- condition: selection
  selection:
    TargetObject|contains: HKLM\SOFTWARE\Microsoft\HTMLHelp\data
- condition: selection
  selection:
    TargetObject|endswith: Software\Microsoft\Windows\CurrentVersion\Run\Backup Mgr
- condition: selection and not 1 of filter_*
  filter_chrome:
    Details|contains: \Installer\chrmstp.exe" --configure-user-settings --verbose-logging
      --system-level
    Details|startswith: '"C:\Program Files\Google\Chrome\Application\'
  filter_edge:
    Details|endswith: \Installer\setup.exe" --configure-user-settings --verbose-logging
      --system-level --msedge --channel=stable
    Details|startswith:
    - '"C:\Program Files (x86)\Microsoft\Edge\Application\'
    - '"C:\Program Files\Microsoft\Edge\Application\'
  selection:
    TargetObject|endswith: \StubPath
    TargetObject|startswith: HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components
- condition: selection1 or selection2 or (selection3 and not filter_sel3)
  filter_sel3:
    Details: (Empty)
  selection1:
    Details|contains: \Software\Classes\{
    EventType: SetValue
    TargetObject|endswith: Classes\ms-settings\shell\open\command\SymbolicLinkValue
  selection2:
    TargetObject|endswith: Classes\ms-settings\shell\open\command\DelegateExecute
  selection3:
    EventType: SetValue
    TargetObject|endswith:
    - Classes\ms-settings\shell\open\command\(Default)
    - Classes\exefile\shell\open\command\(Default)
- condition: selection
  selection:
    TargetObject|contains: Microsoft\Windows NT\CurrentVersion\SilentProcessExit\lsass.exe
- condition: selection_registry and not exclusion_images
  exclusion_images:
    Image:
    - C:\Windows\system32\msiexec.exe
    - C:\Windows\syswow64\MsiExec.exe
  selection_registry:
    TargetObject:
    - HKLM\System\CurrentControlSet\Control\Lsa\Security Packages
    - HKLM\System\CurrentControlSet\Control\Lsa\OSConfig\Security Packages
- condition: selection_registry
  selection_registry:
    TargetObject|endswith:
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe\Debugger
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\utilman.exe\Debugger
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\osk.exe\Debugger
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\Magnify.exe\Debugger
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\Narrator.exe\Debugger
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\DisplaySwitch.exe\Debugger
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\atbroker.exe\Debugger
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\HelpPane.exe\Debugger
- condition: selection and not 1 of filter_*
  filter_atbroker:
    Details: (Empty)
    Image: C:\Windows\system32\atbroker.exe
    TargetObject|contains: \Microsoft\Windows NT\CurrentVersion\Accessibility\Configuration
  filter_uninstallers:
    Image|startswith: C:\Windows\Installer\MSI
    TargetObject|contains: Software\Microsoft\Windows NT\CurrentVersion\Accessibility\ATs
  selection:
    TargetObject|contains:
    - Software\Microsoft\Windows NT\CurrentVersion\Accessibility\ATs
    - Software\Microsoft\Windows NT\CurrentVersion\Accessibility\Configuration
- condition: selection
  selection:
    Image|contains:
    - \Downloads\
    - \Temporary Internet Files\Content.Outlook\
    - \Local Settings\Temporary Internet Files\
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion\Run\
- condition: selection and not 1 of filter_*
  filter_domain_controller:
    Details:
    - '%%systemroot%%\system32\ntdsa.dll'
    - '%%systemroot%%\system32\lsadb.dll'
    Image: C:\Windows\system32\lsass.exe
  selection:
    TargetObject|contains:
    - \CurrentControlSet\Services\NTDS\DirectoryServiceExtPt
    - \CurrentControlSet\Services\NTDS\LsaDbExtPt
- condition: all of selection_*
  selection_1:
    TargetObject|contains|all:
    - \Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\
    - \NonPackaged
  selection_2:
    TargetObject|contains:
    - microphone
    - webcam
  selection_3:
    TargetObject|contains:
    - :#Windows#Temp#
    - :#$Recycle.bin#
    - :#Temp#
    - :#Users#Public#
    - :#Users#Default#
    - :#Users#Desktop#
- condition: selection and not 1 of filter_*
  filter_sophos:
    Image: C:\WINDOWS\system32\msiexec.exe
    TargetObject:
    - HKLM\System\CurrentControlSet\Control\SafeBoot\Minimal\SAVService\(Default)
    - HKLM\System\CurrentControlSet\Control\SafeBoot\Network\SAVService\(Default)
  selection:
    Details: Service
    EventType: Setvalue
    TargetObject|endswith: \(Default)
    TargetObject|startswith:
    - HKLM\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\
    - HKLM\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\
- condition: selection and not 1 of filter_*
  filter_cutepdf:
    Details: cpwmon64_v40.dll
    Image: C:\Windows\System32\spoolsv.exe
    TargetObject|contains: \System\CurrentControlSet\Control\Print\Monitors\CutePDF
      Writer Monitor v4.0\Driver
    User|contains:
    - AUTHORI
    - AUTORI
  filter_leg1:
    TargetObject|contains: Control\Print\Monitors\MONVNC\Driver
  filter_leg2:
    TargetObject|contains|all:
    - Control\Print\Environments\
    - \Drivers\
    - \VNC Printer
  selection:
    Details|endswith: .dll
    EventType: SetValue
    TargetObject|startswith: HKLM\System\CurrentControlSet\Control\Print\Monitors\
- condition: selection and not filter
  filter:
    Details: '"C:\WINDOWS\system32\vsjitdebugger.exe" -p %ld -e %ld -j 0x%p'
  selection:
    Details|endswith: .dll
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug\Debugger
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: System\CurrentControlSet\Control\Terminal Server\fAllowToGetHelp
- condition: selection and not filter
  filter:
    Details: '%windir%\system32\amsi.dll'
  selection:
    EventType: SetValue
    TargetObject|endswith: \CLSID\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\InProcServer32\(Default)
- condition: all of selection_* and not 1 of filter_*
  filter_drivers:
    Image: C:\Windows\System32\drvinst.exe
  filter_empty:
    Details: (Empty)
  filter_msoffice:
    Details: '{807583E5-5146-11D5-A672-00B0D022E945}'
  filter_svchost:
    Image: C:\Windows\System32\svchost.exe
    TargetObject|contains: \lnkfile\shellex\ContextMenuHandlers\
  selection_classes_base:
    EventType: SetValue
    TargetObject|contains: \Software\Classes
  selection_classes_target:
    TargetObject|contains:
    - \Folder\ShellEx\ExtShellFolderViews
    - \Folder\ShellEx\DragDropHandlers
    - \Folder\Shellex\ColumnHandlers
    - \Filter
    - \Exefile\Shell\Open\Command\(Default)
    - \Directory\Shellex\DragDropHandlers
    - \Directory\Shellex\CopyHookHandlers
    - \CLSID\{AC757296-3522-4E11-9862-C17BE5A1767E}\Instance
    - \CLSID\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\Instance
    - \CLSID\{7ED96837-96F0-4812-B211-F13C24117ED3}\Instance
    - \CLSID\{083863F1-70DE-11d0-BD40-00A0C911CE86}\Instance
    - \Classes\AllFileSystemObjects\ShellEx\DragDropHandlers
    - \.exe
    - \.cmd
    - \ShellEx\PropertySheetHandlers
    - \ShellEx\ContextMenuHandlers
- condition: main_selection and not 1 of filter_*
  filter_IE:
    TargetObject|contains: \Software\Microsoft\Active Setup\Installed Components\{89820200-ECBD-11cf-8B85-00AA005B4383}
  filter_chrome:
    TargetObject|contains: \SOFTWARE\Microsoft\Active Setup\Installed Components\{8A69D345-D564-463c-AFF1-A69D9E530F96}
  filter_edge:
    TargetObject|contains: \SOFTWARE\Microsoft\Active Setup\Installed Components\{9459C573-B17A-45AE-9F64-1857B5D58CEE}
  filter_empty:
    Details: (Empty)
  filter_image:
    Image:
    - C:\Windows\System32\poqexec.exe
    - C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe
  filter_msoffice:
  - TargetObject|contains:
    - \Office\ClickToRun\REGISTRY\MACHINE\Software\Classes\PROTOCOLS\Handler\
    - \ClickToRunStore\HKMU\SOFTWARE\Classes\PROTOCOLS\Handler\
  - Details:
    - '{314111c7-a502-11d2-bbca-00c04f8ec294}'
    - '{3459B272-CC19-4448-86C9-DDC3B4B2FAD3}'
    - '{42089D2D-912D-4018-9087-2B87803E93FB}'
    - '{5504BE45-A83B-4808-900A-3A5C36E7F77A}'
    - '{807583E5-5146-11D5-A672-00B0D022E945}'
  filter_office:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith:
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\
  main_selection:
    EventType: SetValue
    TargetObject|contains:
    - \SOFTWARE\Wow6432Node\Microsoft\Windows CE Services\AutoStart
    - \Software\Wow6432Node\Microsoft\Command Processor\Autorun
    - \SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed Components
    - \SOFTWARE\Microsoft\Windows CE Services\AutoStartOnDisconnect
    - \SOFTWARE\Microsoft\Windows CE Services\AutoStartOnConnect
    - \SYSTEM\Setup\CmdLine
    - \Software\Microsoft\Ctf\LangBarAddin
    - \Software\Microsoft\Command Processor\Autorun
    - \SOFTWARE\Microsoft\Active Setup\Installed Components
    - \SOFTWARE\Classes\Protocols\Handler
    - \SOFTWARE\Classes\Protocols\Filter
    - \SOFTWARE\Classes\Htmlfile\Shell\Open\Command\(Default)
    - \Environment\UserInitMprLogonScript
    - \SOFTWARE\Policies\Microsoft\Windows\Control Panel\Desktop\Scrnsave.exe
    - \Software\Microsoft\Internet Explorer\UrlSearchHooks
    - \SOFTWARE\Microsoft\Internet Explorer\Desktop\Components
    - \Software\Classes\Clsid\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\Inprocserver32
    - \Control Panel\Desktop\Scrnsave.exe
- condition: all of system_control_* and not 1 of filter_*
  filter_cutepdf:
    Details:
    - cpwmon64_v40.dll
    - CutePDF Writer
    Image: C:\Windows\System32\spoolsv.exe
    TargetObject|contains: \Print\Monitors\CutePDF Writer Monitor
  filter_empty:
    Details: (Empty)
  filter_onenote:
    Image: C:\Windows\System32\spoolsv.exe
    TargetObject|contains: Print\Monitors\Appmon\Ports\Microsoft.Office.OneNote_
    User|contains:
    - AUTHORI
    - AUTORI
  filter_poqexec:
    Image: C:\Windows\System32\poqexec.exe
    TargetObject|endswith: \NetworkProvider\Order\ProviderOrder
  filter_realvnc:
    Details: VNCpm.dll
    Image: C:\Windows\System32\spoolsv.exe
    TargetObject|endswith: \Print\Monitors\MONVNC\Driver
  system_control_base:
    EventType: SetValue
    TargetObject|contains: \SYSTEM\CurrentControlSet\Control
  system_control_keys:
    TargetObject|contains:
    - \Terminal Server\WinStations\RDP-Tcp\InitialProgram
    - \Terminal Server\Wds\rdpwd\StartupPrograms
    - \SecurityProviders\SecurityProviders
    - \SafeBoot\AlternateShell
    - \Print\Providers
    - \Print\Monitors
    - \NetworkProvider\Order
    - \Lsa\Notification Packages
    - \Lsa\Authentication Packages
    - \BootVerificationProgram\ImagePath
- condition: all of current_version_* and not 1 of filter_*
  current_version_base:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion
  current_version_keys:
    TargetObject|contains:
    - \ShellServiceObjectDelayLoad
    - \Run\
    - \RunOnce\
    - \RunOnceEx\
    - \RunServices\
    - \RunServicesOnce\
    - \Policies\System\Shell
    - \Policies\Explorer\Run
    - \Group Policy\Scripts\Startup
    - \Group Policy\Scripts\Shutdown
    - \Group Policy\Scripts\Logon
    - \Group Policy\Scripts\Logoff
    - \Explorer\ShellServiceObjects
    - \Explorer\ShellIconOverlayIdentifiers
    - \Explorer\ShellExecuteHooks
    - \Explorer\SharedTaskScheduler
    - \Explorer\Browser Helper Objects
    - \Authentication\PLAP Providers
    - \Authentication\Credential Providers
    - \Authentication\Credential Provider Filters
  filter_AVG:
    Details:
    - '"C:\Program Files\AVG\Antivirus\AvLaunch.exe" /gui'
    - '"C:\Program Files (x86)\AVG\Antivirus\AvLaunch.exe" /gui'
    - '{472083B0-C522-11CF-8763-00608CC02F24}'
    Image|startswith: C:\Program Files\AVG\Antivirus\Setup\
  filter_all:
  - Details: (Empty)
  - TargetObject|endswith: \NgcFirst\ConsecutiveSwitchCount
  - Image|endswith:
    - \AppData\Local\Microsoft\OneDrive\Update\OneDriveSetup.exe
    - \AppData\Roaming\Spotify\Spotify.exe
    - \AppData\Local\WebEx\WebexHost.exe
  - Image:
    - C:\WINDOWS\system32\devicecensus.exe
    - C:\Windows\system32\winsat.exe
    - C:\Program Files\Microsoft OneDrive\StandaloneUpdater\OneDriveSetup.exe
    - C:\Program Files\Microsoft OneDrive\Update\OneDriveSetup.exe
    - C:\Program Files (x86)\Microsoft OneDrive\Update\OneDriveSetup.exe
    - C:\Program Files\KeePass Password Safe 2\ShInstUtil.exe
    - C:\Program Files\Everything\Everything.exe
    - C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe
  filter_aurora_dashboard:
    Details: C:\Program Files\Aurora-Agent\tools\aurora-dashboard.exe
    Image|endswith:
    - \aurora-agent-64.exe
    - \aurora-agent.exe
    TargetObject|endswith: \Microsoft\Windows\CurrentVersion\Run\aurora-dashboard
  filter_ctfmon:
    Details: ctfmon.exe /n
    Image: C:\Windows\system32\userinit.exe
  filter_defender:
    Image: C:\Program Files\Windows Defender\MsMpEng.exe
  filter_dropbox:
    Details|endswith: A251-47B7-93E1-CDD82E34AF8B}
    Image: C:\Windows\system32\regsvr32.exe
    TargetObject|contains: DropboxExt
  filter_edge:
    Image|startswith:
    - C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\
    - C:\Program Files (x86)\Microsoft\EdgeWebView\
    - C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
  filter_everything:
    Details|endswith: \Everything\Everything.exe" -startup
    TargetObject|endswith: \Microsoft\Windows\CurrentVersion\Run\Everything
  filter_googledrive1:
    Details|contains: \GoogleDriveFS.exe
    Details|startswith: C:\Program Files\Google\Drive File Stream\
    TargetObject|endswith: \Software\Microsoft\Windows\CurrentVersion\Run\GoogleDriveFS
  filter_googledrive2:
    Details:
    - '{CFE8B367-77A7-41D7-9C90-75D16D7DC6B6}'
    - '{A8E52322-8734-481D-A7E2-27B309EF8D56}'
    - '{C973DA94-CBDF-4E77-81D1-E5B794FBD146}'
    - '{51EF1569-67EE-4AD6-9646-E726C3FFC8A2}'
    TargetObject|contains: GoogleDrive
  filter_greenshot:
    Details: C:\Program Files\Greenshot\Greenshot.exe
    TargetObject|endswith: \SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Greenshot
  filter_itunes:
    Details: '"C:\Program Files\iTunes\iTunesHelper.exe"'
    TargetObject|endswith: \SOFTWARE\Microsoft\Windows\CurrentVersion\Run\iTunesHelper
  filter_logonui:
    Image: C:\Windows\system32\LogonUI.exe
    TargetObject|contains:
    - \Authentication\Credential Providers\{D6886603-9D2F-4EB2-B667-1971041FA96B}\
    - \Authentication\Credential Providers\{BEC09223-B018-416D-A0AC-523971B639F5}\
    - \Authentication\Credential Providers\{8AF662BF-65A0-4D0A-A540-A338A999D36F}\
    - \Authentication\Credential Providers\{27FBDB57-B613-4AF2-9D7E-4FA7A66C21AD}\
  filter_officeclicktorun:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith:
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\
  filter_onedrive:
    Details|contains: \AppData\Local\Microsoft\OneDrive\
    Details|startswith:
    - C:\Windows\system32\cmd.exe /q /c rmdir /s /q "C:\Users\
    - C:\Windows\system32\cmd.exe /q /c del /q "C:\Users\
  filter_opera:
    Details: C:\Program Files\Opera\assistant\browser_assistant.exe
    TargetObject|endswith: \SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Opera Browser
      Assistant
  filter_python:
    Details|contains|all:
    - \AppData\Local\Package Cache\{
    - '}\python-'
    Details|endswith: .exe" /burn.runonce
    TargetObject|contains: \Microsoft\Windows\CurrentVersion\RunOnce\{
  filter_teams:
    Details|contains: '\Microsoft\Teams\Update.exe --processStart '
    Image|endswith: \Microsoft\Teams\current\Teams.exe
  filter_zoom:
    Details: '"C:\Program Files\Zoom\bin\installer.exe" /repair'
    TargetObject|endswith: \SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce\zoommsirepair
- condition: nt_current_version_base and nt_current_version and not 1 of filter_*
  filter_edge:
    Image|endswith: \MicrosoftEdgeUpdate.exe
    Image|startswith: C:\Program Files (x86)\Microsoft\Temp\
  filter_empty:
    Details: (Empty)
  filter_legitimate_subkey:
    TargetObject|contains: \Image File Execution Options\
    TargetObject|endswith:
    - \DisableExceptionChainValidation
    - \MitigationOptions
  filter_msoffice:
  - TargetObject|contains:
    - \ClickToRunStore\HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\
    - \ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows NT\CurrentVersion\
  - Image:
    - C:\Program Files\Microsoft Office\root\integration\integrator.exe
    - C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe
  filter_ngen:
    Image|endswith: \ngen.exe
    Image|startswith: C:\Windows\Microsoft.NET\Framework
  filter_officeclicktorun:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith:
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\
  filter_onedrive:
    Details|endswith: \AppData\Local\Microsoft\OneDrive\Update\OneDriveSetup.exe"
    Details|startswith: C:\Windows\system32\cmd.exe /q /c del /q "C:\Users\
    Image|endswith: \AppData\Local\Microsoft\OneDrive\StandaloneUpdater\OneDriveSetup.exe
    TargetObject|endswith: \Microsoft\Windows\CurrentVersion\RunOnce\Delete Cached
      Update Binary
  filter_security_extension_dc:
    Details:
    - DWORD (0x00000009)
    - DWORD (0x000003c0)
    Image: C:\Windows\system32\svchost.exe
    TargetObject|contains:
    - \Winlogon\GPExtensions\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\PreviousPolicyAreas
    - \Winlogon\GPExtensions\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\MaxNoGPOListChangesInterval
  nt_current_version:
    TargetObject|contains:
    - \Winlogon\VmApplet
    - \Winlogon\Userinit
    - \Winlogon\Taskman
    - \Winlogon\Shell
    - \Winlogon\GpExtensions
    - \Winlogon\AppSetup
    - \Winlogon\AlternateShells\AvailableShells
    - \Windows\IconServiceLib
    - \Windows\Appinit_Dlls
    - \Image File Execution Options
    - \Font Drivers
    - \Drivers32
    - \Windows\Run
    - \Windows\Load
  nt_current_version_base:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows NT\CurrentVersion
- condition: ie and ie_details and not 1 of filter_*
  filter_empty:
    Details: (Empty)
  filter_extensions:
    TargetObject|contains:
    - \Extensions\{2670000A-7350-4f3c-8081-5663EE0C6C49}
    - \Extensions\{31D09BA0-12F5-4CCE-BE8A-2923E76605DA}
    - \Extensions\{789FE86F-6FC4-46A1-9849-EDE0DB0C95CA}
    - \Extensions\{A95fe080-8f5d-11d2-a20b-00aa003c157a}
  filter_toolbar:
    TargetObject|endswith:
    - \Toolbar\ShellBrowser\ITBar7Layout
    - \Toolbar\ShowDiscussionButton
    - \Toolbar\Locked
  ie:
    EventType: SetValue
    TargetObject|contains:
    - \Software\Wow6432Node\Microsoft\Internet Explorer
    - \Software\Microsoft\Internet Explorer
  ie_details:
    TargetObject|contains:
    - \Toolbar
    - \Extensions
    - \Explorer Bars
- condition: office and office_details and not 1 of filter_*
  filter_avg:
    Image: C:\Program Files\AVG\Antivirus\RegSvr.exe
    TargetObject|contains: \Microsoft\Office\Outlook\Addins\Antivirus.AsOutExt\
  filter_empty:
    Details: (Empty)
  filter_known_addins:
    Image|startswith:
    - C:\Program Files\Microsoft Office\
    - C:\Program Files (x86)\Microsoft Office\
    - C:\Windows\System32\msiexec.exe
    - C:\Windows\System32\regsvr32.exe
    TargetObject|contains:
    - \Excel\Addins\AdHocReportingExcelClientLib.AdHocReportingExcelClientAddIn.1\
    - \Excel\Addins\ExcelPlugInShell.PowerMapConnect\
    - \Excel\Addins\NativeShim\
    - \Excel\Addins\NativeShim.InquireConnector.1\
    - \Excel\Addins\PowerPivotExcelClientAddIn.NativeEntry.1\
    - \Outlook\AddIns\AccessAddin.DC\
    - \Outlook\AddIns\ColleagueImport.ColleagueImportAddin\
    - \Outlook\AddIns\EvernoteCC.EvernoteContactConnector\
    - \Outlook\AddIns\EvernoteOLRD.Connect\
    - \Outlook\Addins\Microsoft.VbaAddinForOutlook.1\
    - \Outlook\Addins\OcOffice.OcForms\
    - \Outlook\Addins\\OneNote.OutlookAddin
    - \Outlook\Addins\OscAddin.Connect\
    - \Outlook\Addins\OutlookChangeNotifier.Connect\
    - \Outlook\Addins\UCAddin.LyncAddin.1
    - \Outlook\Addins\UCAddin.UCAddin.1
    - \Outlook\Addins\UmOutlookAddin.FormRegionAddin\
  filter_officeclicktorun:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith:
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\
  office:
    EventType: SetValue
    TargetObject|contains:
    - \Software\Wow6432Node\Microsoft\Office
    - \Software\Microsoft\Office
  office_details:
    TargetObject|contains:
    - \Word\Addins
    - \PowerPoint\Addins
    - \Outlook\Addins
    - \Onenote\Addins
    - \Excel\Addins
    - \Access\Addins
    - test\Special\Perf
- condition: session_manager_base and session_manager and not filter
  filter:
    Details: (Empty)
  session_manager:
    TargetObject|contains:
    - \SetupExecute
    - \S0InitialCommand
    - \KnownDlls
    - \Execute
    - \BootExecute
    - \AppCertDlls
  session_manager_base:
    EventType: SetValue
    TargetObject|contains: \System\CurrentControlSet\Control\Session Manager
- condition: scripts_base and scripts and not filter
  filter:
    Details: (Empty)
  scripts:
    TargetObject|contains:
    - \Startup
    - \Shutdown
    - \Logon
    - \Logoff
  scripts_base:
    EventType: SetValue
    TargetObject|contains: \Software\Policies\Microsoft\Windows\System\Scripts
- condition: winsock_parameters_base and winsock_parameters and not filter
  filter:
  - Details: (Empty)
  - Image: C:\Windows\System32\MsiExec.exe
  - Image: C:\Windows\syswow64\MsiExec.exe
  winsock_parameters:
    TargetObject|contains:
    - \Protocol_Catalog9\Catalog_Entries
    - \NameSpace_Catalog5\Catalog_Entries
  winsock_parameters_base:
    EventType: SetValue
    TargetObject|contains: \System\CurrentControlSet\Services\WinSock2\Parameters
- condition: all of selection_wow_current_version_* and not 1 of filter_*
  filter_dotnet:
    Details|endswith: .exe" /burn.runonce
    Details|startswith: '"C:\ProgramData\Package Cache\'
    Image|contains: \windowsdesktop-runtime-
    TargetObject|endswith:
    - \WOW6432Node\Microsoft\Windows\CurrentVersion\RunOnce\{e2d1ae32-dd1d-4ad7-a298-10e42e7840fc}
    - \WOW6432Node\Microsoft\Windows\CurrentVersion\RunOnce\{7037b699-7382-448c-89a7-4765961d2537}
  filter_dropbox:
  - Details|endswith: -A251-47B7-93E1-CDD82E34AF8B}
  - Details: grpconv -o
  - Details|contains|all:
    - C:\Program Files
    - \Dropbox\Client\Dropbox.exe
    - ' /systemstartup'
  filter_edge:
    Image|contains|all:
    - C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\{
    - \setup.exe
  filter_empty:
    Details: (Empty)
  filter_evernote:
    TargetObject|endswith: \Explorer\Browser Helper Objects\{92EF2EAD-A7CE-4424-B0DB-499CF856608E}\NoExplorer
  filter_ms_win_desktop_runtime:
    Details|startswith: '"C:\ProgramData\Package Cache\{d21a4f20-968a-4b0c-bf04-a38da5f06e41}\windowsdesktop-runtime-'
  filter_msiexec:
    Image: C:\WINDOWS\system32\msiexec.exe
    TargetObject|contains: \SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run\
  filter_msoffice1:
    Image: C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe
    TargetObject|contains: \Office\ClickToRun\REGISTRY\MACHINE\Software\Wow6432Node\
  filter_msoffice2:
    Image:
    - C:\Program Files\Microsoft Office\root\integration\integrator.exe
    - C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe
    TargetObject|contains: \Explorer\Browser Helper Objects\{31D09BA0-12F5-4CCE-BE8A-2923E76605DA}\
  filter_office:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith:
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\
  filter_uninstallers:
    Image|startswith: C:\Windows\Installer\MSI
    TargetObject|contains: \Explorer\Browser Helper Objects
  filter_upgrades:
    Details|endswith: ' /burn.runonce'
    Image|contains:
    - \winsdksetup.exe
    - \windowsdesktop-runtime-
    - \AspNetCoreSharedFrameworkBundle-
    Image|startswith:
    - C:\ProgramData\Package Cache
    - C:\Windows\Temp\
  filter_vcredist:
    Details|endswith: '}\VC_redist.x64.exe" /burn.runonce'
    Image|endswith: \VC_redist.x64.exe
  selection_wow_current_version_base:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion
  selection_wow_current_version_keys:
    TargetObject|contains:
    - \ShellServiceObjectDelayLoad
    - \Run\
    - \RunOnce\
    - \RunOnceEx\
    - \RunServices\
    - \RunServicesOnce\
    - \Explorer\ShellServiceObjects
    - \Explorer\ShellIconOverlayIdentifiers
    - \Explorer\ShellExecuteHooks
    - \Explorer\SharedTaskScheduler
    - \Explorer\Browser Helper Objects
- condition: wow_classes_base and wow_classes and not filter
  filter:
    Details: (Empty)
  wow_classes:
    TargetObject|contains:
    - \Folder\ShellEx\ExtShellFolderViews
    - \Folder\ShellEx\DragDropHandlers
    - \Folder\ShellEx\ColumnHandlers
    - \Directory\Shellex\DragDropHandlers
    - \Directory\Shellex\CopyHookHandlers
    - \CLSID\{AC757296-3522-4E11-9862-C17BE5A1767E}\Instance
    - \CLSID\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\Instance
    - \CLSID\{7ED96837-96F0-4812-B211-F13C24117ED3}\Instance
    - \CLSID\{083863F1-70DE-11d0-BD40-00A0C911CE86}\Instance
    - \AllFileSystemObjects\ShellEx\DragDropHandlers
    - \ShellEx\PropertySheetHandlers
    - \ShellEx\ContextMenuHandlers
  wow_classes_base:
    EventType: SetValue
    TargetObject|contains: \Software\Wow6432Node\Classes
- condition: wow_nt_current_version_base and wow_nt_current_version and not filter
  filter:
    Details:
    - (Empty)
    - \REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution
      Options
  wow_nt_current_version:
    TargetObject|contains:
    - \Windows\Appinit_Dlls
    - \Image File Execution Options
    - \Drivers32
  wow_nt_current_version_base:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject:
    - HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy
    - HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLinkedConnections
    - HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\LongPathsEnabled
- condition: selection
  selection:
    Details: (Empty)
    EventType: SetValue
    TargetObject|endswith: \open\command\DelegateExecute
- condition: selection and not filter
  filter:
    Details|startswith: '%SystemRoot%\system32\mmc.exe "%1" %'
  selection:
    EventType: SetValue
    TargetObject|endswith: _Classes\mscfile\shell\open\command\(Default)
- condition: selection
  selection:
    Details|contains: '&REM'
    EventType: SetValue
    TargetObject|endswith: \Environment\windir
- condition: selection and not filter
  filter:
    Details: DWORD (0x00000d3d)
  selection:
    EventType: SetValue
    TargetObject: HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\PortNumber
- condition: selection_domains and not filter
  filter:
    Details:
    - DWORD (0x00000000)
    - DWORD (0x00000001)
    - (Empty)
  selection_domains:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains\
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|endswith: \Instances\Sysmon Instance\Altitude
    TargetObject|startswith: HKLM\SYSTEM\CurrentControlSet\
- condition: selection and not 1 of filter*
  filter_ti_worker:
    Image|endswith: \TiWorker.exe
  filter_trustedinstaller:
    Image: C:\Windows\servicing\TrustedInstaller.exe
  selection:
    Details|contains:
    - (A;;0x1;;;SY)
    - (A;;0x5;;;BA)
    - (A;;0x1;;;LA)
    EventType: SetValue
    TargetObject|endswith: \ChannelAccess
    TargetObject|startswith: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\
- chrome_ext:
    EventType: SetValue
    TargetObject|contains: Software\Wow6432Node\Google\Chrome\Extensions
    TargetObject|endswith: update_url
  chrome_vpn:
    TargetObject|contains:
    - fdcgdnkidjaadafnichfpabhfomcebme
    - fcfhplploccackoneaefokcmbjfbkenj
    - bihmplhobchoageeokmgbdihknkjbknd
    - gkojfkhlekighikafcpjkiklfbnlmeio
    - jajilbjjinjmgcibalaakngmkilboobh
    - gjknjjomckknofjidppipffbpoekiipm
    - nabbmpekekjknlbkgpodfndbodhijjem
    - kpiecbcckbofpmkkkdibbllpinceiihk
    - nlbejmccbhkncgokjcmghpfloaajcffj
    - omghfjlpggmjjaagoclmmobgdodcjboh
    - bibjcjfmgapbfoljiojpipaooddpkpai
    - mpcaainmfjjigeicjnlkdfajbioopjko
    - jljopmgdobloagejpohpldgkiellmfnc
    - lochiccbgeohimldjooaakjllnafhaid
    - nhnfcgpcbfclhfafjlooihdfghaeinfc
    - ookhnhpkphagefgdiemllfajmkdkcaim
    - namfblliamklmeodpcelkokjbffgmeoo
    - nbcojefnccbanplpoffopkoepjmhgdgh
    - majdfhpaihoncoakbjgbdhglocklcgno
    - lnfdmdhmfbimhhpaeocncdlhiodoblbd
    - eppiocemhmnlbhjplcgkofciiegomcon
    - cocfojppfigjeefejbpfmedgjbpchcng
    - foiopecknacmiihiocgdjgbjokkpkohc
    - hhdobjgopfphlmjbmnpglhfcgppchgje
    - jgbaghohigdbgbolncodkdlpenhcmcge
    - inligpkjkhbpifecbdjhmdpcfhnlelja
    - higioemojdadgdbhbbbkfbebbdlfjbip
    - hipncndjamdcmphkgngojegjblibadbe
    - iolonopooapdagdemdoaihahlfkncfgg
    - nhfjkakglbnnpkpldhjmpmmfefifedcj
    - jpgljfpmoofbmlieejglhonfofmahini
    - fgddmllnllkalaagkghckoinaemmogpe
    - ejkaocphofnobjdedneohbbiilggdlbi
    - keodbianoliadkoelloecbhllnpiocoi
    - hoapmlpnmpaehilehggglehfdlnoegck
    - poeojclicodamonabcabmapamjkkmnnk
    - dfkdflfgjdajbhocmfjolpjbebdkcjog
    - kcdahmgmaagjhocpipbodaokikjkampi
    - klnkiajpmpkkkgpgbogmcgfjhdoljacg
    - lneaocagcijjdpkcabeanfpdbmapcjjg
    - pgfpignfckbloagkfnamnolkeaecfgfh
    - jplnlifepflhkbkgonidnobkakhmpnmh
    - jliodmnojccaloajphkingdnpljdhdok
    - hnmpcagpplmpfojmgmnngilcnanddlhb
    - ffbkglfijbcbgblgflchnbphjdllaogb
    - kcndmbbelllkmioekdagahekgimemejo
    - jdgilggpfmjpbodmhndmhojklgfdlhob
    - bihhflimonbpcfagfadcnbbdngpopnjb
    - ppajinakbfocjfnijggfndbdmjggcmde
    - oofgbpoabipfcfjapgnbbjjaenockbdp
    - bhnhkdgoefpmekcgnccpnhjfdgicfebm
    - knmmpciebaoojcpjjoeonlcjacjopcpf
    - dhadilbmmjiooceioladdphemaliiobo
    - jedieiamjmoflcknjdjhpieklepfglin
    - mhngpdlhojliikfknhfaglpnddniijfh
    - omdakjcmkglenbhjadbccaookpfjihpa
    - npgimkapccfidfkfoklhpkgmhgfejhbj
    - akeehkgglkmpapdnanoochpfmeghfdln
    - gbmdmipapolaohpinhblmcnpmmlgfgje
    - aigmfoeogfnljhnofglledbhhfegannp
    - cgojmfochfikphincbhokimmmjenhhgk
    - ficajfeojakddincjafebjmfiefcmanc
    - ifnaibldjfdmaipaddffmgcmekjhiloa
    - jbnmpdkcfkochpanomnkhnafobppmccn
    - apcfdffemoinopelidncddjbhkiblecc
    - mjolnodfokkkaichkcjipfgblbfgojpa
    - oifjbnnafapeiknapihcmpeodaeblbkn
    - plpmggfglncceinmilojdkiijhmajkjh
    - mjnbclmflcpookeapghfhapeffmpodij
    - bblcccknbdbplgmdjnnikffefhdlobhp
    - aojlhgbkmkahabcmcpifbolnoichfeep
    - lcmammnjlbmlbcaniggmlejfjpjagiia
    - knajdeaocbpmfghhmijicidfcmdgbdpm
    - bdlcnpceagnkjnjlbbbcepohejbheilk
    - edknjdjielmpdlnllkdmaghlbpnmjmgb
    - eidnihaadmmancegllknfbliaijfmkgo
    - ckiahbcmlmkpfiijecbpflfahoimklke
    - macdlemfnignjhclfcfichcdhiomgjjb
    - chioafkonnhbpajpengbalkececleldf
    - amnoibeflfphhplmckdbiajkjaoomgnj
    - llbhddikeonkpbhpncnhialfbpnilcnc
    - pcienlhnoficegnepejpfiklggkioccm
    - iocnglnmfkgfedpcemdflhkchokkfeii
    - igahhbkcppaollcjeaaoapkijbnphfhb
    - njpmifchgidinihmijhcfpbdmglecdlb
    - ggackgngljinccllcmbgnpgpllcjepgc
    - kchocjcihdgkoplngjemhpplmmloanja
    - bnijmipndnicefcdbhgcjoognndbgkep
    - lklekjodgannjcccdlbicoamibgbdnmi
    - dbdbnchagbkhknegmhgikkleoogjcfge
    - egblhcjfjmbjajhjhpmnlekffgaemgfh
    - ehbhfpfdkmhcpaehaooegfdflljcnfec
    - bkkgdjpomdnfemhhkalfkogckjdkcjkg
    - almalgbpmcfpdaopimbdchdliminoign
    - akkbkhnikoeojlhiiomohpdnkhbkhieh
    - gbfgfbopcfokdpkdigfmoeaajfmpkbnh
    - bniikohfmajhdcffljgfeiklcbgffppl
    - lejgfmmlngaigdmmikblappdafcmkndb
    - ffhhkmlgedgcliajaedapkdfigdobcif
    - gcknhkkoolaabfmlnjonogaaifnjlfnp
    - pooljnboifbodgifngpppfklhifechoe
    - fjoaledfpmneenckfbpdfhkmimnjocfa
    - aakchaleigkohafkfjfjbblobjifikek
    - dpplabbmogkhghncfbfdeeokoefdjegm
    - padekgcemlokbadohgkifijomclgjgif
    - bfidboloedlamgdmenmlbipfnccokknp
  condition: all of chrome_*
- condition: selection
  selection:
    Details: Enabled
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\MICROSOFT\.NETFramework\Security\TrustManager\PromptingLevel\
    TargetObject|endswith:
    - \Internet
    - \LocalIntranet
    - \MyComputer
    - \TrustedSites
    - \UntrustedSites
- condition: main and 1 of selection_*
  main:
    EventType: SetValue
    TargetObject|contains: HKLM\System\CurrentControlSet\Services
  selection_1:
    Details|contains|all:
    - ADMIN$
    - .exe
  selection_2:
    Details|contains|all:
    - '%COMSPEC%'
    - start
    - powershell
- condition: selection
  selection:
    EventType: Setvalue
    TargetObject: HKCU\Software\Classes\Folder\shell\open\command\DelegateExecute
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains: SYSTEM\CurrentControlSet\Control\CrashControl
- condition: 1 of selection_* and not 1 of filter_*
  filter_1:
    Image|contains|all:
    - \Common Files\
    - \Temp\
  selection_1:
    Details:
    - DWORD (0x00000000)
    - DWORD (0x00000001)
    - DWORD (0x00000002)
    EventType: SetValue
    Image|contains:
    - \Users\Public\
    - \Perflogs\
    - \ADMIN$\
    - \Temp\
    TargetObject|endswith: \Start
    TargetObject|startswith: HKLM\System\CurrentControlSet\Services\
  selection_2:
    Details|contains:
    - \Users\Public\
    - \Perflogs\
    - \ADMIN$\
    - \Temp\
    EventType: SetValue
    TargetObject|endswith: \ImagePath
    TargetObject|startswith: HKLM\System\CurrentControlSet\Services\
- condition: 1 of selection_* and not filter
  filter:
  - Image|contains:
    - \AppData\Roaming\Zoom
    - \AppData\Local\Zoom
  - Details|contains:
    - \AppData\Roaming\Zoom
    - \AppData\Local\Zoom
  selection_1:
    Details:
    - DWORD (0x00000000)
    - DWORD (0x00000001)
    - DWORD (0x00000002)
    EventType: SetValue
    Image|contains:
    - \AppData\Local\
    - \AppData\Roaming\
    TargetObject|endswith: \Start
    TargetObject|startswith: HKLM\System\CurrentControlSet\Services\
  selection_2:
    Details|contains:
    - \AppData\Local\
    - \AppData\Roaming\
    EventType: SetValue
    TargetObject|endswith: \ImagePath
    TargetObject|startswith: HKLM\System\CurrentControlSet\Services\
- condition: selection
  selection:
    Details|contains|all:
    - powershell
    - -command
    EventType: SetValue
    TargetObject|contains: shell\open\command\
- condition: selection
  selection:
    Details|contains:
    - .dll
    - .exe
    - .bat
    - .com
    - 'C:'
    EventType: SetValue
    TargetObject|startswith: HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|startswith: HKCR\ms-msdt\
- condition: selection and not filter
  filter:
    Details: '"C:\Windows\system32\vsjitdebugger.exe" PID %d APPDOM %d EXTEXT "%s"
      EVTHDL %d'
  selection:
    EventType: SetValue
    TargetObject|endswith: \Microsoft\.NETFramework\DbgManagedDebugger
- condition: selection2
  selection2:
    EventType: SetValue
    TargetObject|contains: \Microsoft\Windows Defender\Exclusions
- condition: selection
  selection:
    EventType: Setvalue
    TargetObject|endswith:
    - \Services\DHCPServer\Parameters\CalloutDlls
    - \Services\DHCPServer\Parameters\CalloutEnabled
- condition: selection
  selection:
    Details: DWORD (00000001)
    EventType: SetValue
    TargetObject|contains: SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App
      and Browser protection\DisallowExploitProtectionOverride
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains: \Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Windows
      Defender/Operational\Enabled
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains: \Policies\Microsoft\Windows Defender\PUAProtection
- condition: selection and not 1 of filter_*
  filter_msmpeng_client:
    Image|endswith: \MsMpEng.exe
    Image|startswith: C:\ProgramData\Microsoft\Windows Defender\Platform\
  filter_msmpeng_domain_controller:
    Image: C:\Program Files\Windows Defender\MsMpEng.exe
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains: \Microsoft\Windows Defender\Features\TamperProtection
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith:
    - AutoShareWks
    - AutoShareServer
    TargetObject|startswith: HKLM\System\CurrentControlSet\Services\LanmanServer\Parameters\
- condition: all of selection_* and not 1 of filter_*
  filter_wevtutil:
    Image: C:\Windows\system32\wevtutil.exe
  selection_main:
    EventType: SetValue
    TargetObject|contains: \System\CurrentControlSet\Control\WMI\Autologger\
  selection_values:
    Details: DWORD (0x00000000)
    TargetObject|contains:
    - \EventLog-
    - \Defender
    TargetObject|endswith:
    - \Enable
    - \Start
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith: \EnableFirewall
    TargetObject|startswith: HKLM\System\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\
- condition: 1 of selection_set_*
  selection_set_0:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith:
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\shutdownwithoutlogon
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin
    - SOFTWARE\Microsoft\Windows\CurrentVersion\PushNotifications\ToastEnabled
    - \SYSTEM\CurrentControlSet\Control\Storage\Write Protection
    - \SYSTEM\CurrentControlSet\Control\StorageDevicePolicies\WriteProtect
  selection_set_1:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith:
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\DisableRegistryTools
    - SOFTWARE\Policies\Microsoft\Windows\System\DisableCMD
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\DisableTaskmgr
    - SOFTWARE\Policies\Microsoft\Windows\Explorer\DisableNotificationCenter
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\DisableChangePassword
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\DisableLockWorkstation
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\StartMenuLogOff
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains|all:
    - \SOFTWARE\
    - \Microsoft\Office\
    - \Common\Security
    TargetObject|endswith: \MacroRuntimeScanScope
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith: \SOFTWARE\Policies\Microsoft\Windows\OOBE\DisablePrivacyExperience
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith: Windows\CurrentVersion\ImmersiveShell\UseActionCenterExperience
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: Setvalue
    TargetObject|contains:
    - \Policies\Microsoft\Windows NT\SystemRestore
    - \Microsoft\Windows NT\CurrentVersion\SystemRestore
    TargetObject|endswith:
    - DisableConfig
    - DisableSR
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains: SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA
- condition: selection
  selection:
    Details: DWORD (0x00000004)
    EventType: SetValue
    TargetObject: HKLM\SYSTEM\CurrentControlSet\Services\WinDefend\Start
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith:
    - \SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile\EnableFirewall
    - \SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\EnableFirewall
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_iis:
    Image|endswith: \TiWorker.exe
    Image|startswith: C:\Windows\winsxs\
  filter_main_svchost:
    Image: C:\Windows\System32\svchost.exe
    TargetObject|contains:
    - \Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-FileInfoMinifilter
    - \Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-ASN1\
    - \Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Kernel-AppCompat\
    - \Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Runtime\Error\
    - \Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-CAPI2/Operational\
  filter_main_trusted_installer:
    Image: C:\Windows\servicing\TrustedInstaller.exe
    TargetObject|contains: \Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Compat-Appraiser
  filter_main_wevutil:
    Image|endswith: \Windows\system32\wevtutil.exe
  filter_optional_empty:
    Image: ''
  filter_optional_null:
    Image: null
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith: \Enabled
    TargetObject|startswith: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\DisallowRun
- condition: root and 1 of selection_*
  root:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\
  selection_autorun:
    Details: DWORD (0x00000001)
    TargetObject|contains: \Autorun
  selection_pre_after:
    Details|contains:
    - cmd
    - powershell
    - rundll32
    - mshta
    - cscript
    - wscript
    - wsl
    - \Users\Public\
    - \Windows\TEMP\
    - \Microsoft\Windows\Start Menu\Programs\Startup\
    TargetObject|contains:
    - \CleanupString
    - \PreCleanupString
- condition: 1 of selection_*
  selection_chrome:
    Details: secure
    EventType: SetValue
    TargetObject|endswith: \SOFTWARE\Google\Chrome\DnsOverHttpsMode
  selection_edge:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: \SOFTWARE\Policies\Microsoft\Edge\BuiltInDnsClientEnabled
  selection_firefox:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: \SOFTWARE\Policies\Mozilla\Firefox\DNSOverHTTPS\Enabled
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|endswith: \services\DNS\Parameters\ServerLevelPluginDll
- condition: 1 of selection_*
  selection_complus:
    Details:
    - 0
    - DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith:
    - \COMPlus_ETWEnabled
    - \COMPlus_ETWFlags
  selection_etw_enabled:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith: SOFTWARE\Microsoft\.NETFramework\ETWEnabled
- condition: selection
  selection:
    EventType: Setvalue
    TargetObject|endswith:
    - \COR_ENABLE_PROFILING
    - \COR_PROFILER
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: \Policies\Microsoft\Windows\ScriptedDiagnostics\TurnOffCheck
- condition: selection and not filter
  filter:
    Details|contains: \System32\Winevt\Logs\
  selection:
    EventType: SetValue
    TargetObject|contains: \SYSTEM\CurrentControlSet\Services\EventLog\
    TargetObject|endswith: \File
- condition: all of selection_*
  selection_key:
    EventType: SetValue
    TargetObject|contains: SOFTWARE\Microsoft\Windows Defender\Windows Defender Exploit
      Guard\Controlled Folder Access\AllowedApplications
  selection_paths:
    TargetObject|contains:
    - \Users\Public\
    - \AppData\Local\Temp\
    - \Desktop\
    - \PerfLogs\
    - \Windows\Temp\
- condition: selection and not filter
  filter:
    Details|contains: NetworkService
  selection:
    TargetObject: HKLM\System\CurrentControlSet\Services\Fax\ObjectName
- condition: selection and not filter
  filter:
    Details: '%systemroot%\system32\fxst30.dll'
  selection:
    TargetObject|contains|all:
    - \Software\Microsoft\Fax\Device Providers\
    - \ImageName
- condition: selection
  selection:
    Details: exefile
    EventType: SetValue
    TargetObject|contains: Classes\.
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\Windows Error Reporting\Hangs\Debugger
- condition: selection and not filter
  filter:
    Details: C:\Windows\System32\hhctrl.ocx
  selection:
    EventType: SetValue
    TargetObject|contains: \CLSID\{52A2AAAE-085D-4187-97EA-8C30DB990436}\InprocServer32\(Default)
- condition: 1 of selection_*
  selection_Hidden:
    Details: DWORD (0x00000002)
    EventType: SetValue
    TargetObject|endswith: \SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\Hidden
  selection_HideFileExt:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: \SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\HideFileExt
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: Setvalue
    TargetObject:
    - HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\ShowSuperHidden
    - HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\Hidden
- condition: 1 of selection_set_*
  selection_set_0:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith:
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\ShowInfoTip
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\ShowCompColor
  selection_set_1:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith:
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\HideClock
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\HideSCAHealth
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\HideSCANetwork
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\HideSCAPower
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\HideSCAVolume
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains|all:
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\
    - Index
- condition: selection
  selection:
    Details: Binary Data
    EventType: Setvalue
    TargetObject|contains:
    - \SOFTWARE\Microsoft\SystemCertificates\Root\Certificates\
    - \SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates\
    - \SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates\
    - \SOFTWARE\Microsoft\SystemCertificates\CA\Certificates\
    - \SOFTWARE\Policies\Microsoft\SystemCertificates\CA\Certificates\
    - \SOFTWARE\Microsoft\EnterpriseCertificates\CA\Certificates\
    - \SOFTWARE\Microsoft\SystemCertificates\AuthRoot\Certificates\
    - \SOFTWARE\Policies\Microsoft\SystemCertificates\AuthRoot\Certificates\
    - \SOFTWARE\Microsoft\EnterpriseCertificates\AuthRoot\Certificates\
    TargetObject|endswith: \Blob
- condition: selection and not 1 of filter_main_*
  filter_main_generic:
    Image:
    - C:\Windows\explorer.exe
    - C:\Windows\System32\ie4uinit.exe
  selection:
    Details:
    - DWORD (0x00000001)
    - DWORD (0x00000002)
    EventType: SetValue
    TargetObject|endswith: \Microsoft\Internet Explorer\Main\DisableFirstRunCustomize
- condition: selection
  selection:
    Details|contains:
    - encrypted
    - Unlock-Password
    - paying
    EventType: SetValue
    TargetObject|contains:
    - \SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LegalNoticeCaption
    - \SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LegalNoticeText
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\OneDrive\UpdateOfficeConfig\UpdateRingSettingURLFromOC
- condition: selection
  selection:
    Details: DWORD (0x00000002)
    EventType: SetValue
    TargetObject|contains:
    - \SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps\DumpType
    - \SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps\lsass.exe\DumpType
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: System\CurrentControlSet\Control\Lsa\DisableRestrictedAdmin
- condition: selection
  selection:
    Details|startswith: '%AppData%\Roaming\Oracle\bin\'
    EventType: SetValue
    TargetObject|startswith: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
- condition: selection
  selection:
    EventType: Setvalue
    TargetObject|endswith: \CurrentControlSet\Services\wercplsupport\Parameters\ServiceDll
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|endswith: SOFTWARE\Microsoft\.NETFramework\NGenAssemblyUsageLog
- condition: selection
  selection:
    EventType: Setvalue
    TargetObject|contains: \AppCompatFlags\Compatibility Assistant\Store\
- condition: selection and not 1 of filter*
  filter:
    TargetObject|contains:
    - \System\CurrentControlSet\Services\WebClient\NetworkProvider
    - \System\CurrentControlSet\Services\LanmanWorkstation\NetworkProvider
    - \System\CurrentControlSet\Services\RDPNP\NetworkProvider
  filter_valid_procs:
    Image: C:\Windows\System32\poqexec.exe
  selection:
    EventType: SetValue
    TargetObject|contains|all:
    - \System\CurrentControlSet\Services\
    - \NetworkProvider
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_sqlserver:
    Details: '%WINDIR%\System32\SQLSRV32.dll'
    TargetObject|contains: \SQL Server\
  filter_optional_office_access:
    Details|endswith: \ACEODBC.DLL
    Details|startswith: C:\Progra
    TargetObject|contains: '\Microsoft Access '
  filter_optional_office_excel:
    Details|endswith: \ACEODBC.DLL
    Details|startswith: C:\Progra
    TargetObject|contains: \Microsoft Excel Driver
  selection:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\ODBC\ODBCINST.INI\
    TargetObject|endswith: \Driver
- condition: selection
  selection:
    Details|contains:
    - :\PerfLogs\
    - :\ProgramData\
    - :\Temp\
    - :\Users\Public\
    - :\Windows\Registration\CRMLog
    - :\Windows\System32\com\dmp\
    - :\Windows\System32\FxsTmp\
    - :\Windows\System32\Microsoft\Crypto\RSA\MachineKeys\
    - :\Windows\System32\spool\drivers\color\
    - :\Windows\System32\spool\PRINTERS\
    - :\Windows\System32\spool\SERVERS\
    - :\Windows\System32\Tasks_Migrated\
    - :\Windows\System32\Tasks\Microsoft\Windows\SyncCenter\
    - :\Windows\SysWOW64\com\dmp\
    - :\Windows\SysWOW64\FxsTmp\
    - :\Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System\
    - :\Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter\
    - :\Windows\Tasks\
    - :\Windows\Temp\
    - :\Windows\Tracing\
    - \AppData\Local\Temp\
    - \AppData\Roaming\
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\ODBC\ODBCINST.INI\
    TargetObject|endswith:
    - \Driver
    - \Setup
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: Setvalue
    TargetObject|endswith: \Security\AccessVBOM
- condition: selection_path and 1 of selection_values_*
  selection_path:
    EventType: SetValue
    TargetObject|contains|all:
    - \SOFTWARE\Microsoft\Office\
    - \Security\ProtectedView\
  selection_values_0:
    Details: DWORD (0x00000000)
    TargetObject|endswith:
    - \enabledatabasefileprotectedview
    - \enableforeigntextfileprotectedview
  selection_values_1:
    Details: DWORD (0x00000001)
    TargetObject|endswith:
    - \DisableAttachementsInPV
    - \DisableInternetFilesInPV
    - \DisableIntranetCheck
    - \DisableUnsafeLocationsInPV
- condition: 1 of selection_*
  selection_excel:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|endswith:
    - \Excel\Security\DisableDDEServerLaunch
    - \Excel\Security\DisableDDEServerLookup
  selection_word:
    Details:
    - DWORD (0x00000001)
    - DWORD (0x00000002)
    EventType: SetValue
    TargetObject|endswith: \Word\Security\AllowDDE
- condition: selection
  selection:
    Details|contains: '0x00000001'
    EventType: SetValue
    TargetObject|endswith: \Outlook\LoadMacroProviderOnBoot
- condition: selection
  selection:
    Details|contains: '0x00000001'
    EventType: SetValue
    TargetObject|endswith: \Outlook\Security\Level
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: \Outlook\Security\EnableUnsafeClientMailRules
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains|all:
    - \SOFTWARE\Microsoft\Office\
    - \Outlook\Security\
- condition: selection and not 1 of filter_main_* and not 1 of filter_exclude_*
  filter_exclude_known_paths:
    Details|startswith:
    - '%APPDATA%\Microsoft\Templates'
    - '%%APPDATA%%\Microsoft\Templates'
    - '%APPDATA%\Microsoft\Word\Startup'
    - '%%APPDATA%%\Microsoft\Word\Startup'
    - C:\Program Files (x86)\Microsoft Office\root\Templates\
    - C:\Program Files\Microsoft Office (x86)\Templates
    - C:\Program Files\Microsoft Office\root\Templates\
    - C:\Program Files\Microsoft Office\Templates\
  filter_main_office_apps:
    Image|endswith:
    - \winword.exe
    - \excel.exe
    Image|startswith:
    - C:\Program Files\Microsoft Office\
    - C:\Program Files (x86)\Microsoft Office\
  filter_main_office_click_to_run:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith: C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
  selection:
    EventType: Setvalue
    TargetObject|contains: Security\Trusted Locations\Location
    TargetObject|endswith: \Path
- condition: all of selection_*
  selection_paths:
    TargetObject|contains:
    - /AppData/Local/Microsoft/Windows/INetCache/
    - /AppData/Local/Temp/
    - /PerfLogs/
    - C:/Users/Public/
    - file:///D:/
    - file:///E:/
  selection_value:
    EventType: Setvalue
    TargetObject|contains: \Security\Trusted Documents\TrustRecords
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: Setvalue
    TargetObject|endswith: \Security\VBAWarnings
- condition: 1 of selection_*
  selection_debug:
    EventType: SetValue
    TargetObject|contains: Classes\ActivatableClasses\Package\Microsoft.
    TargetObject|endswith: \DebugPath
  selection_default:
    EventType: SetValue
    TargetObject|contains: \Software\Microsoft\Windows\CurrentVersion\PackagedAppXDebug\Microsoft.
    TargetObject|endswith: \(Default)
- condition: selection
  selection:
    Details|contains:
    - \Users\Public
    - \AppData\Local\Temp\
    - \Windows\Temp\
    - \Desktop\
    - \Downloads\
    - '%temp%'
    - '%tmp%'
    - iex
    - Invoke-
    - rundll32
    - regsvr32
    - mshta
    - cscript
    - wscript
    - .bat
    - .hta
    - .dll
    - .ps1
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths
    TargetObject|endswith:
    - (Default)
    - Path
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains: \Services\WinSock2\Parameters\AutodialDLL
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains:
    - \Software\Microsoft\HtmlHelp Author\Location
    - \Software\WOW6432Node\Microsoft\HtmlHelp Author\Location
- condition: selection and not filter_main
  filter_main:
    Details:
    - '%windir%\System32\ActXPrxy.dll'
    - C:\Windows\System32\ActXPrxy.dll
  selection:
    EventType: SetValue
    TargetObject|endswith: \CLSID\{c90250f3-4d7d-4991-9b69-a5c5bc1c2ae6}\InProcServer32\(Default)
- condition: selection
  selection:
    Details|contains:
    - \Users\Public\
    - \Desktop\
    - \AppData\Local\Temp\
    - \Downloads\
    - \Windows\Temp\
    - \Microsoft\Windows\Start Menu\Programs\Startup\
    - \System32\spool\drivers\color\
    - '%temp%'
    - '%tmp%'
    - '%appdata%'
    EventType: SetValue
    TargetObject|endswith:
    - \InprocServer32\(Default)
    - \LocalServer32\(Default)
    TargetObject|startswith:
    - HKCR\CLSID\
    - HKEY_CLASSES_ROOT\CLSID\
    - HKCU\Software\Classes\CLSID\
    - HKEY_CURRENT_USER\Software\Classes\CLSID\
- condition: selection and not 1 of filter_main_*
  filter_main_generic_locations:
    Image|startswith:
    - C:\Program Files (x86)
    - C:\Program Files\
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  filter_main_ms_trusted:
    Details|startswith: URL:ms-
  selection:
    Details|startswith: 'URL:'
    TargetObject|startswith: HKCR\
- condition: selection and not 1 of filter_*
  filter_cleaner:
    Details: (Empty)
  filter_default_redirect_program:
    Details: '%%SystemRoot%%\PCHealth\HelpCtr\Binaries\HelpCtr.exe'
    Image|endswith: C:\WINDOWS\system32\svchost.exe
    TargetObject|endswith: \Microsoft\Windows NT\CurrentVersion\Event Viewer\MicrosoftRedirectionProgram
  filter_default_redirect_program_cli:
    Details: -url hcp://services/centers/support?topic=%%s
    Image|endswith: C:\WINDOWS\system32\svchost.exe
    TargetObject|endswith: \Microsoft\Windows NT\CurrentVersion\Event Viewer\MicrosoftRedirectionProgramCommandLineParameters
  filter_url:
    Details: http://go.microsoft.com/fwlink/events.asp
  selection:
    TargetObject|contains:
    - \Microsoft\Windows NT\CurrentVersion\Event Viewer\MicrosoftRedirectionProgram
    - \Microsoft\Windows NT\CurrentVersion\Event Viewer\MicrosoftRedirectionURL
- condition: 1 of selection_*
  selection_global_flag:
    TargetObject|contains|all:
    - \Microsoft\Windows NT\CurrentVersion\
    - \Image File Execution Options\
    - \GlobalFlag
  selection_silent_process:
    TargetObject|contains:
    - \ReportingMode
    - \MonitorProcess
    TargetObject|contains|all:
    - \Microsoft\Windows NT\CurrentVersion\
    - \SilentProcessExit\
- condition: selection_domains and not 1 of filter_*
  filter_accepted_documents:
    TargetObject|contains: \Accepted Documents\
  filter_binary:
    Details: Binary Data
  filter_dword:
    Details|startswith: DWORD
  filter_office:
    Details:
    - 'Cookie:'
    - 'Visited:'
    - (Empty)
  filter_path:
    TargetObject|contains:
    - \Cache
    - \ZoneMap
    - \WpadDecision
  selection_domains:
    EventType: SetValue
    TargetObject|contains: \Software\Microsoft\Windows\CurrentVersion\Internet Settings
- condition: 1 of selection_* and not 1 of filter_*
  filter_default_targets:
    TargetObject|contains:
    - \CLSID\{4F46F75F-199F-4C63-8B7D-86D48FE7970C}\
    - \CLSID\{4887767F-7ADC-4983-B576-88FB643D6F79}\
    - \CLSID\{D3B41FA1-01E3-49AF-AA25-1D0D824275AE}\
    - \CLSID\{72773E1A-B711-4d8d-81FA-B9A43B0650DD}\
    - \CLSID\{098f2470-bae0-11cd-b579-08002b30bfeb}\
    - \CLSID\{1AA9BF05-9A97-48c1-BA28-D9DCE795E93C}\
    - \CLSID\{2e2294a9-50d7-4fe7-a09f-e6492e185884}\
    - \CLSID\{34CEAC8D-CBC0-4f77-B7B1-8A60CB6DA0F7}\
    - \CLSID\{3B224B11-9363-407e-850F-C9E1FFACD8FB}\
    - \CLSID\{3DDEB7A4-8ABF-4D82-B9EE-E1F4552E95BE}\
    - \CLSID\{5645C8C1-E277-11CF-8FDA-00AA00A14F93}\
    - \CLSID\{5645C8C4-E277-11CF-8FDA-00AA00A14F93}\
    - \CLSID\{58A9EBF6-5755-4554-A67E-A2467AD1447B}\
    - \CLSID\{5e941d80-bf96-11cd-b579-08002b30bfeb}\
    - \CLSID\{698A4FFC-63A3-4E70-8F00-376AD29363FB}\
    - \CLSID\{7E9D8D44-6926-426F-AA2B-217A819A5CCE}\
    - \CLSID\{8CD34779-9F10-4f9b-ADFB-B3FAEABDAB5A}\
    - \CLSID\{9694E38A-E081-46ac-99A0-8743C909ACB6}\
    - \CLSID\{98de59a0-d175-11cd-a7bd-00006b827d94}\
    - \CLSID\{AA10385A-F5AA-4EFF-B3DF-71B701E25E18}\
    - \CLSID\{B4132098-7A03-423D-9463-163CB07C151F}\
    - \CLSID\{d044309b-5da6-4633-b085-4ed02522e5a5}\
    - \CLSID\{D169C14A-5148-4322-92C8-754FC9D018D8}\
    - \CLSID\{DD75716E-B42E-4978-BB60-1497B92E30C4}\
    - \CLSID\{E2F83EED-62DE-4A9F-9CD0-A1D40DCD13B6}\
    - \CLSID\{E772CEB3-E203-4828-ADF1-765713D981B8}\
    - \CLSID\{eec97550-47a9-11cf-b952-00aa0051fe20}
    - \CLSID\{FB10BD80-A331-4e9e-9EB7-00279903AD99}\
  filter_generic_paths:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Program Files (x86)\
    - C:\Program Files\
  selection_clsid:
    EventType: SetValue
    TargetObject|contains: \PersistentAddinsRegistered\{89BCB740-6119-101A-BCB7-00DD010655AF}
    TargetObject|startswith:
    - HKLM\SOFTWARE\Classes\CLSID
    - HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID
  selection_ext:
    EventType: SetValue
    TargetObject|contains: \PersistentHandler
    TargetObject|startswith:
    - HKLM\SOFTWARE\Classes\.
    - HKEY_LOCAL_MACHINE\SOFTWARE\Classes\.
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains: \SYSTEM\CurrentControlSet\Control\LsaExtensionConfig\LsaSrv\Extensions
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\mpnotify
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer
    TargetObject|endswith: (Default)
- condition: all of selection_*
  selection_root:
    EventType: SetValue
    TargetObject|contains: \SYSTEM\CurrentControlSet\Control\ContentIndex\Language\
  selection_values:
    TargetObject|contains:
    - \StemmerDLLPathOverride
    - \WBDLLPathOverride
    - \StemmerClass
    - \WBreakerClass
- condition: selection and not 1 of filter_*
  filter_avg:
    Image: C:\Program Files\AVG\Antivirus\RegSvr.exe
    TargetObject|contains: \Microsoft\Office\Outlook\Addins\Antivirus.AsOutExt\
  filter_image:
    Image|endswith:
    - \msiexec.exe
    - \regsvr32.exe
  filter_office:
    Image|endswith:
    - \excel.exe
    - \integrator.exe
    - \OfficeClickToRun.exe
    - \winword.exe
  selection:
    EventType: SetValue
    TargetObject|contains:
    - \Software\Microsoft\Office\Outlook\Addins\
    - \Software\Microsoft\Office\Word\Addins\
    - \Software\Microsoft\Office\Excel\Addins\
    - \Software\Microsoft\Office\Powerpoint\Addins\
    - \Software\Microsoft\VSTO\Security\Inclusion\
- condition: all of selection_*
  selection_1:
    EventType: SetValue
    TargetObject|contains:
    - \Software\Microsoft\Office\
    - \Outlook\WebView\
    TargetObject|endswith: \URL
  selection_2:
    TargetObject|contains:
    - \Calendar\
    - \Inbox\
- condition: selection_main and 1 of selection_value_* and not 1 of filter_*
  filter_office:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith:
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
    - C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\
  selection_main:
    EventType: SetValue
    TargetObject|contains|all:
    - Software\Microsoft\Office\
    - \Outlook\Today\
  selection_value_stamp:
    Details: DWORD (0x00000001)
    TargetObject|endswith: Stamp
  selection_value_user_defined:
    TargetObject|endswith: UserDefinedUrl
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|endswith: \Microsoft\Windows\Windows Error Reporting\Hangs\ReflectDebugger
- condition: selection
  selection:
    Details: C:\WINDOWS\system32\scrobj.dll
    EventType: SetValue
    TargetObject|endswith: InprocServer32\(Default)
- condition: selection and not 1 of filter_*
  filter_bonjourlib:
    Details:
    - C:\Windows\system32\dnssdX.dll
    - C:\Windows\SysWOW64\dnssdX.dll
  filter_defender:
    Image|endswith: \MsMpEng.exe
    Image|startswith:
    - C:\ProgramData\Microsoft\Windows Defender\Platform\
    - C:\Program Files\Windows Defender\
  filter_dropbox:
    Details|contains|all:
    - \AppData\Roaming\Dropbox\
    - \DropboxExt64.*.dll
  filter_dx:
    Image: C:\WINDOWS\SYSTEM32\dxdiag.exe
  filter_edge:
    Image|endswith: \MicrosoftEdgeUpdateComRegisterShell64.exe
  filter_gameservice:
    Details|contains: C:\WINDOWS\system32\GamingServicesProxy.dll
  filter_generic:
    Details|contains:
    - '%%systemroot%%\system32\'
    - '%%systemroot%%\SysWow64\'
  filter_health_service:
    Image: C:\WINDOWS\system32\SecurityHealthService.exe
  filter_inprocserver:
    Image:
    - C:\Windows\System32\poqexec.exe
    - C:\Windows\System32\regsvr32.exe
    TargetObject|endswith: \InProcServer32\(Default)
  filter_nvidia:
    Details|contains: \FileRepository\nvmdi.inf
  filter_onedrive:
    Details|contains:
    - \AppData\Local\Microsoft\OneDrive\
    - \FileCoAuthLib64.dll
    - \FileSyncShell64.dll
    - \FileSyncApi64.dll
  filter_poqexec:
    Details|contains: C:\Windows\System32\Autopilot.dll
    Image: C:\Windows\System32\poqexec.exe
  filter_printextensionmanager:
    Details: C:\Windows\system32\spool\drivers\x64\3\PrintConfig.dll
  filter_programdata:
    Details|startswith: C:\ProgramData\Microsoft\
  filter_programfiles:
    Details|startswith:
    - C:\Program Files\
    - C:\Program Files (x86)\
  filter_python:
    Details:
    - C:\Windows\pyshellext.amd64.dll
    - C:\Windows\pyshellext.dll
  filter_sec_health_svc:
    Details|contains: C:\Windows\System32\SecurityHealth
    Image: C:\Windows\system32\SecurityHealthService.exe
  filter_teams:
    Details|contains|all:
    - \AppData\Local\Microsoft\TeamsMeetingAddin\
    - \Microsoft.Teams.AddinLoader.dll
  filter_trend_micro:
    Details|endswith: TmopIEPlg.dll
  filter_update:
    Image:
    - C:\WINDOWS\system32\wuauclt.exe
    - C:\WINDOWS\system32\svchost.exe
  selection:
    EventType: SetValue
    TargetObject|endswith: \InprocServer32\(Default)
    TargetObject|startswith:
    - HKCR\CLSID\
    - HKCU\Software\Classes\CLSID\
- condition: selection and not filter
  filter:
    Details: ''
  selection:
    EventType: SetValue
    TargetObject|startswith:
    - HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB\
    - HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom\
- condition: selection and not filter
  filter:
    Image:
    - C:\Windows\explorer.exe
    - C:\Windows\SysWOW64\explorer.exe
  selection:
    EventType: SetValue
    TargetObject|contains: \Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths\
- condition: selection
  selection:
    Details|endswith: .xll
    Details|startswith: '/R '
    EventType: SetValue
    TargetObject|contains: Software\Microsoft\Office\
    TargetObject|endswith: \Excel\Options
- condition: selection_main and 1 of selection_value_*
  selection_main:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Associations\
  selection_value_default_file_type_rsik:
    Details: DWORD (0x00006152)
    TargetObject|endswith: \DefaultFileTypeRisk
  selection_value_low_risk_filetypes:
    Details|contains:
    - .zip;
    - .rar;
    - .exe;
    - .bat;
    - .com;
    - .cmd;
    - .reg;
    - .msi;
    - .htm;
    - .html;
    TargetObject|endswith: \LowRiskFileTypes
- condition: selection_main and 1 of selection_value_*
  selection_main:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Attachments\
  selection_value_hide_zone_info:
    Details: DWORD (0x00000001)
    TargetObject|endswith: \HideZoneInfoOnProperties
  selection_value_save_zone_info:
    Details: DWORD (0x00000002)
    TargetObject|endswith: \SaveZoneInformation
  selection_value_scan_with_av:
    Details: DWORD (0x00000001)
    TargetObject|endswith: \ScanWithAntiVirus
- condition: selection
  selection:
    Details|contains:
    - powershell
    - pwsh
    EventType: SetValue
    TargetObject|contains: \Services\
    TargetObject|endswith: \ImagePath
- condition: selection and not 1 of filter_*
  filter_svchost:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  selection:
    Details|contains:
    - Bypass
    - RemoteSigned
    - Unrestricted
    EventType: SetValue
    TargetObject|endswith:
    - \ShellIds\Microsoft.PowerShell\ExecutionPolicy
    - \Policies\Microsoft\Windows\PowerShell\ExecutionPolicy
- condition: selection
  selection:
    Details|contains:
    - powershell
    - 'pwsh '
    - FromBase64String
    - .DownloadFile(
    - .DownloadString(
    - ' -w hidden '
    - ' -w 1 '
    - -windowstyle hidden
    - -window hidden
    - ' -nop '
    - ' -encodedcommand '
    - -ExecutionPolicy Bypass
    - Invoke-Expression
    - IEX (
    - Invoke-Command
    - ICM -
    - Invoke-WebRequest
    - 'IWR '
    - ' -noni '
    - ' -noninteractive '
    EventType: SetValue
    TargetObject|contains: \Software\Microsoft\Windows\CurrentVersion\Run
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains:
    - \Microsoft\Windows\PowerShell\
    - \Microsoft\PowerShellCore\
    TargetObject|endswith:
    - \ModuleLogging\EnableModuleLogging
    - \ScriptBlockLogging\EnableScriptBlockLogging
    - \ScriptBlockLogging\EnableScriptBlockInvocationLogging
    - \Transcription\EnableTranscripting
    - \Transcription\EnableInvocationHeader
    - \EnableScripts
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
  filter_main_image_names:
    Image|endswith:
    - \PsExec.exe
    - \PsExec64.exe
    - \procdump.exe
    - \procdump64.exe
    - \handle.exe
    - \handle64.exe
    - \livekd.exe
    - \livekd64.exe
    - \procexp.exe
    - \procexp64.exe
    - \psloglist.exe
    - \psloglist64.exe
    - \pspasswd.exe
    - \pspasswd64.exe
    - \ADExplorer.exe
    - \ADExplorer64.exe
  filter_optional_null:
    Image: null
  selection:
    EventType: SetValue
    TargetObject|contains:
    - \PsExec
    - \ProcDump
    - \Handle
    - \LiveKd
    - \Process Explorer
    - \PsLoglist
    - \PsPasswd
    - \Active Directory Explorer
    TargetObject|endswith: \EulaAccepted
- condition: selection
  selection:
    Details:
    - DWORD (0x00000000)
    - DWORD (0x00000002)
    EventType: SetValue
    TargetObject|endswith: \Microsoft\Windows NT\Rpc\ExtErrorInformation
- condition: selection and registry and not filter
  filter:
    Details|contains:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  registry:
    Details|endswith: .scr
    TargetObject|contains: \Control Panel\Desktop\SCRNSAVE.EXE
  selection:
    EventType: SetValue
    Image|endswith: \rundll32.exe
- condition: selection and not 1 of filter*
  filter_domain_controller:
    Details: '%%systemroot%%\system32\ntdsa.dll'
    Image: C:\Windows\system32\lsass.exe
    TargetObject|endswith: \CurrentControlSet\Services\NTDS\Parameters\ServiceDll
  filter_poqexec:
    Image: C:\Windows\System32\poqexec.exe
  filter_printextensionmanger:
    Details: C:\Windows\system32\spool\drivers\x64\3\PrintConfig.dll
  selection:
    EventType: SetValue
    TargetObject|endswith: \Parameters\ServiceDll
    TargetObject|startswith: HKLM\System\CurrentControlSet\Services\
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: Software\Microsoft\Windows NT\CurrentVersion\Tracing\SCM\Regular\TracingDisabled
- condition: selection_set_1
  selection_set_1:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith:
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoLogOff
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDesktop
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoRun
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoFind
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoControlPanel
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoFileMenu
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoClose
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoSetTaskbar
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoPropertiesMyDocuments
    - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoTrayContextMenu
- condition: all of selection_* and not 1 of filter*
  filter:
    Details:
    - WINTRUST.DLL
    - mso.dll
  filter_poqexec:
    Details: C:\Windows\System32\PsfSip.dll
    Image: C:\Windows\System32\poqexec.exe
    TargetObject|contains: \CryptSIPDll
  selection_dll:
    TargetObject|contains:
    - \Dll
    - \$DLL
  selection_root:
    EventType: SetValue
    TargetObject|contains:
    - \SOFTWARE\Microsoft\Cryptography\Providers\
    - \SOFTWARE\Microsoft\Cryptography\OID\EncodingType
    - \SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\
    - \SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID\EncodingType
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains:
    - \Sophos Endpoint Defense\TamperProtection\Config\SAVEnabled
    - \Sophos Endpoint Defense\TamperProtection\Config\SEDEnabled
    - \Sophos\SAVService\TamperProtection\Enabled
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: SOFTWARE\Policies\Microsoft\Windows Defender\UX Configuration\Notification_Suppress
- condition: all of selection_*
  selection_details:
  - Details:
    - powershell
    - pwsh
  - Details|contains:
    - \AppData\Local\Temp\
    - C:\Users\Public\
    - TVqQAAMAAAAEAAAA
    - TVpQAAIAAAAEAA8A
    - TVqAAAEAAAAEABAA
    - TVoAAAAAAAAAAAAA
    - TVpTAQEAAAAEAAAA
    - SW52b2tlL
    - ludm9rZS
    - JbnZva2Ut
    - SQBuAHYAbwBrAGUALQ
    - kAbgB2AG8AawBlAC0A
    - JAG4AdgBvAGsAZQAtA
  - Details|startswith:
    - SUVY
    - SQBFAF
    - SQBuAH
    - cwBhA
    - aWV4
    - aQBlA
    - R2V0
    - dmFy
    - dgBhA
    - dXNpbm
    - H4sIA
    - Y21k
    - cABhAH
    - Qzpc
    - Yzpc
  selection_main:
    EventType: SetValue
    TargetObject|contains: \Environment\
- condition: selection_registry
  selection_registry:
    Details|contains:
    - 00000429
    - 00050429
    - 0000042a
    EventType: SetValue
    TargetObject|contains:
    - \Keyboard Layout\Preload\
    - \Keyboard Layout\Substitutes\
- condition: selection_main and 1 of selection_susp_*
  selection_main:
    EventType: SetValue
    TargetObject|contains: \CurrentControlSet\Control\Session Manager\PendingFileRenameOperations
  selection_susp_images:
    Image|endswith:
    - \reg.exe
    - \regedit.exe
  selection_susp_paths:
    Image|contains:
    - \AppData\Local\Temp\
    - \Users\Public\
- condition: selection and not 1 of filter_*
  filter_cutepdf:
    TargetObject|contains: \CutePDF Writer v4.0\
  filter_pdf24:
    TargetObject|contains: \Version-3\PDF24\
  filter_vnc:
    TargetObject|contains:
    - \VNC Printer (PS)\
    - \VNC Printer (UD)\
  selection:
    Details: (Empty)
    EventType: SetValue
    TargetObject|contains|all:
    - \Control\Print\Environments\Windows x64\Drivers
    - \Manufacturer
- condition: selection and selection2
  selection:
    EventType: SetValue
    TargetObject|endswith: \Microsoft\Windows\CurrentVersion\Policies\Explorer\Run
  selection2:
  - Details|startswith:
    - C:\Windows\Temp\
    - C:\ProgramData\
    - C:\$Recycle.bin\
    - C:\Temp\
    - C:\Users\Public\
    - C:\Users\Default\
  - Details|contains: \AppData\
- condition: all of selection_*
  selection_details:
  - Details|contains:
    - C:\Windows\Temp\
    - C:\$Recycle.bin\
    - C:\Temp\
    - C:\Users\Public\
    - C:\Users\Default\
    - C:\Users\Desktop\
    - \AppData\Local\Temp\
    - '%temp%\'
    - '%tmp%\'
  - Details|startswith:
    - '%Public%\'
    - wscript
    - cscript
  selection_target:
    EventType: SetValue
    TargetObject|contains:
    - \SOFTWARE\Microsoft\Windows\CurrentVersion\Run\
    - \SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce\
- condition: selection and not filter
  filter:
    Details|contains: \WINDOWS\system32\Drivers\PROCEXP152.SYS
    Image|endswith:
    - \procexp64.exe
    - \procexp.exe
    - \procmon64.exe
    - \procmon.exe
    - \handle.exe
    - \handle64.exe
  selection:
    EventType: SetValue
    TargetObject:
    - HKLM\System\CurrentControlSet\Services\NalDrv\ImagePath
    - HKLM\System\CurrentControlSet\Services\PROCEXP152\ImagePath
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains: SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User
      Shell Folders
    TargetObject|endswith: Startup
- condition: selection and not 1 of filter*
  filter:
    TargetObject|contains:
    - Microsoft\Windows\UpdateOrchestrator
    - Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask\Index
    - Microsoft\Windows\Flighting\OneSettings\RefreshCache\Index
  filter_dropbox_updater:
    Image:
    - C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe
    - C:\Program Files\Dropbox\Update\DropboxUpdate.exe
  filter_explorer:
    Image: C:\Windows\explorer.exe
    TargetObject|contains: \Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\PLA\Server
      Manager Performance Monitor\
  filter_msiexec:
    Image: C:\Windows\System32\msiexec.exe
  filter_ngen:
    Image|endswith: \ngen.exe
    Image|startswith: C:\Windows\Microsoft.NET\Framework
    TargetObject|contains:
    - \Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{B66B135D-DA06-4FC4-95F8-7458E1D10129}
    - \Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\.NET
      Framework\.NET Framework NGEN
  filter_office_click_to_run:
    Image:
    - C:\Program Files\Microsoft Office\root\Integration\Integrator.exe
    - C:\Program Files (x86)\Microsoft Office\root\Integration\Integrator.exe
  filter_svchost:
    Image: C:\WINDOWS\system32\svchost.exe
  filter_system:
    Image: System
  filter_tiworker:
    Image|endswith: \TiWorker.exe
    Image|startswith: C:\Windows\
  selection:
    EventType: SetValue
    TargetObject|contains: SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\
- condition: selection and not filter
  filter:
    Details|contains:
    - \system32\CompatTelRunner.exe
    - \system32\DeviceCensus.exe
  selection:
    Details|contains:
    - .sh
    - .exe
    - .dll
    - .bin
    - .bat
    - .cmd
    - .js
    - .ps
    - .vb
    - .jar
    - .hta
    - .msi
    - .vbs
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\TelemetryController\
    TargetObject|endswith: \Command
- condition: selection
  selection:
    Details: DWORD (0x00000000)
    TargetObject|endswith:
    - \fDenyTSConnections
    - \fSingleSessionPerUser
    - \UserAuthentication
- condition: selection_shadow or (selection_terminal_services_key and selection_terminal_services_values)
    or selection_tamper_only
  selection_shadow:
    Details:
    - DWORD (0x00000001)
    - DWORD (0x00000002)
    - DWORD (0x00000003)
    - DWORD (0x00000004)
    EventType: SetValue
    TargetObject|contains:
    - SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\
    - \Control\Terminal Server\
    TargetObject|endswith: \Shadow
  selection_tamper_only:
    EventType: SetValue
    TargetObject|contains:
    - \services\TermService\Parameters\ServiceDll
    - \Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram
    - \Control\Terminal Server\InitialProgram
    - SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\InitialProgram
  selection_terminal_services_key:
    EventType: SetValue
    TargetObject|contains:
    - \Control\Terminal Server\
    - SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\
  selection_terminal_services_values:
    Details: DWORD (0x00000001)
    TargetObject|endswith:
    - \fAllowUnsolicited
    - \fAllowUnsolicitedFullControl
- condition: selection and not filter
  filter:
    Details: C:\Windows\SYSTEM32\w32time.DLL
  selection:
    EventType: SetValue
    TargetObject|endswith: DllName
    TargetObject|startswith: HKLM\System\CurrentControlSet\Services\W32Time\TimeProviders
- condition: selection and not 1 of filter_*
  filter_misexec:
    Image:
    - C:\Windows\system32\msiexec.exe
    - C:\Windows\SysWOW64\msiexec.exe
  filter_office:
    Image|endswith: \OfficeClickToRun.exe
    Image|startswith: C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
  filter_office2:
    Image: C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe
  filter_svchost:
    Image: C:\Windows\system32\svchost.exe
  selection:
    EventType: SetValue
    TargetObject|endswith: TreatAs\(Default)
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|contains:
    - \Microsoft\Windows\CurrentVersion\AppModelUnlock
    - \Policies\Microsoft\Windows\Appx\
    TargetObject|endswith:
    - \AllowAllTrustedApps
    - \AllowDevelopmentWithoutDevLicense
- condition: selection
  selection:
    TargetObject|endswith: \mscfile\shell\open\command
    TargetObject|startswith: HKCU\
- condition: 1 of selection*
  selection1:
    EventType: SetValue
    TargetObject|endswith: Software\Classes\exefile\shell\runas\command\isolatedCommand
  selection2:
    Details|re: -1[0-9]{3}\\Software\\Classes\\
    EventType: SetValue
    TargetObject|endswith: Software\Classes\Folder\shell\open\command\SymbolicLinkValue
- condition: selection
  selection:
    Details|endswith: \appdata\local\temp\system32\winsat.exe
    Details|startswith: c:\users\
    EventType: SetValue
    TargetObject|contains: \Root\InventoryApplicationFile\winsat.exe|
    TargetObject|endswith: \LowerCaseLongPath
- condition: selection
  selection:
    Details: Binary Data
    EventType: SetValue
    TargetObject|endswith: \SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility
      Assistant\Store\C:\Program Files\Windows Media Player\osk.exe
- condition: selection and not 1 of filter*
  filter:
    TargetObject|contains: Software\Microsoft\Windows\CurrentVersion\Run
  filter_dotnet:
    Details|contains:
    - \Microsoft.NET\Primary Interop Assemblies\Microsoft.mshtml.dll
    - <\Microsoft.mshtml,fileVersion=
    - _mshtml_dll_
    - <\Microsoft.mshtml,culture=
    Image|endswith: \msiexec.exe
    TargetObject|contains: \SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\
  selection:
    Details|contains:
    - 'vbscript:'
    - 'jscript:'
    - mshtml,
    - RunHTMLApplication
    - Execute(
    - CreateObject
    - window.close
    EventType: SetValue
    TargetObject|contains: Software\Microsoft\Windows\CurrentVersion
- condition: selection and not filter
  filter:
    Details: '%CommonProgramFiles%\System\wab32.dll'
  selection:
    EventType: SetValue
    TargetObject|endswith: \Software\Microsoft\WAB\DLLPath
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: WDigest\UseLogonCredential
- condition: selection_main and 1 of selection_dword_*
  selection_dword_0:
    Details: DWORD (0x00000000)
    TargetObject|endswith:
    - \App and Browser protection\DisallowExploitProtectionOverride
    - \Features\TamperProtection
    - \MpEngine\MpEnablePus
    - \PUAProtection
    - \Signature Update\ForceUpdateFromMU
    - \SpyNet\SpynetReporting
    - \SpyNet\SubmitSamplesConsent
    - \Windows Defender Exploit Guard\Controlled Folder Access\EnableControlledFolderAccess
  selection_dword_1:
    Details: DWORD (0x00000001)
    TargetObject|endswith:
    - \DisableAntiSpyware
    - \DisableAntiVirus
    - \Real-Time Protection\DisableBehaviorMonitoring
    - \Real-Time Protection\DisableIntrusionPreventionSystem
    - \Real-Time Protection\DisableIOAVProtection
    - \Real-Time Protection\DisableOnAccessProtection
    - \Real-Time Protection\DisableRealtimeMonitoring
    - \Real-Time Protection\DisableScanOnRealtimeEnable
    - \Real-Time Protection\DisableScriptScanning
    - \Reporting\DisableEnhancedNotifications
    - \SpyNet\DisableBlockAtFirstSeen
  selection_main:
    EventType: SetValue
    TargetObject|contains:
    - \SOFTWARE\Microsoft\Windows Defender\
    - \SOFTWARE\Policies\Microsoft\Windows Defender Security Center\
    - \SOFTWARE\Policies\Microsoft\Windows Defender\
- condition: selection
  selection:
    EventType: SetValue
    Image|endswith: \winget.exe
    TargetObject|endswith: \LocalState\admin_settings
    TargetObject|startswith: \REGISTRY\A\
- condition: selection
  selection:
    Details: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: \AppInstaller\EnableLocalManifestFiles
- condition: selection
  selection:
    Details|endswith: DWORD (0x00000001)
    EventType: SetValue
    TargetObject|endswith: \Microsoft\Windows NT\CurrentVersion\Winlogon\AllowMultipleTSSessions
- condition: selection
  selection:
    Details|endswith: .dll
    EventType: SetValue
    TargetObject|endswith: \SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\logon
- condition: selection
  selection:
    EventID: 16
- condition: selection_error and not 1 of filter*
  filter_by_errorcode:
    Description|contains:
    - Failed to open service configuration with error 19
    - Failed to open service configuration with error 93
  filter_generic_english:
    Description|contains|all:
    - Failed to open service configuration with error
    - 'Last error: The media is write protected.'
  selection_error:
    Description|contains:
    - Failed to open service configuration with error
    - Failed to connect to the driver to update configuration
- condition: 1 of selection_* and not filter
  filter:
    State: Started
  selection_conf:
  - Sysmon config state changed
  selection_stop:
    State: Stopped
- condition: selection
  selection:
    EventID: 27
- condition: selection
  selection:
    EventID: 28
- condition: selection
  selection:
    EventID: 29
- condition: selection and not filters
  filters:
    Image|contains:
    - :\Program Files\
    - :\Program Files (x86)
    Image|endswith:
    - \chrome.exe
    - \opera.exe
    - \firefox.exe
    - \MicrosoftEdge.exe
    - \WMIADAP.exe
  selection:
    Type: Image is replaced
- condition: selection
  selection:
    EventID:
    - 19
    - 20
    - 21
- condition: selection_destination
  selection_destination:
    Destination|base64offset|contains:
    - WriteProcessMemory
    - This program cannot be run in DOS mode
    - This program must be run under Win32
- condition: selection_destination
  selection_destination:
  - Destination|contains|all:
    - new-object
    - net.webclient
    - .downloadstring
  - Destination|contains|all:
    - new-object
    - net.webclient
    - .downloadfile
  - Destination|contains:
    - ' iex('
    - WScript.shell
    - ' -nop '
    - ' -noprofile '
    - ' -decode '
    - ' -enc '
  - Destination|contains:
    - WScript.Shell
    - System.Security.Cryptography.FromBase64Transform
- condition: selection
  selection:
    ImageLoaded: C:\Windows\ADFS\version.dll
- condition: selection
  selection:
    ImageLoaded: C:\Windows\oci.dll
    Image|endswith: \msdtc.exe
- condition: selection
  selection:
    cs-uri-query|contains: /manager/controllers/default/resource/tvs.php?class_key=../../../../../../../../../../windows/win.ini%00
- condition: all of selection_*
  selection_payload:
    cs-uri-query|contains:
    - save|
    - powershell
    - cmd.exe
    - cmd /c
    - cmd /r
    - cmd /k
    - cscript
    - wscript
    - python
    - C:\Users\Public\
    - '%comspec%'
  selection_search:
    cs-uri-query|contains: ?search=%00{.
- condition: selection
  selection:
    CommandLine|contains:
    - zxFunction
    - RemoteDiskXXXXX
    Image|endswith: \rundll32.exe
- condition: selection
  selection:
    CommandLine:
    - net use \\\\%DomainController%\C$ "P@ssw0rd" *
    - dir c:\\*.files* /s
    - dir %TEMP%\\*.exe
- condition: 1 of selection_*
  selection_cli_1:
    CommandLine|contains:
    - tracert -h 10 yahoo.com
    - .WSqmCons))|iex;
    - Fr`omBa`se6`4Str`ing
  selection_cli_2:
    CommandLine|contains|all:
    - net use https://docs.live.net
    - '@aol.co.uk'
- condition: selection
  selection:
    Image|endswith: \MicroScMgmt.exe
    ParentImage|endswith: \WINWORD.EXE
- condition: selection
  selection:
    Image|contains: \FLTLDR.exe
    ParentImage|endswith: \WINWORD.EXE
- condition: selection
  selection:
    ParentImage|endswith: \EQNEDT32.EXE
- condition: selection
  selection:
    Image|endswith: \csc.exe
    ParentImage|endswith: \WINWORD.EXE
- condition: selection
  selection:
  - CommandLine|contains|all:
    - \AppData\Roaming\Oracle
    - \java
    - '.exe '
  - CommandLine|contains|all:
    - cscript.exe
    - Retrive
    - '.vbs '
- condition: selection
  selection:
    CommandLine|contains|all:
    - rundll32.exe
    - InstallArcherSvc
- condition: 1 of selection*
  selection_pattern:
    CommandLine|contains:
    - 'wevtutil cl Application & fsutil usn deletejournal /D C:'
    - dllhost.dat %WINDIR%\ransoms
  selection_perfc_keyword:
  - \perfc.dat
  selection_rundll32_dash1:
    CommandLine|endswith:
    - .dat,#1
    - '.dat #1'
    - .zip.dll",#1
    Image|endswith: \rundll32.exe
- condition: ( selection_cammute and not filter_cammute ) or ( selection_chrome_frame
    and not filter_chrome_frame ) or ( selection_devemu and not filter_devemu ) or
    ( selection_gadget and not filter_gadget ) or ( selection_hcc and not filter_hcc
    ) or ( selection_hkcmd and not filter_hkcmd ) or ( selection_mc and not filter_mc
    ) or ( selection_msmpeng and not filter_msmpeng ) or ( selection_msseces and not
    filter_msseces ) or ( selection_oinfo and not filter_oinfo ) or ( selection_oleview
    and not filter_oleview ) or ( selection_rc and not filter_rc )
  filter_cammute:
    Image|contains:
    - \Lenovo\Communication Utility\
    - \Lenovo\Communications Utility\
  filter_chrome_frame:
    Image|contains: \Google\Chrome\application\
  filter_devemu:
    Image|contains: \Microsoft Device Emulator\
  filter_gadget:
    Image|contains: \Windows Media Player\
  filter_hcc:
    Image|contains: \HTML Help Workshop\
  filter_hkcmd:
    Image|contains:
    - \System32\
    - \SysNative\
    - \SysWow64\
  filter_mc:
    Image|contains:
    - \Microsoft Visual Studio
    - \Microsoft SDK
    - \Windows Kit
  filter_msmpeng:
    Image|contains:
    - \Microsoft Security Client\
    - \Windows Defender\
    - \AntiMalware\
  filter_msseces:
    Image|contains:
    - \Microsoft Security Center\
    - \Microsoft Security Client\
    - \Microsoft Security Essentials\
  filter_oinfo:
    Image|contains: \Common Files\Microsoft Shared\
  filter_oleview:
    Image|contains:
    - \Microsoft Visual Studio
    - \Microsoft SDK
    - \Windows Kit
    - \Windows Resource Kit\
  filter_rc:
    Image|contains:
    - \Microsoft Visual Studio
    - \Microsoft SDK
    - \Windows Kit
    - \Windows Resource Kit\
    - \Microsoft.NET\
  selection_cammute:
    Image|endswith: \CamMute.exe
  selection_chrome_frame:
    Image|endswith: \chrome_frame_helper.exe
  selection_devemu:
    Image|endswith: \dvcemumanager.exe
  selection_gadget:
    Image|endswith: \Gadget.exe
  selection_hcc:
    Image|endswith: \hcc.exe
  selection_hkcmd:
    Image|endswith: \hkcmd.exe
  selection_mc:
    Image|endswith: \Mc.exe
  selection_msmpeng:
    Image|endswith: \MsMpEng.exe
  selection_msseces:
    Image|endswith: \msseces.exe
  selection_oinfo:
    Image|endswith: \OInfoP11.exe
  selection_oleview:
    Image|endswith: \OleView.exe
  selection_rc:
    Image|endswith: \rc.exe
- condition: 1 of selection*
  selection1:
  - Image|endswith:
    - \tasksche.exe
    - \mssecsvc.exe
    - \taskdl.exe
    - \taskhsvc.exe
    - \taskse.exe
    - \111.exe
    - \lhdfrgui.exe
    - \linuxnew.exe
    - \wannacry.exe
  - Image|contains: WanaDecryptor
  selection2:
  - CommandLine|contains|all:
    - icacls
    - /grant
    - Everyone:F
    - /T
    - /C
    - /Q
  - CommandLine|contains|all:
    - bcdedit
    - /set
    - '{default}'
    - recoveryenabled
    - 'no'
  - CommandLine|contains|all:
    - wbadmin
    - delete
    - catalog
    - -quiet
  - CommandLine|contains: '@Please_Read_Me@.txt'
- condition: 1 of selection_*
  selection_cscript:
    CommandLine|contains: '.vbs /shell '
    Image|endswith: \cscript.exe
  selection_csvde:
    CommandLine|contains|all:
    - csvde -f C:\windows\web\
    - .log
- condition: selection
  selection:
    CommandLine|contains|all:
    - ps.exe -accepteula
    - -s cmd /c netstat
- condition: selection and not filter
  filter:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  selection:
    Image|endswith:
    - \msdtc.exe
    - \gpsvc.exe
- condition: selection
  selection:
    cs-uri-query|contains|all:
    - lang=/../../
    - /dev/cmdb/sslvpn_websession
- condition: selection
  selection:
    cs-uri-query: '*/config/keystore/*.js*'
- condition: 1 of selection_other_* or all of selection_dll_*
  selection_dll_function:
    CommandLine|contains: ',Setting'
  selection_dll_path:
    CommandLine|endswith:
    - \AppData\Roaming\MICROS~1\Windows\Caches\NavShExt.dll
    - \AppData\Roaming\Microsoft\Windows\Caches\NavShExt.dll
  selection_other_del:
    CommandLine|contains|all:
    - \Windows\Caches\NavShExt.dll
    - /c del
  selection_other_svchost:
    Image|endswith: \Microsoft\Network\svchost.exe
- condition: 1 of selection_*
  selection_sllauncher:
    Image|endswith: \svchost.exe
    ParentImage|endswith: \sllauncher.exe
  selection_svchost:
    CommandLine|contains: -k
    Image|endswith: \svchost.exe
    ParentImage|contains: \AppData\Roaming\
- condition: all of selection_* and not 1 of filter_main_*
  filter_main_exclude_temp:
    CommandLine|contains: \AppData\Local\Temp\
  selection_extensions:
  - CommandLine|contains: .dat",
  - CommandLine|endswith:
    - '.dll #1'
    - '.dll" #1'
    - .dll",#1
  selection_path:
    CommandLine|contains:
    - '%LOCALAPPDATA%'
    - \AppData\Local\
    Image|endswith: \rundll32.exe
- condition: selection
  selection:
    TargetFilename|contains:
    - ds7002.lnk
    - ds7002.pdf
    - ds7002.zip
- condition: selection
  selection:
  - CommandLine|contains: -noni -ep bypass $
  - CommandLine|contains|all:
    - cyzfc.dat,
    - PointFunctionCall
- condition: 1 of selection_*
  selection_mshta:
    CommandLine|contains|all:
    - vbscript:Close(Execute("CreateObject(
    - powershell
    - -w 1 -exec Bypass
    - \ProgramData\
  selection_pwsh_backdoor:
    CommandLine|contains|all:
    - '[Convert]::ToBase64String'
    - '[System.Text.Encoding]::UTF8.GetString]'
    - GetResponse().GetResponseStream()
    - '[System.Net.HttpWebRequest]::Create('
    - '-bxor '
  selection_survey:
    CommandLine|contains|all:
    - Win32_OperatingSystem
    - Win32_NetworkAdapterConfiguration
    - root\SecurityCenter2
    - '[System.Net.DNS]'
- condition: 1 of selection_*
  selection_autoit:
    CommandLine|contains|all:
    - nslookup.exe
    - -q=TXT
    ParentImage|endswith: \local\microsoft\Taskbar\autoit3.exe
  selection_schtasks:
    CommandLine|contains|all:
    - SC Scheduled Scan
    - \microsoft\Taskbar\autoit3.exe
  selection_service:
    CommandLine|contains:
    - i
    - u
    Image: C:\Windows\system32\Service.exe
  selection_temp:
    Image|contains: \Windows\Temp\DB\
    Image|endswith: .exe
- condition: selection_service
  selection_service:
    EventID: 4698
    TaskName:
    - SC Scheduled Scan
    - UpdatMachine
- condition: selection
  selection:
    EventID: 7045
    Provider_Name: Service Control Manager
    ServiceName:
    - SC Scheduled Scan
    - UpdatMachine
- condition: selection
  selection:
    CommandLine|contains:
    - /delete
    - /change
    CommandLine|contains|all:
    - /TN
    - \Microsoft\Windows\Defrag\ScheduledDefrag
    Image|endswith: \schtasks.exe
- condition: selection
  selection:
    EventID: 4701
    TaskName: \Microsoft\Windows\Defrag\ScheduledDefrag
- condition: selection
  selection:
    CommandLine|contains: abCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCc
- condition: all of selection*
  selection_cli:
    CommandLine|contains|all:
    - /change
    - /TN
    - /RU
    - /RP
  selection_img:
  - Image|endswith: \schtasks.exe
  - OriginalFileName: schtasks.exe
- condition: selection
  selection:
    cs-uri-query: '*?/dana/html5acc/guacamole/*'
- condition: selection and not filter
  filter:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
    - C:\Windows\Setup\
  selection:
    ParentCommandLine|contains|all:
    - \cmd.exe
    - /c
    - C:\Windows\Setup\Scripts\
    ParentCommandLine|endswith:
    - SetupComplete.cmd
    - PartnerSetupComplete.cmd
- condition: selection and ( rights1 or rights2 )
  rights1:
    IntegrityLevel: System
  rights2:
    User|contains:
    - AUTHORI
    - AUTORI
  selection:
    CommandLine|contains: ' http'
    Image|endswith: \iexplore.exe
    ParentImage|endswith: \consent.exe
- condition: 1 of selection_*
  selection_cs:
  - cs-uri-query|contains: /../vpns/
  - cs-uri-query|endswith: /vpns/cfg/smb.conf
  selection_csall:
    cs-uri-query|contains|all:
    - /vpns/portal/scripts/
    - .pl
- condition: selection
  selection:
    cs-method: POST
    cs-uri-query|contains|all:
    - /upload.action
    - filename=../../../../
- condition: selection
  selection:
  - CommandLine|contains|all:
    - powershell.exe mshta.exe http
    - .hta
  - CommandLine|contains:
    - reg query "HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default"
    - cmd.exe /c taskkill /im cmd.exe
    - (New-Object System.Net.WebClient).UploadFile('http
- condition: (selection_svchost and not filter_svchost) or (selection_regsvr and not
    filter_regsvr) or (selection_anomaly_parent and 1 of selection_anomaly_child_*)
  filter_regsvr:
    CommandLine|contains: .dll
  filter_svchost:
    ParentImage|startswith: C:\Windows\System32\
  selection_anomaly_child_1:
    CommandLine|contains: ' /all'
    Image|endswith: \whoami.exe
  selection_anomaly_child_2:
    CommandLine|contains: ' view'
    Image|endswith:
    - \net.exe
    - \net1.exe
  selection_anomaly_parent:
    ParentImage|endswith: \svchost.exe
  selection_regsvr:
    CommandLine|contains:
    - ' -s '
    - \AppData\Local\Temp\
    Image|endswith: \regsvr32.exe
    ParentImage|endswith: \excel.exe
  selection_svchost:
    CommandLine|contains|all:
    - C:\Users\
    - \Desktop\
    Image|endswith: \svchost.exe
- condition: 1 of selection_*
  selection_ipconfig:
    CommandLine|contains|all:
    - ipconfig /all
    - \temp\res.ip
  selection_netsh:
    CommandLine|contains|all:
    - interface ip show config
    - \temp\netsh.res
  selection_ping:
    CommandLine|contains|all:
    - 'ping -n '
    - ' echo EEEE > '
- condition: selection and not filter
  filter:
    CommandLine|contains:
    - fAAgAEMAbwBuAHYAZQByAHQAVABvAC0ASgBzAG8AbgAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwBpAGwAZQBuAHQAbAB5AEMAbwBuAHQAaQBuAHUAZQ
    - wAIABDAG8AbgB2AGUAcgB0AFQAbwAtAEoAcwBvAG4AIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAFMAaQBsAGUAbgB0AGwAeQBDAG8AbgB0AGkAbgB1AGUA
    - 8ACAAQwBvAG4AdgBlAHIAdABUAG8ALQBKAHMAbwBuACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAGkAbABlAG4AdABsAHkAQwBvAG4AdABpAG4AdQBlA
  selection:
    CommandLine|contains:
    - ' -e* PAA'
    - JABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQ
    - QAZQBuAHYAOgB1AHMAZQByAHAAcgBvAGYAaQBsAGUA
    - kAGUAbgB2ADoAdQBzAGUAcgBwAHIAbwBmAGkAbABlA
    - IgAoACcAKgAnACkAOwAkA
    - IAKAAnACoAJwApADsAJA
    - iACgAJwAqACcAKQA7ACQA
    - JABGAGwAeAByAGgAYwBmAGQ
    - PQAkAGUAbgB2ADoAdABlAG0AcAArACgA
    - 0AJABlAG4AdgA6AHQAZQBtAHAAKwAoA
    - 9ACQAZQBuAHYAOgB0AGUAbQBwACsAKA
- condition: all of selection*
  selection1:
    ParentCommandLine|endswith: .exe
    ParentCommandLine|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
  selection2:
  - CommandLine|contains|all:
    - /c
    - del
    - C:\Users\
    - \AppData\Local\Temp\
  - CommandLine|contains|all:
    - /c
    - del
    - C:\Users\
    - \Desktop\
  - CommandLine|contains|all:
    - /C
    - type nul >
    - C:\Users\
    - \Desktop\
  selection3:
    CommandLine|endswith: .exe
- condition: selection
  selection:
    CommandLine|contains: -i SM-tgytutrc -s
- condition: 1 of selection*
  selection1:
    Image|endswith: \wscript.exe
    ParentImage|endswith: \WinRAR.exe
  selection2:
    CommandLine|contains: ' /c ping.exe -n 6 127.0.0.1 & type '
  selection3:
    CommandLine|contains|all:
    - regsvr32.exe
    - C:\ProgramData
    - .tmp
- condition: 1 of selection_*
  selection_del:
    CommandLine|contains|all:
    - del /s /f /q c:\
    - \*.bac
    - \*.bak
    - \*.bkf
  selection_net:
    CommandLine|contains:
    - samss
    - audioendpointbuilder
    - unistoresvc_
    - AcrSch2Svc
    CommandLine|contains|all:
    - ' stop '
    - ' /y'
    Image|endswith:
    - \net.exe
    - \net1.exe
  selection_reg:
    CommandLine|contains|all:
    - Microsoft\Windows\CurrentVersion\Run
    - C:\users\Public\
- condition: selection
  selection:
    CommandLine|contains:
    - shutdown /r /f /t 00
    - net stop SuperBackupMan
- condition: selection
  selection:
    CommandLine|contains|all:
    - regsvr32
    - \AppData\Local\
    - .dll
    - ',DllEntry'
- condition: 1 of selection_*
  selection_lateral_movement:
    CommandLine|contains:
    - \aaaa\procdump64.exe
    - \aaaa\netsess.exe
    - \aaaa\7za.exe
    - \c$\aaaa\
    CommandLine|contains|all:
    - copy \\\\
    - c$
  selection_ldifde:
    CommandLine|contains|all:
    - ldifde
    - -f -n
    - eprod.ldf
- condition: 1 of selection_*
  selection_adexplorer:
    CommandLine|contains|all:
    - adexplorer -snapshot "" c:\users\
    - \downloads\
    - .snp
  selection_xcopy:
    CommandLine|contains|all:
    - xcopy /S /E /C /Q /H \\\\
    - \sysvol\
- condition: selection
  selection:
    CommandLine|contains|all:
    - /e:jscript
    - \Local\Temp\Errors.bat
- condition: selection
  selection:
  - CommandLine|contains: -export dll_u
  - CommandLine|endswith:
    - ',dll_u'
    - ' dll_u'
- condition: 1 of selection_*
  selection_cli:
  - CommandLine|contains:
    - Temp\wtask.exe /create
    - '%windir:~-3,1%%PUBLIC:~-9,1%'
    - '/tn "Security Script '
    - '%windir:~-1,1%'
  - CommandLine|contains|all:
    - /E:vbscript
    - C:\Users\
    - .txt
    - /F
  selection_img:
    Image|endswith: Temp\winwsh.exe
- condition: selection
  selection:
    CommandLine|contains:
    - checkadmin.exe 127.0.0.1 -all
    - netsh advfirewall firewall add rule name=powershell dir=in
    - cmd /c powershell.exe -ep bypass -file c:\s.ps1
    - /tn win32times /f
    - create win32times binPath=
    - \c$\windows\system32\devmgr.dll
    - ' -exec bypass -enc JgAg'
    - type *keepass\KeePass.config.xml
    - iie.exe iie.txt
    - reg query HKEY_CURRENT_USER\Software\\*\PuTTY\Sessions\
- condition: selection
  selection:
    CallerProcessName|endswith: \checkadmin.exe
    EventID: 4799
    TargetUserName|startswith: Administr
- condition: selection
  selection:
    cs-uri-query|contains|all:
    - /ecp/default.aspx
    - __VIEWSTATEGENERATOR=
    - __VIEWSTATE=
- condition: all of selection*
  selection1:
    cs-method: GET
    cs-uri-query|contains:
    - /ecp/
    - /owa/
  selection2:
    cs-uri-query|contains: __VIEWSTATE=
- condition: all of selection* and not 1 of valid_request_*
  selection:
    cs-uri-query|contains:
    - /WebResource.axd
    - /ScriptResource.axd
    - /i18n.ashx
    - /Skipi18n
  selection2:
    cs-uri-query|contains:
    - /SolarWinds/
    - /api/
  valid_request_1:
    cs-uri-query|contains: Orion/Skipi18n/Profiler/
  valid_request_2:
    cs-uri-query|contains:
    - css.i18n.ashx
    - js.i18n.ashx
- condition: selection
  selection:
    Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
    - \bitsadmin.exe
    - \systeminfo.exe
    - \net.exe
    - \net1.exe
    - \reg.exe
    - \query.exe
    ParentImage|endswith: DesktopCentral_Server\jre\bin\java.exe
- condition: (selection1 and selection2) or selection3
  selection1:
    CommandLine|contains: Add-PrinterPort -Name
  selection2:
    CommandLine|contains:
    - .exe
    - .dll
    - .bat
  selection3:
    CommandLine|contains: Generic / Text Only
- condition: selection and not filter
  filter:
    Image|endswith:
    - \System32\werfault.exe
    - \System32\conhost.exe
    - \System32\dnscmd.exe
    - \System32\dns.exe
  selection:
    ParentImage|endswith: \System32\dns.exe
- condition: selection
  selection:
    cs-uri-query|contains:
    - /console/images/%252E%252E%252Fconsole.portal
    - /console/css/%2e
- base_url:
    cs-method: GET
    cs-uri-query|contains|all:
    - /include/makecvs.php
    - ?Event=
  condition: base_url and payload
  payload:
    cs-uri-query|contains:
    - curl
    - wget
    - .py
    - .sh
    - chmod
    - _GET
- condition: selection_endpoint and selection_path_select and select_status_code
  select_status_code:
    sc-status: 200
  selection_endpoint:
    cs-uri-query|contains:
    - +CSCOT+/translation-table
    - +CSCOT+/oem-customization
  selection_path_select:
    cs-uri-query|contains:
    - '&textdomain=/'
    - '&textdomain=%'
    - '&name=/'
    - '&name=%'
- condition: selection_base and selection_traversal
  selection_base:
    cs-uri-query|contains:
    - /tmui/
    - /hsqldb
  selection_traversal:
    cs-uri-query|contains:
    - ..;/
    - .jsp/..
- condition: 1 of selection*
  selection1:
    cs-uri-query|contains: /rapi/filedownload?filter=path:%2F
  selection2:
    cs-uri-query|contains|all:
    - /pcidss/report
    - type=all_signatures
    - sig_name=_default_signature_
- condition: sc_cmd or wmic_cmd
  sc_cmd:
    CommandLine|contains|all:
    - sc config
    - wercplsupporte.dll
    Image|endswith: \cmd.exe
  wmic_cmd:
    CommandLine|endswith: COR_PROFILER
    Image|endswith: \wmic.exe
- condition: all of selection_* and not 1 of filter_*
  filter_ide:
    ParentImage|endswith: \tracker.exe
  filter_legitimate_dll:
    CommandLine|endswith:
    - .dll,Control_RunDLL
    - .dll",Control_RunDLL
    - .dll',Control_RunDLL
  selection_cli:
    CommandLine|endswith:
    - ',RunDLL'
    - ',Control_RunDLL'
  selection_img:
  - Image|endswith: \rundll32.exe
  - OriginalFileName: RUNDLL32.EXE
- condition: selection
  selection:
    CommandLine|contains:
    - -Property DWORD -name DisableFirstRunCustomize -value 2 -Force
    - -Property String -name Check_Associations -value
    - -Property DWORD -name IEHarden -value 0 -Force
- condition: 1 of selection*
  selection1:
    Image|endswith: .tmp
    ParentImage|endswith: \WINWORD.exe
  selection2:
    CommandLine|endswith: shadowcopy delete
    Image|endswith: \wmic.exe
    ParentImage|contains: \Temp\
  selection3:
    CommandLine|contains: \..\..\system32
    CommandLine|endswith: shadowcopy delete
- condition: selection
  selection:
    Image|endswith: \wermgr.exe
    ParentCommandLine|contains: DllRegisterServer
    ParentImage|endswith: \rundll32.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - regsvr32
    - /s
    - /i
    - \AppData\Roaming\
    - .ocx
- condition: 1 of selection_*
  selection_hashes:
  - sha256:
    - 9ae7c4a4e1cfe9b505c3a47e66551eb1357affee65bfefb0109d02f4e97c06dd
    - 7772d624e1aed327abcd24ce2068063da0e31bb1d5d3bf2841fc977e198c6c5b
    - 657fc7e6447e0065d488a7db2caab13071e44741875044f9024ca843fe4e86b5
    - 2ef157a97e28574356e1d871abf75deca7d7a1ea662f38b577a06dd039dbae29
    - 52fd7b90d7144ac448af4008be639d4d45c252e51823f4311011af3207a5fc77
    - a370e47cb97b35f1ae6590d14ada7561d22b4a73be0cb6df7e851d85054b1ac3
    - 5bf80b871278a29f356bd42af1e35428aead20cd90b0c7642247afcaaa95b022
    - 6f690ccfd54c2b02f0c3cb89c938162c10cbeee693286e809579c540b07ed883
    - 3c884f776fbd16597c072afd81029e8764dd57ee79d798829ca111f5e170bd8e
    - 1922a419f57afb351b58330ed456143cc8de8b3ebcbd236d26a219b03b3464d7
    - fe0e4ef832b62d49b43433e10c47dc51072959af93963c790892efc20ec422f1
    - 7ce9e1c5562c8a5c93878629a47fe6071a35d604ed57a8f918f3eadf82c11a9c
    - 178d5ee8c04401d332af331087a80fb4e5e2937edfba7266f9be34a5029b6945
    - 51f70956fa8c487784fd21ab795f6ba2199b5c2d346acdeef1de0318a4c729d9
    - 889bca95f1a69e94aaade1e959ed0d3620531dc0fc563be9a8decf41899b4d79
    - 332ddaa00e2eb862742cb8d7e24ce52a5d38ffb22f6c8bd51162bd35e84d7ddf
    - 44bcf82fa536318622798504e8369e9dcdb32686b95fcb44579f0b4efa79df08
    - 63552772fdd8c947712a2cff00dfe25c7a34133716784b6d486227384f8cf3ef
    - 056744a3c371b5938d63c396fe094afce8fb153796a65afa5103e1bffd7ca070
  - sha1:
    - 53a44c2396d15c3a03723fa5e5db54cafd527635
    - 9c5e496921e3bc882dc40694f1dcc3746a75db19
    - aeb573accfd95758550cf30bf04f389a92922844
    - 79ef78a797403a4ed1a616c68e07fff868a8650a
    - 4f6f38b4cec35e895d91c052b1f5a83d665c2196
    - 1e8c2cac2e4ce7cbd33c3858eb2e24531cb8a84d
    - e841a63e47361a572db9a7334af459ddca11347a
    - c28f606df28a9bc8df75a4d5e5837fc5522dd34d
    - 2e94b305d6812a9f96e6781c888e48c7fb157b6b
    - dd44133716b8a241957b912fa6a02efde3ce3025
    - 8793bf166cb89eb55f0593404e4e933ab605e803
    - a39b57032dbb2335499a51e13470a7cd5d86b138
    - 41cc2b15c662bc001c0eb92f6cc222934f0beeea
    - d209430d6af54792371174e70e27dd11d3def7a7
    - 1c6452026c56efd2c94cea7e0f671eb55515edb0
    - c6b41d3afdcdcaf9f442bbe772f5da871801fd5a
    - 4923d460e22fbbf165bbbaba168e5a46b8157d9f
    - f201504bd96e81d0d350c3a8332593ee1c9e09de
    - ddd2db1127632a2a52943a2fe516a2e7d05d70d2
  selection_sysmon:
    Hashes|contains:
    - SHA256=9ae7c4a4e1cfe9b505c3a47e66551eb1357affee65bfefb0109d02f4e97c06dd
    - SHA256=7772d624e1aed327abcd24ce2068063da0e31bb1d5d3bf2841fc977e198c6c5b
    - SHA256=657fc7e6447e0065d488a7db2caab13071e44741875044f9024ca843fe4e86b5
    - SHA256=2ef157a97e28574356e1d871abf75deca7d7a1ea662f38b577a06dd039dbae29
    - SHA256=52fd7b90d7144ac448af4008be639d4d45c252e51823f4311011af3207a5fc77
    - SHA256=a370e47cb97b35f1ae6590d14ada7561d22b4a73be0cb6df7e851d85054b1ac3
    - SHA256=5bf80b871278a29f356bd42af1e35428aead20cd90b0c7642247afcaaa95b022
    - SHA256=6f690ccfd54c2b02f0c3cb89c938162c10cbeee693286e809579c540b07ed883
    - SHA256=3c884f776fbd16597c072afd81029e8764dd57ee79d798829ca111f5e170bd8e
    - SHA256=1922a419f57afb351b58330ed456143cc8de8b3ebcbd236d26a219b03b3464d7
    - SHA256=fe0e4ef832b62d49b43433e10c47dc51072959af93963c790892efc20ec422f1
    - SHA256=7ce9e1c5562c8a5c93878629a47fe6071a35d604ed57a8f918f3eadf82c11a9c
    - SHA256=178d5ee8c04401d332af331087a80fb4e5e2937edfba7266f9be34a5029b6945
    - SHA256=51f70956fa8c487784fd21ab795f6ba2199b5c2d346acdeef1de0318a4c729d9
    - SHA256=889bca95f1a69e94aaade1e959ed0d3620531dc0fc563be9a8decf41899b4d79
    - SHA256=332ddaa00e2eb862742cb8d7e24ce52a5d38ffb22f6c8bd51162bd35e84d7ddf
    - SHA256=44bcf82fa536318622798504e8369e9dcdb32686b95fcb44579f0b4efa79df08
    - SHA256=63552772fdd8c947712a2cff00dfe25c7a34133716784b6d486227384f8cf3ef
    - SHA256=056744a3c371b5938d63c396fe094afce8fb153796a65afa5103e1bffd7ca070
    - SHA1=53a44c2396d15c3a03723fa5e5db54cafd527635
    - SHA1=9c5e496921e3bc882dc40694f1dcc3746a75db19
    - SHA1=aeb573accfd95758550cf30bf04f389a92922844
    - SHA1=79ef78a797403a4ed1a616c68e07fff868a8650a
    - SHA1=4f6f38b4cec35e895d91c052b1f5a83d665c2196
    - SHA1=1e8c2cac2e4ce7cbd33c3858eb2e24531cb8a84d
    - SHA1=e841a63e47361a572db9a7334af459ddca11347a
    - SHA1=c28f606df28a9bc8df75a4d5e5837fc5522dd34d
    - SHA1=2e94b305d6812a9f96e6781c888e48c7fb157b6b
    - SHA1=dd44133716b8a241957b912fa6a02efde3ce3025
    - SHA1=8793bf166cb89eb55f0593404e4e933ab605e803
    - SHA1=a39b57032dbb2335499a51e13470a7cd5d86b138
    - SHA1=41cc2b15c662bc001c0eb92f6cc222934f0beeea
    - SHA1=d209430d6af54792371174e70e27dd11d3def7a7
    - SHA1=1c6452026c56efd2c94cea7e0f671eb55515edb0
    - SHA1=c6b41d3afdcdcaf9f442bbe772f5da871801fd5a
    - SHA1=4923d460e22fbbf165bbbaba168e5a46b8157d9f
    - SHA1=f201504bd96e81d0d350c3a8332593ee1c9e09de
    - SHA1=ddd2db1127632a2a52943a2fe516a2e7d05d70d2
- condition: 1 of selection_*
  selection_img:
    Image|endswith:
    - :\ProgramData\adobe\Adobe.exe
    - :\ProgramData\oracle\local.exe
    - \revshell.exe
    - \infopagesbackup\ncat.exe
    - :\ProgramData\comms\comms.exe
  selection_msf:
    CommandLine|contains|all:
    - -ExecutionPolicy Bypass -File
    - \msf.ps1
  selection_ncat:
    CommandLine|contains|all:
    - infopagesbackup
    - \ncat
    - -e cmd.exe
  selection_other:
    CommandLine|contains: L3NlcnZlcj1
  selection_powershell:
    CommandLine|contains:
    - system.Data.SqlClient.SqlDataAdapter($cmd); [void]$da.fill
    - -nop -w hidden -c $k=new-object
    - '[Net.CredentialCache]::DefaultCredentials;IEX '
    - ' -nop -w hidden -c $m=new-object net.webclient;$m'
    - -noninteractive -executionpolicy bypass whoami
    - -noninteractive -executionpolicy bypass netstat -a
- condition: 1 of selection_*
  selection_generic:
    CommandLine|contains:
    - reg.exe save hklm\sam %temp%\~reg_sam.save
    - 1q2w3e4r@#$@#$@#$
    - ' -hp1q2w3e4 '
    - '.dat data03 10000 -p '
  selection_netstat:
    CommandLine|contains|all:
    - 'netstat -aon | find '
    - ESTA
    - ' > %temp%\~'
  selection_network_discovery:
    CommandLine|contains|all:
    - .255 10 C:\ProgramData\IBM\
    - .DAT
  selection_persistence:
    CommandLine|contains:
    - C:\ProgramData\
    - C:\RECYCLER\
    CommandLine|contains|all:
    - ' /c '
    - ' -p 0x'
  selection_rundll32:
    CommandLine|contains:
    - .bin,
    - .tmp,
    - .dat,
    - .io,
    - .ini,
    - .db,
    CommandLine|contains|all:
    - 'rundll32 '
    - C:\ProgramData\
- condition: 1 of selection_* or ( specific1 and not filter1 )
  filter1:
    CommandLine:
    - ' '
    - ''
  selection_1:
    CommandLine|contains: 7z.exe a -v500m -mx9 -r0 -p
  selection_2:
    CommandLine|contains|all:
    - rundll32.exe
    - C:\Windows
    - .dll,Tk_
    ParentCommandLine|contains|all:
    - wscript.exe
    - .vbs
  selection_3:
    CommandLine|contains: 'cmd.exe /C '
    ParentCommandLine|contains: C:\Windows
    ParentImage|endswith: \rundll32.exe
  selection_4:
    CommandLine|contains|all:
    - rundll32 c:\windows\
    - '.dll '
  specific1:
    Image|endswith: \dllhost.exe
    ParentImage|endswith: \rundll32.exe
- condition: 1 of selection_*
  selection_cli_1:
    CommandLine|contains|all:
    - Invoke-WMIMethod win32_process -name create -argumentlist
    - rundll32 c:\windows
  selection_cli_2:
    CommandLine|contains|all:
    - 'wmic /node:'
    - process call create "rundll32 c:\windows
- condition: selection and not filter
  filter:
    CommandLine|contains: \Software\Microsoft\Windows\CurrentVersion\Run
  selection:
    CommandLine|contains|all:
    - Execute
    - CreateObject
    - RegRead
    - window.close
    - \Microsoft\Windows\CurrentVersion
- condition: selection1 or selection2
  selection1:
    cs-uri-query|contains|all:
    - logoimagehandler.ashx
    - clazz
  selection2:
    cs-uri-query|contains: logoimagehandler.ashx
    sc-status: 500
- condition: selection1 or ( selection2a and selection2b )
  selection1:
    CommandLine|contains:
    - dll,MyStart
    - dll MyStart
  selection2a:
    CommandLine|endswith: ' MyStart'
  selection2b:
    CommandLine|contains: rundll32.exe
- condition: 1 of selection*
  selection1:
    Image|startswith: C:\ProgramData\DRM
    ParentImage|contains:
    - C:\Windows\Temp
    - \hpqhvind.exe
  selection2:
    Image|endswith: \wmplayer.exe
    ParentImage|startswith: C:\ProgramData\DRM
  selection3:
    Image|endswith: \wmplayer.exe
    ParentImage|endswith: \Test.exe
  selection4:
    Image: C:\ProgramData\DRM\CLR\CLR.exe
  selection5:
    Image|endswith: \SearchFilterHost.exe
    ParentImage|startswith: C:\ProgramData\DRM\Windows
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains: setup0.exe -p
  selection_2:
    CommandLine|contains: setup.exe
    CommandLine|endswith:
    - -x:0
    - -x:1
    - -x:2
- condition: selection and not filter
  filter:
    Details|endswith:
    - system32\wbem\wmiutils.dll
    - system32\wbem\wbemsvc.dll
  selection:
    EventType: SetValue
    TargetObject|endswith:
    - CLSID\{CF4CC405-E2C5-4DDD-B3CE-5E7582D8C9FA}\InprocServer32\(Default)
    - CLSID\{7C857801-7381-11CF-884D-00AA004B2E24}\InProcServer32\(Default)
- condition: (path_traversal or config_file_inj) and noauth_list
  config_file_inj:
    cs-uri-query|contains|all:
    - ..%2f
    - apply_abstract.cgi
  noauth_list:
    cs-uri-query|contains:
    - /images/
    - /js/
    - /css/
    - /setup_top_login.htm
    - /login.html
    - /loginerror.html
    - /loginexclude.html
    - /loginlock.html
  path_traversal:
    cs-uri-query|contains: ..%2f
- condition: (selection or keywords) and not falsepositive
  falsepositive:
  - ' registration timed out'
  keywords:
  - The print spooler failed to load a plug-in module
  - MyExploit.dll
  - evil.dll
  - \addCube.dll
  - \rev.dll
  - \rev2.dll
  - \main64.dll
  - \mimilib.dll
  - \mimispool.dll
  selection:
    ErrorCode:
    - '0x45A'
    - '0x7e'
    EventID: 808
- condition: selection and keywords
  keywords:
  - 'UNIDRV.DLL, kernelbase.dll, '
  - ' 123 '
  - ' 1234 '
  - mimispool
  selection:
    EventID: 316
- condition: selection
  selection:
    AccessMask: '0x3'
    EventID: 5145
    ObjectType: File
    RelativeTargetName: spoolss
    ShareName: \\\\\*\\IPC$
- condition: selection
  selection:
    cs-method: GET
    cs-uri-query|contains|all:
    - com.bea.console.handles.JndiBindingHandle
    - ldap://
    - AdminServer
- condition: selection
  selection:
    cs-method: POST
    cs-uri-query: /ui/vropspluginui/rest/services/uploadova
- condition: selection
  selection:
    cs-method: POST
    cs-uri-query|contains|all:
    - logupload
    - logMetaData
    - wsgi_log_upload.py
- condition: selection
  selection:
    cs-method: POST
    cs-uri-query|contains: /analytics/telemetry/ph/api/hyper/send?
- condition: selection and not filter1 and not filter2
  filter1:
    cs-referer|contains: /root/user/remote-user/saml-user/
  filter2:
    cs-referer: null
  selection:
    cs-method: POST
    cs-uri-query|contains: /api/v2.0/user/remoteserver.saml
- condition: all of selection*
  selection1:
    cs-uri-query|contains:
    - /dana-na/auth/
    - /dana-ws/
    - /dana-cached/
  selection2:
    cs-uri-query|contains:
    - ?id=
    - ?token=
    - Secid_canceltoken.cgi
    - CGI::param
    - meeting
    - smb
    - namedusers
    - metric
- condition: selection
  selection:
    CommandLine|contains:
    - certutil
    - cmd /c
    - cmd /k
    - cscript
    - curl
    - ipconfig
    - powershell
    - pwsh
    - regsvr32
    - rundll32
    - whoami
    - wscript
    ParentImage|endswith: \Atlassian\Confluence\jre\bin\java.exe
- condition: selection_main and (selection_exploit_1 or all of selection_exploit_2_*)
  selection_exploit_1:
    cs-uri-query|contains|all:
    - /pages/createpage-entervariables.action
    - SpaceKey=x
  selection_exploit_2_keyword:
  - u0027
  selection_exploit_2_uri:
    cs-uri-query|contains: /doenterpagevariables.action
  selection_main:
    cs-method: POST
    cs-username: anonymous
    sc-status: 200
- condition: selection
  selection:
    cs-uri-query|contains: /manager/files?path=etc/lists/../../../../..
- condition: selection and not filter
  filter:
    Image|endswith:
    - wermgr.exe
    - WerFault.exe
  selection:
    ParentImage|endswith: \UMWorkerProcess.exe
- condition: selection or keywords
  keywords:
    '|all':
    - POST
    - 200
    - /ecp/DDI/DDIService.svc/SetObject
    - schema=Reset
    - VirtualDirectory
    - $
  selection:
    cs-method: POST
    cs-uri-query|contains|all:
    - schema=Reset
    - VirtualDirectory
    cs-uri-stem: /ecp/DDI/DDIService.svc/SetObject
    cs-username|endswith: $
    sc-status: 200
- condition: 1 of selection_*
  selection_request1:
    cs-uri-query|contains|all:
    - /solr/
    - /debug/dump?
    - param=ContentStream
    sc-status: 200
  selection_request2:
    cs-method: GET
    cs-uri-query|contains|all:
    - /solr/
    - command=fetchindex
    - masterUrl=
    sc-status: 200
- condition: selection and not filter
  filter:
    sc-status: 503
  selection:
    cs-method: POST
    cs-uri-query|contains: /owa/calendar/a
- condition: selection1 or selection2
  selection1:
    cs-method: POST
    cs-uri-query|contains|all:
    - /ecp/
    - /RulesEditor/InboxRules.svc/NewObject
    sc-status: 500
  selection2:
    cs-uri-query|contains|all:
    - SecurityToken=
    - /ecp/
    sc-status: 500
- condition: selection_whoami and 1 of selection_cmd*
  selection_cmd_1:
    CommandLine|contains:
    - ./Client/Common/
    - .\Client\Common\
  selection_cmd_2:
    CommandLine|contains: C:\Windows\Temp\Serv-U.bat
  selection_whoami:
    CommandLine|contains: whoami
- condition: 1 of selection_* and not 1 of filter_main_*
  filter_main_legit:
    TargetFilename|contains: AppData\Local\Temp
    TargetFilename|endswith: \Content.inf
    TargetFilename|startswith: C:\Users\
  selection_cab:
    Image|endswith: \winword.exe
    TargetFilename|contains: \Windows\INetCache
    TargetFilename|endswith: .cab
  selection_inf:
    Image|endswith: \winword.exe
    TargetFilename|contains|all:
    - \AppData\Local\Temp\
    - '.inf'
- condition: selection and not filter
  filter:
    CommandLine|endswith:
    - \control.exe input.dll
    - \control.exe" input.dll
  selection:
    Image|endswith: \control.exe
    ParentImage|endswith:
    - \winword.exe
    - \powerpnt.exe
    - \excel.exe
- condition: selection
  selection:
    CommandLine|contains:
    - ../../../..
    - ..\..\..\..
    - ..//..//..//..
    ParentImage|endswith:
    - \winword.exe
    - \excel.exe
    - \powerpnt.exe
    - \msaccess.exe
    - \mspub.exe
    - \eqnedt32.exe
    - \visio.exe
- condition: selection
  selection:
    cs-uri-query|contains:
    - /help/admin-guide/Reports/ReportGenerate.jsp
    - /ServletApi/../RestApi/LogonCustomization
    - /ServletApi/../RestAPI/Connection
- condition: selection
  selection:
    cs-uri-query|contains:
    - /help/admin-guide/Reports/ReportGenerate.jsp
    - /RestAPI/LogonCustomization
    - /RestAPI/Connection
- condition: all of selection_*
  selection_img:
  - Image|endswith:
    - \cmd.exe
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - Cmd.Exe
    - PowerShell.EXE
    - pwsh.dll
  selection_parent:
    IntegrityLevel: System
    ParentImage|endswith: \elevation_service.exe
- condition: selection
  selection:
    cs-uri-query|contains:
    - /cgi-bin/.%2e/
    - /icons/.%2e/
    - /cgi-bin/.%%32%65/
    - /icons/.%%32%65/
    - /cgi-bin/.%%%25%33
    - /icons/.%%%25%33
    sc-status:
    - 200
    - 301
- condition: selection
  selection:
    cs-method: POST
    cs-uri-query|contains: /sitecore/shell/ClientBin/Reporting/Report.ashx
    sc-status: 200
- condition: selection
  selection:
    EventID:
    - 35
    - 36
    - 37
    - 38
    Provider_Name: Microsoft-Windows-Kerberos-Key-Distribution-Center
- condition: selection and not filter
  filter:
    NewTargetUserName|contains: $
  selection:
    EventID: 4781
    OldTargetUserName|contains: $
- condition: all of selection*
  selection_plugins:
    cs-uri-query|contains:
    - /public/plugins/live
    - /public/plugins/icon
    - /public/plugins/loki
    - /public/plugins/text
    - /public/plugins/logs
    - /public/plugins/news
    - /public/plugins/stat
    - /public/plugins/mssql
    - /public/plugins/mixed
    - /public/plugins/mysql
    - /public/plugins/tempo
    - /public/plugins/graph
    - /public/plugins/gauge
    - /public/plugins/table
    - /public/plugins/debug
    - /public/plugins/zipkin
    - /public/plugins/jaeger
    - /public/plugins/geomap
    - /public/plugins/canvas
    - /public/plugins/grafana
    - /public/plugins/welcome
    - /public/plugins/xychart
    - /public/plugins/heatmap
    - /public/plugins/postgres
    - /public/plugins/testdata
    - /public/plugins/opentsdb
    - /public/plugins/influxdb
    - /public/plugins/barchart
    - /public/plugins/annolist
    - /public/plugins/bargauge
    - /public/plugins/graphite
    - /public/plugins/dashlist
    - /public/plugins/piechart
    - /public/plugins/dashboard
    - /public/plugins/nodeGraph
    - /public/plugins/alertlist
    - /public/plugins/histogram
    - /public/plugins/table-old
    - /public/plugins/pluginlist
    - /public/plugins/timeseries
    - /public/plugins/cloudwatch
    - /public/plugins/prometheus
    - /public/plugins/stackdriver
    - /public/plugins/alertGroups
    - /public/plugins/alertmanager
    - /public/plugins/elasticsearch
    - /public/plugins/gettingstarted
    - /public/plugins/state-timeline
    - /public/plugins/status-history
    - /public/plugins/grafana-clock-panel
    - /public/plugins/grafana-simple-json-datasource
    - /public/plugins/grafana-azure-monitor-datasource
  selection_traversal:
    cs-uri-query|contains: /../../../../../../../
    sc-status: 200
- condition: keywords and not filter
  filter:
  - w.nessus.org/nessus
  - /nessus}
  keywords:
  - ${jndi:ldap:/
  - ${jndi:rmi:/
  - ${jndi:ldaps:/
  - ${jndi:dns:/
  - '/$%7bjndi:'
  - '%24%7bjndi:'
  - '$%7Bjndi:'
  - '%2524%257Bjndi'
  - '%2F%252524%25257Bjndi%3A'
  - '${jndi:${lower:'
  - ${::-j}${
  - ${jndi:nis
  - ${jndi:nds
  - ${jndi:corba
  - ${jndi:iiop
  - 'Reference Class Name: foo'
  - ${${env:BARFOO:-j}
  - ${::-l}${::-d}${::-a}${::-p}
  - ${base64:JHtqbmRp
  - ${${env:ENV_NAME:-j}ndi${env:ENV_NAME:-:}$
  - '${${lower:j}ndi:'
  - '${${upper:j}ndi:'
  - '${${::-j}${::-n}${::-d}${::-i}:'
- condition: 1 of selection*
  selection1:
    cs-user-agent|contains:
    - ${jndi:ldap:/
    - ${jndi:rmi:/
    - ${jndi:ldaps:/
    - ${jndi:dns:/
    - '/$%7bjndi:'
    - '%24%7bjndi:'
    - '$%7Bjndi:'
    - '%2524%257Bjndi'
    - '%2F%252524%25257Bjndi%3A'
    - '${jndi:${lower:'
    - ${::-j}${
    - ${jndi:nis
    - ${jndi:nds
    - ${jndi:corba
    - ${jndi:iiop
    - 'Reference Class Name: foo'
    - ${${env:BARFOO:-j}
    - ${::-l}${::-d}${::-a}${::-p}
    - ${base64:JHtqbmRp
    - ${${env:ENV_NAME:-j}ndi${env:ENV_NAME:-:}$
    - '${${lower:j}ndi:'
    - '${${upper:j}ndi:'
    - '${${::-j}${::-n}${::-d}${::-i}:'
  selection3:
    cs-uri-query|contains:
    - ${jndi:ldap:/
    - ${jndi:rmi:/
    - ${jndi:ldaps:/
    - ${jndi:dns:/
    - '/$%7bjndi:'
    - '%24%7bjndi:'
    - '$%7Bjndi:'
    - '%2524%257Bjndi'
    - '%2F%252524%25257Bjndi%3A'
    - '${jndi:${lower:'
    - ${::-j}${
    - ${jndi:nis
    - ${jndi:nds
    - ${jndi:corba
    - ${jndi:iiop
    - 'Reference Class Name: foo'
    - ${${env:BARFOO:-j}
    - ${::-l}${::-d}${::-a}${::-p}
    - ${base64:JHtqbmRp
    - ${${env:ENV_NAME:-j}ndi${env:ENV_NAME:-:}$
    - '${${lower:j}ndi:'
    - '${${upper:j}ndi:'
    - '${${::-j}${::-n}${::-d}${::-i}:'
  selection4:
    cs-referer|contains:
    - ${jndi:ldap:/
    - ${jndi:rmi:/
    - ${jndi:ldaps:/
    - ${jndi:dns:/
    - '/$%7bjndi:'
    - '%24%7bjndi:'
    - '$%7Bjndi:'
    - '%2524%257Bjndi'
    - '%2F%252524%25257Bjndi%3A'
    - '${jndi:${lower:'
    - ${::-j}${
    - ${jndi:nis
    - ${jndi:nds
    - ${jndi:corba
    - ${jndi:iiop
    - 'Reference Class Name: foo'
    - ${${env:BARFOO:-j}
    - ${::-l}${::-d}${::-a}${::-p}
    - ${base64:JHtqbmRp
    - ${${env:ENV_NAME:-j}ndi${env:ENV_NAME:-:}$
    - '${${lower:j}ndi:'
    - '${${upper:j}ndi:'
    - '${${::-j}${::-n}${::-d}${::-i}:'
- condition: all of selection_1* or selection_poc
  selection_1:
    sc-status: 401
  selection_1_auto:
    cs-uri-query|contains: /autodiscover.json
  selection_1_uri:
    cs-uri-query|contains:
    - /powershell
    - /mapi/nspi
    - /EWS
    - X-Rps-CAT
  selection_poc:
    cs-uri-query|contains:
    - autodiscover.json?@
    - autodiscover.json%3f@
    - '%3f@foo.com'
    - Email=autodiscover/autodiscover.json
    - json?@foo.com
    sc-status: 401
- condition: selection_auto and selection_uri and selection_success
  selection_auto:
    cs-uri-query|contains: /autodiscover.json
  selection_success:
    sc-status:
    - 200
    - 301
  selection_uri:
    cs-uri-query|contains:
    - /powershell
    - /mapi/nspi
    - /EWS
    - X-Rps-CAT
- condition: selection and not filter
  filter:
    Image|startswith: C:\Windows\Installer\Razer\Installer\
  selection:
    IntegrityLevel: System
    ParentImage|endswith: \RazerInstaller.exe
- condition: selection
  selection:
    CommandLine|contains:
    - printnightmare.gentilkiwi.com
    - ' /user:gentilguest '
    - Kiwi Legit Printer
- condition: selection
  selection:
    cs-uri-query|contains: /cgi-bin/jarrewrite.sh
    cs-user-agent|contains:
    - :;
    - () {
    - /bin/bash -c
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains: ' -single '
    Image|startswith: C:\Users\Public\
  selection_2:
    CommandLine|contains:
    - del C:\Windows\System32\Taskmgr.exe
    - ;Set-Service -StartupType Disabled $
    - powershell -command "$x =[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(
    - ' do start wordpad.exe /p '
- condition: selection
  selection:
    CommandLine|contains|all:
    - vssadmin list shadows
    - log.txt
- condition: selection
  selection:
    CommandLine|contains|all:
    - 7za.exe
    - \\C$\\temp\\log.zip
- condition: selection
  selection:
    CommandLine|contains|all:
    - '-m '
    - '-net '
    - '-size '
    - '-nomutex '
    - -p \\\\
    - $
- condition: all of selection_*
  selection_query:
    CommandLine|contains:
    - sys.sysprocesses
    - master.dbo.sysdatabases
    - BACKUP DATABASE
  selection_svr:
    CommandLine|contains: ' -S localhost '
  selection_tools:
  - Image|endswith: \sqlcmd.exe
  - CommandLine|contains:
    - 'sqlcmd '
    - sqlcmd.exe
- condition: 1 of selection*
  selection1:
    CommandLine|contains:
    - =[char][byte]('0x'+
    - ' -work worker0 -path '
  selection2:
    Image|contains: \AppData\Local\Temp\
    ParentCommandLine|contains: DllHost.exe /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}
- condition: selection
  selection:
    Image|endswith:
    - \schtasks.exe
    - \wscript.exe
    - \mshta.exe
    TargetFilename|contains: \AppData\Roaming\Microsoft\
    TargetFilename|endswith:
    - .txt
    - .xml
- condition: all of selection_*
  selection_recon_cmd:
    CommandLine|contains:
    - dir
    - ipconfig /all
    - systeminfo
    - tasklist
  selection_redirect:
    CommandLine|contains: '>>%APPDATA%\Microsoft\'
    CommandLine|endswith:
    - .xml
    - .txt
    Image|endswith: \cmd.exe
    ParentImage|endswith: \wscript.exe
- condition: selection
  selection:
    cs-method: GET
    cs-uri|all:
    - /cross.php?op=
    - '&dt='
    - '&uid='
- condition: selection
  selection:
    TargetFilename:
    - C:\ProgramData\GoogleUpdate\config.dat
    - C:\ProgramData\GoogleUpdate\GoogleUpdate.exe
    - C:\ProgramData\GoogleUpdate\GoogleUpdate\tmp.bat
    - C:\ProgramData\GoogleUpdate\goopdate.dll
- condition: selection
  selection:
    CommandLine|contains: choice /t %d /d y /n >nul
- condition: selection and not 1 of filter_main_*
  filter_main_legit_paths:
  - Image|startswith:
    - C:\Program Files\Google\
    - C:\Program Files (x86)\Google\
  - Image|contains: \AppData\Local\Google\Update\
  selection:
    Image|endswith: \GoogleUpdate.exe
    ParentImage|endswith: \GoogleUpdate.exe
- condition: selection
  selection:
    c-useragent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like
      Gecko) Chrome/54.0.2840.71 Safari/537.36
    cs-host: static.tcplog.com
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains|all:
    - rundll32
    - FileProtocolHandler
    - \ProgramData\GoogleUpdate\GoogleUpdate.exe
    Provider_Name: Service Control Manager
    ServiceName: GoogleUpdate
- condition: selection
  selection:
    TargetFilename: C:\Windows\System32\drivers\MoriyaStreamWatchmen.sys
- condition: selection
  selection:
    Image|endswith: updata.exe
    TargetFilename: C:\Windows\oci.dll
- condition: selection
  selection:
    CommandLine|contains|all:
    - config
    - msdtc
    - start
    - auto
    ParentImage|endswith: \updata.exe
- condition: all of selection_typo_* or selection_ioc
  selection_ioc:
    TargetFilename|endswith: \AppData\Local\MicrosoftWindowsOutlookDataPlus.txt
  selection_typo_keyword:
    TargetFilename|contains: Microsift
  selection_typo_path:
    TargetFilename|contains:
    - \Roaming\
    - \Local\
    TargetFilename|contains|all:
    - :\Users\
    - \AppData\
- condition: selection
  selection:
    CommandLine|endswith: .exe Platypus
- condition: selection
  selection:
    cs-host: api.telegram.org
    cs-method: GET
    cs-uri|contains|all:
    - chat_id=2090761833
    - text=com/
- condition: all of selection_*
  selection_path:
    EventType: SetValue
    TargetObject|contains: \Microsoft\Windows\CurrentVersion\Run\
  selection_value:
  - TargetObject|contains: Microsift
  - Details|contains: .exe Platypus
- condition: 1 of selection*
  selection_7zip:
    CommandLine|contains|all:
    - ' -t7z '
    - C:\Programdata\pst
    - \it.zip
  selection_attrib:
    CommandLine|contains|all:
    - attrib
    - ' +h '
    - ' +s '
    - ' +r '
    - .aspx
  selection_makecab_1:
    CommandLine|contains|all:
    - inetpub\wwwroot\
    - .dmp.zip
    Image|endswith: \makecab.exe
  selection_makecab_2:
    CommandLine|contains:
    - Microsoft\Exchange Server\
    - compressionmemory
    - .gif
    Image|endswith: \makecab.exe
  selection_opera_1:
    Image|endswith: Opera_browser.exe
    ParentImage|endswith:
    - \services.exe
    - \svchost.exe
  selection_opera_2:
    Image|endswith: Users\Public\opera\Opera_browser.exe
  selection_other:
    CommandLine|contains:
    - Windows\Temp\xx.bat
    - Windows\WwanSvcdcs
    - Windows\Temp\cw.exe
  selection_rundll32:
    CommandLine|contains|all:
    - \comsvcs.dll
    - Minidump
    - 'full '
    - \inetpub\wwwroot
  selection_vsperfmon:
  - Image|contains: \ProgramData\VSPerfMon\
  - CommandLine|contains|all:
    - schtasks
    - VSPerfMon
  selection_vssadmin:
    CommandLine|contains|all:
    - vssadmin list shadows
    - Temp\__output
- condition: 1 of selection*
  selection1:
    cs-method: POST
    cs-uri-query|contains: /owa/auth/Current/themes/resources/
  selection2:
    cs-method: POST
    cs-uri-query|contains: /owa/auth/Current/
    cs-user-agent:
    - DuckDuckBot/1.0;+(+http://duckduckgo.com/duckduckbot.html)
    - facebookexternalhit/1.1+(+http://www.facebook.com/externalhit_uatext.php)
    - Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)
    - Mozilla/5.0+(compatible;+Bingbot/2.0;++http://www.bing.com/bingbot.htm)
    - Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html
    - Mozilla/5.0+(compatible;+Konqueror/3.5;+Linux)+KHTML/3.5.5+(like+Gecko)+(Exabot-Thumbnails)
    - Mozilla/5.0+(compatible;+Yahoo!+Slurp;+http://help.yahoo.com/help/us/ysearch/slurp)
    - Mozilla/5.0+(compatible;+YandexBot/3.0;++http://yandex.com/bots)
    - Mozilla/5.0+(X11;+Linux+x86_64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/51.0.2704.103+Safari/537.36
  selection3:
    cs-method: POST
    cs-uri-query|contains: /ecp/
    cs-user-agent:
    - ExchangeServicesClient/0.0.0.0
    - python-requests/2.19.1
    - python-requests/2.25.1
  selection4:
    cs-method: POST
    cs-uri-query|contains:
    - /aspnet_client/
    - /owa/
    cs-user-agent:
    - antSword/v2.1
    - Googlebot/2.1+(+http://www.googlebot.com/bot.html)
    - Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)
  selection5:
    cs-method: POST
    cs-uri-query|contains:
    - /owa/auth/Current/
    - /ecp/default.flt
    - /ecp/main.css
  selection6:
    cs-method: POST
    cs-uri-query|contains|all:
    - /ecp/
    - .js
- condition: 1 of selection*
  selection1:
    CommandLine|contains:
    - C:\Windows\cert.exe
    - del /q /f c:\kworking\agent.crt
    - Kaseya VSA Agent Hot-fix
    - \AppData\Local\Temp\MsMpEng.exe
    - rmdir /s /q %SystemDrive%\inetpub\logs
    - del /s /q /f %SystemDrive%\\*.log
    - c:\kworking1\agent.exe
    - c:\kworking1\agent.crt
  selection2:
    Image:
    - C:\Windows\MsMpEng.exe
    - C:\Windows\cert.exe
    - C:\kworking\agent.exe
    - C:\kworking1\agent.exe
  selection3:
    CommandLine|contains|all:
    - del /s /q /f
    - WebPages\Errors\webErrorLog.txt
- condition: selection
  selection:
    ImageLoaded|endswith: \clfsw32.dll
    Image|endswith: \svchost.exe
- condition: selection or all of registry_*
  registry_image:
    CommandLine|contains: reg add
    Image|contains:
    - windows\system32\filepath2
    - windows\system32\ime
  registry_key:
    CommandLine|contains:
    - HKEY_LOCAL_MACHINE\software\classes\clsid\{7c857801-7381-11cf-884d-00aa004b2e24}\inprocserver32
    - HKEY_LOCAL_MACHINE\software\classes\clsid\{cf4cc405-e2c5-4ddd-b3ce-5e7582d8c9fa}\inprocserver32
  selection:
    Image|contains:
    - windows\system32\Physmem.sys
    - Windows\system32\ime\SHARED\WimBootConfigurations.ini
    - Windows\system32\ime\IMEJP\WimBootConfigurations.ini
    - Windows\system32\ime\IMETC\WimBootConfigurations.ini
- condition: 1 of selection*
  selection1:
    cs-uri-query|contains|all:
    - ?dwn=
    - '&fn='
    - .html?
  selection2:
    cs-uri-query|contains|all:
    - '&dwn='
    - ?fn=
    - .html?
- condition: selection
  selection:
    Image|endswith:
    - \cmd.exe
    - \cscript.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \schtasks.exe
    - \wmic.exe
    - \wscript.exe
    - \wsl.exe
    ParentImage|endswith: \Windows\System32\mqsvc.exe
- condition: selection
  selection:
    cs-method: POST
    cs-uri-query|contains:
    - /OA_HTML/BneViewerXMLService?bne:uueupload=TRUE
    - /OA_HTML/BneUploaderService?bne:uueupload=TRUE
    - /OA_HTML/BneDownloadService?bne:uueupload=TRUE
    - /OA_HTML/BneOfflineLOVService?bne:uueupload=TRUE
- condition: selection
  selection:
    ParentCommandLine|contains: -k RPCSS
    ParentImage: C:\Windows\System32\svchost.exe
- condition: selection_servlet or selection_shell
  selection_servlet:
    cs-method: POST
    cs-uri-query|contains: /service/extension/backup/mboximport\?
    cs-uri-query|contains|all:
    - account-name
    - ow
    - no-switch
    - append
    sc-status:
    - 401
    - 200
  selection_shell:
    cs-uri-query|contains: /zimbraAdmin/
    cs-uri-query|endswith: .jsp
    sc-status|contains: '200'
- condition: all of selection_* and not 1 of filter_*
  filter_bat:
    CommandLine|contains:
    - ' /c '
    - ' /k '
    - ' /r '
  filter_null:
    CommandLine: null
  selection_img:
  - Image|endswith: \cmd.exe
  - OriginalFileName: Cmd.Exe
  selection_parent:
    ParentImage|endswith: \7zFM.exe
- condition: selection
  selection:
    cs-uri-query|contains: /SAAS/t/_/;/
- condition: selection
  selection:
    cs-method: POST
    cs-uri-query|contains: /SAAS/jersey/manager/api/migrate/tenant
- condition: selection
  selection:
    cs-uri-query|contains: ?doAs=`
- condition: selection
  selection:
    cs-uri-query|contains|all:
    - /rest/api/latest/projects/
    - prefix=
    - '%00--exec'
- condition: selection and not filter
  filter:
  - Image:
    - C:\Windows\Sysmon.exe
    - C:\Windows\Sysmon64.exe
    - C:\Windows\System32\conhost.exe
    - wevtutil.exe
    - C:\WINDOWS\system32\wevtutil.exe
    - C:\Windows\System32\WerFault.exe
  - Image|endswith: \AppData\Local\Temp\Sysmon.exe
  selection:
    ParentImage|endswith:
    - \Sysmon.exe
    - \Sysmon64.exe
- condition: selection
  selection:
    cs-method: POST
    cs-uri-query|contains:
    - login=$(
    - base64
    - subprocess
    - socket
    - ${IFS}
    - cHl0aG9u
    - B5dGhvb
    - weXRob2
    cs-uri-query|contains|all:
    - /login/index.php
    - login=
- condition: selection
  selection:
    cs-method: GET
    cs-uri-query|contains:
    - '| base64 -d | /bin/bash`'
    - '%7C%20base64%20-d%20%7C%20%2Fbin%2Fbash%60'
    - '`whoami'
    - powershell
    - cmd
    - wget
    cs-uri-query|contains|all:
    - /remote_agent.php
    - action=polldata
    - poller_id=
- condition: selection and not filter
  filter:
    cs-user-agent:
    - ClientInfo
    - Microsoft WinRM Client
    - Exchange BackEnd Probes
  selection:
    cs-method: POST
    cs-uri-query|contains:
    - '@'
    - '%40'
    cs-uri-query|contains|all:
    - /owa/
    - /powershell
    sc-status: 200
- condition: selection
  selection:
    cs-method: POST
    cs-uri-query|contains|all:
    - /owa/mastermailbox
    - /powershell
    cs-user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
      like Gecko) Chrome/105.0.5195.54 Safari/537.36
    sc-status: 200
- condition: selection
  selection:
    SourceImage|endswith:
    - \wabmig.exe
    - \wab.exe
    - \ImagingDevices.exe
    TargetImage|endswith: \rundll32.exe
- condition: 1 of selection*
  selection1:
    Image|endswith: \policydefinitions\postgresql.exe
  selection2:
  - CommandLine|contains:
    - CSIDL_SYSTEM_DRIVE\temp\sys.tmp
    - ' 1> \\\\127.0.0.1\ADMIN$\__16'
  - CommandLine|contains|all:
    - 'powershell -c '
    - '\comsvcs.dll MiniDump '
    - \winupd.log full
- condition: selection
  selection:
    CommandLine|re: \\[a-zA-Z0-9]{1,32}\.[a-zA-Z0-9]{1,6}\.[ "']{1}
- condition: selection
  selection:
    CommandLine|contains|all:
    - schtasks
    - create
    - wscript
    - ' /e:vbscript'
- condition: all of selection*
  selection_base:
    CommandLine|contains|all:
    - -exec bypass -w 1 -enc
    - UwB0AGEAcgB0AC0ASgBvAGIAIAAtAFMAYwByAGkAcAB0AEIAbABvAGMAawAgAHsAKABzAGEAcABzACAAKAAiAHAA
- condition: keywords
  keywords:
  - Failed to generate curve25519 keys
- condition: selection
  selection:
    EventType: SetValue
    TargetObject|contains:
    - \Tasks\
    - \Notes\
    TargetObject|contains|all:
    - \SOFTWARE\Microsoft\Office\
    - \Outlook\
- condition: selection
  selection:
    AccessList|contains: '%%4416'
    EventID:
    - 4656
    - 4663
    ObjectName|contains|all:
    - \REGISTRY\MACHINE\SYSTEM
    - Services\
    ObjectName|endswith:
    - WebClient\NetworkProvider
    - LanmanWorkstation\NetworkProvider
    ProcessName|endswith: \OUTLOOK.EXE
- condition: selection and not 1 of filter_main_*
  filter_main_local_ips:
    ServerAddress|startswith:
    - '10.'
    - 192.168.
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - '127.'
    - 169.254.
  selection:
    EventID:
    - 30803
    - 30804
    - 30806
- condition: selection
  selection:
    cs-method: GET
    cs-uri-query|contains|all:
    - /api/index.php/v1/
    - public=true
- condition: all of selection_*
  selection_payload:
    cs-uri-query|contains:
    - +--
    - +AS+
    - +OR+
    - FROM
    - ORDER+BY
    - SELECT
    - sleep%28
    - substring%28
    - UNION
    - WHERE
  selection_url:
    cs-method: GET
    cs-uri-query|contains:
    - PropertyIsLike
    - strEndsWith
    - strStartsWith
    - FeatureId
    - jsonArrayContains
    - DWithin
    cs-uri-query|contains|all:
    - /geoserver/ows
    - CQL_FILTER=
- condition: selection
  selection:
    cs-method: GET
    cs-uri-query|contains:
    - $(
    - '%24%28'
    cs-uri-query|contains|all:
    - /forms/doLogin
    - login_username
    - password
- condition: 1 of selection_*
  selection_compiled_asp:
    CreationUtcTime|startswith:
    - '2023-03- '
    - '2023-04- '
    - '2023-05- '
    - '2023-06- '
    TargetFilename|contains|all:
    - \Windows\Microsoft.net\Framework64\v
    - \Temporary ASP.NET Files\
    - App_Web_
    TargetFilename|endswith: .dll
  selection_generic:
    TargetFilename|contains:
    - \MOVEit Transfer\wwwroot\
    - \MOVEitTransfer\wwwroot\
    TargetFilename|endswith:
    - .7z
    - .bat
    - .dll
    - .exe
    - .ps1
    - .rar
    - .vbe
    - .vbs
    - .zip
  selection_known_ioc:
    TargetFilename|endswith:
    - \MOVEit Transfer\wwwroot\_human2.aspx.lnk
    - \MOVEit Transfer\wwwroot\_human2.aspx
    - \MOVEit Transfer\wwwroot\human2.aspx.lnk
    - \MOVEit Transfer\wwwroot\human2.aspx
    - \MOVEitTransfer\wwwroot\_human2.aspx.lnk
    - \MOVEitTransfer\wwwroot\_human2.aspx
    - \MOVEitTransfer\wwwroot\human2.aspx.lnk
    - \MOVEitTransfer\wwwroot\human2.aspx
- condition: selection
  selection:
    cs-method: GET
    cs-uri-stem:
    - /human2.aspx
    - /_human2.aspx
- condition: selection
  selection:
    TargetFilename|contains: \AppData\Roaming\Microsoft\Office\Recent\
    TargetFilename|endswith: \file001.url
    TargetFilename|startswith: C:\Users\
- condition: selection
  selection:
    c-uri|contains: /MSHTML_C7/
    c-uri|re: \?d=[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}
    cs-method: GET
- condition: selection
  selection:
    c-uri|re: \.(zip|asp|htm|url|xml|chm|mht|vbs|search-ms)\?d=[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}
    cs-method: GET
- condition: selection
  selection:
    c-uri|contains:
    - /ex001.url
    - /file001.search-ms
    - /file001.url
    - /file001.vbs
    - /file1.mht
    - /o2010.asp
    - /redir_obj.html
    - /RFile.asp
    - /zip_k.asp
    - /zip_k2.asp
    - /zip_k3.asp
    cs-method: GET
- condition: selection
  selection:
    c-uri|contains: /MSHTML_C7/
    cs-method: GET
- condition: selection_eid and 1 of selection_share_*
  selection_eid:
    EventID: 5140
  selection_share_name:
    ShareName|contains: \MSHTML_C7\
    ShareName|re: '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}'
  selection_share_path:
    ShareLocalPath|contains: \MSHTML_C7\
    ShareLocalPath|re: '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}'
- condition: selection
  selection:
    CommandLine|contains: -k DHCPServer
    Image|endswith: \svchost.exe
    ParentCommandLine|contains: -k DHCPServer
    ParentImage|endswith: \svchost.exe
    User|contains:
    - NETWORK SERVICE
    - NETZWERKDIENST
    - SERVIZIO DI RETE
    - SERVICIO DE RED
- condition: selection
  selection:
    TargetFilename: C:\users\public\Documents\dllhost.exe
- condition: selection
  selection:
    TargetFilename|endswith: \AppData\Roaming\newdev.dll
    TargetFilename|startswith: C:\Users\
- condition: selection
  selection:
    ImageLoaded|endswith: \AppData\Roaming\newdev.dll
    Image|endswith: \svchost.exe
- condition: selection
  selection:
    ParentImage|contains:
    - \Windows\System32\
    - \AppData\
    User|contains: ANONYMOUS
- condition: selection
  selection:
    CommandLine|contains:
    - UpdateDriverForPlugAndPlayDevicesW
    - ServiceMain
    - DiUninstallDevice
    Image|endswith: \rundll32.exe
    ParentCommandLine|contains:
    - ' -k msupdate'
    - ' -k msupdate2'
    - ' -k alg'
    ParentImage|endswith: \svchost.exe
- condition: selection
  selection:
    CommandLine|endswith:
    - ' -k msupdate'
    - ' -k msupdate2'
    - ' -k alg'
    Image|endswith: \svchost.exe
- condition: selection
  selection:
    Details|contains:
    - ANONYMOUS
    - _DomainUser_
    EventType: SetValue
    TargetObject|contains|all:
    - \SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\S-1-5-21-
    - \ProfileImagePath
- condition: selection
  selection:
    EventID: 7045
    ImagePath|contains: \Windows\System32\svchost.exe
    Provider_Name: Service Control Manager
    ServiceName:
    - Name
    - msupdate
    - msupdate2
- condition: selection
  selection:
    CommandLine|contains|all:
    - \local\temp\
    - //b /e:jscript
    - .txt
- condition: selection
  selection:
    CommandLine|contains:
    - ' /s'
    - ' -s'
    CommandLine|endswith: ' calc'
    Image|endswith: \regsvr32.exe
- condition: all of selection_*
  selection_extension:
    CommandLine|contains: .dll
  selection_paths:
    CommandLine|contains:
    - :\ProgramData\
    - :\Users\Public\
    - \AppData\Local\Temp\
    - \AppData\Roaming\
    Image|endswith: \rundll32.exe
    ParentImage|endswith:
    - \cmd.exe
    - \cscript.exe
    - \curl.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
- condition: all of selection_*
  selection_exports:
    CommandLine|endswith:
    - aslr
    - bind
    - DrawThemeIcon
    - GG10
    - GL70
    - jhbvygftr
    - kjhbhkjvydrt
    - LS88
    - Motd
    - N115
    - next
    - Nikn
    - print
    - qqqb
    - qqqq
    - RS32
    - Test
    - Time
    - Updt
    - vips
    - Wind
    - WW50
    - X555
    - XL55
    - xlAutoOpen
    - XS88
  selection_paths:
    CommandLine|contains:
    - :\ProgramData\
    - :\Users\Public\
    - \AppData\Local\Temp\
    - \AppData\Roaming\
    Image|endswith: \rundll32.exe
    ParentImage|endswith:
    - \cmd.exe
    - \cscript.exe
    - \curl.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
- condition: selection and not 1 of filter_main_*
  filter_main_extension:
    CommandLine|contains: .dll
  selection:
    CommandLine|contains:
    - :\ProgramData\
    - :\Users\Public\
    - \AppData\Local\Temp\
    - \AppData\Roaming\
    Image|endswith: \rundll32.exe
    ParentImage|endswith:
    - \cmd.exe
    - \cscript.exe
    - \curl.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \wscript.exe
- condition: all of selection_*
  selection_dll:
    CommandLine|contains: nsis_uns
  selection_export_function:
    CommandLine|contains: PrintUIEntry
  selection_rundll32:
  - OriginalFileName: RUNDLL32.EXE
  - Image|endswith: \rundll32.exe
- condition: selection
  selection:
    CommandLine|contains: '11111111'
    Image|endswith:
    - \bcdedit.exe
    - \net.exe
    - \net1.exe
    - \netsh.exe
    - \wevtutil.exe
    - \vssadmin.exe
- condition: selection
  selection:
    TargetFilename: C:\Windows\System32\Com\Comadmin.dat
- condition: selection
  selection:
    TargetFilename|endswith:
    - \jpsetup.exe
    - \jpinst.exe
- condition: selection and not 1 of filter_main_*
  filter_main_system_location:
    Image|startswith:
    - C:\Windows\System32\
    - C:\Windows\SysWOW64\
    - C:\Windows\WinSxS\
  selection:
    TargetFilename|endswith: \WerFault.exe
    TargetFilename|startswith: C:\Windows\WinSxS\
- condition: selection
  selection:
    CommandLine|re: \s[a-fA-F0-9]{64}\s[a-fA-F0-9]{16}
- condition: selection and not 1 of filter_main_*
  filter_main_cli_empty:
    CommandLine: ''
  filter_main_cli_name:
    CommandLine:
    - jpinst.exe
    - jpinst
    - jpsetup.exe
    - jpsetup
  filter_main_cli_null:
    CommandLine: null
  selection:
    Image|endswith:
    - \jpsetup.exe
    - \jpinst.exe
- condition: selection
  selection:
    Image|endswith: \WerFault.exe
    Image|startswith: C:\Windows\WinSxS\
    ParentImage|endswith: \services.exe
- condition: selection
  selection:
    TargetObject|endswith: SECURITY\Policy\Secrets\n
- condition: selection and not 1 of filter_main_*
  filter_main_wav:
  - TargetObject|endswith: .AssocFile.WAV
  - TargetObject|contains: .wav.
  selection:
    EventType: SetValue
    TargetObject|contains: \SOFTWARE\Classes\.wav\OpenWithProgIds\
- condition: selection
  selection:
    EventID: 7045
    ImagePath|endswith: \WerFault.exe
    ImagePath|startswith: C:\Windows\WinSxS\
    Provider_Name: Service Control Manager
    ServiceName|contains: WerFaultSvc
- condition: selection
  selection:
    QueryName|contains:
    - akamaicontainer.com
    - akamaitechcloudservices.com
    - azuredeploystore.com
    - azureonlinecloud.com
    - azureonlinestorage.com
    - dunamistrd.com
    - glcloudservice.com
    - journalide.org
    - msedgepackageinfo.com
    - msedgeupdate.net
    - msstorageazure.com
    - msstorageboxes.com
    - officeaddons.com
    - officestoragebox.com
    - pbxcloudeservices.com
    - pbxphonenetwork.com
    - pbxsources.com
    - qwepoi123098.com
    - sbmsa.wiki
    - sourceslabs.com
    - visualstudiofactory.com
    - zacharryblogs.com
- condition: 1 of selection_*
  selection_hashes_1:
    Hashes|contains:
    - SHA256=7986BBAEE8940DA11CE089383521AB420C443AB7B15ED42AED91FD31CE833896
    - SHA1=BF939C9C261D27EE7BB92325CC588624FCA75429
    - MD5=74BC2D0B6680FAA1A5A76B27E5479CBC
    - SHA256=11BE1803E2E307B647A8A7E02D128335C448FF741BF06BF52B332E0BBF423B03
    - SHA1=20D554A80D759C50D6537DD7097FED84DD258B3E
    - MD5=82187AD3F0C6C225E2FBA0C867280CC9
    - SHA256=F79C3B0ADB6EC7BCC8BC9AE955A1571AAED6755A28C8B17B1D7595EE86840952
    - SHA1=894E7D4FFD764BB458809C7F0643694B036EAD30
    - MD5=11BC82A9BD8297BD0823BCE5D6202082
    - SHA256=8AB3A5EAAF8C296080FADF56B265194681D7DA5DA7C02562953A4CB60E147423
    - SHA1=3B3E778B647371262120A523EB873C20BB82BEAF
    - MD5=7FAEA2B01796B80D180399040BB69835
  selection_hashes_2:
  - sha256:
    - 7986BBAEE8940DA11CE089383521AB420C443AB7B15ED42AED91FD31CE833896
    - 11BE1803E2E307B647A8A7E02D128335C448FF741BF06BF52B332E0BBF423B03
    - F79C3B0ADB6EC7BCC8BC9AE955A1571AAED6755A28C8B17B1D7595EE86840952
    - 8AB3A5EAAF8C296080FADF56B265194681D7DA5DA7C02562953A4CB60E147423
  - sha1:
    - BF939C9C261D27EE7BB92325CC588624FCA75429
    - 20D554A80D759C50D6537DD7097FED84DD258B3E
    - 894E7D4FFD764BB458809C7F0643694B036EAD30
    - 3B3E778B647371262120A523EB873C20BB82BEAF
  - md5:
    - 74BC2D0B6680FAA1A5A76B27E5479CBC
    - 82187AD3F0C6C225E2FBA0C867280CC9
    - 11BC82A9BD8297BD0823BCE5D6202082
    - 7FAEA2B01796B80D180399040BB69835
- condition: selection
  selection:
    DestinationHostname|contains:
    - akamaicontainer.com
    - akamaitechcloudservices.com
    - azuredeploystore.com
    - azureonlinecloud.com
    - azureonlinestorage.com
    - dunamistrd.com
    - glcloudservice.com
    - journalide.org
    - msedgepackageinfo.com
    - msstorageazure.com
    - msstorageboxes.com
    - officeaddons.com
    - officestoragebox.com
    - pbxcloudeservices.com
    - pbxphonenetwork.com
    - pbxsources.com
    - qwepoi123098.com
    - sbmsa.wiki
    - sourceslabs.com
    - visualstudiofactory.com
    - zacharryblogs.com
    Image|endswith: \3CXDesktopApp.exe
- condition: all of selection_pe_* or 1 of selection_hashes_*
  selection_hashes_1:
    Hashes|contains:
    - SHA256=DDE03348075512796241389DFEA5560C20A3D2A2EAC95C894E7BBED5E85A0ACC
    - SHA256=54004DFAA48CA5FA91E3304FB99559A2395301C570026450882D6AAD89132A02
    - SHA256=D45674F941BE3CCA2FBC1AF42778043CC18CD86D95A2ECB9E6F0E212ED4C74AE
    - SHA1=480DC408EF50BE69EBCF84B95750F7E93A8A1859
    - SHA1=3B43A5D8B83C637D00D769660D01333E88F5A187
    - SHA1=6285FFB5F98D35CD98E78D48B63A05AF6E4E4DEA
    - MD5=BB915073385DD16A846DFA318AFA3C19
    - MD5=08D79E1FFFA244CC0DC61F7D2036ACA9
    - MD5=4965EDF659753E3C05D800C6C8A23A7A
    - SHA256=FAD482DED2E25CE9E1DD3D3ECC3227AF714BDFBBDE04347DBC1B21D6A3670405
    - SHA256=5D99EFA36F34AA6B43CD81E77544961C5C8D692C96059FEF92C2DF2624550734
    - SHA256=A60A61BF844BC181D4540C9FAC53203250A982E7C3AD6153869F01E19CC36203
    - SHA1=E272715737B51C01DC2BED0F0AEE2BF6FEEF25F1
    - SHA1=8433A94AEDB6380AC8D4610AF643FB0E5220C5CB
    - SHA1=413D9CBFCBF8D1E8304EAB0AA5484F5EEC5185F5
    - MD5=9833A4779B69B38E3E51F04E395674C6
    - MD5=704DB9184700481A56E5100FB56496CE
    - MD5=8EE6802F085F7A9DF7E0303E65722DC0
    - SHA256=AA124A4B4DF12B34E74EE7F6C683B2EBEC4CE9A8EDCF9BE345823B4FDCF5D868
    - SHA256=59E1EDF4D82FAE4978E97512B0331B7EB21DD4B838B850BA46794D9C7A2C0983
    - SHA1=BEA77D1E59CF18DCE22AD9A2FAD52948FD7A9EFA
    - SHA1=BFECB8CE89A312D2EF4AFC64A63847AE11C6F69E
    - MD5=F3D4144860CA10BA60F7EF4D176CC736
    - MD5=0EEB1C0133EB4D571178B2D9D14CE3E9
  selection_hashes_2:
  - sha256:
    - DDE03348075512796241389DFEA5560C20A3D2A2EAC95C894E7BBED5E85A0ACC
    - 54004DFAA48CA5FA91E3304FB99559A2395301C570026450882D6AAD89132A02
    - D45674F941BE3CCA2FBC1AF42778043CC18CD86D95A2ECB9E6F0E212ED4C74AE
    - FAD482DED2E25CE9E1DD3D3ECC3227AF714BDFBBDE04347DBC1B21D6A3670405
    - 5D99EFA36F34AA6B43CD81E77544961C5C8D692C96059FEF92C2DF2624550734
    - A60A61BF844BC181D4540C9FAC53203250A982E7C3AD6153869F01E19CC36203
    - AA124A4B4DF12B34E74EE7F6C683B2EBEC4CE9A8EDCF9BE345823B4FDCF5D868
    - 59E1EDF4D82FAE4978E97512B0331B7EB21DD4B838B850BA46794D9C7A2C0983
  - sha1:
    - 480DC408EF50BE69EBCF84B95750F7E93A8A1859
    - 3B43A5D8B83C637D00D769660D01333E88F5A187
    - 6285FFB5F98D35CD98E78D48B63A05AF6E4E4DEA
    - E272715737B51C01DC2BED0F0AEE2BF6FEEF25F1
    - 8433A94AEDB6380AC8D4610AF643FB0E5220C5CB
    - 413D9CBFCBF8D1E8304EAB0AA5484F5EEC5185F5
    - BEA77D1E59CF18DCE22AD9A2FAD52948FD7A9EFA
    - BFECB8CE89A312D2EF4AFC64A63847AE11C6F69E
  - md5:
    - BB915073385DD16A846DFA318AFA3C19
    - 08D79E1FFFA244CC0DC61F7D2036ACA9
    - 4965EDF659753E3C05D800C6C8A23A7A
    - 9833A4779B69B38E3E51F04E395674C6
    - 704DB9184700481A56E5100FB56496CE
    - 8EE6802F085F7A9DF7E0303E65722DC0
    - F3D4144860CA10BA60F7EF4D176CC736
    - 0EEB1C0133EB4D571178B2D9D14CE3E9
  selection_pe_1:
  - OriginalFileName: 3CXDesktopApp.exe
  - Image|endswith: \3CXDesktopApp.exe
  - Product: 3CX Desktop App
  selection_pe_2:
    FileVersion|contains: 18.12.
- condition: selection
  selection:
    Image|endswith:
    - \cmd.exe
    - \cscript.exe
    - \mshta.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \wscript.exe
    ParentImage|endswith: \3CXDesktopApp.exe
- condition: selection
  selection:
    CommandLine|contains|all:
    - --update
    - http
    - /electron/update/win32/18.12
    Image|endswith: \3CXDesktopApp\app\update.exe
- condition: selection
  selection:
    cs-host|contains:
    - akamaicontainer.com
    - akamaitechcloudservices.com
    - azuredeploystore.com
    - azureonlinecloud.com
    - azureonlinestorage.com
    - dunamistrd.com
    - glcloudservice.com
    - journalide.org
    - msedgepackageinfo.com
    - msstorageazure.com
    - msstorageboxes.com
    - officeaddons.com
    - officestoragebox.com
    - pbxcloudeservices.com
    - pbxphonenetwork.com
    - pbxsources.com
    - qwepoi123098.com
    - sbmsa.wiki
    - sourceslabs.com
    - visualstudiofactory.com
    - zacharryblogs.com
- condition: selection
  selection:
    c-uri|contains|all:
    - IconStorages/images/main/icon
    - .ico
- condition: selection
  selection:
    query:
    - addatamarket.net
    - ans7tv.net
    - anstv.net
    - backuprabbit.com
    - businessvideonews.com
    - cloudsponcer.com
    - datamarketplace.net
    - growthtransport.com
    - mobilegamerstats.com
    - snoweeanalytics.com
    - tagclick-cdn.com
    - topographyupdates.com
    - unlimitedteacup.com
    - virtuallaughing.com
    - web-trackers.com
- condition: selection
  selection:
    cs-host|contains:
    - addatamarket.net
    - ans7tv.net
    - anstv.net
    - backuprabbit.com
    - businessvideonews.com
    - cloudsponcer.com
    - datamarketplace.net
    - growthtransport.com
    - mobilegamerstats.com
    - snoweeanalytics.com
    - tagclick-cdn.com
    - topographyupdates.com
    - unlimitedteacup.com
    - virtuallaughing.com
    - web-trackers.com
- condition: selection
  selection:
  - TargetFilename|endswith: _64refl.ps1
  - TargetFilename: host_ip.ps1
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - $env:APPDATA
    - function MainPayload
    - ::WriteAllBytes
    - wscript.exe
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - IO.Compression.DeflateStream
    - IO.MemoryStream
    - ::FromBase64String
    - GetDelegateForFunctionPointer
    - .Invoke()
    - GlobalAssemblyCache
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains|all:
    - -noni -nop -exe bypass -f \\\\
    - ADMIN$
  selection_2:
    CommandLine|contains|all:
    - -ex bypass -noprof -nolog -nonint -f
    - C:\Windows\Temp\
- condition: selection_parent and (all of selection_special_child_powershell_* or
    all of selection_special_child_lsass_* or 1 of selection_child_*)
  selection_child_curl:
    CommandLine|contains: http
    Image|endswith: \curl.exe
  selection_child_localgroup:
    CommandLine|contains|all:
    - localgroup Administrators
    - /add
  selection_child_net:
    CommandLine|contains: net
    CommandLine|contains|all:
    - user
    - /add
  selection_child_reg:
  - CommandLine|contains|all:
    - reg add
    - DisableAntiSpyware
    - \Microsoft\Windows Defender
  - CommandLine|contains|all:
    - reg add
    - DisableRestrictedAdmin
    - CurrentControlSet\Control\Lsa
  selection_child_script:
    CommandLine|contains:
    - E:jscript
    - e:vbscript
  selection_child_vssadmin:
    CommandLine|contains|all:
    - vssadmin
    - delete
    - shadows
  selection_child_wbadmin:
    CommandLine|contains|all:
    - wbadmin
    - delete
    - catalog
  selection_child_wget:
    CommandLine|contains: http
    Image|endswith: \wget.exe
  selection_child_wmic_1:
    CommandLine|contains|all:
    - wmic
    - process call create
  selection_child_wmic_2:
    CommandLine|contains|all:
    - wmic
    - delete
    - shadowcopy
  selection_parent:
    ParentImage|contains|all:
    - aspera
    - \ruby
  selection_special_child_lsass_1:
    CommandLine|contains: lsass
  selection_special_child_lsass_2:
    CommandLine|contains:
    - procdump
    - tasklist
    - findstr
  selection_special_child_powershell_cli:
  - CommandLine|contains:
    - ' echo '
    - -dumpmode
    - -ssh
    - .dmp
    - add-MpPreference
    - adscredentials
    - bitsadmin
    - certutil
    - csvhost.exe
    - DownloadFile
    - DownloadString
    - dsquery
    - ekern.exe
    - FromBase64String
    - 'iex '
    - iex(
    - Invoke-Expression
    - Invoke-WebRequest
    - localgroup administrators
    - net group
    - net user
    - o365accountconfiguration
    - query session
    - samaccountname=
    - set-MpPreference
    - svhost.exe
    - System.IO.Compression
    - System.IO.MemoryStream
    - usoprivate
    - usoshared
    - whoami
  - CommandLine|re: "[-/\u2013][Ee^]{1,2}[ncodema^]*\\s[A-Za-z0-9+/=]{15,}"
  selection_special_child_powershell_img:
    Image|endswith:
    - \powershell.exe
    - \powershell_ise.exe
- condition: selection
  selection:
    Image|endswith: \repadmin.exe
    ParentImage|endswith: \ws_tomcatservice.exe
- condition: all of selection_parent_* and (all of selection_special_child_powershell_*
    or all of selection_special_child_lsass_* or 1 of selection_child_*) and not filter_main
  filter_main:
    CommandLine|contains|all:
    - download.microsoft.com
    - manageengine.com
    - msiexec
  selection_child_curl:
    CommandLine|contains: http
    Image|endswith: \curl.exe
  selection_child_localgroup:
    CommandLine|contains|all:
    - localgroup Administrators
    - /add
  selection_child_net:
    CommandLine|contains: net
    CommandLine|contains|all:
    - user
    - /add
  selection_child_reg:
  - CommandLine|contains|all:
    - reg add
    - DisableAntiSpyware
    - \Microsoft\Windows Defender
  - CommandLine|contains|all:
    - reg add
    - DisableRestrictedAdmin
    - CurrentControlSet\Control\Lsa
  selection_child_script:
    CommandLine|contains:
    - E:jscript
    - e:vbscript
  selection_child_vssadmin:
    CommandLine|contains|all:
    - vssadmin
    - delete
    - shadows
  selection_child_wbadmin:
    CommandLine|contains|all:
    - wbadmin
    - delete
    - catalog
  selection_child_wget:
    CommandLine|contains: http
    Image|endswith: \wget.exe
  selection_child_wmic_1:
    CommandLine|contains|all:
    - wmic
    - process call create
  selection_child_wmic_2:
    CommandLine|contains|all:
    - wmic
    - delete
    - shadowcopy
  selection_parent_image:
    ParentImage|contains: \java
  selection_parent_path:
    ParentImage|contains:
    - manageengine
    - ServiceDesk
  selection_special_child_lsass_1:
    CommandLine|contains: lsass
  selection_special_child_lsass_2:
    CommandLine|contains:
    - procdump
    - tasklist
    - findstr
  selection_special_child_powershell_cli:
  - CommandLine|contains:
    - ' echo '
    - -dumpmode
    - -ssh
    - .dmp
    - add-MpPreference
    - adscredentials
    - bitsadmin
    - certutil
    - csvhost.exe
    - DownloadFile
    - DownloadString
    - dsquery
    - ekern.exe
    - FromBase64String
    - 'iex '
    - iex(
    - Invoke-Expression
    - Invoke-WebRequest
    - localgroup administrators
    - net group
    - net user
    - o365accountconfiguration
    - query session
    - samaccountname=
    - set-MpPreference
    - svhost.exe
    - System.IO.Compression
    - System.IO.MemoryStream
    - usoprivate
    - usoshared
    - whoami
  - CommandLine|re: "[-/\u2013][Ee^]{1,2}[ncodema^]*\\s[A-Za-z0-9+/=]{15,}"
  selection_special_child_powershell_img:
    Image|endswith:
    - \powershell.exe
    - \powershell_ise.exe
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains|all:
    - copy SolidPDFCreator.dll
    - C:\Users\Public\Libraries\PhotoTvRHD\SolidPDFCreator.dll
  selection_2:
    CommandLine|contains|all:
    - 'reg '
    - \Windows\CurrentVersion\Run
    - SolidPDF
    - C:\Users\Public\Libraries\PhotoTvRHD\
- condition: 1 of selection_*
  selection_1:
    CommandLine|contains|all:
    - ' /c '
    - powershell
    - -nop -w hidden
    - Invoke-WebRequest
    - setup.msi
    - -OutFile
  selection_2:
    CommandLine|contains|all:
    - 'msiexec '
    - '/i '
    - 'setup.msi '
    - '/qn '
    - IntegratorLogin=fimaribahundq
- condition: selection
  selection:
    Image|endswith:
    - \bash.exe
    - \calc.exe
    - \certutil.exe
    - \cmd.exe
    - \csc.exe
    - \cscript.exe
    - \dllhost.exe
    - \mshta.exe
    - \msiexec.exe
    - \powershell.exe
    - \pwsh.exe
    - \regsvr32.exe
    - \rundll32.exe
    - \scriptrunner.exe
    - \wmic.exe
    - \wscript.exe
    - \wsl.exe
    ParentImage|endswith: \pc-app.exe
- condition: selection
  selection:
    TargetFilename|re: /mail/tmp/[a-zA-Z0-9]{3}[0-9]{3}\.tar\.gz
- condition: selection
  selection:
    TargetFilename|endswith:
    - /11111.tar
    - /aacore.sh
    - /appcheck.sh
    - /autoins
    - /BarracudaMailService
    - /etc/cron.daily/core_check.sh
    - /etc/cron.daily/core.sh
    - /etc/cron.hourly/aacore.sh
    - /etc/cron.hourly/appcheck.sh
    - /etc/cron.hourly/core.sh
    - /get_fs_info.pl
    - /imgdata.jpg
    - /install_att_v2.tar
    - /install_bvp74_auth.tar
    - /install_helo.tar
    - /install_reuse.tar
    - /intent_helo
    - /intent_reuse
    - /intentbas
    - /mknod
    - /mod_attachment.lua
    - /mod_content.lua
    - /mod_require_helo.lua
    - /mod_rtf
    - /mod_sender.lua
    - /mod_udp.so
    - /nfsd_stub.ko
    - /resize_reisertab
    - /resize_risertab
    - /resize2fstab
    - /rverify
    - /saslautchd
    - /sendscd
    - /snapshot.tar
    - /tmp/p
    - /tmp/p7
    - /tmp/t
    - /update_v2.sh
    - /update_v31.sh
    - /update_v35.sh
    - /update_version
- condition: selection
  selection:
    CommandLine|contains:
    - :443
    - :8080
    CommandLine|contains|all:
    - s_client
    - -quiet
    - -connect
    CommandLine|re: '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}'
    Image|endswith: /openssl
- condition: selection
  selection:
    CommandLine|contains: https://temp.sh/
    CommandLine|endswith:
    - .rar
    - .zip
    Image|endswith: /wget
- condition: selection and not 1 of filter_main_*
  filter_main_local_ips:
    CommandLine|contains:
    - https://10.
    - https://192.168.
    - https://172.16.
    - https://172.17.
    - https://172.18.
    - https://172.19.
    - https://172.20.
    - https://172.21.
    - https://172.22.
    - https://172.23.
    - https://172.24.
    - https://172.25.
    - https://172.26.
    - https://172.27.
    - https://172.28.
    - https://172.29.
    - https://172.30.
    - https://172.31.
    - https://127.
    - https://169.254.
  selection:
    CommandLine|contains: --no-check-certificate
    CommandLine|endswith: .tar
    CommandLine|re: https://[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}
    Image|endswith: /wget
- condition: selection
  selection:
    Image|endswith:
    - /BarracudaMailService
    - /resize2fstab
    - /resize_reisertab
- condition: selection and not valid_admin
  selection:
    Status: Sucess
    properties.message:
    - Add user
    - Delete user
  valid_admin:
    Initiatied.By: '%ApprovedUserUpn%'
- condition: selection
  selection:
    Date: '%ClosingTime%'
    Location: '%LegitCountries%'
    Status: Sucess
- condition: selection
  selection:
    DeviceDetail.isCompliant: 'false'
    DeviceInfo: '%UnApprovedDevice%'
    IPaddress: '%UnApprovedIp%'
    Location: '%LegitCountries%'
    Status:
    - Sucess
    - failure
    properties.message|contains: Add memmber to role completed (PIM aciviation)
- condition: selection
  selection:
    DeviceInfo: '%UnApprovedDevice%'
    IPaddress: '%UnApprovedIp%'
    Location: '%UnLegitCountries%'
    Status: failure
- condition: selection
  selection:
    Date: '%ClosingTime%'
    Initiatied.By: '%ApprovedUserUpn%'
    Location: '%LegitCountries%'
    Status: Sucess
- condition: selection and not filter_main
  filter_main:
    PasswordLastSet: '-'
  selection:
    EventID: 4742
    SubjectUserName: ANONYMOUS LOGON
    TargetUserName: '%DC-MACHINE-NAME%'
- condition: selection and not filter
  filter:
    TargetUserName: ANONYMOUS LOGON
  selection:
    ComputerName: '%Workstations%'
    EventID:
    - 4624
    - 4625
    LogonProcessName: NtLmSsp
    LogonType: 3
    WorkstationName: '%Workstations%'
- condition: selection and not filter_main
  filter_main:
    IpAddress: '%Admins_Workstations%'
  selection:
    EventID: 5145
    RelativeTargetName|contains: \winreg
- condition: selection and not filter_main
  filter_main:
    ComputerName: '%Workstations%'
    LogonProcessName: Advapi
  selection:
    ComputerName:
    - '%ServerSystems%'
    - '%DomainControllers%'
    EventID:
    - 528
    - 529
    - 4624
    - 4625
    LogonType: 2
- condition: selection
  selection:
    CommandLine|contains|all:
    - 'echo '
    - '%userdomain%'
- condition: selection
  selection:
    ImageLoaded|endswith: .xll
    Image|endswith: \excel.exe
- condition: selection and not 1 of filter_main_*
  filter_main_local_ipv4:
    DestinationIp|startswith:
    - '10.'
    - 127.0.0.1
    - 172.16.
    - 172.17.
    - 172.18.
    - 172.19.
    - 172.20.
    - 172.21.
    - 172.22.
    - 172.23.
    - 172.24.
    - 172.25.
    - 172.26.
    - 172.27.
    - 172.28.
    - 172.29.
    - 172.30.
    - 172.31.
    - 192.168.
  filter_main_local_ipv6:
    DestinationIp|startswith:
    - ::1
    - 0:0:0:0:0:0:0:1
    - fc
    - fd
    - 'fe80:'
  selection:
    Image|endswith: \dfsvc.exe
    Initiated: 'true'
- condition: 1 of selection_*
  selection_contextinfo:
    ContextInfo|contains:
    - Get-NetFirewallRule
    - Show-NetFirewallRule
  selection_payload:
    Payload|contains:
    - Get-NetFirewallRule
    - Show-NetFirewallRule
- condition: selection
  selection:
    ScriptBlockText|contains: \Comms\Unistore\data
- condition: selection
  selection:
    ScriptBlockText|contains|all:
    - New-SmbMapping
    - -TransportType QUIC
- condition: selection
  selection:
    ScriptBlockText|re: (Get-Item|gci|Get-ChildItem).{1,64}-Path.{1,64}\\(currentcontrolset\\services|CurrentVersion\\Policies\\Explorer\\Run|CurrentVersion\\Run|CurrentVersion\\ShellServiceObjectDelayLoad|CurrentVersion\\Windows\winlogon)\\
- condition: all of selection_*
  selection_img:
  - Image|endswith: \curl.exe
  - Product: The curl executable
  selection_remote:
    CommandLine|contains:
    - ' -O'
    - --remote-name
    - --output
- condition: selection
  selection:
  - Image|endswith: \curl.exe
  - Product: The curl executable
- condition: all of selection_* and not 1 of filter_optional_*
  filter_optional_localhost:
    CommandLine|contains:
    - ://localhost
    - ://127.0.0.1
  selection_cli:
  - CommandLine|contains:
    - ' --form'
    - ' --upload-file '
    - ' --data '
    - ' --data-'
  - CommandLine|re: \s-[FTd]\s
  selection_img:
  - Image|endswith: \curl.exe
  - Product: The curl executable
- condition: all of selection_*
  selection_curl:
  - Image|endswith: \curl.exe
  - Product: The curl executable
  selection_opt:
    CommandLine|contains:
    - ' -A '
    - ' --user-agent '
- condition: selection
  selection:
    Image|endswith: \AppData\Local\Apps\2.0\
    ParentImage|endswith: \dfsvc.exe
- condition: all of selection_*
  selection_cli:
    CommandLine|contains:
    - "contrase\xF1a"
    - "has\u0142o"
    - heslo
    - parola
    - passe
    - passw
    - senha
    - senord
    - "\u5BC6\u78BC"
  selection_img:
  - Image|endswith: \findstr.exe
  - OriginalFileName: FINDSTR.EXE
- condition: all of selection_*
  selection_cli:
    CommandLine|contains: /TRANSPORT:QUIC
  selection_img:
  - Image|endswith:
    - \net.exe
    - \net1.exe
  - OriginalFileName:
    - net.exe
    - net1.exe
- condition: all of selection_*
  selection_length:
    CommandLine|re: .{1000,}
  selection_powershell:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
  - Description: Windows Powershell
  - Product: PowerShell Core 6
- condition: all of selection_*
  selection_cmdlet:
    CommandLine|contains:
    - 'Import-Module '
    - 'ipmo '
  selection_img:
  - Image|endswith:
    - \powershell.exe
    - \pwsh.exe
  - OriginalFileName:
    - PowerShell.EXE
    - pwsh.dll
- condition: selection
  selection:
    EventType: Setvalue
    TargetObject|contains: Security\Trusted Locations\Location
    TargetObject|endswith: \Path
