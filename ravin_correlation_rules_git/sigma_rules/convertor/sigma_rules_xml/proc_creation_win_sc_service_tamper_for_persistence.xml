<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Attempt Via Existing Service Tampering</title><id type="str">38879043-7e1e-47a9-8d46-6bec88e201df</id><status type="str">test</status><description type="str">Detects the modification of an existing service in order to execute an arbitrary payload when the service is started or killed as a potential method for persistence.</description><references type="list"><item type="str">https://pentestlab.blog/2020/01/22/persistence-modify-existing-service/</item></references><author type="str">Sreeman</author><date type="str">2020/09/29</date><modified type="str">2023/02/04</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1543.003</item><item type="str">attack.t1574.011</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_sc type="list"><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">sc </item><item type="str">config </item><item type="str">binpath=</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">sc </item><item type="str">failure</item><item type="str">command=</item></key></item></selection_sc><selection_reg_img type="list"><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">reg </item><item type="str">add </item><item type="str">FailureCommand</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">reg </item><item type="str">add </item><item type="str">ImagePath</item></key></item></selection_reg_img><selection_reg_ext type="dict"><key name="CommandLine|contains" type="list"><item type="str">.sh</item><item type="str">.exe</item><item type="str">.dll</item><item type="str">.bin$</item><item type="str">.bat</item><item type="str">.cmd</item><item type="str">.js</item><item type="str">.msh$</item><item type="str">.reg$</item><item type="str">.scr</item><item type="str">.ps</item><item type="str">.vb</item><item type="str">.jar</item><item type="str">.pl</item></key></selection_reg_ext><condition type="str">selection_sc or all of selection_reg_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>