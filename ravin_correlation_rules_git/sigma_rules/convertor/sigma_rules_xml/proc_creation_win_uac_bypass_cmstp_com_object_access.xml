<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">CMSTP UAC Bypass via COM Object Access</title><id type="str">4b60e6f2-bf39-47b4-b4ea-398e33cfe253</id><status type="str">stable</status><description type="str">Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65)</description><references type="list"><item type="str">https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/</item><item type="str">https://twitter.com/hFireF0X/status/897640081053364225</item><item type="str">https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf</item><item type="str">https://github.com/hfiref0x/UACME</item></references><author type="str">Nik Seetharaman, Christian Burkard (Nextron Systems)</author><date type="str">2019/07/31</date><modified type="str">2022/09/21</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.defense_evasion</item><item type="str">attack.privilege_escalation</item><item type="str">attack.t1548.002</item><item type="str">attack.t1218.003</item><item type="str">attack.g0069</item><item type="str">car.2019-04-001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="ParentImage|endswith" type="str">\DllHost.exe</key><key name="ParentCommandLine|contains" type="list"><item type="str"> /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}</item><item type="str"> /Processid:{3E000D72-A845-4CD9-BD83-80C07C3B881F}</item><item type="str"> /Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}</item><item type="str"> /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}</item><item type="str"> /Processid:{E9495B87-D950-4AB5-87A5-FF6D70BF3E90}</item></key><IntegrityLevel type="list"><item type="str">High</item><item type="str">System</item></IntegrityLevel></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Legitimate CMSTP use (unlikely in modern enterprise environments)</item></falsepositives><level type="str">high</level></root>