<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Direct Syscall of NtOpenProcess</title><id type="str">3f3f3506-1895-401b-9cc3-e86b16e630d0</id><status type="str">experimental</status><description type="str">Detects the usage of the direct syscall of NtOpenProcess which might be done from a CobaltStrike BOF.</description><references type="list"><item type="str">https://medium.com/falconforce/falconfriday-direct-system-calls-and-cobalt-strike-bofs-0xff14-741fa8e1bdd6</item></references><author type="str">Christian Burkard (Nextron Systems), Tim Shelton</author><date type="str">2021/07/28</date><modified type="str">2023/03/22</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1106</item></tags><logsource type="dict"><category type="str">process_access</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="CallTrace|startswith" type="str">UNKNOWN</key></selection><falsepositive1 type="dict"><TargetImage type="str">C:\Program Files\Cylance\Desktop\CylanceUI.exe</TargetImage><SourceImage type="str">C:\Windows\Explorer.EXE</SourceImage></falsepositive1><falsepositive2 type="dict"><TargetImage type="str">C:\Program Files (x86)\Microsoft\EdgeUpdate\MicrosoftEdgeUpdate.exe</TargetImage><key name="SourceImage|startswith" type="str">C:\Program Files (x86)\Microsoft\Temp\</key><key name="SourceImage|endswith" type="str">\MicrosoftEdgeUpdate.exe</key></falsepositive2><falsepositive3 type="dict"><key name="TargetImage|endswith" type="str">vcredist_x64.exe</key><key name="SourceImage|endswith" type="str">vcredist_x64.exe</key></falsepositive3><falsepositive4 type="dict"><TargetImage type="str">C:\Windows\system32\systeminfo.exe</TargetImage><key name="SourceImage|endswith" type="str">setup64.exe</key></falsepositive4><falsepositive5 type="dict"><key name="TargetImage|endswith" type="str">AmazonSSMAgentSetup.exe</key><key name="SourceImage|endswith" type="str">AmazonSSMAgentSetup.exe</key></falsepositive5><falsepositive6 type="dict"><key name="TargetImage|endswith" type="str">C:\Program Files\Mozilla Firefox\firefox.exe</key><key name="SourceImage|endswith" type="str">C:\Program Files\Mozilla Firefox\firefox.exe</key></falsepositive6><falsepositive7 type="dict"><key name="TargetImage|endswith" type="str">\AppData\Local\Programs\Microsoft VS Code\Code.exe</key><key name="SourceImage|endswith" type="str">\AppData\Local\Programs\Microsoft VS Code\Code.exe</key></falsepositive7><falsepositive8 type="dict"><key name="TargetImage|endswith" type="str">C:\Program Files\Google\Chrome\Application\chrome.exe</key><key name="SourceImage|endswith" type="str">C:\Program Files\Google\Chrome\Application\chrome.exe</key></falsepositive8><falsepositive9 type="dict"><key name="TargetImage|endswith" type="str">C:\Program Files (x86)\Google\Update\GoogleUpdate.exe</key><key name="SourceImage|endswith" type="str">C:\Program Files (x86)\Google\Update\GoogleUpdate.exe</key></falsepositive9><falsepositive10 type="dict"><key name="TargetImage|endswith" type="str">\AppData\Local\Microsoft\Teams\current\Teams.exe</key><key name="SourceImage|endswith" type="str">\AppData\Local\Microsoft\Teams\current\Teams.exe</key></falsepositive10><falsepositives11 type="dict"><TargetImage type="str">C:\Windows\System32\backgroundTaskHost.exe</TargetImage><SourceImage type="str">C:\Windows\System32\backgroundTaskHost.exe</SourceImage></falsepositives11><falsepositives12 type="dict"><TargetImage type="str">C:\Program Files (x86)\CCleaner Browser\Application\CCleanerBrowser.exe</TargetImage><SourceImage type="str">C:\Program Files (x86)\CCleaner Browser\Application\CCleanerBrowser.exe</SourceImage></falsepositives12><falsepositives13 type="dict"><key name="TargetImage|startswith" type="str">C:\Users\</key><key name="TargetImage|contains" type="str">\AppData\Local\Discord\</key><key name="TargetImage|endswith" type="str">\Discord.exe</key></falsepositives13><falsepositives14 type="dict"><TargetImage type="str">C:\WINDOWS\system32\AUDIODG.EXE</TargetImage></falsepositives14><falsepositives15 type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|contains" type="str">\AppData\Local\yammerdesktop\app-</key><key name="SourceImage|endswith" type="str">\Yammer.exe</key><key name="TargetImage|startswith" type="str">C:\Users\</key><key name="TargetImage|contains" type="str">\AppData\Local\yammerdesktop\app-</key><key name="TargetImage|endswith" type="str">\Yammer.exe</key><GrantedAccess type="str">0x1000</GrantedAccess></falsepositives15><falsepositive_kerneltrace_edge type="dict"><Provider_Name type="str">Microsoft-Windows-Kernel-Audit-API-Calls</Provider_Name></falsepositive_kerneltrace_edge><falsepositives_mixed type="dict"><key name="TargetImage|endswith" type="str">\Evernote\Evernote.exe</key></falsepositives_mixed><condition type="str">selection and not 1 of falsepositive*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>