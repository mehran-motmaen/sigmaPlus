<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">WMIC Loading Scripting Libraries</title><id type="str">06ce37c2-61ab-4f05-9ff5-b1a96d18ae32</id><status type="str">test</status><description type="str">Detects threat actors proxy executing code and bypassing application controls by leveraging wmic and the `/FORMAT` argument switch to download and execute an XSL file (i.e js, vbs, etc).</description><references type="list"><item type="str">https://securitydatasets.com/notebooks/atomic/windows/defense_evasion/SDWIN-201017061100.html</item><item type="str">https://twitter.com/dez_/status/986614411711442944</item><item type="str">https://lolbas-project.github.io/lolbas/Binaries/Wmic/</item></references><author type="str">Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)</author><date type="str">2020/10/17</date><modified type="str">2022/10/13</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1220</item></tags><logsource type="dict"><category type="str">image_load</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="str">\wmic.exe</key><key name="ImageLoaded|endswith" type="list"><item type="str">\jscript.dll</item><item type="str">\vbscript.dll</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">The command wmic os get lastboottuptime loads vbscript.dll</item><item type="str">The command wmic os get locale loads vbscript.dll</item><item type="str">Since the ImageLoad event doesn&apos;t have enough information in this case. It&apos;s better to look at the recent process creation events that spawned the WMIC process and investigate the command line and parent/child processes to get more insights</item></falsepositives><level type="str">medium</level></root>