<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Custom File Open Handler Executes PowerShell</title><id type="str">7530b96f-ad8e-431d-a04d-ac85cc461fdc</id><status type="str">experimental</status><description type="str">Detects the abuse of custom file open handler, executing powershell</description><references type="list"><item type="str">https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/?cmp=30728</item></references><author type="str">CD_R0M_</author><date type="str">2022/06/11</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1202</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="TargetObject|contains" type="str">shell\open\command\</key><key name="Details|contains|all" type="list"><item type="str">powershell</item><item type="str">-command</item></key><EventType type="str">SetValue</EventType></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>