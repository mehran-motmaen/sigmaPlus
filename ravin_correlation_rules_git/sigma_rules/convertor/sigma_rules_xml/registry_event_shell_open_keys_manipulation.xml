<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Shell Open Registry Keys Manipulation</title><id type="str">152f3630-77c1-4284-bcc0-4cc68ab2f6e7</id><status type="str">test</status><description type="str">Detects the shell open key manipulation (exefile and ms-settings) used for persistence and the pattern of UAC Bypass using fodhelper.exe, computerdefaults.exe, slui.exe via registry keys (e.g. UACMe 33 or 62)</description><references type="list"><item type="str">https://github.com/hfiref0x/UACME</item><item type="str">https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/</item><item type="str">https://github.com/RhinoSecurityLabs/Aggressor-Scripts/tree/master/UACBypass</item><item type="str">https://tria.ge/211119-gs7rtshcfr/behavioral2 [Lokibot sample from Nov 2021]</item></references><author type="str">Christian Burkard (Nextron Systems)</author><date type="str">2021/08/30</date><modified type="str">2022/01/13</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.privilege_escalation</item><item type="str">attack.t1548.002</item><item type="str">attack.t1546.001</item></tags><logsource type="dict"><category type="str">registry_event</category><product type="str">windows</product></logsource><detection type="dict"><selection1 type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|endswith" type="str">Classes\ms-settings\shell\open\command\SymbolicLinkValue</key><key name="Details|contains" type="str">\Software\Classes\{</key></selection1><selection2 type="dict"><key name="TargetObject|endswith" type="str">Classes\ms-settings\shell\open\command\DelegateExecute</key></selection2><selection3 type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|endswith" type="list"><item type="str">Classes\ms-settings\shell\open\command\(Default)</item><item type="str">Classes\exefile\shell\open\command\(Default)</item></key></selection3><filter_sel3 type="dict"><Details type="str">(Empty)</Details></filter_sel3><condition type="str">selection1 or selection2 or (selection3 and not filter_sel3)</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>