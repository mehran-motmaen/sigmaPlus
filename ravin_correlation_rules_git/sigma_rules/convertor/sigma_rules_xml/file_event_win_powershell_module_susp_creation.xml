<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Suspicious PowerShell Module File Created</title><id type="str">e8a52bbd-bced-459f-bd93-64db45ce7657</id><status type="str">experimental</status><description type="str">Detects the creation of a new PowerShell module in the first folder of the module directory structure &quot;\WindowsPowerShell\Modules\malware\malware.psm1&quot;. This is somewhat an uncommon practice as legitimate modules often includes a version folder.</description><references type="list"><item type="str">Internal Research</item><item type="str">https://learn.microsoft.com/en-us/powershell/scripting/developer/module/understanding-a-windows-powershell-module?view=powershell-7.3</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/05/09</date><tags type="list"><item type="str">attack.persistence</item></tags><logsource type="dict"><category type="str">file_event</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="TargetFilename|endswith" type="list"><item type="str">\\WindowsPowerShell\\Modules\\*\.ps</item><item type="str">\\WindowsPowerShell\\Modules\\*\.dll</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">False positive rate will vary depending on the environments. Additional filters might be required to make this logic usable in production.</item></falsepositives><level type="str">medium</level></root>