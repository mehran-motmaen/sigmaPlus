<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">PowerShell Logging Disabled Via Registry Key Tampering</title><id type="str">fecfd1a1-cc78-4313-a1ea-2ee2e8ec27a7</id><status type="str">experimental</status><description type="str">Detects changes to the registry for the currently logged-in user. In order to disable PowerShell module logging, script block logging or transcription and script execution logging</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-32---windows-powershell-logging-disabled</item></references><author type="str">frack113</author><date type="str">2022/04/02</date><modified type="str">2023/01/20</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1564.001</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains" type="list"><item type="str">\Microsoft\Windows\PowerShell\</item><item type="str">\Microsoft\PowerShellCore\</item></key><key name="TargetObject|endswith" type="list"><item type="str">\ModuleLogging\EnableModuleLogging</item><item type="str">\ScriptBlockLogging\EnableScriptBlockLogging</item><item type="str">\ScriptBlockLogging\EnableScriptBlockInvocationLogging</item><item type="str">\Transcription\EnableTranscripting</item><item type="str">\Transcription\EnableInvocationHeader</item><item type="str">\EnableScripts</item></key><Details type="str">DWORD (0x00000000)</Details></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>