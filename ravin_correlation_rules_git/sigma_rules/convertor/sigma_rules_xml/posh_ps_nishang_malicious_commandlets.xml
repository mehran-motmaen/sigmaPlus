<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Malicious Nishang PowerShell Commandlets</title><id type="str">f772cee9-b7c2-4cb2-8f07-49870adc02e0</id><status type="str">experimental</status><description type="str">Detects Commandlet names and arguments from the Nishang exploitation framework</description><references type="list"><item type="str">https://github.com/samratashok/nishang</item></references><author type="str">Alec Costello</author><date type="str">2019/05/16</date><modified type="str">2023/01/16</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><selection type="dict"><key name="ScriptBlockText|contains" type="list"><item type="str">Add-ConstrainedDelegationBackdoor</item><item type="str">Copy-VSS</item><item type="str">Create-MultipleSessions</item><item type="str">DataToEncode</item><item type="str">DNS_TXT_Pwnage</item><item type="str">Do-Exfiltration-Dns</item><item type="str">Download_Execute</item><item type="str">Download-Execute-PS</item><item type="str">DownloadAndExtractFromRemoteRegistry</item><item type="str">DumpCerts</item><item type="str">DumpCreds</item><item type="str">DumpHashes</item><item type="str">Enable-DuplicateToken</item><item type="str">Enable-Duplication</item><item type="str">Execute-Command-MSSQL</item><item type="str">Execute-DNSTXT-Code</item><item type="str">Execute-OnTime</item><item type="str">ExetoText</item><item type="str">exfill</item><item type="str">ExfilOption</item><item type="str">FakeDC</item><item type="str">FireBuster</item><item type="str">FireListener</item><item type="str">Get-Information </item><item type="str">Get-PassHints</item><item type="str">Get-Web-Credentials</item><item type="str">Get-WebCredentials</item><item type="str">Get-WLAN-Keys</item><item type="str">HTTP-Backdoor</item><item type="str">Invoke-AmsiBypass</item><item type="str">Invoke-BruteForce</item><item type="str">Invoke-CredentialsPhish</item><item type="str">Invoke-Decode</item><item type="str">Invoke-Encode</item><item type="str">Invoke-Interceptor</item><item type="str">Invoke-JSRatRegsvr</item><item type="str">Invoke-JSRatRundll</item><item type="str">Invoke-MimikatzWDigestDowngrade</item><item type="str">Invoke-NetworkRelay</item><item type="str">Invoke-PowerShellIcmp</item><item type="str">Invoke-PowerShellUdp</item><item type="str">Invoke-Prasadhak</item><item type="str">Invoke-PSGcat</item><item type="str">Invoke-PsGcatAgent</item><item type="str">Invoke-SessionGopher</item><item type="str">Invoke-SSIDExfil</item><item type="str">LoggedKeys</item><item type="str">Nishang</item><item type="str">NotAllNameSpaces</item><item type="str">Out-CHM</item><item type="str">OUT-DNSTXT</item><item type="str">Out-HTA</item><item type="str">Out-RundllCommand</item><item type="str">Out-SCF</item><item type="str">Out-SCT</item><item type="str">Out-Shortcut</item><item type="str">Out-WebQuery</item><item type="str">Out-Word</item><item type="str">Parse_Keys</item><item type="str">Password-List</item><item type="str">Powerpreter</item><item type="str">Remove-Persistence</item><item type="str">Remove-PoshRat</item><item type="str">Remove-Update</item><item type="str">Run-EXEonRemote</item><item type="str">Set-DCShadowPermissions</item><item type="str">Set-RemotePSRemoting</item><item type="str">Set-RemoteWMI</item><item type="str">Shellcode32</item><item type="str">Shellcode64</item><item type="str">StringtoBase64</item><item type="str">TexttoExe</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>