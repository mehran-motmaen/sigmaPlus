<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">PUA - Ngrok Execution</title><id type="str">ee37eb7c-a4e7-4cd5-8fa4-efa27f1c3f31</id><status type="str">test</status><description type="str">Detects the use of Ngrok, a utility used for port forwarding and tunneling, often used by threat actors to make local protected services publicly available.
Involved domains are bin.equinox.io for download and *.ngrok.io for connections.
</description><references type="list"><item type="str">https://ngrok.com/docs</item><item type="str">https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html</item><item type="str">https://stackoverflow.com/questions/42442320/ssh-tunnel-to-ngrok-and-initiate-rdp</item><item type="str">https://www.virustotal.com/gui/file/58d21840d915aaf4040ceb89522396124c82f325282f805d1085527e1e2ccfa1/detection</item><item type="str">https://cybleinc.com/2021/02/15/ngrok-platform-abused-by-hackers-to-deliver-a-new-wave-of-phishing-attacks/</item><item type="str">https://twitter.com/xorJosh/status/1598646907802451969</item><item type="str">https://www.softwaretestinghelp.com/how-to-use-ngrok/</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2021/05/14</date><modified type="str">2023/02/21</modified><tags type="list"><item type="str">attack.command_and_control</item><item type="str">attack.t1572</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection1 type="dict"><key name="CommandLine|contains" type="list"><item type="str"> tcp 139</item><item type="str"> tcp 445</item><item type="str"> tcp 3389</item><item type="str"> tcp 5985</item><item type="str"> tcp 5986</item></key></selection1><selection2 type="dict"><key name="CommandLine|contains|all" type="list"><item type="str"> start </item><item type="str">--all</item><item type="str">--config</item><item type="str">.yml</item></key></selection2><selection3 type="dict"><key name="Image|endswith" type="str">ngrok.exe</key><key name="CommandLine|contains" type="list"><item type="str"> tcp </item><item type="str"> http </item><item type="str"> authtoken </item></key></selection3><selection4 type="dict"><key name="CommandLine|contains" type="list"><item type="str">.exe authtoken </item><item type="str">.exe start --all</item></key></selection4><condition type="str">1 of selection*</condition></detection><falsepositives type="list"><item type="str">Another tool that uses the command line switches of Ngrok</item><item type="str">Ngrok http 3978 (https://docs.microsoft.com/en-us/azure/bot-service/bot-service-debug-channel-ngrok?view=azure-bot-service-4.0)</item></falsepositives><level type="str">high</level></root>