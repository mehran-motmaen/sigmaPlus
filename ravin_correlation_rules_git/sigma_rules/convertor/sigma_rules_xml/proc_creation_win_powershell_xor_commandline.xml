<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious XOR Encoded PowerShell Command</title><id type="str">bb780e0c-16cf-4383-8383-1e5471db6cf9</id><related type="list"><item type="dict"><id type="str">5b572dcf-254b-425c-a8c5-d9af6bea35a6</id><type type="str">obsoletes</type></item></related><status type="str">test</status><description type="str">Detects presence of a potentially xor encoded powershell command</description><references type="list"><item type="str">https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=65</item><item type="str">https://redcanary.com/blog/yellow-cockatoo/</item><item type="str">https://zero2auto.com/2020/05/19/netwalker-re/</item><item type="str">https://mez0.cc/posts/cobaltstrike-powershell-exec/</item></references><author type="str">Sami Ruohonen, Harish Segar, Tim Shelton, Teymur Kheirkhabarov, Vasiliy Burov, oscd.community, Nasreddine Bencherchali</author><date type="str">2018/09/05</date><modified type="str">2023/01/30</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.execution</item><item type="str">attack.t1059.001</item><item type="str">attack.t1140</item><item type="str">attack.t1027</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">PowerShell.EXE</item><item type="str">pwsh.dll</item></OriginalFileName></item><item type="dict"><Description type="str">Windows PowerShell</Description></item><item type="dict"><Product type="str">PowerShell Core 6</Product></item></selection_img><selection_cli_xor type="dict"><key name="CommandLine|contains" type="str">bxor</key></selection_cli_xor><selection_cli_other type="dict"><key name="CommandLine|contains" type="list"><item type="str">ForEach</item><item type="str">for(</item><item type="str">for </item><item type="str">-join </item><item type="str">-join&apos;</item><item type="str">-join&quot;</item><item type="str">-join`</item><item type="str">::Join</item><item type="str">[char]</item></key></selection_cli_other><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>