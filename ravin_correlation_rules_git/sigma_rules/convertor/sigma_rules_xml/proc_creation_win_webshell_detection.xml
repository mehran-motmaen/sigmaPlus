<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Webshell Detection With Command Line Keywords</title><id type="str">bed2a484-9348-4143-8a8a-b801c979301c</id><status type="str">experimental</status><description type="str">Detects certain command line parameters often used during reconnaissance activity via web shells</description><references type="list"><item type="str">https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html</item><item type="str">https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/</item></references><author type="str">Florian Roth (Nextron Systems), Jonhnathan Ribeiro, Anton Kutepov, oscd.community</author><date type="str">2017/01/01</date><modified type="str">2022/05/13</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1505.003</item><item type="str">attack.t1018</item><item type="str">attack.t1033</item><item type="str">attack.t1087</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_webserver_image type="dict"><key name="ParentImage|endswith" type="list"><item type="str">\w3wp.exe</item><item type="str">\php-cgi.exe</item><item type="str">\nginx.exe</item><item type="str">\httpd.exe</item><item type="str">\caddy.exe</item><item type="str">\ws_tomcatservice.exe</item></key></selection_webserver_image><selection_webserver_characteristics_tomcat1 type="dict"><key name="ParentImage|endswith" type="list"><item type="str">\java.exe</item><item type="str">\javaw.exe</item></key><key name="ParentImage|contains" type="list"><item type="str">-tomcat-</item><item type="str">\tomcat</item></key></selection_webserver_characteristics_tomcat1><selection_webserver_characteristics_tomcat2 type="dict"><key name="ParentImage|endswith" type="list"><item type="str">\java.exe</item><item type="str">\javaw.exe</item></key><key name="CommandLine|contains" type="list"><item type="str">catalina.jar</item><item type="str">CATALINA_HOME</item></key></selection_webserver_characteristics_tomcat2><susp_net_utility type="dict"><OriginalFileName type="list"><item type="str">net.exe</item><item type="str">net1.exe</item></OriginalFileName><key name="CommandLine|contains" type="list"><item type="str"> user </item><item type="str"> use </item><item type="str"> group </item></key></susp_net_utility><susp_ping_utility type="dict"><OriginalFileName type="str">ping.exe</OriginalFileName><key name="CommandLine|contains" type="str"> -n </key></susp_ping_utility><susp_change_dir type="dict"><key name="CommandLine|contains" type="list"><item type="str">&amp;cd&amp;echo</item><item type="str">cd /d </item></key></susp_change_dir><susp_wmic_utility type="dict"><OriginalFileName type="str">wmic.exe</OriginalFileName><key name="CommandLine|contains" type="str"> /node:</key></susp_wmic_utility><susp_misc_discovery_binaries type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\whoami.exe</item><item type="str">\systeminfo.exe</item><item type="str">\quser.exe</item><item type="str">\ipconfig.exe</item><item type="str">\pathping.exe</item><item type="str">\tracert.exe</item><item type="str">\netstat.exe</item><item type="str">\schtasks.exe</item><item type="str">\vssadmin.exe</item><item type="str">\wevtutil.exe</item><item type="str">\tasklist.exe</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">whoami.exe</item><item type="str">sysinfo.exe</item><item type="str">quser.exe</item><item type="str">ipconfig.exe</item><item type="str">pathping.exe</item><item type="str">tracert.exe</item><item type="str">netstat.exe</item><item type="str">schtasks.exe</item><item type="str">VSSADMIN.EXE</item><item type="str">wevtutil.exe</item><item type="str">tasklist.exe</item></OriginalFileName></item></susp_misc_discovery_binaries><susp_misc_discovery_commands type="dict"><key name="CommandLine|contains" type="list"><item type="str"> Test-NetConnection </item><item type="str">dir \</item></key></susp_misc_discovery_commands><condition type="str">1 of selection* and 1 of susp*</condition></detection><fields type="list"><item type="str">CommandLine</item><item type="str">ParentCommandLine</item></fields><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>