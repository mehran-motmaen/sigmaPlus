<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Malicious Base64 Encoded PowerShell Keywords in Command Lines</title><id type="str">f26c6093-6f14-4b12-800f-0fcb46f5ffd0</id><status type="str">test</status><description type="str">Detects base64 encoded strings used in hidden malicious PowerShell command lines</description><references type="list"><item type="str">http://www.leeholmes.com/blog/2017/09/21/searching-for-content-in-base-64-strings/</item></references><author type="str">John Lambert (rule)</author><date type="str">2019/01/16</date><modified type="str">2023/01/05</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">PowerShell.EXE</item><item type="str">pwsh.dll</item></OriginalFileName></item></selection_img><selection_hidden type="dict"><key name="CommandLine|contains" type="str"> hidden </key></selection_hidden><selection_encoded type="dict"><key name="CommandLine|contains" type="list"><item type="str">AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA</item><item type="str">aXRzYWRtaW4gL3RyYW5zZmVy</item><item type="str">IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA</item><item type="str">JpdHNhZG1pbiAvdHJhbnNmZX</item><item type="str">YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg</item><item type="str">Yml0c2FkbWluIC90cmFuc2Zlc</item><item type="str">AGMAaAB1AG4AawBfAHMAaQB6AGUA</item><item type="str">JABjAGgAdQBuAGsAXwBzAGkAegBlA</item><item type="str">JGNodW5rX3Npem</item><item type="str">QAYwBoAHUAbgBrAF8AcwBpAHoAZQ</item><item type="str">RjaHVua19zaXpl</item><item type="str">Y2h1bmtfc2l6Z</item><item type="str">AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A</item><item type="str">kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg</item><item type="str">lPLkNvbXByZXNzaW9u</item><item type="str">SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA</item><item type="str">SU8uQ29tcHJlc3Npb2</item><item type="str">Ty5Db21wcmVzc2lvb</item><item type="str">AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ</item><item type="str">kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA</item><item type="str">lPLk1lbW9yeVN0cmVhb</item><item type="str">SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A</item><item type="str">SU8uTWVtb3J5U3RyZWFt</item><item type="str">Ty5NZW1vcnlTdHJlYW</item><item type="str">4ARwBlAHQAQwBoAHUAbgBrA</item><item type="str">5HZXRDaHVua</item><item type="str">AEcAZQB0AEMAaAB1AG4Aaw</item><item type="str">LgBHAGUAdABDAGgAdQBuAGsA</item><item type="str">LkdldENodW5r</item><item type="str">R2V0Q2h1bm</item><item type="str">AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A</item><item type="str">QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA</item><item type="str">RIUkVBRF9JTkZPNj</item><item type="str">SFJFQURfSU5GTzY0</item><item type="str">VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA</item><item type="str">VEhSRUFEX0lORk82N</item><item type="str">AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA</item><item type="str">cmVhdGVSZW1vdGVUaHJlYW</item><item type="str">MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA</item><item type="str">NyZWF0ZVJlbW90ZVRocmVhZ</item><item type="str">Q3JlYXRlUmVtb3RlVGhyZWFk</item><item type="str">QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA</item><item type="str">0AZQBtAG0AbwB2AGUA</item><item type="str">1lbW1vdm</item><item type="str">AGUAbQBtAG8AdgBlA</item><item type="str">bQBlAG0AbQBvAHYAZQ</item><item type="str">bWVtbW92Z</item><item type="str">ZW1tb3Zl</item></key></selection_encoded><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>