<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Access To Windows Credential History File</title><id type="str">7a2a22ea-a203-4cd3-9abf-20eb1c5c6cd2</id><status type="str">experimental</status><description type="str">Detects suspicious processes based on name and location that access the Windows Credential History File.
Which can be a sign of credential stealing. Example case would be usage of mimikatz &quot;dpapi::credhist&quot; function
</description><references type="list"><item type="str">https://tools.thehacker.recipes/mimikatz/modules/dpapi/credhist</item><item type="str">https://www.passcape.com/windows_password_recovery_dpapi_credhist</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/10/17</date><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1555.004</item></tags><logsource type="dict"><category type="str">file_access</category><product type="str">windows</product><definition type="str">Requirements: Microsoft-Windows-Kernel-File ETW provider</definition></logsource><detection type="dict"><selection type="dict"><key name="FileName|endswith" type="str">\Microsoft\Protect\CREDHIST</key></selection><filter_system_folders type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\</item><item type="str">C:\Program Files (x86)\</item><item type="str">C:\Windows\system32\</item><item type="str">C:\Windows\SysWOW64\</item></key></filter_system_folders><filter_processes type="dict"><Image type="str">C:\Windows\explorer.exe</Image></filter_processes><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>