<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Alternate PowerShell Hosts - PowerShell Module</title><id type="str">64e8e417-c19a-475a-8d19-98ea705394cc</id><status type="str">test</status><description type="str">Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe</description><references type="list"><item type="str">https://threathunterplaybook.com/hunts/windows/190610-PwshAlternateHosts/notebook.html</item></references><author type="str">Roberto Rodriguez @Cyb3rWard0g</author><date type="str">2019/08/11</date><modified type="str">2022/12/13</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_module</category><definition type="str">0ad03ef1-f21b-4a79-8ce8-e6900c54b65b</definition></logsource><detection type="dict"><selection type="dict"><key name="ContextInfo|contains" type="str">*</key></selection><filter_powershell type="dict"><key name="ContextInfo|contains" type="list"><item type="str">= powershell</item><item type="str">= C:\Windows\System32\WindowsPowerShell\v1.0\powershell</item><item type="str">= C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell</item><item type="str">= C:/Windows/System32/WindowsPowerShell/v1.0/powershell</item><item type="str">= C:/Windows/SysWOW64/WindowsPowerShell/v1.0/powershell</item></key></filter_powershell><filter_sdiagnhost type="dict"><key name="ContextInfo|contains" type="str">= C:\WINDOWS\System32\sdiagnhost.exe -Embedding</key></filter_sdiagnhost><filter_citrix type="dict"><key name="ContextInfo|contains" type="str">ConfigSyncRun.exe</key></filter_citrix><filter_adace type="dict"><key name="ContextInfo|contains" type="str">C:\Windows\system32\dsac.exe</key></filter_adace><filter_winrm type="dict"><key name="ContextInfo|contains" type="str">C:\Windows\system32\wsmprovhost.exe -Embedding</key></filter_winrm><filter_help_update type="dict"><key name="Payload|contains" type="list"><item type="str">Update-Help</item><item type="str">Failed to update Help for the module</item></key></filter_help_update><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Programs using PowerShell directly without invocation of a dedicated interpreter</item><item type="str">MSP Detection Searcher</item><item type="str">Citrix ConfigSync.ps1</item></falsepositives><level type="str">medium</level></root>