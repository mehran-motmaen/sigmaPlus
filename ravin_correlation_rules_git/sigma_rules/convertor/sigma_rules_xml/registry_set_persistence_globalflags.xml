<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Via GlobalFlags</title><id type="str">36803969-5421-41ec-b92f-8500f79c23b0</id><related type="list"><item type="dict"><id type="str">c81fe886-cac0-4913-a511-2822d72ff505</id><type type="str">obsoletes</type></item></related><status type="str">test</status><description type="str">Detects registry persistence technique using the GlobalFlags and SilentProcessExit keys</description><references type="list"><item type="str">https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/</item><item type="str">https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/</item></references><author type="str">Karneades, Jonhnathan Ribeiro, Florian Roth</author><date type="str">2018/04/11</date><modified type="str">2023/06/05</modified><tags type="list"><item type="str">attack.privilege_escalation</item><item type="str">attack.persistence</item><item type="str">attack.defense_evasion</item><item type="str">attack.t1546.012</item><item type="str">car.2013-01-002</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection_global_flag type="dict"><key name="TargetObject|contains|all" type="list"><item type="str">\Microsoft\Windows NT\CurrentVersion\</item><item type="str">\Image File Execution Options\</item><item type="str">\GlobalFlag</item></key></selection_global_flag><selection_silent_process type="dict"><key name="TargetObject|contains|all" type="list"><item type="str">\Microsoft\Windows NT\CurrentVersion\</item><item type="str">\SilentProcessExit\</item></key><key name="TargetObject|contains" type="list"><item type="str">\ReportingMode</item><item type="str">\MonitorProcess</item></key></selection_silent_process><condition type="str">1 of selection_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>