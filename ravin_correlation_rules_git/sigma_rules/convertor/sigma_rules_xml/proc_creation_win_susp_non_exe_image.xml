<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Execution of Suspicious File Type Extension</title><id type="str">c09dad97-1c78-4f71-b127-7edb2b8e491a</id><status type="str">experimental</status><description type="str">Checks whether the image specified in a process creation event doesn&apos;t refer to an .exe file (caused by process ghosting or other unorthodox methods to start a process)</description><references type="list"><item type="str">https://pentestlaboratories.com/2021/12/08/process-ghosting/</item></references><author type="str">Max Altgelt (Nextron Systems)</author><date type="str">2021/12/09</date><modified type="str">2023/06/15</modified><tags type="list"><item type="str">attack.defense_evasion</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><known_image_extension type="dict"><key name="Image|endswith" type="list"><item type="str">.exe</item><item type="str">.tmp</item><item type="str">.scr</item></key></known_image_extension><filter_main_image type="dict"><Image type="list"><item type="str">System</item><item type="str">Registry</item><item type="str">MemCompression</item><item type="str">vmmem</item></Image></filter_main_image><filter_main_msi_installers type="dict"><key name="Image|startswith" type="str">C:\Windows\Installer\MSI</key></filter_main_msi_installers><filter_main_driver_store type="dict"><key name="Image|startswith" type="str">C:\Windows\System32\DriverStore\FileRepository\</key></filter_main_driver_store><filter_main_msi_rollbackfiles type="dict"><key name="Image|startswith" type="str">C:\Config.Msi\</key><key name="Image|endswith" type="list"><item type="str">.rbf</item><item type="str">.rbs</item></key></filter_main_msi_rollbackfiles><filter_main_windows_helper type="dict"><key name="ParentImage|startswith" type="str">C:\Windows\Temp\</key><key name="Image|startswith" type="str">C:\Windows\Temp\Helper\</key></filter_main_windows_helper><filter_main_com type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Windows\System32\</item><item type="str">C:\Windows\SysWOW64\</item></key><key name="Image|endswith" type="str">.com</key></filter_main_com><filter_main_deleted type="dict"><key name="Image|startswith" type="str">C:\$Extend\$Deleted\</key></filter_main_deleted><filter_optional_empty type="dict"><Image type="list"><item type="str">-</item><item type="str"></item></Image></filter_optional_empty><filter_optional_null type="dict"><Image type="null"></Image></filter_optional_null><filter_optional_avira type="dict"><key name="ParentImage|startswith" type="str">C:\ProgramData\Avira\</key></filter_optional_avira><filter_optional_nvidia type="dict"><key name="Image|contains" type="str">NVIDIA\NvBackend\</key><key name="Image|endswith" type="str">.dat</key></filter_optional_nvidia><filter_optional_winscp type="dict"><key name="Image|endswith" type="str">\WinSCP.com</key></filter_optional_winscp><filter_optional_vscode type="dict"><key name="Image|contains|all" type="list"><item type="str">C:\Users\</item><item type="str">\AppData\</item><item type="str">.tmp</item><item type="str">CodeSetup</item></key></filter_optional_vscode><filter_optional_libreoffice type="dict"><key name="Image|endswith" type="str">\program\soffice.bin</key></filter_optional_libreoffice><filter_optional_emc_networker type="dict"><Image type="list"><item type="str">C:\Program Files\EMC NetWorker\Management\GST\apache\cgi-bin\update_jnlp.cgi</item><item type="str">C:\Program Files (x86)\EMC NetWorker\Management\GST\apache\cgi-bin\update_jnlp.cgi</item></Image></filter_optional_emc_networker><filter_optional_winpakpro type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files (x86)\WINPAKPRO\</item><item type="str">C:\Program Files\WINPAKPRO\</item></key><key name="Image|endswith" type="str">.ngn</key></filter_optional_winpakpro><filter_optional_myq_server type="dict"><Image type="list"><item type="str">C:\Program Files (x86)\MyQ\Server\pcltool.dll</item><item type="str">C:\Program Files\MyQ\Server\pcltool.dll</item></Image></filter_optional_myq_server><filter_optional_visualstudio type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\Microsoft Visual Studio\</item><item type="str">C:\Program Files (x86)\Microsoft Visual Studio</item></key><key name="Image|endswith" type="str">.com</key></filter_optional_visualstudio><filter_optional_wsl type="dict"><key name="Image|contains|all" type="list"><item type="str">\AppData\Local\Packages\</item><item type="str">\LocalState\rootfs\</item></key></filter_optional_wsl><filter_optional_lzma_exe type="dict"><key name="Image|endswith" type="str">\LZMA_EXE</key></filter_optional_lzma_exe><filter_optional_dell_dock type="dict"><key name="ParentImage|startswith" type="str">C:\Windows\Temp\</key><key name="ParentImage|endswith" type="str">\TBT_Dock_Firmware\GetDockVer32W.exe</key></filter_optional_dell_dock><filter_optional_firefox_crashreporter type="dict"><key name="Image|startswith" type="str">C:\Program Files\Mozilla Firefox\tobedeleted\</key></filter_optional_firefox_crashreporter><filter_optional_office_c2r type="dict"><ParentImage type="str">C:\Windows\UUS\amd64\MoUsoCoreWorker.exe</ParentImage><key name="Image|startswith" type="str">C:\$Extend\$Deleted\</key><key name="CommandLine|contains|all" type="list"><item type="str">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</item><item type="str">/update UPDATEORCHESTRATOR displaylevel=False</item></key></filter_optional_office_c2r><filter_optional_docker type="dict"><ParentImage type="str">C:\Windows\System32\services.exe</ParentImage><key name="Image|endswith" type="str">com.docker.service</key></filter_optional_docker><condition type="str">not known_image_extension and not 1 of filter_main_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>