<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Cmd.EXE Missing Space Characters Execution Anomaly</title><id type="str">a16980c2-0c56-4de0-9a79-17971979efdd</id><status type="str">experimental</status><description type="str">Detects Windows command lines that miss a space before or after the /c flag when running a command using the cmd.exe.
This could be a sign of obfuscation of a fat finger problem (typo by the developer).
</description><references type="list"><item type="str">https://twitter.com/cyb3rops/status/1562072617552678912</item><item type="str">https://ss64.com/nt/cmd.html</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2022/08/23</date><modified type="str">2023/03/06</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection1 type="dict"><key name="CommandLine|contains" type="list"><item type="str">cmd.exe/c</item><item type="str">\cmd/c</item><item type="str">&quot;cmd/c</item><item type="str">cmd.exe/k</item><item type="str">\cmd/k</item><item type="str">&quot;cmd/k</item><item type="str">cmd.exe/r</item><item type="str">\cmd/r</item><item type="str">&quot;cmd/r</item></key></selection1><selection2 type="dict"><key name="CommandLine|contains" type="list"><item type="str">/cwhoami</item><item type="str">/cpowershell</item><item type="str">/cschtasks</item><item type="str">/cbitsadmin</item><item type="str">/ccertutil</item><item type="str">/kwhoami</item><item type="str">/kpowershell</item><item type="str">/kschtasks</item><item type="str">/kbitsadmin</item><item type="str">/kcertutil</item></key></selection2><selection3 type="dict"><key name="CommandLine|contains" type="list"><item type="str">cmd.exe /c</item><item type="str">cmd /c</item><item type="str">cmd.exe /k</item><item type="str">cmd /k</item><item type="str">cmd.exe /r</item><item type="str">cmd /r</item></key></selection3><filter_generic type="dict"><key name="CommandLine|contains" type="list"><item type="str">cmd.exe /c </item><item type="str">cmd /c </item><item type="str">cmd.exe /k </item><item type="str">cmd /k </item><item type="str">cmd.exe /r </item><item type="str">cmd /r </item></key></filter_generic><filter_fp type="list"><item type="dict"><key name="CommandLine|contains" type="str">AppData\Local\Programs\Microsoft VS Code\resources\app\node_modules</key></item><item type="dict"><key name="CommandLine|endswith" type="str">cmd.exe/c .</key></item><item type="dict"><CommandLine type="str">cmd.exe /c</CommandLine></item></filter_fp><condition type="str">1 of selection* and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>