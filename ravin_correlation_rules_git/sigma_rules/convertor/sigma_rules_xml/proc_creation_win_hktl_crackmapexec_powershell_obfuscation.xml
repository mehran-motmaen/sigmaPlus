<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">HackTool - CrackMapExec PowerShell Obfuscation</title><id type="str">6f8b3439-a203-45dc-a88b-abf57ea15ccf</id><status type="str">test</status><description type="str">The CrachMapExec pentesting framework implements a PowerShell obfuscation with some static strings detected by this rule.</description><references type="list"><item type="str">https://github.com/byt3bl33d3r/CrackMapExec</item><item type="str">https://github.com/byt3bl33d3r/CrackMapExec/blob/0a49f75347b625e81ee6aa8c33d3970b5515ea9e/cme/helpers/powershell.py#L242</item></references><author type="str">Thomas Patzke</author><date type="str">2020/05/22</date><modified type="str">2023/02/21</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item><item type="str">attack.defense_evasion</item><item type="str">attack.t1027.005</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">PowerShell.EXE</item><item type="str">pwsh.dll</item></OriginalFileName></item></selection_img><selection_cli type="dict"><key name="CommandLine|contains" type="list"><item type="str">join*split</item><item type="str">( $ShellId[1]+$ShellId[13]+&apos;x&apos;)</item><item type="str">( $PSHome[*]+$PSHOME[*]+</item><item type="str">( $env:Public[13]+$env:Public[5]+&apos;x&apos;)</item><item type="str">( $env:ComSpec[4,*,25]-Join&apos;&apos;)</item><item type="str">[1,3]+&apos;x&apos;-Join&apos;&apos;)</item></key></selection_cli><condition type="str">all of selection_*</condition></detection><fields type="list"><item type="str">ComputerName</item><item type="str">User</item><item type="str">CommandLine</item></fields><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>