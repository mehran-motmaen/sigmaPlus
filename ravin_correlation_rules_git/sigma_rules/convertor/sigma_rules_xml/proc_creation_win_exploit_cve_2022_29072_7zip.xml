<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential CVE-2022-29072 Exploitation Attempt</title><id type="str">9a4ccd1a-3526-4d99-b980-9f9c5d3a6ee3</id><status type="str">experimental</status><description type="str">Detects potential exploitation attempts of CVE-2022-29072, a 7-Zip privilege escalation and command execution vulnerability.
7-Zip version 21.07 and earlier on Windows allows privilege escalation (CVE-2022-29072) and command execution when a file with the .7z extension is dragged to the Help&gt;Contents area. This is caused by misconfiguration of 7z.dll and a heap overflow.
The command runs in a child process under the 7zFM.exe process.
</description><references type="list"><item type="str">https://github.com/kagancapar/CVE-2022-29072</item><item type="str">https://twitter.com/kagancapar/status/1515219358234161153</item></references><author type="str">frack113</author><date type="str">2022/04/17</date><modified type="str">2023/02/07</modified><tags type="list"><item type="str">attack.execution</item><item type="str">cve.2022.29072</item><item type="str">detection.emerging_threats</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">process_creation</category></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\cmd.exe</key></item><item type="dict"><OriginalFileName type="str">Cmd.Exe</OriginalFileName></item></selection_img><selection_parent type="dict"><key name="ParentImage|endswith" type="str">\7zFM.exe</key></selection_parent><filter_bat type="dict"><key name="CommandLine|contains" type="list"><item type="str"> /c </item><item type="str"> /k </item><item type="str"> /r </item></key></filter_bat><filter_null type="dict"><CommandLine type="null"></CommandLine></filter_null><condition type="str">all of selection_* and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>