<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Remote Thread Creation In Mstsc.Exe From Suspicious Location</title><id type="str">c0aac16a-b1e7-4330-bab0-3c27bb4987c7</id><status type="str">experimental</status><description type="str">Detects remote thread creation in the &quot;mstsc.exe&quot; process by a process located in a potentially suspicious location.
This technique is often used by attackers in order to hook some APIs used by DLLs loaded by &quot;mstsc.exe&quot; during RDP authentications in order to steal credentials.
</description><references type="list"><item type="str">https://github.com/S12cybersecurity/RDPCredentialStealer/blob/1b8947cdd065a06c1b62e80967d3c7af895fcfed/APIHookInjectorBin/APIHookInjectorBin/Inject.h#L25</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/07/28</date><tags type="list"><item type="str">attack.credential_access</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">create_remote_thread</category></logsource><detection type="dict"><selection type="dict"><key name="TargetImage|endswith" type="str">\mstsc.exe</key><key name="SourceImage|contains" type="list"><item type="str">:\Users\Public\</item><item type="str">:\Windows\PerfLogs\</item><item type="str">:\Windows\Tasks\</item><item type="str">:\Temp\</item><item type="str">:\Windows\Temp\</item><item type="str">:\AppData\Local\Temp\</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>