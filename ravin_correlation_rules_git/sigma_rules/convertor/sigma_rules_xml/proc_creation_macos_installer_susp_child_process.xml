<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Installer Package Child Process</title><id type="str">e0cfaecd-602d-41af-988d-f6ccebb2af26</id><status type="str">experimental</status><description type="str">Detects the execution of suspicious child processes from macOS installer package parent process. This includes osascript, JXA, curl and wget amongst other interpreters</description><references type="list"><item type="str">https://redcanary.com/blog/clipping-silver-sparrows-wings/</item><item type="str">https://github.com/elastic/detection-rules/blob/4312d8c9583be524578a14fe6295c3370b9a9307/rules/macos/execution_installer_package_spawned_network_event.toml</item></references><author type="str">Sohan G (D4rkCiph3r)</author><date type="str">2023/02/18</date><tags type="list"><item type="str">attack.t1059</item><item type="str">attack.t1059.007</item><item type="str">attack.t1071</item><item type="str">attack.t1071.001</item><item type="str">attack.execution</item><item type="str">attack.command_and_control</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">macos</product></logsource><detection type="dict"><selection_installer type="dict"><key name="ParentImage|endswith" type="list"><item type="str">/package_script_service</item><item type="str">/installer</item></key><key name="Image|endswith" type="list"><item type="str">/sh</item><item type="str">/bash</item><item type="str">/dash</item><item type="str">/python</item><item type="str">/ruby</item><item type="str">/perl</item><item type="str">/php</item><item type="str">/javascript</item><item type="str">/osascript</item><item type="str">/tclsh</item><item type="str">/curl</item><item type="str">/wget</item></key><key name="CommandLine|contains" type="list"><item type="str">preinstall</item><item type="str">postinstall</item></key></selection_installer><condition type="str">selection_installer</condition></detection><falsepositives type="list"><item type="str">Legitimate software uses the scripts (preinstall, postinstall)</item></falsepositives><level type="str">medium</level></root>