<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious PowerShell Parameter Substring</title><id type="str">36210e0d-5b19-485d-a087-c096088885f0</id><status type="str">test</status><description type="str">Detects suspicious PowerShell invocation with a parameter substring</description><references type="list"><item type="str">http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier</item></references><author type="str">Florian Roth (Nextron Systems), Daniel Bohannon (idea), Roberto Rodriguez (Fix)</author><date type="str">2019/01/16</date><modified type="str">2022/07/14</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key><key name="CommandLine|contains" type="list"><item type="str"> -windowstyle h </item><item type="str"> -windowstyl h</item><item type="str"> -windowsty h</item><item type="str"> -windowst h</item><item type="str"> -windows h</item><item type="str"> -windo h</item><item type="str"> -wind h</item><item type="str"> -win h</item><item type="str"> -wi h</item><item type="str"> -win h </item><item type="str"> -win hi </item><item type="str"> -win hid </item><item type="str"> -win hidd </item><item type="str"> -win hidde </item><item type="str"> -NoPr </item><item type="str"> -NoPro </item><item type="str"> -NoProf </item><item type="str"> -NoProfi </item><item type="str"> -NoProfil </item><item type="str"> -nonin </item><item type="str"> -nonint </item><item type="str"> -noninte </item><item type="str"> -noninter </item><item type="str"> -nonintera </item><item type="str"> -noninterac </item><item type="str"> -noninteract </item><item type="str"> -noninteracti </item><item type="str"> -noninteractiv </item><item type="str"> -ec </item><item type="str"> -encodedComman </item><item type="str"> -encodedComma </item><item type="str"> -encodedComm </item><item type="str"> -encodedCom </item><item type="str"> -encodedCo </item><item type="str"> -encodedC </item><item type="str"> -encoded </item><item type="str"> -encode </item><item type="str"> -encod </item><item type="str"> -enco </item><item type="str"> -en </item><item type="str"> -executionpolic </item><item type="str"> -executionpoli </item><item type="str"> -executionpol </item><item type="str"> -executionpo </item><item type="str"> -executionp </item><item type="str"> -execution bypass</item><item type="str"> -executio bypass</item><item type="str"> -executi bypass</item><item type="str"> -execut bypass</item><item type="str"> -execu bypass</item><item type="str"> -exec bypass</item><item type="str"> -exe bypass</item><item type="str"> -ex bypass</item><item type="str"> -ep bypass</item><item type="str"> /windowstyle h </item><item type="str"> /windowstyl h</item><item type="str"> /windowsty h</item><item type="str"> /windowst h</item><item type="str"> /windows h</item><item type="str"> /windo h</item><item type="str"> /wind h</item><item type="str"> /win h</item><item type="str"> /wi h</item><item type="str"> /win h </item><item type="str"> /win hi </item><item type="str"> /win hid </item><item type="str"> /win hidd </item><item type="str"> /win hidde </item><item type="str"> /NoPr </item><item type="str"> /NoPro </item><item type="str"> /NoProf </item><item type="str"> /NoProfi </item><item type="str"> /NoProfil </item><item type="str"> /nonin </item><item type="str"> /nonint </item><item type="str"> /noninte </item><item type="str"> /noninter </item><item type="str"> /nonintera </item><item type="str"> /noninterac </item><item type="str"> /noninteract </item><item type="str"> /noninteracti </item><item type="str"> /noninteractiv </item><item type="str"> /ec </item><item type="str"> /encodedComman </item><item type="str"> /encodedComma </item><item type="str"> /encodedComm </item><item type="str"> /encodedCom </item><item type="str"> /encodedCo </item><item type="str"> /encodedC </item><item type="str"> /encoded </item><item type="str"> /encode </item><item type="str"> /encod </item><item type="str"> /enco </item><item type="str"> /en </item><item type="str"> /executionpolic </item><item type="str"> /executionpoli </item><item type="str"> /executionpol </item><item type="str"> /executionpo </item><item type="str"> /executionp </item><item type="str"> /execution bypass</item><item type="str"> /executio bypass</item><item type="str"> /executi bypass</item><item type="str"> /execut bypass</item><item type="str"> /execu bypass</item><item type="str"> /exec bypass</item><item type="str"> /exe bypass</item><item type="str"> /ex bypass</item><item type="str"> /ep bypass</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>