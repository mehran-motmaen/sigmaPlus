<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Disable Windows Event Logging Via Registry</title><id type="str">2f78da12-f7c7-430b-8b19-a28f269b77a3</id><status type="str">experimental</status><description type="str">Detects tampering with the &quot;Enabled&quot; registry key in order to disable Windows logging of a Windows event channel</description><references type="list"><item type="str">https://twitter.com/WhichbufferArda/status/1543900539280293889</item><item type="str">https://github.com/DebugPrivilege/CPP/blob/c39d365617dbfbcb01fffad200d52b6239b2918c/Windows%20Defender/RestoreDefenderConfig.cpp</item></references><author type="str">frack113, Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/07/04</date><modified type="str">2023/04/05</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1562.002</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|startswith" type="str">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\</key><key name="TargetObject|endswith" type="str">\Enabled</key><Details type="str">DWORD (0x00000000)</Details></selection><filter_main_wevutil type="dict"><key name="Image|endswith" type="str">\Windows\system32\wevtutil.exe</key></filter_main_wevutil><filter_main_iis type="dict"><key name="Image|startswith" type="str">C:\Windows\winsxs\</key><key name="Image|endswith" type="str">\TiWorker.exe</key></filter_main_iis><filter_main_svchost type="dict"><Image type="str">C:\Windows\System32\svchost.exe</Image><key name="TargetObject|contains" type="list"><item type="str">\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-FileInfoMinifilter</item><item type="str">\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-ASN1\</item><item type="str">\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Kernel-AppCompat\</item><item type="str">\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Runtime\Error\</item><item type="str">\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-CAPI2/Operational\</item></key></filter_main_svchost><filter_main_trusted_installer type="dict"><Image type="str">C:\Windows\servicing\TrustedInstaller.exe</Image><key name="TargetObject|contains" type="str">\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Compat-Appraiser</key></filter_main_trusted_installer><filter_optional_empty type="dict"><Image type="str"></Image></filter_optional_empty><filter_optional_null type="dict"><Image type="null"></Image></filter_optional_null><condition type="str">selection and not 1 of filter_main_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Rare falsepositives may occur from legitimate administrators disabling specific event log for troubleshooting</item></falsepositives><level type="str">high</level></root>