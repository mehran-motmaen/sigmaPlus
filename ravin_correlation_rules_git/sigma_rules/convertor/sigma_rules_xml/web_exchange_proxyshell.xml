<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Exchange ProxyShell Pattern</title><id type="str">23eee45e-933b-49f9-ae1b-df706d2d52ef</id><status type="str">experimental</status><description type="str">Detects URL patterns that could be found in ProxyShell exploitation attempts against Exchange servers (failed and successful)</description><references type="list"><item type="str">https://youtu.be/5mqid-7zp8k?t=2231</item><item type="str">https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html</item><item type="str">https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1</item></references><author type="str">Florian Roth (Nextron Systems), Rich Warren</author><date type="str">2021/08/07</date><modified type="str">2023/01/02</modified><tags type="list"><item type="str">attack.initial_access</item><item type="str">attack.t1190</item><item type="str">detection.emerging_threats</item></tags><logsource type="dict"><category type="str">webserver</category></logsource><detection type="dict"><selection_1 type="dict"><sc-status type="int">401</sc-status></selection_1><selection_1_auto type="dict"><key name="cs-uri-query|contains" type="str">/autodiscover.json</key></selection_1_auto><selection_1_uri type="dict"><key name="cs-uri-query|contains" type="list"><item type="str">/powershell</item><item type="str">/mapi/nspi</item><item type="str">/EWS</item><item type="str">X-Rps-CAT</item></key></selection_1_uri><selection_poc type="dict"><sc-status type="int">401</sc-status><key name="cs-uri-query|contains" type="list"><item type="str">autodiscover.json?@</item><item type="str">autodiscover.json%3f@</item><item type="str">%3f@foo.com</item><item type="str">Email=autodiscover/autodiscover.json</item><item type="str">json?@foo.com</item></key></selection_poc><condition type="str">all of selection_1* or selection_poc</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>