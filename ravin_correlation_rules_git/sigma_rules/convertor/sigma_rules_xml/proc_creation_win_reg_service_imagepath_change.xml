<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Changing Existing Service ImagePath Value Via Reg.EXE</title><id type="str">9b0b7ac3-6223-47aa-a3fd-e8f211e637db</id><status type="str">test</status><description type="str">Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services.
Adversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start.
Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services
</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.011/T1574.011.md#atomic-test-2---service-imagepath-change-with-regexe</item></references><author type="str">frack113</author><date type="str">2021/12/30</date><modified type="str">2023/02/05</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1574.011</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="str">\reg.exe</key><key name="CommandLine|contains|all" type="list"><item type="str">add </item><item type="str">SYSTEM\CurrentControlSet\Services\</item><item type="str"> ImagePath </item></key></selection><selection_value type="dict"><key name="CommandLine|contains" type="list"><item type="str"> /d </item><item type="str"> -d </item></key></selection_value><condition type="str">all of selection*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>