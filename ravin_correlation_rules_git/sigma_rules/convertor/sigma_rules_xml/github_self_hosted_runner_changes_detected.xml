<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Github Self Hosted Runner Changes Detected</title><id type="str">f8ed0e8f-7438-4b79-85eb-f358ef2fbebd</id><status type="str">experimental</status><description type="str">A self-hosted runner is a system that you deploy and manage to execute jobs from GitHub Actions on GitHub.com.
This rule detects changes to self-hosted runners configurations in the environment. The self-hosted runner configuration changes once detected,
it should be validated from GitHub UI because the log entry may not provide full context.
</description><author type="str">Muhammad Faisal</author><date type="str">2023/01/27</date><references type="list"><item type="str">https://docs.github.com/en/actions/hosting-your-own-runners/about-self-hosted-runners#about-self-hosted-runners</item><item type="str">https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#search-based-on-operation</item></references><tags type="list"><item type="str">attack.impact</item><item type="str">attack.discovery</item><item type="str">attack.collection</item><item type="str">attack.defense_evasion</item><item type="str">attack.persistence</item><item type="str">attack.privilege_escalation</item><item type="str">attack.initial_access</item><item type="str">attack.t1526</item><item type="str">attack.t1213.003</item><item type="str">attack.t1078.004</item></tags><logsource type="dict"><product type="str">github</product><service type="str">audit</service><definition type="str">Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming</definition></logsource><detection type="dict"><selection type="dict"><action type="list"><item type="str">org.remove_self_hosted_runner</item><item type="str">org.runner_group_created</item><item type="str">org.runner_group_removed</item><item type="str">org.runner_group_updated</item><item type="str">org.runner_group_runners_added</item><item type="str">org.runner_group_runner_removed</item><item type="str">org.runner_group_runners_updated</item><item type="str">repo.register_self_hosted_runner</item><item type="str">repo.remove_self_hosted_runner</item></action></selection><condition type="str">selection</condition></detection><fields type="list"><item type="str">action</item><item type="str">actor</item><item type="str">org</item><item type="str">actor_location.country_code</item><item type="str">transport_protocol_name</item><item type="str">repository</item><item type="str">repo</item><item type="str">repository_public</item><item type="str">@timestamp</item></fields><falsepositives type="list"><item type="str">Allowed self-hosted runners changes in the environment.</item><item type="str">A self-hosted runner is automatically removed from GitHub if it has not connected to GitHub Actions for more than 14 days.</item><item type="str">An ephemeral self-hosted runner is automatically removed from GitHub if it has not connected to GitHub Actions for more than 1 day.</item></falsepositives><level type="str">low</level></root>