<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Generic Password Dumper Activity on LSASS</title><id type="str">4a1b6da0-d94f-4fc3-98fc-2d9cb9e5ee76</id><status type="str">experimental</status><description type="str">Detects process handle on LSASS process with certain access mask</description><references type="list"><item type="str">https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html</item><item type="str">https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment</item></references><author type="str">Roberto Rodriguez, Teymur Kheirkhabarov, Dimitrios Slamaris, Mark Russinovich, Aleksey Potapov, oscd.community (update)</author><date type="str">2019/11/01</date><modified type="str">2023/08/03</modified><tags type="list"><item type="str">attack.credential_access</item><item type="str">car.2019-04-004</item><item type="str">attack.t1003.001</item></tags><logsource type="dict"><product type="str">windows</product><service type="str">security</service></logsource><detection type="dict"><selection_1 type="dict"><EventID type="int">4656</EventID><key name="ObjectName|endswith" type="str">\lsass.exe</key><key name="AccessMask|contains" type="list"><item type="str">0x40</item><item type="str">0x1400</item><item type="str">0x100000</item><item type="str">0x1410</item><item type="str">0x1010</item><item type="str">0x1438</item><item type="str">0x143a</item><item type="str">0x1418</item><item type="str">0x1f0fff</item><item type="str">0x1f1fff</item><item type="str">0x1f2fff</item><item type="str">0x1f3fff</item></key></selection_1><selection_2 type="dict"><EventID type="int">4663</EventID><key name="ObjectName|endswith" type="str">\lsass.exe</key><key name="AccessList|contains" type="list"><item type="str">4484</item><item type="str">4416</item></key></selection_2><filter_specific type="dict"><key name="ProcessName|endswith" type="list"><item type="str">\csrss.exe</item><item type="str">\GamingServices.exe</item><item type="str">\lsm.exe</item><item type="str">\MicrosoftEdgeUpdate.exe</item><item type="str">\minionhost.exe</item><item type="str">\MRT.exe</item><item type="str">\MsMpEng.exe</item><item type="str">\perfmon.exe</item><item type="str">\procexp.exe</item><item type="str">\procexp64.exe</item><item type="str">\svchost.exe</item><item type="str">\taskmgr.exe</item><item type="str">\thor.exe</item><item type="str">\thor64.exe</item><item type="str">\vmtoolsd.exe</item><item type="str">\VsTskMgr.exe</item><item type="str">\wininit.exe</item><item type="str">\wmiprvse.exe</item><item type="str">RtkAudUService64</item></key><key name="ProcessName|startswith" type="list"><item type="str">C:\Program Files (x86)\</item><item type="str">C:\Program Files\</item><item type="str">C:\ProgramData\Microsoft\Windows Defender\Platform\</item><item type="str">C:\Windows\SysNative\</item><item type="str">C:\Windows\System32\</item><item type="str">C:\Windows\SysWow64\</item><item type="str">C:\Windows\Temp\asgard2-agent\</item></key></filter_specific><filter_generic type="dict"><key name="ProcessName|startswith" type="str">C:\Program Files</key></filter_generic><filter_exact type="dict"><ProcessName type="list"><item type="str">C:\Windows\System32\taskhostw.exe</item><item type="str">C:\Windows\System32\msiexec.exe</item><item type="str">C:\Windows\CCM\CcmExec.exe</item></ProcessName></filter_exact><filter_sysmon type="dict"><ProcessName type="str">C:\Windows\Sysmon64.exe</ProcessName><key name="AccessList|contains" type="str">%%4484</key></filter_sysmon><filter_aurora type="dict"><key name="ProcessName|startswith" type="str">C:\Windows\Temp\asgard2-agent-sc\aurora\</key><key name="ProcessName|endswith" type="str">\aurora-agent-64.exe</key><key name="AccessList|contains" type="str">%%4484</key></filter_aurora><filter_scenarioengine type="dict"><key name="ProcessName|endswith" type="str">\x64\SCENARIOENGINE.EXE</key><key name="AccessList|contains" type="str">%%4484</key></filter_scenarioengine><filter_avira type="dict"><key name="ProcessName|startswith" type="str">C:\Users\</key><key name="ProcessName|contains" type="str">\AppData\Local\Temp\is-</key><key name="ProcessName|endswith" type="str">\avira_system_speedup.tmp</key><key name="AccessList|contains" type="str">%%4484</key></filter_avira><filter_snmp type="dict"><ProcessName type="str">C:\Windows\System32\snmp.exe</ProcessName><key name="AccessList|contains" type="str">%%4484</key></filter_snmp><condition type="str">1 of selection_* and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Legitimate software accessing LSASS process for legitimate reason; update the whitelist with it</item></falsepositives><level type="str">high</level></root>