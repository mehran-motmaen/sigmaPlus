<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">PSScriptPolicyTest Creation By Uncommon Process</title><id type="str">1027d292-dd87-4a1a-8701-2abe04d7783c</id><status type="str">experimental</status><description type="str">Detects the creation of the &quot;PSScriptPolicyTest&quot; PowerShell script by an uncommon process. This file is usually generated by Microsoft Powershell to test against Applocker.</description><references type="list"><item type="str">https://www.paloaltonetworks.com/blog/security-operations/stopping-powershell-without-powershell/</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/06/01</date><tags type="list"><item type="str">attack.defense_evasion</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">file_event</category></logsource><detection type="dict"><selection type="dict"><key name="TargetFilename|contains" type="str">__PSScriptPolicyTest_</key></selection><filter_main_generic type="dict"><key name="Image|endswith" type="list"><item type="str">:\Program Files\PowerShell\7\pwsh.exe</item><item type="str">:\Windows\System32\dsac.exe</item><item type="str">:\Windows\System32\ServerManager.exe</item><item type="str">:\Windows\System32\WindowsPowerShell\v1.0\powershell_ise.exe</item><item type="str">:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</item><item type="str">:\Windows\System32\wsmprovhost.exe</item><item type="str">:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell_ise.exe</item><item type="str">:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe</item></key></filter_main_generic><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>