<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Tamper Windows Defender Remove-MpPreference - ScriptBlockLogging</title><id type="str">ae2bdd58-0681-48ac-be7f-58ab4e593458</id><related type="list"><item type="dict"><id type="str">07e3cb2c-0608-410d-be4b-1511cb1a0448</id><type type="str">similar</type></item></related><status type="str">experimental</status><description type="str">Detects attempts to remove Windows Defender configuration using the &apos;MpPreference&apos; cmdlet</description><references type="list"><item type="str">https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/windows-10-controlled-folder-access-event-search/ba-p/2326088</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/08/05</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1562.001</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><selection_remove type="dict"><key name="ScriptBlockText|contains" type="str">Remove-MpPreference</key></selection_remove><selection_tamper type="dict"><key name="ScriptBlockText|contains" type="list"><item type="str">-ControlledFolderAccessProtectedFolders </item><item type="str">-AttackSurfaceReductionRules_Ids </item><item type="str">-AttackSurfaceReductionRules_Actions </item><item type="str">-CheckForSignaturesBeforeRunningScan </item></key></selection_tamper><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Legitimate PowerShell scripts</item></falsepositives><level type="str">high</level></root>