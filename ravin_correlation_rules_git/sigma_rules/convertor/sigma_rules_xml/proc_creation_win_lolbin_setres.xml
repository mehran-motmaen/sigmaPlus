<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Use of Setres.exe</title><id type="str">835e75bf-4bfd-47a4-b8a6-b766cac8bcb7</id><status type="str">experimental</status><description type="str">Detects the use of Setres.exe to set the screen resolution and then potentially launch a file named &quot;choice&quot; (with any executable extension such as &quot;.cmd&quot; or &quot;.exe&quot;) from the current execution path</description><references type="list"><item type="str">https://lolbas-project.github.io/lolbas/Binaries/Setres/</item><item type="str">https://twitter.com/0gtweet/status/1583356502340870144</item><item type="str">https://strontic.github.io/xcyclopedia/library/setres.exe-0E30E4C09637D7A128A37B59A3BC4D09.html</item><item type="str">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)</item></references><author type="str">@gott_cyber</author><date type="str">2022/12/11</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1218</item><item type="str">attack.t1202</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="ParentImage|endswith" type="str">\setres.exe</key><key name="Image|endswith" type="str">\choice</key></selection><condition type="str">all of selection*</condition></detection><falsepositives type="list"><item type="str">Legitimate usage of Setres</item></falsepositives><level type="str">medium</level></root>