<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Capture Credentials with Rpcping.exe</title><id type="str">93671f99-04eb-4ab4-a161-70d446a84003</id><status type="str">test</status><description type="str">Detects using Rpcping.exe to send a RPC test connection to the target server (-s) and force the NTLM hash to be sent in the process.</description><references type="list"><item type="str">https://lolbas-project.github.io/lolbas/Binaries/Rpcping/</item><item type="str">https://twitter.com/vysecurity/status/974806438316072960</item><item type="str">https://twitter.com/vysecurity/status/873181705024266241</item><item type="str">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh875578(v=ws.11)</item></references><author type="str">Julia Fomina, oscd.community</author><date type="str">2020/10/09</date><modified type="str">2021/11/27</modified><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1003</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><use_rpcping type="dict"><key name="Image|endswith" type="str">\rpcping.exe</key></use_rpcping><remote_server type="dict"><key name="CommandLine|contains" type="list"><item type="str">-s</item><item type="str">/s</item></key></remote_server><ntlm_auth type="list"><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">-u</item><item type="str">NTLM</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">/u</item><item type="str">NTLM</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">-t</item><item type="str">ncacn_np</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">/t</item><item type="str">ncacn_np</item></key></item></ntlm_auth><condition type="str">use_rpcping and remote_server and ntlm_auth</condition></detection><falsepositives type="list"><item type="str">Unlikely</item></falsepositives><level type="str">medium</level></root>