<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Rename Common File to DLL File</title><id type="str">bbfd974c-248e-4435-8de6-1e938c79c5c1</id><status type="str">experimental</status><description type="str">Detects cases in which a file gets renamed to .dll, which often happens to bypass perimeter protection</description><references type="list"><item type="str">https://twitter.com/ffforward/status/1481672378639912960</item><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1036/T1036.md#atomic-test-1---system-file-copied-to-unusual-location</item></references><author type="str">frack113</author><date type="str">2022/02/19</date><modified type="str">2023/01/02</modified><logsource type="dict"><product type="str">windows</product><category type="str">file_rename</category><definition type="str">Requirements: Microsoft-Windows-Kernel-File Provider with at least the KERNEL_FILE_KEYWORD_RENAME_SETLINK_PATH keyword</definition></logsource><detection type="dict"><to_dll type="dict"><key name="TargetFilename|endswith" type="str">.dll</key></to_dll><filter_from_dll type="list"><item type="dict"><key name="SourceFilename|endswith" type="list"><item type="str">.dll</item><item type="str">.tmp</item></key></item><item type="dict"><key name="SourceFilename|contains" type="list"><item type="str">.dll.</item><item type="str">\SquirrelTemp\temp</item></key></item></filter_from_dll><filter_empty_source type="dict"><SourceFilename type="str"></SourceFilename></filter_empty_source><filter_non_existing_source type="dict"><SourceFilename type="null"></SourceFilename></filter_non_existing_source><filter_tiworker type="dict"><key name="Image|startswith" type="str">C:\Windows\WinSxS\</key><key name="Image|endswith" type="str">\TiWorker.exe</key></filter_tiworker><filter_upgrade type="list"><item type="dict"><Image type="str">C:\Windows\System32\wuauclt.exe</Image></item><item type="dict"><key name="TargetFilename|startswith" type="str">C:\$WINDOWS.~BT\Sources\</key></item></filter_upgrade><filter_program_files type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files (x86)\</item><item type="str">C:\Program Files\</item></key></filter_program_files><condition type="str">to_dll and not 1 of filter*</condition></detection><falsepositives type="list"><item type="str">Application installation</item></falsepositives><level type="str">medium</level></root>