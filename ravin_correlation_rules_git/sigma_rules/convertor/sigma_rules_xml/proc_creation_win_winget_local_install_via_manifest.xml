<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Install New Package Via Winget Local Manifest</title><id type="str">313d6012-51a0-4d93-8dfc-de8553239e25</id><status type="str">experimental</status><description type="str">Detects usage of winget to install applications via manifest file. Adversaries can abuse winget to download payloads remotely and execute them.
The manifest option enables you to install an application by passing in a YAML file directly to the client.
Winget can be used to download and install exe, msi or msix files later.
</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/windows/package-manager/winget/install#local-install</item><item type="str">https://lolbas-project.github.io/lolbas/Binaries/Winget/</item><item type="str">https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget</item></references><author type="str">Sreeman, Florian Roth (Nextron Systems), frack113</author><date type="str">2020/04/21</date><modified type="str">2023/04/17</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.execution</item><item type="str">attack.t1059</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\winget.exe</key></item><item type="dict"><OriginalFileName type="str">winget.exe</OriginalFileName></item></selection_img><selection_install_flag type="dict"><key name="CommandLine|contains" type="list"><item type="str">install</item><item type="str"> add </item></key></selection_install_flag><selection_manifest_flag type="dict"><key name="CommandLine|contains" type="list"><item type="str">-m </item><item type="str">--manifest</item></key></selection_manifest_flag><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Some false positives are expected in some environment that may use this functionality to install and test their custom applications</item></falsepositives><level type="str">medium</level></root>