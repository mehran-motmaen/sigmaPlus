<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Possible PrintNightmare Print Driver Install</title><id type="str">7b33baef-2a75-4ca3-9da4-34f9a15382d8</id><related type="list"><item type="dict"><id type="str">53389db6-ba46-48e3-a94c-e0f2cefe1583</id><type type="str">derived</type></item></related><status type="str">stable</status><description type="str">Detects the remote installation of a print driver which is possible indication of the exploitation of PrintNightmare (CVE-2021-1675).
The occurrence of print drivers being installed remotely via RPC functions should be rare, as print drivers are normally installed locally and or through group policy.
</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-par/93d1915d-4d9f-4ceb-90a7-e8f2a59adc29</item><item type="str">https://github.com/zeek/zeek/blob/691b099de13649d6576c7b9d637f8213ff818832/scripts/base/protocols/dce-rpc/consts.zeek</item><item type="str">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527</item><item type="str">https://github.com/corelight/CVE-2021-1675</item><item type="str">https://old.zeek.org/zeekweek2019/slides/bzar.pdf</item><item type="str">https://www.crowdstrike.com/blog/cve-2021-1678-printer-spooler-relay-security-advisory/</item></references><author type="str">@neu5ron (Nate Guagenti)</author><date type="str">2021/08/23</date><modified type="str">2022/07/07</modified><tags type="list"><item type="str">attack.execution</item><item type="str">cve.2021.1678</item><item type="str">cve.2021.1675</item><item type="str">cve.2021.34527</item></tags><logsource type="dict"><product type="str">zeek</product><service type="str">dce_rpc</service></logsource><detection type="dict"><selection type="dict"><operation type="list"><item type="str">RpcAsyncInstallPrinterDriverFromPackage</item><item type="str">RpcAsyncAddPrintProcessor</item><item type="str">RpcAddPrintProcessor</item><item type="str">RpcAddPrinterDriverEx</item><item type="str">RpcAddPrinterDriver</item><item type="str">RpcAsyncAddPrinterDriver</item></operation></selection><condition type="str">selection</condition></detection><fields type="list"><item type="str">id.orig_h</item><item type="str">id.resp_h</item><item type="str">id.resp_p</item><item type="str">operation</item><item type="str">endpoint</item><item type="str">named_pipe</item><item type="str">uid</item></fields><falsepositives type="list"><item type="str">Legitimate remote alteration of a printer driver.</item></falsepositives><level type="str">medium</level></root>