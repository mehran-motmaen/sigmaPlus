<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Initial Access via DLL Search Order Hijacking</title><id type="str">dbbd9f66-2ed3-4ca2-98a4-6ea985dd1a1c</id><status type="str">experimental</status><description type="str">Detects attempts to create a DLL file to a known desktop application dependencies folder such as Slack, Teams or OneDrive and by an unusual process. This may indicate an attempt to load a malicious module via DLL search order hijacking.</description><author type="str">Tim Rauch (rule), Elastic (idea)</author><references type="list"><item type="str">https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-5d46dd4ac6866b4337ec126be8cee0e115467b3e8703794ba6f6df6432c806bc</item><item type="str">https://posts.specterops.io/automating-dll-hijack-discovery-81c4295904b0</item></references><date type="str">2022/10/21</date><logsource type="dict"><product type="str">windows</product><category type="str">file_event</category></logsource><tags type="list"><item type="str">attack.t1566</item><item type="str">attack.t1566.001</item><item type="str">attack.initial_access</item><item type="str">attack.t1574</item><item type="str">attack.t1574.001</item><item type="str">attack.defense_evasion</item></tags><detection type="dict"><selection type="dict"><key name="Image|endswith" type="list"><item type="str">\winword.exe</item><item type="str">\excel.exe</item><item type="str">\powerpnt.exe</item><item type="str">\MSACCESS.EXE</item><item type="str">\MSPUB.EXE</item><item type="str">\fltldr.exe</item><item type="str">\cmd.exe</item><item type="str">\certutil.exe</item><item type="str">\mshta.exe</item><item type="str">\cscript.exe</item><item type="str">\wscript.exe</item><item type="str">\curl.exe</item><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key><key name="TargetFilename|endswith" type="str">.dll</key><key name="TargetFilename|contains|all" type="list"><item type="str">\Users\</item><item type="str">\AppData\</item></key><key name="TargetFilename|contains" type="list"><item type="str">\Microsoft\OneDrive\</item><item type="str">\Microsoft OneDrive\</item><item type="str">\Microsoft\Teams\</item><item type="str">\Local\slack\app-</item><item type="str">\Local\Programs\Microsoft VS Code\</item></key></selection><filter type="dict"><key name="Image|endswith" type="str">\cmd.exe</key><key name="TargetFilename|contains|all" type="list"><item type="str">\Users\</item><item type="str">\AppData\</item><item type="str">\Microsoft\OneDrive\</item><item type="str">\api-ms-win-core-</item></key></filter><condition type="str">selection and not filter</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>