<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Possible Privilege Escalation via Weak Service Permissions</title><id type="str">d937b75f-a665-4480-88a5-2f20e9f9b22a</id><status type="str">test</status><description type="str">Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand</description><references type="list"><item type="str">https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment</item><item type="str">https://pentestlab.blog/2017/03/30/weak-service-permissions/</item></references><author type="str">Teymur Kheirkhabarov</author><date type="str">2019/10/26</date><modified type="str">2022/07/14</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.defense_evasion</item><item type="str">attack.privilege_escalation</item><item type="str">attack.t1574.011</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><scbynonadmin type="dict"><key name="Image|endswith" type="str">\sc.exe</key><IntegrityLevel type="str">Medium</IntegrityLevel></scbynonadmin><selection_binpath type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">config</item><item type="str">binPath</item></key></selection_binpath><selection_failure type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">failure</item><item type="str">command</item></key></selection_failure><condition type="str">scbynonadmin and 1 of selection_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>