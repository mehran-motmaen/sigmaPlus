<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Log4j RCE CVE-2021-44228 in Fields</title><id type="str">9be472ed-893c-4ec0-94da-312d2765f654</id><status type="str">experimental</status><description type="str">Detects exploitation attempt against log4j RCE vulnerability reported as CVE-2021-44228 in different header fields found in web server logs (Log4Shell)</description><references type="list"><item type="str">https://www.lunasec.io/docs/blog/log4j-zero-day/</item><item type="str">https://news.ycombinator.com/item?id=29504755</item><item type="str">https://github.com/tangxiaofeng7/apache-log4j-poc</item><item type="str">https://gist.github.com/Neo23x0/e4c8b03ff8cdf1fa63b7d15db6e3860b</item><item type="str">https://github.com/YfryTchsGD/Log4jAttackSurface</item><item type="str">https://twitter.com/shutingrz/status/1469255861394866177?s=21</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2021/12/10</date><modified type="str">2023/01/02</modified><tags type="list"><item type="str">attack.initial_access</item><item type="str">attack.t1190</item><item type="str">cve.2021.44228</item><item type="str">detection.emerging_threats</item></tags><logsource type="dict"><category type="str">webserver</category></logsource><detection type="dict"><selection1 type="dict"><key name="cs-user-agent|contains" type="list"><item type="str">${jndi:ldap:/</item><item type="str">${jndi:rmi:/</item><item type="str">${jndi:ldaps:/</item><item type="str">${jndi:dns:/</item><item type="str">/$%7bjndi:</item><item type="str">%24%7bjndi:</item><item type="str">$%7Bjndi:</item><item type="str">%2524%257Bjndi</item><item type="str">%2F%252524%25257Bjndi%3A</item><item type="str">${jndi:${lower:</item><item type="str">${::-j}${</item><item type="str">${jndi:nis</item><item type="str">${jndi:nds</item><item type="str">${jndi:corba</item><item type="str">${jndi:iiop</item><item type="str">Reference Class Name: foo</item><item type="str">${${env:BARFOO:-j}</item><item type="str">${::-l}${::-d}${::-a}${::-p}</item><item type="str">${base64:JHtqbmRp</item><item type="str">${${env:ENV_NAME:-j}ndi${env:ENV_NAME:-:}$</item><item type="str">${${lower:j}ndi:</item><item type="str">${${upper:j}ndi:</item><item type="str">${${::-j}${::-n}${::-d}${::-i}:</item></key></selection1><selection3 type="dict"><key name="cs-uri-query|contains" type="list"><item type="str">${jndi:ldap:/</item><item type="str">${jndi:rmi:/</item><item type="str">${jndi:ldaps:/</item><item type="str">${jndi:dns:/</item><item type="str">/$%7bjndi:</item><item type="str">%24%7bjndi:</item><item type="str">$%7Bjndi:</item><item type="str">%2524%257Bjndi</item><item type="str">%2F%252524%25257Bjndi%3A</item><item type="str">${jndi:${lower:</item><item type="str">${::-j}${</item><item type="str">${jndi:nis</item><item type="str">${jndi:nds</item><item type="str">${jndi:corba</item><item type="str">${jndi:iiop</item><item type="str">Reference Class Name: foo</item><item type="str">${${env:BARFOO:-j}</item><item type="str">${::-l}${::-d}${::-a}${::-p}</item><item type="str">${base64:JHtqbmRp</item><item type="str">${${env:ENV_NAME:-j}ndi${env:ENV_NAME:-:}$</item><item type="str">${${lower:j}ndi:</item><item type="str">${${upper:j}ndi:</item><item type="str">${${::-j}${::-n}${::-d}${::-i}:</item></key></selection3><selection4 type="dict"><key name="cs-referer|contains" type="list"><item type="str">${jndi:ldap:/</item><item type="str">${jndi:rmi:/</item><item type="str">${jndi:ldaps:/</item><item type="str">${jndi:dns:/</item><item type="str">/$%7bjndi:</item><item type="str">%24%7bjndi:</item><item type="str">$%7Bjndi:</item><item type="str">%2524%257Bjndi</item><item type="str">%2F%252524%25257Bjndi%3A</item><item type="str">${jndi:${lower:</item><item type="str">${::-j}${</item><item type="str">${jndi:nis</item><item type="str">${jndi:nds</item><item type="str">${jndi:corba</item><item type="str">${jndi:iiop</item><item type="str">Reference Class Name: foo</item><item type="str">${${env:BARFOO:-j}</item><item type="str">${::-l}${::-d}${::-a}${::-p}</item><item type="str">${base64:JHtqbmRp</item><item type="str">${${env:ENV_NAME:-j}ndi${env:ENV_NAME:-:}$</item><item type="str">${${lower:j}ndi:</item><item type="str">${${upper:j}ndi:</item><item type="str">${${::-j}${::-n}${::-d}${::-i}:</item></key></selection4><condition type="str">1 of selection*</condition></detection><falsepositives type="list"><item type="str">Vulnerability scanning</item></falsepositives><level type="str">high</level></root>