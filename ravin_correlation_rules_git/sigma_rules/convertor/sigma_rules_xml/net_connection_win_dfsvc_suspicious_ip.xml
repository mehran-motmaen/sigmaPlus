<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Dfsvc.EXE Network Connection To Non-Local IPs</title><id type="str">3c21219b-49b5-4268-bce6-c914ed50f09c</id><status type="str">experimental</status><description type="str">Detects network connections from &quot;dfsvc.exe&quot; used to handled ClickOnce applications to non-local IPs</description><references type="list"><item type="str">https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/06/12</date><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1203</item><item type="str">detection.threat_hunting</item></tags><logsource type="dict"><category type="str">network_connection</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="str">\dfsvc.exe</key><Initiated type="str">true</Initiated></selection><filter_main_local_ipv4 type="dict"><key name="DestinationIp|startswith" type="list"><item type="str">10.</item><item type="str">127.0.0.1</item><item type="str">172.16.</item><item type="str">172.17.</item><item type="str">172.18.</item><item type="str">172.19.</item><item type="str">172.20.</item><item type="str">172.21.</item><item type="str">172.22.</item><item type="str">172.23.</item><item type="str">172.24.</item><item type="str">172.25.</item><item type="str">172.26.</item><item type="str">172.27.</item><item type="str">172.28.</item><item type="str">172.29.</item><item type="str">172.30.</item><item type="str">172.31.</item><item type="str">192.168.</item></key></filter_main_local_ipv4><filter_main_local_ipv6 type="dict"><key name="DestinationIp|startswith" type="list"><item type="str">::1</item><item type="str">0:0:0:0:0:0:0:1</item><item type="str">fc</item><item type="str">fd</item><item type="str">fe80:</item></key></filter_main_local_ipv6><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">False positives are expected from ClickOnce manifests hosted on public IPs and domains. Apply additional filters for the accepted IPs in your environement as necessary</item></falsepositives><level type="str">medium</level></root>