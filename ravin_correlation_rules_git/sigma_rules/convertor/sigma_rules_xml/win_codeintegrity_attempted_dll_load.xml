<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">CodeIntegrity - Unmet Signing Level Requirements By File Under Validation</title><id type="str">f8931561-97f5-4c46-907f-0a4a592e47a7</id><status type="str">experimental</status><description type="str">Detects attempted file load events that did not meet the signing level requirements. It often means the file&apos;s signature is revoked or a signature with the Lifetime Signing EKU has expired.
This event is best correlated with EID 3089 to determine the error of the validation.
</description><references type="list"><item type="str">https://twitter.com/SBousseaden/status/1483810148602814466</item><item type="str">https://github.com/MicrosoftDocs/windows-itpro-docs/blob/40fe118976734578f83e5e839b9c63ae7a4af82d/windows/security/threat-protection/windows-defender-application-control/event-id-explanations.md#windows-codeintegrity-operational-log</item><item type="str">https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/event-tag-explanations</item><item type="str">https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/event-id-explanations</item></references><author type="str">Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/01/20</date><modified type="str">2023/07/25</modified><tags type="list"><item type="str">attack.execution</item></tags><logsource type="dict"><product type="str">windows</product><service type="str">codeintegrity-operational</service></logsource><detection type="dict"><selection type="dict"><EventID type="list"><item type="int">3033</item><item type="int">3034</item></EventID></selection><filter_optional_dtrace type="dict"><key name="FileNameBuffer|endswith" type="str">\Program Files\DTrace\dtrace.dll</key><key name="ProcessNameBuffer|endswith" type="str">\Windows\System32\svchost.exe</key><RequestedPolicy type="int">12</RequestedPolicy></filter_optional_dtrace><filter_optional_av_generic type="dict"><key name="FileNameBuffer|contains" type="str">\Windows\System32\DriverStore\FileRepository\</key><key name="FileNameBuffer|endswith" type="str">\igd10iumd64.dll</key><RequestedPolicy type="int">7</RequestedPolicy></filter_optional_av_generic><filter_optional_electron_based_app type="dict"><key name="FileNameBuffer|endswith" type="str">\Windows\System32\nvspcap64.dll</key><key name="ProcessNameBuffer|endswith" type="list"><item type="str">\AppData\Local\Keybase\Gui\Keybase.exe</item><item type="str">\Microsoft\Teams\stage\Teams.exe</item></key><RequestedPolicy type="int">8</RequestedPolicy></filter_optional_electron_based_app><filter_optional_bonjour type="dict"><key name="FileNameBuffer|endswith" type="str">\Program Files\Bonjour\mdnsNSP.dll</key><key name="ProcessNameBuffer|endswith" type="list"><item type="str">\Windows\System32\svchost.exe</item><item type="str">\Windows\System32\SIHClient.exe</item></key><RequestedPolicy type="list"><item type="int">8</item><item type="int">12</item></RequestedPolicy></filter_optional_bonjour><filter_optional_msoffice type="dict"><key name="FileNameBuffer|contains" type="str">\Microsoft Office\root\vfs\ProgramFilesCommonX64\Microsoft Shared\OFFICE</key><key name="FileNameBuffer|endswith" type="str">\MSOXMLMF.DLL</key><RequestedPolicy type="int">7</RequestedPolicy></filter_optional_msoffice><filter_optional_slack type="dict"><key name="FileNameBuffer|endswith" type="str">\Windows\System32\nvspcap64.dll</key><key name="ProcessNameBuffer|contains" type="str">\AppData\Local\slack\app-</key><key name="ProcessNameBuffer|endswith" type="str">\slack.exe</key><RequestedPolicy type="int">8</RequestedPolicy></filter_optional_slack><filter_optional_firefox type="dict"><key name="FileNameBuffer|endswith" type="list"><item type="str">\Mozilla Firefox\mozavcodec.dll</item><item type="str">\Mozilla Firefox\mozavutil.dll</item></key><key name="ProcessNameBuffer|endswith" type="str">\Mozilla Firefox\firefox.exe</key><RequestedPolicy type="int">8</RequestedPolicy></filter_optional_firefox><filter_optional_avast type="dict"><key name="FileNameBuffer|endswith" type="list"><item type="str">\Program Files\Avast Software\Avast\aswAMSI.dll</item><item type="str">\Program Files (x86)\Avast Software\Avast\aswAMSI.dll</item></key><RequestedPolicy type="list"><item type="int">8</item><item type="int">12</item></RequestedPolicy></filter_optional_avast><filter_main_gac type="dict"><key name="FileNameBuffer|contains" type="str">\Windows\assembly\GAC\</key><key name="ProcessNameBuffer|endswith" type="str">\mscorsvw.exe</key><key name="ProcessNameBuffer|contains" type="str">\Windows\Microsoft.NET\</key><RequestedPolicy type="int">8</RequestedPolicy></filter_main_gac><filter_optional_google_drive type="dict"><key name="FileNameBuffer|contains" type="str">\Program Files\Google\Drive File Stream\</key><key name="FileNameBuffer|endswith" type="str">\crashpad_handler.exe</key><key name="ProcessNameBuffer|endswith" type="str">\Windows\ImmersiveControlPanel\SystemSettings.exe</key><RequestedPolicy type="int">8</RequestedPolicy></filter_optional_google_drive><filter_optional_trend_micro type="dict"><key name="FileNameBuffer|endswith" type="str">\Trend Micro\Client Server Security Agent\perficrcperfmonmgr.dll</key><RequestedPolicy type="int">8</RequestedPolicy></filter_optional_trend_micro><filter_optional_mdns_responder type="dict"><key name="FileNameBuffer|endswith" type="str">\Program Files\National Instruments\Shared\mDNS Responder\nimdnsNSP.dll </key></filter_optional_mdns_responder><filter_optional_mcafee type="dict"><key name="FileNameBuffer|endswith" type="list"><item type="str">\Program Files\McAfee\Endpoint Security\Threat Prevention\MfeAmsiProvider.dll</item><item type="str">\Program Files\McAfee\MfeAV\AMSIExt.dll</item></key></filter_optional_mcafee><filter_optional_eset type="dict"><key name="FileNameBuffer|endswith" type="str">\Program Files\ESET\ESET Security\eamsi.dll</key></filter_optional_eset><condition type="str">selection and not 1 of filter_main_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Antivirus and other third party products are known to trigger this rule quite a lot. Initial filters and tuning is required before using this rule.</item></falsepositives><level type="str">medium</level></root>