<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">PowerShell Base64 Encoded WMI Classes</title><id type="str">1816994b-42e1-4fb1-afd2-134d88184f71</id><related type="list"><item type="dict"><id type="str">47688f1b-9f51-4656-b013-3cc49a166a36</id><type type="str">obsoletes</type></item></related><status type="str">experimental</status><description type="str">Detects calls to base64 encoded WMI class such as &quot;Win32_Shadowcopy&quot;, &quot;Win32_ScheduledJob&quot;, etc.</description><references type="list"><item type="str">https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/mal_revil.yar</item></references><author type="str">Christian Burkard (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/01/30</date><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item><item type="str">attack.defense_evasion</item><item type="str">attack.t1027</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">PowerShell.EXE</item><item type="str">pwsh.dll</item></OriginalFileName></item></selection_img><selection_cli_shadowcopy type="dict"><key name="CommandLine|contains" type="list"><item type="str">VwBpAG4AMwAyAF8AUwBoAGEAZABvAHcAYwBvAHAAeQ</item><item type="str">cAaQBuADMAMgBfAFMAaABhAGQAbwB3AGMAbwBwAHkA</item><item type="str">XAGkAbgAzADIAXwBTAGgAYQBkAG8AdwBjAG8AcAB5A</item><item type="str">V2luMzJfU2hhZG93Y29we</item><item type="str">dpbjMyX1NoYWRvd2NvcH</item><item type="str">XaW4zMl9TaGFkb3djb3B5</item></key></selection_cli_shadowcopy><selection_cli_scheduledJob type="dict"><key name="CommandLine|contains" type="list"><item type="str">VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQASgBvAGIA</item><item type="str">cAaQBuADMAMgBfAFMAYwBoAGUAZAB1AGwAZQBkAEoAbwBiA</item><item type="str">XAGkAbgAzADIAXwBTAGMAaABlAGQAdQBsAGUAZABKAG8AYg</item><item type="str">V2luMzJfU2NoZWR1bGVkSm9i</item><item type="str">dpbjMyX1NjaGVkdWxlZEpvY</item><item type="str">XaW4zMl9TY2hlZHVsZWRKb2</item></key></selection_cli_scheduledJob><selection_cli_process type="dict"><key name="CommandLine|contains" type="list"><item type="str">VwBpAG4AMwAyAF8AUAByAG8AYwBlAHMAcw</item><item type="str">cAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMA</item><item type="str">XAGkAbgAzADIAXwBQAHIAbwBjAGUAcwBzA</item><item type="str">V2luMzJfUHJvY2Vzc</item><item type="str">dpbjMyX1Byb2Nlc3</item><item type="str">XaW4zMl9Qcm9jZXNz</item></key></selection_cli_process><selection_cli_useraccount type="dict"><key name="CommandLine|contains" type="list"><item type="str">VwBpAG4AMwAyAF8AVQBzAGUAcgBBAGMAYwBvAHUAbgB0A</item><item type="str">cAaQBuADMAMgBfAFUAcwBlAHIAQQBjAGMAbwB1AG4AdA</item><item type="str">XAGkAbgAzADIAXwBVAHMAZQByAEEAYwBjAG8AdQBuAHQA</item><item type="str">V2luMzJfVXNlckFjY291bn</item><item type="str">dpbjMyX1VzZXJBY2NvdW50</item><item type="str">XaW4zMl9Vc2VyQWNjb3Vud</item></key></selection_cli_useraccount><selection_cli_loggedonuser type="dict"><key name="CommandLine|contains" type="list"><item type="str">VwBpAG4AMwAyAF8ATABvAGcAZwBlAGQATwBuAFUAcwBlAHIA</item><item type="str">cAaQBuADMAMgBfAEwAbwBnAGcAZQBkAE8AbgBVAHMAZQByA</item><item type="str">XAGkAbgAzADIAXwBMAG8AZwBnAGUAZABPAG4AVQBzAGUAcg</item><item type="str">V2luMzJfTG9nZ2VkT25Vc2Vy</item><item type="str">dpbjMyX0xvZ2dlZE9uVXNlc</item><item type="str">XaW4zMl9Mb2dnZWRPblVzZX</item></key></selection_cli_loggedonuser><condition type="str">selection_img and 1 of selection_cli_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>