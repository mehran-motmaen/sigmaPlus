<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">LSASS Access From Program in Potentially Suspicious Folder</title><id type="str">fa34b441-961a-42fa-a100-ecc28c886725</id><status type="str">experimental</status><description type="str">Detects process access to LSASS memory with suspicious access flags and from a potentially suspicious folder</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights</item><item type="str">https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&amp;ithint=file%2cpptx&amp;app=PowerPoint&amp;authkey=!AMvCRTKB_V1J5ow</item><item type="str">https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html</item><item type="str">https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment</item><item type="str">http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2021/11/27</date><modified type="str">2023/05/05</modified><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1003.001</item><item type="str">attack.s0002</item></tags><logsource type="dict"><category type="str">process_access</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="TargetImage|endswith" type="str">\lsass.exe</key><key name="GrantedAccess|endswith" type="list"><item type="str">10</item><item type="str">30</item><item type="str">50</item><item type="str">70</item><item type="str">90</item><item type="str">B0</item><item type="str">D0</item><item type="str">F0</item><item type="str">18</item><item type="str">38</item><item type="str">58</item><item type="str">78</item><item type="str">98</item><item type="str">B8</item><item type="str">D8</item><item type="str">F8</item><item type="str">1A</item><item type="str">3A</item><item type="str">5A</item><item type="str">7A</item><item type="str">9A</item><item type="str">BA</item><item type="str">DA</item><item type="str">FA</item><item type="str">0x14C2</item><item type="str">FF</item></key><key name="SourceImage|contains" type="list"><item type="str">\Temp\</item><item type="str">\Users\Public\</item><item type="str">\PerfLogs\</item><item type="str">\AppData\</item><item type="str">\Temporary</item></key></selection><filter_optional_generic_appdata type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|contains" type="str">\AppData\Local\</key><key name="SourceImage|endswith" type="list"><item type="str">\Microsoft VS Code\Code.exe</item><item type="str">\software_reporter_tool.exe</item><item type="str">\DropboxUpdate.exe</item><item type="str">\MBAMInstallerService.exe</item><item type="str">\WebexMTA.exe</item><item type="str">\WebEx\WebexHost.exe</item><item type="str">\JetBrains\Toolbox\bin\jetbrains-toolbox.exe</item></key><GrantedAccess type="str">0x410</GrantedAccess></filter_optional_generic_appdata><filter_optional_dropbox_1 type="dict"><key name="SourceImage|startswith" type="str">C:\Windows\Temp\</key><key name="SourceImage|endswith" type="str">.tmp\DropboxUpdate.exe</key><GrantedAccess type="list"><item type="str">0x410</item><item type="str">0x1410</item></GrantedAccess></filter_optional_dropbox_1><filter_optional_dropbox_2 type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|contains" type="str">\AppData\Local\Temp\</key><key name="SourceImage|endswith" type="str">.tmp\DropboxUpdate.exe</key><GrantedAccess type="str">0x1410</GrantedAccess></filter_optional_dropbox_2><filter_optional_dropbox_3 type="dict"><key name="SourceImage|startswith" type="list"><item type="str">C:\Program Files (x86)\Dropbox\</item><item type="str">C:\Program Files\Dropbox\</item></key><key name="SourceImage|endswith" type="str">\DropboxUpdate.exe</key><GrantedAccess type="str">0x1410</GrantedAccess></filter_optional_dropbox_3><filter_optional_nextron type="dict"><key name="SourceImage|startswith" type="list"><item type="str">C:\Windows\Temp\asgard2-agent\</item><item type="str">C:\Windows\Temp\asgard2-agent-sc\</item></key><key name="SourceImage|endswith" type="list"><item type="str">\thor64.exe</item><item type="str">\thor.exe</item><item type="str">\aurora-agent-64.exe</item><item type="str">\aurora-agent.exe</item></key><GrantedAccess type="list"><item type="str">0x1fffff</item><item type="str">0x1010</item><item type="str">0x101010</item></GrantedAccess></filter_optional_nextron><filter_optional_ms_products type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|contains|all" type="list"><item type="str">\AppData\Local\Temp\</item><item type="str">\vs_bootstrapper_</item></key><GrantedAccess type="str">0x1410</GrantedAccess></filter_optional_ms_products><filter_optional_chrome_update type="dict"><key name="SourceImage|startswith" type="str">C:\Program Files (x86)\Google\Temp\</key><key name="SourceImage|endswith" type="str">.tmp\GoogleUpdate.exe</key><GrantedAccess type="list"><item type="str">0x410</item><item type="str">0x1410</item></GrantedAccess></filter_optional_chrome_update><filter_optional_keybase type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|endswith" type="str">\AppData\Local\Keybase\keybase.exe</key><GrantedAccess type="str">0x1fffff</GrantedAccess></filter_optional_keybase><filter_optional_avira type="dict"><key name="SourceImage|contains" type="str">\AppData\Local\Temp\is-</key><key name="SourceImage|endswith" type="str">.tmp\avira_system_speedup.tmp</key><GrantedAccess type="str">0x1410</GrantedAccess></filter_optional_avira><filter_optional_viberpc_updater type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|contains" type="str">\AppData\Roaming\ViberPC\</key><key name="SourceImage|endswith" type="str">\updater.exe</key><key name="TargetImage|endswith" type="str">\winlogon.exe</key><GrantedAccess type="str">0x1fffff</GrantedAccess></filter_optional_viberpc_updater><filter_optional_adobe_arm_helper type="dict"><key name="SourceImage|startswith" type="list"><item type="str">C:\Program Files\Common Files\Adobe\ARM\</item><item type="str">C:\Program Files (x86)\Common Files\Adobe\ARM\</item></key><key name="SourceImage|endswith" type="str">\AdobeARMHelper.exe</key><GrantedAccess type="str">0x1410</GrantedAccess></filter_optional_adobe_arm_helper><condition type="str">selection and not 1 of filter_optional_*</condition></detection><fields type="list"><item type="str">User</item><item type="str">SourceImage</item><item type="str">GrantedAccess</item></fields><falsepositives type="list"><item type="str">Updaters and installers are typical false positives. Apply custom filters depending on your environment</item></falsepositives><level type="str">medium</level></root>