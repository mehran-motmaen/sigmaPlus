<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Change PowerShell Policies to an Insecure Level - PowerShell</title><id type="str">61d0475c-173f-4844-86f7-f3eebae1c66b</id><related type="list"><item type="dict"><id type="str">cf2e938e-9a3e-4fe8-a347-411642b28a9f</id><type type="str">similar</type></item><item type="dict"><id type="str">87e3c4e8-a6a8-4ad9-bb4f-46e7ff99a180</id><type type="str">similar</type></item><item type="dict"><id type="str">fad91067-08c5-4d1a-8d8c-d96a21b37814</id><type type="str">similar</type></item></related><status type="str">experimental</status><description type="str">Detects use of Set-ExecutionPolicy to set insecure policies</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.1</item><item type="str">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.1</item><item type="str">https://adsecurity.org/?p=2604</item></references><author type="str">frack113</author><date type="str">2021/10/20</date><modified type="str">2022/12/30</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><cmdlet type="dict"><key name="ScriptBlockText|contains" type="str">Set-ExecutionPolicy</key></cmdlet><option type="dict"><key name="ScriptBlockText|contains" type="list"><item type="str">Unrestricted</item><item type="str">bypass</item><item type="str">RemoteSigned</item></key></option><filter type="dict"><key name="ScriptBlockText|contains" type="list"><item type="str">(New-Object System.Net.WebClient).DownloadString(&apos;https://community.chocolatey.org/install.ps1&apos;)</item><item type="str">(New-Object System.Net.WebClient).DownloadString(&apos;https://chocolatey.org/install.ps1&apos;)</item><item type="str">\AppData\Roaming\Code\</item></key></filter><condition type="str">cmdlet and option and not filter</condition></detection><falsepositives type="list"><item type="str">Administrator script</item></falsepositives><level type="str">medium</level></root>