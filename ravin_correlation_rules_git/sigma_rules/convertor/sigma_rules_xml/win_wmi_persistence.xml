<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">WMI Persistence</title><id type="str">0b7889b4-5577-4521-a60a-3376ee7f9f7b</id><status type="str">test</status><description type="str">Detects suspicious WMI event filter and command line event consumer based on WMI and Security Logs.</description><references type="list"><item type="str">https://twitter.com/mattifestation/status/899646620148539397</item><item type="str">https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/</item></references><author type="str">Florian Roth (Nextron Systems), Gleb Sukhodolskiy, Timur Zinniatullin oscd.community</author><date type="str">2017/08/22</date><modified type="str">2022/02/10</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.privilege_escalation</item><item type="str">attack.t1546.003</item></tags><logsource type="dict"><product type="str">windows</product><service type="str">wmi</service><definition type="str">WMI Namespaces Auditing and SACL should be configured, EventID 5861 and 5859 detection requires Windows 10, 2012 and higher</definition></logsource><detection type="dict"><wmi_filter_to_consumer_binding type="dict"><EventID type="int">5861</EventID></wmi_filter_to_consumer_binding><consumer_keywords type="list"><item type="str">ActiveScriptEventConsumer</item><item type="str">CommandLineEventConsumer</item><item type="str">CommandLineTemplate</item></consumer_keywords><wmi_filter_registration type="dict"><EventID type="int">5859</EventID></wmi_filter_registration><filter_scmevent type="dict"><Provider type="str">SCM Event Provider</Provider><Query type="str">select * from MSFT_SCMEventLogEvent</Query><User type="str">S-1-5-32-544</User><PossibleCause type="str">Permanent</PossibleCause></filter_scmevent><condition type="str">( (wmi_filter_to_consumer_binding and consumer_keywords) or (wmi_filter_registration) ) and not filter_scmevent</condition></detection><falsepositives type="list"><item type="str">Unknown (data set is too small; further testing needed)</item></falsepositives><level type="str">medium</level></root>