<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">VsCode Child Process Anomaly</title><id type="str">5a3164f2-b373-4152-93cf-090b13c12d27</id><status type="str">experimental</status><description type="str">Detects uncommon or suspicious child processes spawning from a VsCode &quot;code.exe&quot; process. This could indicate an attempt of persistence via VsCode tasks or terminal profiles.</description><references type="list"><item type="str">https://twitter.com/nas_bench/status/1618021838407495681</item><item type="str">https://twitter.com/nas_bench/status/1618021415852335105</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/01/26</date><tags type="list"><item type="str">attack.execution</item><item type="str">attack.defense_evasion</item><item type="str">attack.t1218</item><item type="str">attack.t1202</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_parent type="dict"><key name="ParentImage|endswith" type="str">\code.exe</key></selection_parent><selection_children_images type="dict"><key name="Image|endswith" type="list"><item type="str">\calc.exe</item><item type="str">\regsvr32.exe</item><item type="str">\rundll32.exe</item><item type="str">\cscript.exe</item><item type="str">\wscript.exe</item></key></selection_children_images><selection_children_cli type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item><item type="str">\cmd.exe</item></key><key name="CommandLine|contains" type="list"><item type="str">Invoke-Expressions</item><item type="str">IEX</item><item type="str">Invoke-Command</item><item type="str">ICM</item><item type="str">DownloadString</item><item type="str">rundll32</item><item type="str">regsvr32</item><item type="str">wscript</item><item type="str">cscript</item></key></selection_children_cli><selection_children_paths type="dict"><key name="Image|contains" type="list"><item type="str">C:\Users\Public\</item><item type="str">C:\Windows\Temp\</item><item type="str">C:\Temp\</item></key></selection_children_paths><condition type="str">selection_parent and 1 of selection_children_*</condition></detection><falsepositives type="list"><item type="str">In development environment where VsCode is used heavily. False positives may occur when developers use task to compile or execute different types of code. Remove or add processes accordingly</item></falsepositives><level type="str">medium</level></root>