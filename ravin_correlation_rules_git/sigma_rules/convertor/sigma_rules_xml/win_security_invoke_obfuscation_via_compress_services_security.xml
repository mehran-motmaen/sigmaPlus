<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Invoke-Obfuscation COMPRESS OBFUSCATION - Security</title><id type="str">7a922f1b-2635-4d6c-91ef-af228b198ad3</id><related type="list"><item type="dict"><id type="str">175997c5-803c-4b08-8bb0-70b099f47595</id><type type="str">derived</type></item></related><status type="str">experimental</status><description type="str">Detects Obfuscated Powershell via COMPRESS OBFUSCATION</description><references type="list"><item type="str">https://github.com/SigmaHQ/sigma/issues/1009</item></references><author type="str">Timur Zinniatullin, oscd.community</author><date type="str">2020/10/18</date><modified type="str">2022/11/29</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1027</item><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><product type="str">windows</product><service type="str">security</service><definition type="str">The &apos;System Security Extension&apos; audit subcategory need to be enabled to log the EID 4697</definition></logsource><detection type="dict"><selection type="dict"><EventID type="int">4697</EventID><key name="ServiceFileName|contains|all" type="list"><item type="str">new-object</item><item type="str">text.encoding]::ascii</item><item type="str">readtoend</item></key><key name="ServiceFileName|contains" type="list"><item type="str">system.io.compression.deflatestream</item><item type="str">system.io.streamreader</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>