<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Microsoft Office Child Process</title><id type="str">438025f9-5856-4663-83f7-52f878a70a50</id><related type="list"><item type="dict"><id type="str">c27515df-97a9-4162-8a60-dc0eeb51b775</id><type type="str">derived</type></item><item type="dict"><id type="str">e1693bc8-7168-4eab-8718-cdcaa68a1738</id><type type="str">derived</type></item><item type="dict"><id type="str">23daeb52-e6eb-493c-8607-c4f0246cb7d8</id><type type="str">obsoletes</type></item><item type="dict"><id type="str">518643ba-7d9c-4fa5-9f37-baed36059f6a</id><type type="str">obsoletes</type></item><item type="dict"><id type="str">04f5363a-6bca-42ff-be70-0d28bf629ead</id><type type="str">obsoletes</type></item></related><status type="str">test</status><description type="str">Detects a suspicious process spawning from one of the Microsoft Office suite products (Word, Excel, PowerPoint, Publisher, Visio, etc.)</description><references type="list"><item type="str">https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100</item><item type="str">https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html</item><item type="str">https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/</item><item type="str">https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e</item><item type="str">https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml</item><item type="str">https://github.com/splunk/security_content/blob/develop/detections/endpoint/office_spawning_control.yml</item><item type="str">https://twitter.com/andythevariable/status/1576953781581144064?s=20&amp;t=QiJILvK4ZiBdR8RJe24u-A</item><item type="str">https://www.elastic.co/security-labs/exploring-the-ref2731-intrusion-set</item><item type="str">https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/defense_evasion_execution_msbuild_started_by_office_app.toml</item><item type="str">https://www.vmray.com/analyses/2d2fa29185ad/report/overview.html</item><item type="str">https://app.any.run/tasks/c903e9c8-0350-440c-8688-3881b556b8e0/</item></references><author type="str">Florian Roth (Nextron Systems), Markus Neis, FPT.EagleEye Team, Vadim Khrykov, Cyb3rEng, Michael Haag, Christopher Peacock @securepeacock, @scythe_io</author><date type="str">2018/04/06</date><modified type="str">2023/04/24</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.execution</item><item type="str">attack.t1047</item><item type="str">attack.t1204.002</item><item type="str">attack.t1218.010</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_parent type="dict"><key name="ParentImage|endswith" type="list"><item type="str">\EQNEDT32.EXE</item><item type="str">\EXCEL.EXE</item><item type="str">\MSACCESS.EXE</item><item type="str">\MSPUB.exe</item><item type="str">\ONENOTE.EXE</item><item type="str">\POWERPNT.exe</item><item type="str">\VISIO.exe</item><item type="str">\WINWORD.EXE</item><item type="str">\wordpad.exe</item><item type="str">\wordview.exe</item></key></selection_parent><selection_child_processes type="list"><item type="dict"><OriginalFileName type="list"><item type="str">bitsadmin.exe</item><item type="str">CertOC.exe</item><item type="str">CertUtil.exe</item><item type="str">Cmd.Exe</item><item type="str">CMSTP.EXE</item><item type="str">cscript.exe</item><item type="str">curl.exe</item><item type="str">HH.exe</item><item type="str">IEExec.exe</item><item type="str">InstallUtil.exe</item><item type="str">javaw.exe</item><item type="str">Microsoft.Workflow.Compiler.exe</item><item type="str">msdt.exe</item><item type="str">MSHTA.EXE</item><item type="str">msiexec.exe</item><item type="str">Msxsl.exe</item><item type="str">odbcconf.exe</item><item type="str">pcalua.exe</item><item type="str">PowerShell.EXE</item><item type="str">RegAsm.exe</item><item type="str">RegSvcs.exe</item><item type="str">REGSVR32.exe</item><item type="str">RUNDLL32.exe</item><item type="str">schtasks.exe</item><item type="str">ScriptRunner.exe</item><item type="str">wmic.exe</item><item type="str">WorkFolders.exe</item><item type="str">wscript.exe</item></OriginalFileName></item><item type="dict"><key name="Image|endswith" type="list"><item type="str">\AppVLP.exe</item><item type="str">\bash.exe</item><item type="str">\bitsadmin.exe</item><item type="str">\certoc.exe</item><item type="str">\certutil.exe</item><item type="str">\cmd.exe</item><item type="str">\cmstp.exe</item><item type="str">\control.exe</item><item type="str">\cscript.exe</item><item type="str">\curl.exe</item><item type="str">\forfiles.exe</item><item type="str">\hh.exe</item><item type="str">\ieexec.exe</item><item type="str">\installutil.exe</item><item type="str">\javaw.exe</item><item type="str">\mftrace.exe</item><item type="str">\Microsoft.Workflow.Compiler.exe</item><item type="str">\msbuild.exe</item><item type="str">\msdt.exe</item><item type="str">\mshta.exe</item><item type="str">\msidb.exe</item><item type="str">\msiexec.exe</item><item type="str">\msxsl.exe</item><item type="str">\odbcconf.exe</item><item type="str">\pcalua.exe</item><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item><item type="str">\regasm.exe</item><item type="str">\regsvcs.exe</item><item type="str">\regsvr32.exe</item><item type="str">\rundll32.exe</item><item type="str">\schtasks.exe</item><item type="str">\scrcons.exe</item><item type="str">\scriptrunner.exe</item><item type="str">\sh.exe</item><item type="str">\svchost.exe</item><item type="str">\verclsid.exe</item><item type="str">\wmic.exe</item><item type="str">\workfolders.exe</item><item type="str">\wscript.exe</item></key></item></selection_child_processes><selection_child_susp_paths type="dict"><key name="Image|contains" type="list"><item type="str">\AppData\</item><item type="str">\Users\Public\</item><item type="str">\ProgramData\</item><item type="str">\Windows\Tasks\</item><item type="str">\Windows\Temp\</item><item type="str">\Windows\System32\Tasks\</item></key></selection_child_susp_paths><condition type="str">selection_parent and 1 of selection_child_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>