<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Malicious PowerShell Scripts - PoshModule</title><id type="str">41025fd7-0466-4650-a813-574aaacbe7f4</id><related type="list"><item type="dict"><id type="str">f331aa1f-8c53-4fc3-b083-cc159bc971cb</id><type type="str">similar</type></item><item type="dict"><id type="str">bf7286e7-c0be-460b-a7e8-5b2e07ecc2f2</id><type type="str">obsoletes</type></item></related><status type="str">experimental</status><description type="str">Detects the execution of known offensive powershell scripts used for exploitation or reconnaissance</description><references type="list"><item type="str">https://github.com/PowerShellMafia/PowerSploit</item><item type="str">https://github.com/NetSPI/PowerUpSQL</item><item type="str">https://github.com/CsEnox/EventViewer-UACBypass</item><item type="str">https://github.com/AlsidOfficial/WSUSpendu/</item><item type="str">https://github.com/nettitude/Invoke-PowerThIEf</item><item type="str">https://github.com/S3cur3Th1sSh1t/WinPwn</item><item type="str">https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries</item><item type="str">https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1</item><item type="str">https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1</item><item type="str">https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1</item><item type="str">https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1</item><item type="str">https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/</item><item type="str">https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/</item><item type="str">https://github.com/HarmJ0y/DAMP</item><item type="str">https://github.com/samratashok/nishang</item><item type="str">https://github.com/DarkCoderSc/PowerRunAsSystem/</item><item type="str">https://github.com/besimorhino/powercat</item></references><author type="str">frack113, Nasreddine Bencherchali</author><date type="str">2023/01/23</date><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_module</category><definition type="str">0ad03ef1-f21b-4a79-8ce8-e6900c54b65b</definition></logsource><detection type="dict"><selection_generic type="dict"><key name="ContextInfo|contains" type="list"><item type="str">Add-ConstrainedDelegationBackdoor.ps1</item><item type="str">Add-Exfiltration.ps1</item><item type="str">Add-Persistence.ps1</item><item type="str">Add-RegBackdoor.ps1</item><item type="str">Add-RemoteRegBackdoor.ps1</item><item type="str">Add-ScrnSaveBackdoor.ps1</item><item type="str">Check-VM.ps1</item><item type="str">ConvertTo-ROT13.ps1</item><item type="str">Copy-VSS.ps1</item><item type="str">Create-MultipleSessions.ps1</item><item type="str">DNS_TXT_Pwnage.ps1</item><item type="str">Do-Exfiltration.ps1</item><item type="str">DomainPasswordSpray.ps1</item><item type="str">Download_Execute.ps1</item><item type="str">Download-Execute-PS.ps1</item><item type="str">Enabled-DuplicateToken.ps1</item><item type="str">Enable-DuplicateToken.ps1</item><item type="str">Execute-Command-MSSQL.ps1</item><item type="str">Execute-DNSTXT-Code.ps1</item><item type="str">Execute-OnTime.ps1</item><item type="str">ExetoText.ps1</item><item type="str">Exploit-Jboss.ps1</item><item type="str">Find-AVSignature.ps1</item><item type="str">Find-Fruit.ps1</item><item type="str">Find-GPOLocation.ps1</item><item type="str">Find-TrustedDocuments.ps1</item><item type="str">FireBuster.ps1</item><item type="str">FireListener.ps1</item><item type="str">Get-ApplicationHost.ps1</item><item type="str">Get-ChromeDump.ps1</item><item type="str">Get-ClipboardContents.ps1</item><item type="str">Get-ComputerDetail.ps1</item><item type="str">Get-FoxDump.ps1</item><item type="str">Get-GPPAutologon.ps1</item><item type="str">Get-GPPPassword.ps1</item><item type="str">Get-IndexedItem.ps1</item><item type="str">Get-Keystrokes.ps1</item><item type="str">Get-LSASecret.ps1</item><item type="str">Get-MicrophoneAudio.ps1</item><item type="str">Get-PassHashes.ps1</item><item type="str">Get-PassHints.ps1</item><item type="str">Get-RegAlwaysInstallElevated.ps1</item><item type="str">Get-RegAutoLogon.ps1</item><item type="str">Get-RickAstley.ps1</item><item type="str">Get-Screenshot.ps1</item><item type="str">Get-SecurityPackages.ps1</item><item type="str">Get-ServiceFilePermission.ps1</item><item type="str">Get-ServicePermission.ps1</item><item type="str">Get-ServiceUnquoted.ps1</item><item type="str">Get-SiteListPassword.ps1</item><item type="str">Get-System.ps1</item><item type="str">Get-TimedScreenshot.ps1</item><item type="str">Get-UnattendedInstallFile.ps1</item><item type="str">Get-Unconstrained.ps1</item><item type="str">Get-USBKeystrokes.ps1</item><item type="str">Get-VaultCredential.ps1</item><item type="str">Get-VulnAutoRun.ps1</item><item type="str">Get-VulnSchTask.ps1</item><item type="str">Get-WebConfig.ps1</item><item type="str">Get-WebCredentials.ps1</item><item type="str">Get-WLAN-Keys.ps1</item><item type="str">Gupt-Backdoor.ps1</item><item type="str">HTTP-Backdoor.ps1</item><item type="str">HTTP-Login.ps1</item><item type="str">Install-ServiceBinary.ps1</item><item type="str">Install-SSP.ps1</item><item type="str">Invoke-ACLScanner.ps1</item><item type="str">Invoke-ADSBackdoor.ps1</item><item type="str">Invoke-AmsiBypass.ps1</item><item type="str">Invoke-ARPScan.ps1</item><item type="str">Invoke-BackdoorLNK.ps1</item><item type="str">Invoke-BadPotato.ps1</item><item type="str">Invoke-BetterSafetyKatz.ps1</item><item type="str">Invoke-BruteForce.ps1</item><item type="str">Invoke-BypassUAC.ps1</item><item type="str">Invoke-Carbuncle.ps1</item><item type="str">Invoke-Certify.ps1</item><item type="str">Invoke-ConPtyShell.ps1</item><item type="str">Invoke-CredentialInjection.ps1</item><item type="str">Invoke-CredentialsPhish.ps1</item><item type="str">Invoke-DAFT.ps1</item><item type="str">Invoke-DCSync.ps1</item><item type="str">Invoke-Decode.ps1</item><item type="str">Invoke-DinvokeKatz.ps1</item><item type="str">Invoke-DllInjection.ps1</item><item type="str">Invoke-DowngradeAccount.ps1</item><item type="str">Invoke-EgressCheck.ps1</item><item type="str">Invoke-Encode.ps1</item><item type="str">Invoke-EventViewer.ps1</item><item type="str">Invoke-Eyewitness.ps1</item><item type="str">Invoke-FakeLogonScreen.ps1</item><item type="str">Invoke-Farmer.ps1</item><item type="str">Invoke-Get-RBCD-Threaded.ps1</item><item type="str">Invoke-Gopher.ps1</item><item type="str">Invoke-Grouper2.ps1</item><item type="str">Invoke-Grouper3.ps1</item><item type="str">Invoke-HandleKatz.ps1</item><item type="str">Invoke-Interceptor.ps1</item><item type="str">Invoke-Internalmonologue.ps1</item><item type="str">Invoke-Inveigh.ps1</item><item type="str">Invoke-InveighRelay.ps1</item><item type="str">Invoke-JSRatRegsvr.ps1</item><item type="str">Invoke-JSRatRundll.ps1</item><item type="str">Invoke-KrbRelay.ps1</item><item type="str">Invoke-KrbRelayUp.ps1</item><item type="str">Invoke-LdapSignCheck.ps1</item><item type="str">Invoke-Lockless.ps1</item><item type="str">Invoke-MalSCCM.ps1</item><item type="str">Invoke-Mimikatz.ps1</item><item type="str">Invoke-MimikatzWDigestDowngrade.ps1</item><item type="str">Invoke-Mimikittenz.ps1</item><item type="str">Invoke-MITM6.ps1</item><item type="str">Invoke-NanoDump.ps1</item><item type="str">Invoke-NetRipper.ps1</item><item type="str">Invoke-NetworkRelay.ps1</item><item type="str">Invoke-NinjaCopy.ps1</item><item type="str">Invoke-OxidResolver.ps1</item><item type="str">Invoke-P0wnedshell.ps1</item><item type="str">Invoke-P0wnedshellx86.ps1</item><item type="str">Invoke-Paranoia.ps1</item><item type="str">Invoke-PortScan.ps1</item><item type="str">Invoke-PoshRatHttp.ps1</item><item type="str">Invoke-PoshRatHttps.ps1</item><item type="str">Invoke-PostExfil.ps1</item><item type="str">Invoke-PowerDump.ps1</item><item type="str">Invoke-PowerShellIcmp.ps1</item><item type="str">Invoke-PowerShellTCP.ps1</item><item type="str">Invoke-PowerShellTcpOneLine.ps1</item><item type="str">Invoke-PowerShellTcpOneLineBind.ps1</item><item type="str">Invoke-PowerShellUdp.ps1</item><item type="str">Invoke-PowerShellUdpOneLine.ps1</item><item type="str">Invoke-PowerShellWMI.ps1</item><item type="str">Invoke-PowerThIEf.ps1</item><item type="str">Invoke-PPLDump.ps1</item><item type="str">Invoke-Prasadhak.ps1</item><item type="str">Invoke-PsExec.ps1</item><item type="str">Invoke-PsGcat.ps1</item><item type="str">Invoke-PsGcatAgent.ps1</item><item type="str">Invoke-PSInject.ps1</item><item type="str">Invoke-PsUaCme.ps1</item><item type="str">Invoke-ReflectivePEInjection.ps1</item><item type="str">Invoke-ReverseDNSLookup.ps1</item><item type="str">Invoke-Rubeus.ps1</item><item type="str">Invoke-RunAs.ps1</item><item type="str">Invoke-SafetyKatz.ps1</item><item type="str">Invoke-SauronEye.ps1</item><item type="str">Invoke-SCShell.ps1</item><item type="str">Invoke-Seatbelt.ps1</item><item type="str">Invoke-ServiceAbuse.ps1</item><item type="str">Invoke-SessionGopher.ps1</item><item type="str">Invoke-ShellCode.ps1</item><item type="str">Invoke-SMBScanner.ps1</item><item type="str">Invoke-Snaffler.ps1</item><item type="str">Invoke-Spoolsample.ps1</item><item type="str">Invoke-SSHCommand.ps1</item><item type="str">Invoke-SSIDExfil.ps1</item><item type="str">Invoke-StandIn.ps1</item><item type="str">Invoke-StickyNotesExtract.ps1</item><item type="str">Invoke-Tater.ps1</item><item type="str">Invoke-Thunderfox.ps1</item><item type="str">Invoke-ThunderStruck.ps1</item><item type="str">Invoke-TokenManipulation.ps1</item><item type="str">Invoke-Tokenvator.ps1</item><item type="str">Invoke-TotalExec.ps1</item><item type="str">Invoke-UrbanBishop.ps1</item><item type="str">Invoke-UserHunter.ps1</item><item type="str">Invoke-VoiceTroll.ps1</item><item type="str">Invoke-Whisker.ps1</item><item type="str">Invoke-WinEnum.ps1</item><item type="str">Invoke-winPEAS.ps1</item><item type="str">Invoke-WireTap.ps1</item><item type="str">Invoke-WmiCommand.ps1</item><item type="str">Invoke-WScriptBypassUAC.ps1</item><item type="str">Invoke-Zerologon.ps1</item><item type="str">Keylogger.ps1</item><item type="str">MailRaider.ps1</item><item type="str">New-HoneyHash.ps1</item><item type="str">OfficeMemScraper.ps1</item><item type="str">Offline_Winpwn.ps1</item><item type="str">Out-CHM.ps1</item><item type="str">Out-DnsTxt.ps1</item><item type="str">Out-Excel.ps1</item><item type="str">Out-HTA.ps1</item><item type="str">Out-Java.ps1</item><item type="str">Out-JS.ps1</item><item type="str">Out-Minidump.ps1</item><item type="str">Out-RundllCommand.ps1</item><item type="str">Out-SCF.ps1</item><item type="str">Out-SCT.ps1</item><item type="str">Out-Shortcut.ps1</item><item type="str">Out-WebQuery.ps1</item><item type="str">Out-Word.ps1</item><item type="str">Parse_Keys.ps1</item><item type="str">Port-Scan.ps1</item><item type="str">PowerBreach.ps1</item><item type="str">powercat.ps1</item><item type="str">PowerRunAsSystem.psm1</item><item type="str">PowerSharpPack.ps1</item><item type="str">PowerUp.ps1</item><item type="str">PowerUpSQL.ps1</item><item type="str">PowerView.ps1</item><item type="str">PSAsyncShell.ps1</item><item type="str">RemoteHashRetrieval.ps1</item><item type="str">Remove-Persistence.ps1</item><item type="str">Remove-PoshRat.ps1</item><item type="str">Remove-Update.ps1</item><item type="str">Run-EXEonRemote.ps1</item><item type="str">Schtasks-Backdoor.ps1</item><item type="str">Set-DCShadowPermissions.ps1</item><item type="str">Set-MacAttribute.ps1</item><item type="str">Set-RemotePSRemoting.ps1</item><item type="str">Set-RemoteWMI.ps1</item><item type="str">Set-Wallpaper.ps1</item><item type="str">Show-TargetScreen.ps1</item><item type="str">Speak.ps1</item><item type="str">Start-CaptureServer.ps1</item><item type="str">Start-WebcamRecorder.ps1</item><item type="str">StringToBase64.ps1</item><item type="str">TexttoExe.ps1</item><item type="str">VolumeShadowCopyTools.ps1</item><item type="str">WinPwn.ps1</item><item type="str">WSUSpendu.ps1</item></key></selection_generic><selection_invoke_sharp type="dict"><key name="ContextInfo|contains|all" type="list"><item type="str">Invoke-Sharp</item><item type="str">.ps1</item></key></selection_invoke_sharp><condition type="str">1 of selection_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>