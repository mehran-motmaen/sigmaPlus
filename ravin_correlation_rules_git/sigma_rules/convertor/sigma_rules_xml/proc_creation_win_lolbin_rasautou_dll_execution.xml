<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">DLL Execution via Rasautou.exe</title><id type="str">cd3d1298-eb3b-476c-ac67-12847de55813</id><status type="str">test</status><description type="str">Detects using Rasautou.exe for loading arbitrary .DLL specified in -d option and executes the export specified in -p.</description><references type="list"><item type="str">https://lolbas-project.github.io/lolbas/Binaries/Rasautou/</item><item type="str">https://github.com/fireeye/DueDLLigence</item><item type="str">https://www.fireeye.com/blog/threat-research/2019/10/staying-hidden-on-the-endpoint-evading-detection-with-shellcode.html</item></references><author type="str">Julia Fomina, oscd.community</author><date type="str">2020/10/09</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1218</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">process_creation</category><definition type="str">Since options &apos;-d&apos; and &apos;-p&apos; were removed in Windows 10 this rule is relevant only for Windows before 10. And as Windows 7 doesn&apos;t log command line in 4688 by default, to detect this attack you need Sysmon 1 configured or KB3004375 installed for command-line auditing (https://support.microsoft.com/en-au/help/3004375/microsoft-security-advisory-update-to-improve-windows-command-line-aud)</definition></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\rasautou.exe</key></item><item type="dict"><OriginalFileName type="str">rasdlui.exe</OriginalFileName></item></selection_img><selection_cli type="dict"><key name="CommandLine|contains|all" type="list"><item type="str"> -d </item><item type="str"> -p </item></key></selection_cli><condition type="str">all of selection*</condition></detection><falsepositives type="list"><item type="str">Unlikely</item></falsepositives><level type="str">medium</level></root>