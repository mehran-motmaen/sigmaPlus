<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Via Powershell Search Order Hijacking - Task</title><id type="str">b66474aa-bd92-4333-a16c-298155b120df</id><related type="list"><item type="dict"><id type="str">6e8811ee-90ba-441e-8486-5653e68b2299</id><type type="str">similar</type></item></related><status type="str">experimental</status><description type="str">Detects suspicious powershell execution via a schedule task where the command ends with an suspicious flags to hide the powershell instance instead of executeing scripts or commands. This could be a sign of persistence via PowerShell &quot;Get-Variable&quot; technique as seen being used in Colibri Loader</description><references type="list"><item type="str">https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/</item></references><author type="str">pH-T (Nextron Systems), Florian Roth (Nextron Systems)</author><date type="str">2022/04/08</date><modified type="str">2023/02/03</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.persistence</item><item type="str">attack.t1053.005</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">process_creation</category></logsource><detection type="dict"><selection type="dict"><ParentImage type="str">C:\WINDOWS\System32\svchost.exe</ParentImage><key name="ParentCommandLine|contains|all" type="list"><item type="str">-k netsvcs</item><item type="str">-s Schedule</item></key><key name="CommandLine|endswith" type="list"><item type="str"> -windowstyle hidden</item><item type="str"> -w hidden</item><item type="str"> -ep bypass</item><item type="str"> -noni</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>