<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Execution via macOS Script Editor</title><id type="str">6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4</id><status type="str">experimental</status><description type="str">Detects when the macOS Script Editor utility spawns an unusual child process.</description><author type="str">Tim Rauch (rule), Elastic (idea)</author><references type="list"><item type="str">https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-7f541fbc4a4a28a92970e8bf53effea5bd934604429112c920affb457f5b2685</item><item type="str">https://wojciechregula.blog/post/macos-red-teaming-initial-access-via-applescript-url/</item></references><date type="str">2022/10/21</date><modified type="str">2022/12/28</modified><logsource type="dict"><category type="str">process_creation</category><product type="str">macos</product></logsource><tags type="list"><item type="str">attack.t1566</item><item type="str">attack.t1566.002</item><item type="str">attack.initial_access</item><item type="str">attack.t1059</item><item type="str">attack.t1059.002</item><item type="str">attack.t1204</item><item type="str">attack.t1204.001</item><item type="str">attack.execution</item><item type="str">attack.persistence</item><item type="str">attack.t1553</item><item type="str">attack.defense_evasion</item></tags><detection type="dict"><selection_parent type="dict"><key name="ParentImage|endswith" type="str">/Script Editor</key></selection_parent><selection_img type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">/curl</item><item type="str">/bash</item><item type="str">/sh</item><item type="str">/zsh</item><item type="str">/dash</item><item type="str">/fish</item><item type="str">/osascript</item><item type="str">/mktemp</item><item type="str">/chmod</item><item type="str">/php</item><item type="str">/nohup</item><item type="str">/openssl</item><item type="str">/plutil</item><item type="str">/PlistBuddy</item><item type="str">/xattr</item><item type="str">/sqlite</item><item type="str">/funzip</item><item type="str">/popen</item></key></item><item type="dict"><key name="Image|contains" type="list"><item type="str">python</item><item type="str">perl</item></key></item></selection_img><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>