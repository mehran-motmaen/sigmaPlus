<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Lsass Full Dump Request Via DumpType Registry Settings</title><id type="str">33efc23c-6ea2-4503-8cfe-bdf82ce8f719</id><status type="str">experimental</status><description type="str">Detects the setting of the &quot;DumpType&quot; registry value to &quot;2&quot; which stands for a &quot;Full Dump&quot;. Technique such as LSASS Shtinkering requires this value to be &quot;2&quot; in order to dump LSASS.</description><references type="list"><item type="str">https://github.com/deepinstinct/Lsass-Shtinkering</item><item type="str">https://learn.microsoft.com/en-us/windows/win32/wer/collecting-user-mode-dumps</item><item type="str">https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf</item></references><author type="str">@pbssubhash</author><date type="str">2022/12/08</date><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1003.001</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains" type="list"><item type="str">\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps\DumpType</item><item type="str">\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps\lsass.exe\DumpType</item></key><Details type="str">DWORD (0x00000002)</Details></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Legitimate application that needs to do a full dump of their process</item></falsepositives><level type="str">high</level></root>