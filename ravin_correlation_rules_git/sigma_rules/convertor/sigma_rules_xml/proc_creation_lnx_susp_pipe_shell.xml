<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Linux Shell Pipe to Shell</title><id type="str">880973f3-9708-491c-a77b-2a35a1921158</id><status type="str">experimental</status><description type="str">Detects suspicious process command line that starts with a shell that executes something and finally gets piped into another shell</description><references type="list"><item type="str">Internal Research</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2022/03/14</date><modified type="str">2022/07/26</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1140</item></tags><logsource type="dict"><product type="str">linux</product><category type="str">process_creation</category></logsource><detection type="dict"><selection type="dict"><key name="CommandLine|startswith" type="list"><item type="str">sh -c </item><item type="str">bash -c </item></key></selection><selection_exec type="list"><item type="dict"><key name="CommandLine|contains" type="list"><item type="str">| bash </item><item type="str">| sh </item><item type="str">|bash </item><item type="str">|sh </item></key></item><item type="dict"><key name="CommandLine|endswith" type="list"><item type="str">| bash</item><item type="str">| sh</item><item type="str">|bash</item><item type="str"> |sh</item></key></item></selection_exec><condition type="str">all of selection*</condition></detection><falsepositives type="list"><item type="str">Legitimate software that uses these patterns</item></falsepositives><level type="str">medium</level></root>