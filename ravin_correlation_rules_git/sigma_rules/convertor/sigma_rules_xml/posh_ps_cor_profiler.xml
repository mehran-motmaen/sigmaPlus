<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Registry-Free Process Scope COR_PROFILER</title><id type="str">23590215-4702-4a70-8805-8dc9e58314a2</id><status type="str">test</status><description type="str">Adversaries may leverage the COR_PROFILER environment variable to hijack the execution flow of programs that load the .NET CLR.
The COR_PROFILER is a .NET Framework feature which allows developers to specify an unmanaged (or external of .NET) profiling DLL to be loaded into each .NET process that loads the Common Language Runtime (CLR).
These profiliers are designed to monitor, troubleshoot, and debug managed code executed by the .NET CLR.
(Citation: Microsoft Profiling Mar 2017)
(Citation: Microsoft COR_PROFILER Feb 2013)
</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.012/T1574.012.md#atomic-test-3---registry-free-process-scope-cor_profiler</item></references><author type="str">frack113</author><date type="str">2021/12/30</date><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1574.012</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><selection type="dict"><key name="ScriptBlockText|contains|all" type="list"><item type="str">$env:COR_ENABLE_PROFILING</item><item type="str">$env:COR_PROFILER</item><item type="str">$env:COR_PROFILER_PATH</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Legitimate administrative script</item></falsepositives><level type="str">medium</level></root>