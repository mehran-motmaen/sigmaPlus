<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Cobalt Strike DNS Beaconing - DNS Client</title><id type="str">0d18728b-f5bf-4381-9dcf-915539fff6c2</id><related type="list"><item type="dict"><id type="str">f356a9c4-effd-4608-bbf8-408afd5cd006</id><type type="str">similar</type></item></related><status type="str">test</status><description type="str">Detects a program that invoked suspicious DNS queries known from Cobalt Strike beacons</description><references type="list"><item type="str">https://www.icebrg.io/blog/footprints-of-fin7-tracking-actor-patterns</item><item type="str">https://www.sekoia.io/en/hunting-and-detecting-cobalt-strike/</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/01/16</date><tags type="list"><item type="str">attack.command_and_control</item><item type="str">attack.t1071.004</item></tags><logsource type="dict"><product type="str">windows</product><service type="str">dns-client</service><definition type="str">Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.</definition></logsource><detection type="dict"><selection_eid type="dict"><EventID type="int">3008</EventID></selection_eid><selection_query_1 type="dict"><key name="QueryName|startswith" type="list"><item type="str">aaa.stage.</item><item type="str">post.1</item></key></selection_query_1><selection_query_2 type="dict"><key name="QueryName|contains" type="str">.stage.123456.</key></selection_query_2><condition type="str">selection_eid and 1 of selection_query_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">critical</level></root>