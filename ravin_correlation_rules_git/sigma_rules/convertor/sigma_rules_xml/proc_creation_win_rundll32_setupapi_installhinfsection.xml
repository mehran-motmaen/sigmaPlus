<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Rundll32 Setupapi.dll Activity</title><id type="str">285b85b1-a555-4095-8652-a8a4106af63f</id><status type="str">test</status><description type="str">setupapi.dll library provide InstallHinfSection function for processing INF files. INF file may contain instructions allowing to create values in the registry, modify files and install drivers. This technique could be used to obtain persistence via modifying one of Run or RunOnce registry keys, run process or use other DLLs chain calls (see references) InstallHinfSection function in setupapi.dll calls runonce.exe executable regardless of actual content of INF file.</description><references type="list"><item type="str">https://lolbas-project.github.io/lolbas/Libraries/Setupapi/</item><item type="str">https://gist.githubusercontent.com/bohops/0cc6586f205f3691e04a1ebf1806aabd/raw/baf7b29891bb91e76198e30889fbf7d6642e8974/calc_exe.inf</item><item type="str">https://raw.githubusercontent.com/huntresslabs/evading-autoruns/master/shady.inf</item><item type="str">https://twitter.com/Z3Jpa29z/status/1313742350292746241?s=20</item></references><author type="str">Konstantin Grishchenko, oscd.community</author><date type="str">2020/10/07</date><modified type="str">2021/11/27</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1218.011</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="str">\runonce.exe</key><key name="ParentImage|endswith" type="str">\rundll32.exe</key><key name="ParentCommandLine|contains|all" type="list"><item type="str">setupapi.dll</item><item type="str">InstallHinfSection</item></key></selection><condition type="str">selection</condition></detection><fields type="list"><item type="str">ComputerName</item><item type="str">User</item><item type="str">CommandLine</item><item type="str">ParentCommandLine</item></fields><falsepositives type="list"><item type="str">Scripts and administrative tools that use INF files for driver installation with setupapi.dll</item></falsepositives><level type="str">medium</level></root>