<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Certificate Request Export to Exchange Webserver</title><id type="str">b7bc7038-638b-4ffd-880c-292c692209ef</id><status type="str">test</status><description type="str">Detects a write of an Exchange CSR to an untypical directory or with aspx name suffix which can be used to place a webshell</description><references type="list"><item type="str">https://twitter.com/GossiTheDog/status/1429175908905127938</item></references><author type="str">Max Altgelt (Nextron Systems)</author><date type="str">2021/08/23</date><modified type="str">2023/01/23</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1505.003</item></tags><logsource type="dict"><service type="str">msexchange-management</service><product type="str">windows</product></logsource><detection type="dict"><keywords_export_command type="dict"><key name="|all" type="list"><item type="str">New-ExchangeCertificate</item><item type="str"> -GenerateRequest</item><item type="str"> -BinaryEncoded</item><item type="str"> -RequestFile</item></key></keywords_export_command><keywords_export_params type="list"><item type="str">\\\\localhost\\C$</item><item type="str">\\\\127.0.0.1\\C$</item><item type="str">C:\\inetpub</item><item type="str">.aspx</item></keywords_export_params><condition type="str">keywords_export_command and keywords_export_params</condition></detection><falsepositives type="list"><item type="str">Unlikely</item></falsepositives><level type="str">critical</level></root>