<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential NT API Stub Patching</title><id type="str">b916cba1-b38a-42da-9223-17114d846fd6</id><status type="str">experimental</status><description type="str">Detects potential NT API stub patching as seen used by the project PatchingAPI</description><references type="list"><item type="str">https://github.com/D1rkMtr/UnhookingPatch</item><item type="str">https://twitter.com/D1rkMtr/status/1611471891193298944?s=20</item></references><author type="str">frack113</author><date type="str">2023/01/07</date><modified type="str">2023/01/25</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1562.002</item></tags><logsource type="dict"><category type="str">process_access</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><GrantedAccess type="str">0x1FFFFF</GrantedAccess><key name="CallTrace|startswith" type="str">C:\Windows\SYSTEM32\ntdll.dll+</key><key name="CallTrace|contains" type="str">|UNKNOWN(</key><key name="CallTrace|endswith" type="str">)</key></selection><filter_generic type="list"><item type="dict"><key name="SourceImage|startswith" type="list"><item type="str">C:\Program Files\</item><item type="str">C:\Program Files (x86)\</item><item type="str">C:\Windows\System32\</item><item type="str">C:\Windows\SysWOW64\</item></key></item><item type="dict"><key name="TargetImage|startswith" type="list"><item type="str">C:\Program Files\</item><item type="str">C:\Program Files (x86)\</item><item type="str">C:\Windows\System32\</item><item type="str">C:\Windows\SysWOW64\</item></key></item></filter_generic><filter_thor type="dict"><key name="SourceImage|startswith" type="str">C:\Windows\Temp\asgard2-agent\</key><key name="SourceImage|endswith" type="str">\thor64.exe</key></filter_thor><filter_githubdesktop type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|contains" type="str">\AppData\Local\GitHubDesktop\app-</key><key name="SourceImage|endswith" type="list"><item type="str">\GitHubDesktop.exe</item><item type="str">\resources\app\git\usr\bin\sh.exe</item></key><key name="TargetImage|startswith" type="str">C:\Users\</key><key name="TargetImage|contains" type="str">\AppData\Local\GitHubDesktop\app-</key></filter_githubdesktop><filter_dotnet type="dict"><key name="SourceImage|startswith" type="list"><item type="str">C:\Windows\Microsoft.NET\Framework\v</item><item type="str">C:\Windows\Microsoft.NET\Framework64\v</item></key><key name="SourceImage|endswith" type="str">\NGenTask.exe</key><key name="TargetImage|startswith" type="list"><item type="str">C:\Windows\Microsoft.NET\Framework\v</item><item type="str">C:\Windows\Microsoft.NET\Framework64\v</item></key></filter_dotnet><filter_taskhost type="dict"><SourceImage type="list"><item type="str">C:\WINDOWS\system32\taskhostw.exe</item><item type="str">C:\Windows\system32\taskhost.exe</item></SourceImage><key name="TargetImage|startswith" type="list"><item type="str">C:\Windows\Microsoft.NET\Framework\v</item><item type="str">C:\Windows\Microsoft.NET\Framework64\v</item></key><key name="TargetImage|endswith" type="str">\NGenTask.exe</key></filter_taskhost><filter_teams_to_update type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|endswith" type="str">\AppData\Local\Microsoft\Teams\stage\Teams.exe</key><key name="TargetImage|startswith" type="str">C:\Users\</key><key name="TargetImage|endswith" type="str">\AppData\Local\Microsoft\Teams\Update.exe</key></filter_teams_to_update><filter_teams_update_regsvr32 type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|endswith" type="str">\AppData\Local\Microsoft\Teams\Update.exe</key><TargetImage type="str">C:\WINDOWS\SysWOW64\regsvr32.exe</TargetImage></filter_teams_update_regsvr32><filter_teams_update_to_teams type="dict"><key name="SourceImage|startswith" type="str">C:\Users\</key><key name="SourceImage|endswith" type="str">\AppData\Local\Microsoft\Teams\Update.exe</key><key name="TargetImage|endswith" type="str">\AppData\Local\Microsoft\Teams\stage\Teams.exe</key></filter_teams_update_to_teams><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>