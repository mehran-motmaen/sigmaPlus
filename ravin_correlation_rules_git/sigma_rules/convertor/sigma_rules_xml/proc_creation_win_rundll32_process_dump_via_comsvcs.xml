<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Process Memory Dump Via Comsvcs.DLL</title><id type="str">646ea171-dded-4578-8a4d-65e9822892e3</id><related type="list"><item type="dict"><id type="str">09e6d5c0-05b8-4ff8-9eeb-043046ec774c</id><type type="str">obsoletes</type></item></related><status type="str">test</status><description type="str">Detects a process memory dump via &quot;comsvcs.dll&quot; using rundll32, covering multiple different techniques (ordinal, minidump function, etc.)</description><references type="list"><item type="str">https://twitter.com/shantanukhande/status/1229348874298388484</item><item type="str">https://twitter.com/pythonresponder/status/1385064506049630211?s=21</item><item type="str">https://twitter.com/Hexacorn/status/1224848930795552769</item><item type="str">https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/</item><item type="str">https://twitter.com/SBousseaden/status/1167417096374050817</item><item type="str">https://twitter.com/Wietze/status/1542107456507203586</item><item type="str">https://github.com/Hackndo/lsassy/blob/14d8f8ae596ecf22b449bfe919829173b8a07635/lsassy/dumpmethod/comsvcs.py</item></references><author type="str">Florian Roth (Nextron Systems), Modexp, Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2020/02/18</date><modified type="str">2023/05/16</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.credential_access</item><item type="str">attack.t1036</item><item type="str">attack.t1003.001</item><item type="str">car.2013-05-009</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\rundll32.exe</key></item><item type="dict"><OriginalFileName type="str">RUNDLL32.EXE</OriginalFileName></item><item type="dict"><key name="CommandLine|contains" type="str">rundll32</key></item></selection_img><selection_cli_1 type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">comsvcs</item><item type="str">full</item></key><key name="CommandLine|contains" type="list"><item type="str">#-</item><item type="str">#+</item><item type="str">#24</item><item type="str">24 </item><item type="str">MiniDump</item></key></selection_cli_1><selection_generic type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">24</item><item type="str">comsvcs</item><item type="str">full</item></key><key name="CommandLine|contains" type="list"><item type="str"> #</item><item type="str">,#</item><item type="str">, #</item></key></selection_generic><condition type="str">(selection_img and 1 of selection_cli_*) or selection_generic</condition></detection><falsepositives type="list"><item type="str">Unlikely</item></falsepositives><level type="str">high</level></root>