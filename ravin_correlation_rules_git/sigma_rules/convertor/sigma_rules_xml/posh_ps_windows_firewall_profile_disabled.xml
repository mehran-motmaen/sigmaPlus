<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Windows Firewall Profile Disabled</title><id type="str">488b44e7-3781-4a71-888d-c95abfacf44d</id><related type="list"><item type="dict"><id type="str">12f6b752-042d-483e-bf9c-915a6d06ad75</id><type type="str">similar</type></item></related><status type="str">experimental</status><description type="str">Detects when a user disables the Windows Firewall via a Profile to help evade defense.</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/powershell/module/netsecurity/set-netfirewallprofile?view=windowsserver2019-ps</item><item type="str">https://www.tutorialspoint.com/how-to-get-windows-firewall-profile-settings-using-powershell</item><item type="str">http://powershellhelp.space/commands/set-netfirewallrule-psv5.php</item><item type="str">http://woshub.com/manage-windows-firewall-powershell/</item><item type="str">https://www.elastic.co/guide/en/security/current/windows-firewall-disabled-via-powershell.html</item></references><author type="str">Austin Songer @austinsonger</author><date type="str">2021/10/12</date><modified type="str">2022/12/30</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1562.004</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><selection_args type="dict"><key name="ScriptBlockText|contains|all" type="list"><item type="str">Set-NetFirewallProfile </item><item type="str"> -Enabled </item><item type="str"> False</item></key></selection_args><selection_opt type="dict"><key name="ScriptBlockText|contains" type="list"><item type="str"> -All </item><item type="str">Public</item><item type="str">Domain</item><item type="str">Private</item></key></selection_opt><condition type="str">all of selection*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>