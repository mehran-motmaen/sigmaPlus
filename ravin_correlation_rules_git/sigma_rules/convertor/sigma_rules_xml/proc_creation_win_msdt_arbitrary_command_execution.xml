<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Arbitrary Command Execution Using Msdt.EXE</title><id type="str">258fc8ce-8352-443a-9120-8a11e4857fa5</id><status type="str">experimental</status><description type="str">Detects processes leveraging the &quot;ms-msdt&quot; handler or the &quot;msdt.exe&quot; binary to execute arbitrary commands as seen in the follina (CVE-2022-30190) vulnerability</description><references type="list"><item type="str">https://twitter.com/nao_sec/status/1530196847679401984</item><item type="str">https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/</item><item type="str">https://twitter.com/_JohnHammond/status/1531672601067675648</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/05/29</date><modified type="str">2023/02/08</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1202</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\msdt.exe</key></item><item type="dict"><OriginalFileName type="str">msdt.exe</OriginalFileName></item></selection_img><selection_cmd_inline type="dict"><key name="CommandLine|contains" type="str">IT_BrowseForFile=</key></selection_cmd_inline><selection_cmd_answerfile_flag type="dict"><key name="CommandLine|contains" type="str"> PCWDiagnostic</key></selection_cmd_answerfile_flag><selection_cmd_answerfile_param type="dict"><key name="CommandLine|contains" type="list"><item type="str"> /af </item><item type="str"> -af </item></key></selection_cmd_answerfile_param><condition type="str">selection_img and (selection_cmd_inline or all of selection_cmd_answerfile_*)</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>