<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl</title><id type="str">074e0ded-6ced-4ebd-8b4d-53f55908119d</id><status type="str">test</status><description type="str">Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via winrm.vbs and copied cscript.exe (can be renamed)</description><references type="list"><item type="str">https://posts.specterops.io/application-whitelisting-bypass-and-arbitrary-unsigned-code-execution-technique-in-winrm-vbs-c8c24fb40404</item></references><author type="str">Julia Fomina, oscd.community</author><date type="str">2020/10/06</date><modified type="str">2022/10/09</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1216</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><contains_format_pretty_arg type="dict"><key name="CommandLine|contains" type="list"><item type="str">format:pretty</item><item type="str">format:&quot;pretty&quot;</item><item type="str">format:&quot;text&quot;</item><item type="str">format:text</item></key></contains_format_pretty_arg><image_from_system_folder type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Windows\System32\</item><item type="str">C:\Windows\SysWOW64\</item></key></image_from_system_folder><contains_winrm type="dict"><key name="CommandLine|contains" type="str">winrm</key></contains_winrm><condition type="str">contains_winrm and (contains_format_pretty_arg and not image_from_system_folder)</condition></detection><falsepositives type="list"><item type="str">Unlikely</item></falsepositives><level type="str">medium</level></root>