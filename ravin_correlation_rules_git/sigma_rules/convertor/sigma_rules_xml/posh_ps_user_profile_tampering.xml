<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Via PowerShell User Profile Using Add-Content</title><id type="str">05b3e303-faf0-4f4a-9b30-46cc13e69152</id><status type="str">test</status><description type="str">Detects calls to &quot;Add-Content&quot; cmdlet in order to modify the content of the user profile and potentially adding suspicious commands for persistence</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.013/T1546.013.md</item></references><author type="str">frack113, Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2021/08/18</date><modified type="str">2023/05/04</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.privilege_escalation</item><item type="str">attack.t1546.013</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><selection_add type="dict"><key name="ScriptBlockText|contains" type="str">Add-Content $profile</key></selection_add><selection_options type="dict"><key name="ScriptBlockText|contains" type="list"><item type="str">-Value &quot;IEX </item><item type="str">-Value &quot;Invoke-Expression</item><item type="str">-Value &quot;Invoke-WebRequest</item><item type="str">-Value &quot;Start-Process</item><item type="str">-Value &apos;IEX </item><item type="str">-Value &apos;Invoke-Expression</item><item type="str">-Value &apos;Invoke-WebRequest</item><item type="str">-Value &apos;Start-Process</item></key></selection_options><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Legitimate administration and tuning scripts that aim to add functionality to a user PowerShell session</item></falsepositives><level type="str">medium</level></root>