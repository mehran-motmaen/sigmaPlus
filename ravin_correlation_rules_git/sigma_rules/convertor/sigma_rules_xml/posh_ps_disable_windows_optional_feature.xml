<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Disable-WindowsOptionalFeature Command PowerShell</title><id type="str">99c4658d-2c5e-4d87-828d-7c066ca537c3</id><status type="str">experimental</status><description type="str">Detect built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool.
Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images
</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/5b67c9b141fa3918017f8fa44f2f88f0b1ecb9e1/atomics/T1562.001/T1562.001.md</item><item type="str">https://docs.microsoft.com/en-us/powershell/module/dism/disable-windowsoptionalfeature?view=windowsserver2022-ps</item></references><author type="str">frack113</author><date type="str">2022/09/10</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1562.001</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><selection_cmd type="dict"><key name="ScriptBlockText|contains|all" type="list"><item type="str">Disable-WindowsOptionalFeature</item><item type="str">-Online</item><item type="str">-FeatureName</item></key></selection_cmd><selection_feature type="dict"><key name="ScriptBlockText|contains" type="list"><item type="str">Windows-Defender-Gui</item><item type="str">Windows-Defender-Features</item><item type="str">Windows-Defender</item><item type="str">Windows-Defender-ApplicationGuard</item></key></selection_feature><condition type="str">all of selection*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>