<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious File Downloaded From Direct IP Via Certutil.EXE</title><id type="str">13e6fe51-d478-4c7e-b0f2-6da9b400a829</id><related type="list"><item type="dict"><id type="str">19b08b1c-861d-4e75-a1ef-ea0c1baf202b</id><type type="str">similar</type></item><item type="dict"><id type="str">42a5f1e7-9603-4f6d-97ae-3f37d130d794</id><type type="str">similar</type></item></related><status type="str">experimental</status><description type="str">Detects the execution of certutil with certain flags that allow the utility to download files from direct IPs.</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil</item><item type="str">https://forensicitguy.github.io/agenttesla-vba-certutil-download/</item><item type="str">https://news.sophos.com/en-us/2021/04/13/compromised-exchange-server-hosting-cryptojacker-targeting-other-exchange-servers/</item><item type="str">https://twitter.com/egre55/status/1087685529016193025</item><item type="str">https://lolbas-project.github.io/lolbas/Binaries/Certutil/</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/02/15</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1027</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\certutil.exe</key></item><item type="dict"><OriginalFileName type="str">CertUtil.exe</OriginalFileName></item></selection_img><selection_flags type="dict"><key name="CommandLine|contains" type="list"><item type="str">urlcache </item><item type="str">verifyctl </item></key></selection_flags><selection_http type="dict"><key name="CommandLine|contains" type="list"><item type="str">://1</item><item type="str">://2</item><item type="str">://3</item><item type="str">://4</item><item type="str">://5</item><item type="str">://6</item><item type="str">://7</item><item type="str">://8</item><item type="str">://9</item></key></selection_http><filter_seven_zip type="dict"><key name="CommandLine|contains" type="str">://7-</key></filter_seven_zip><condition type="str">all of selection_* and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>