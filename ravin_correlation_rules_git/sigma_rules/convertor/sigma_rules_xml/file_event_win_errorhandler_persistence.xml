<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Attempt Via ErrorHandler.Cmd</title><id type="str">15904280-565c-4b73-9303-3291f964e7f9</id><status type="str">experimental</status><description type="str">Detects creation of a file named &quot;ErrorHandler.cmd&quot; in the &quot;C:\WINDOWS\Setup\Scripts\&quot; directory which could be used as a method of persistence
The content of C:\WINDOWS\Setup\Scripts\ErrorHandler.cmd is read whenever some tools under C:\WINDOWS\System32\oobe\ (e.g. Setup.exe) fail to run for any reason.
</description><references type="list"><item type="str">https://www.hexacorn.com/blog/2022/01/16/beyond-good-ol-run-key-part-135/</item><item type="str">https://github.com/last-byte/PersistenceSniper</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/08/09</date><modified type="str">2022/12/19</modified><tags type="list"><item type="str">attack.persistence</item></tags><logsource type="dict"><category type="str">file_event</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="TargetFilename|endswith" type="str">\WINDOWS\Setup\Scripts\ErrorHandler.cmd</key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>