<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Defense Evasion Via Rename Of Highly Relevant Binaries</title><id type="str">0ba1da6d-b6ce-4366-828c-18826c9de23e</id><related type="list"><item type="dict"><id type="str">36480ae1-a1cb-4eaa-a0d6-29801d7e9142</id><type type="str">similar</type></item><item type="dict"><id type="str">2569ed8c-1147-498a-9b8c-2ad3656b10ed</id><type type="str">derived</type></item><item type="dict"><id type="str">a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2</id><type type="str">obsoletes</type></item><item type="dict"><id type="str">d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20</id><type type="str">obsoletes</type></item><item type="dict"><id type="str">d4d2574f-ac17-4d9e-b986-aeeae0dc8fe2</id><type type="str">obsoletes</type></item></related><status type="str">test</status><description type="str">Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.</description><references type="list"><item type="str">https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html</item><item type="str">https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html</item><item type="str">https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-enterprise-networks</item><item type="str">https://twitter.com/christophetd/status/1164506034720952320</item><item type="str">https://threatresearch.ext.hp.com/svcready-a-new-loader-reveals-itself/</item></references><author type="str">Matthew Green - @mgreen27, Florian Roth (Nextron Systems), frack113</author><date type="str">2019/06/15</date><modified type="str">2023/03/01</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1036.003</item><item type="str">car.2013-05-009</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="list"><item type="dict"><Description type="str">Execute processes remotely</Description></item><item type="dict"><Product type="str">Sysinternals PsExec</Product></item><item type="dict"><key name="Description|startswith" type="list"><item type="str">Windows PowerShell</item><item type="str">pwsh</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">powershell.exe</item><item type="str">pwsh.dll</item><item type="str">powershell_ise.exe</item><item type="str">psexec.exe</item><item type="str">psexec.c</item><item type="str">psexesvc.exe</item><item type="str">cscript.exe</item><item type="str">wscript.exe</item><item type="str">mshta.exe</item><item type="str">regsvr32.exe</item><item type="str">wmic.exe</item><item type="str">certutil.exe</item><item type="str">rundll32.exe</item><item type="str">cmstp.exe</item><item type="str">msiexec.exe</item><item type="str">reg.exe</item></OriginalFileName></item></selection><filter type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item><item type="str">\powershell_ise.exe</item><item type="str">\psexec.exe</item><item type="str">\psexec64.exe</item><item type="str">\PSEXESVC.exe</item><item type="str">\cscript.exe</item><item type="str">\wscript.exe</item><item type="str">\mshta.exe</item><item type="str">\regsvr32.exe</item><item type="str">\wmic.exe</item><item type="str">\certutil.exe</item><item type="str">\rundll32.exe</item><item type="str">\cmstp.exe</item><item type="str">\msiexec.exe</item><item type="str">\reg.exe</item></key></filter><condition type="str">selection and not filter</condition></detection><falsepositives type="list"><item type="str">Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist</item><item type="str">PsExec installed via Windows Store doesn&apos;t contain original filename field (False negative)</item></falsepositives><level type="str">high</level></root>