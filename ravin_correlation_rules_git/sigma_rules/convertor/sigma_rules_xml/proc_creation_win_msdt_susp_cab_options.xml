<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Cabinet File Execution Via Msdt.EXE</title><id type="str">dc4576d4-7467-424f-9eee-fd2b02855fe0</id><related type="list"><item type="dict"><id type="str">6545ce61-a1bd-4119-b9be-fcbee42c0cf3</id><type type="str">obsoletes</type></item></related><status type="str">experimental</status><description type="str">Detects execution of msdt.exe using the &quot;cab&quot; flag which could indicates suspicious diagcab files with embedded answer files leveraging CVE-2022-30190</description><references type="list"><item type="str">https://twitter.com/nas_bench/status/1537896324837781506</item><item type="str">https://github.com/GossiTheDog/ThreatHunting/blob/e85884abbf05d5b41efc809ea6532b10b45bd05c/AdvancedHuntingQueries/DogWalk-DiagCab</item><item type="str">https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-9015912909545e72ed42cbac4d1e96295e8964579c406d23fd9c47a8091576a0</item><item type="str">https://irsl.medium.com/the-trouble-with-microsofts-troubleshooters-6e32fc80b8bd</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems), GossiTheDog, frack113</author><date type="str">2022/06/21</date><modified type="str">2023/02/06</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1202</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\msdt.exe</key></item><item type="dict"><OriginalFileName type="str">msdt.exe</OriginalFileName></item></selection_img><selection_cmd type="dict"><key name="CommandLine|contains" type="list"><item type="str"> /cab </item><item type="str"> -cab </item></key></selection_cmd><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Legitimate usage of &quot;.diagcab&quot; files</item></falsepositives><level type="str">medium</level></root>