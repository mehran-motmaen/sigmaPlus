<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Via App Paths Default Property</title><id type="str">707e097c-e20f-4f67-8807-1f72ff4500d6</id><status type="str">experimental</status><description type="str">Detects changes to the &quot;Default&quot; property for keys located in the \Software\Microsoft\Windows\CurrentVersion\App Paths\ registry. Which might be used as a method of persistence
The entries found under App Paths are used primarily for the following purposes.
First, to map an application&apos;s executable file name to that file&apos;s fully qualified path.
Second, to pre-pend information to the PATH environment variable on a per-application, per-process basis.
</description><references type="list"><item type="str">https://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/</item><item type="str">https://docs.microsoft.com/en-us/windows/win32/shell/app-registration?redirectedfrom=MSDN</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/08/10</date><modified type="str">2023/01/10</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1546.012</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains" type="str">\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths</key><key name="TargetObject|endswith" type="list"><item type="str">(Default)</item><item type="str">Path</item></key><key name="Details|contains" type="list"><item type="str">\Users\Public</item><item type="str">\AppData\Local\Temp\</item><item type="str">\Windows\Temp\</item><item type="str">\Desktop\</item><item type="str">\Downloads\</item><item type="str">%temp%</item><item type="str">%tmp%</item><item type="str">iex</item><item type="str">Invoke-</item><item type="str">rundll32</item><item type="str">regsvr32</item><item type="str">mshta</item><item type="str">cscript</item><item type="str">wscript</item><item type="str">.bat</item><item type="str">.hta</item><item type="str">.dll</item><item type="str">.ps1</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Legitimate applications registering their binary from on of the suspicious locations mentioned above (tune it)</item></falsepositives><level type="str">high</level></root>