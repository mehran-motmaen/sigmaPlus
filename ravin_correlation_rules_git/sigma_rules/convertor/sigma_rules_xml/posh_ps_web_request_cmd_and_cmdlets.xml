<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Usage Of Web Request Commands And Cmdlets - ScriptBlock</title><id type="str">1139d2e2-84b1-4226-b445-354492eba8ba</id><related type="list"><item type="dict"><id type="str">9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d</id><type type="str">derived</type></item></related><status type="str">experimental</status><description type="str">Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via PowerShell scriptblock logs</description><references type="list"><item type="str">https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/</item><item type="str">https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell</item></references><author type="str">James Pemberton / @4A616D6573</author><date type="str">2019/10/24</date><modified type="str">2023/01/10</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><selection type="dict"><key name="ScriptBlockText|contains" type="list"><item type="str">[System.Net.WebRequest]::create</item><item type="str">curl </item><item type="str">Invoke-RestMethod</item><item type="str">Invoke-WebRequest</item><item type="str">iwr </item><item type="str">Net.WebClient</item><item type="str">Resume-BitsTransfer</item><item type="str">Start-BitsTransfer</item><item type="str">wget </item><item type="str">WinHttp.WinHttpRequest</item></key></selection><filter type="dict"><key name="Path|startswith" type="str">C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\</key></filter><condition type="str">selection and not filter</condition></detection><falsepositives type="list"><item type="str">Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer.</item></falsepositives><level type="str">medium</level></root>