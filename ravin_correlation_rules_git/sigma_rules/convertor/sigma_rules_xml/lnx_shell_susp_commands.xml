<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Activity in Shell Commands</title><id type="str">2aa1440c-9ae9-4d92-84a7-a9e5f5e31695</id><status type="str">test</status><description type="str">Detects suspicious shell commands used in various exploit codes (see references)</description><references type="list"><item type="str">https://web.archive.org/web/20170319121015/http://www.threatgeek.com/2017/03/widespread-exploitation-attempts-using-cve-2017-5638.html</item><item type="str">https://github.com/rapid7/metasploit-framework/blob/eb6535009f5fdafa954525687f09294918b5398d/modules/exploits/multi/http/struts_code_exec_exception_delegator.rb</item><item type="str">http://pastebin.com/FtygZ1cg</item><item type="str">https://artkond.com/2017/03/23/pivoting-guide/</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2017/08/21</date><modified type="str">2021/11/27</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.004</item></tags><logsource type="dict"><product type="str">linux</product></logsource><detection type="dict"><keywords type="list"><item type="str">wget * - http* | perl</item><item type="str">wget * - http* | sh</item><item type="str">wget * - http* | bash</item><item type="str">python -m SimpleHTTPServer</item><item type="str">-m http.server</item><item type="str">import pty; pty.spawn*</item><item type="str">socat exec:*</item><item type="str">socat -O /tmp/*</item><item type="str">socat tcp-connect*</item><item type="str">*echo binary &gt;&gt;*</item><item type="str">*wget *; chmod +x*</item><item type="str">*wget *; chmod 777 *</item><item type="str">*cd /tmp || cd /var/run || cd /mnt*</item><item type="str">*stop;service iptables stop;*</item><item type="str">*stop;SuSEfirewall2 stop;*</item><item type="str">chmod 777 2020*</item><item type="str">*&gt;&gt;/etc/rc.local</item><item type="str">*base64 -d /tmp/*</item><item type="str">* | base64 -d *</item><item type="str">*/chmod u+s *</item><item type="str">*chmod +s /tmp/*</item><item type="str">*chmod u+s /tmp/*</item><item type="str">* /tmp/haxhax*</item><item type="str">* /tmp/ns_sploit*</item><item type="str">nc -l -p *</item><item type="str">cp /bin/ksh *</item><item type="str">cp /bin/sh *</item><item type="str">* /tmp/*.b64 *</item><item type="str">*/tmp/ysocereal.jar*</item><item type="str">*/tmp/x *</item><item type="str">*; chmod +x /tmp/*</item><item type="str">*;chmod +x /tmp/*</item></keywords><condition type="str">keywords</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>