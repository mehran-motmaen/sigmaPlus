<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Script Execution From Temp Folder</title><id type="str">a6a39bdb-935c-4f0a-ab77-35f4bbf44d33</id><status type="str">experimental</status><description type="str">Detects a suspicious script executions from temporary folder</description><references type="list"><item type="str">https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/</item></references><author type="str">Florian Roth (Nextron Systems), Max Altgelt (Nextron Systems), Tim Shelton</author><date type="str">2021/07/14</date><modified type="str">2022/10/05</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item><item type="str">\mshta.exe</item><item type="str">\wscript.exe</item><item type="str">\cscript.exe</item></key><key name="CommandLine|contains" type="list"><item type="str">\Windows\Temp</item><item type="str">\Temporary Internet</item><item type="str">\AppData\Local\Temp</item><item type="str">\AppData\Roaming\Temp</item><item type="str">%TEMP%</item><item type="str">%TMP%</item><item type="str">%LocalAppData%\Temp</item></key></selection><filter type="dict"><key name="CommandLine|contains" type="list"><item type="str"> &gt;</item><item type="str">Out-File</item><item type="str">ConvertTo-Json</item><item type="str">-WindowStyle hidden -Verb runAs</item><item type="str">\Windows\system32\config\systemprofile\AppData\Local\Temp\Amazon\EC2-Windows\</item></key></filter><condition type="str">selection and not filter</condition></detection><falsepositives type="list"><item type="str">Administrative scripts</item></falsepositives><level type="str">high</level></root>