<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Access To Windows DPAPI Master Keys</title><id type="str">46612ae6-86be-4802-bc07-39b59feb1309</id><status type="str">experimental</status><description type="str">Detects suspicious processes based on name and location that access the Windows Data Protection API Master keys.
Which can be a sign of credential stealing. Example case would be usage of mimikatz &quot;dpapi::masterkey&quot; function
</description><references type="list"><item type="str">http://blog.harmj0y.net/redteaming/operational-guidance-for-offensive-user-dpapi-abuse/</item><item type="str">https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/dpapi-extracting-passwords</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/10/17</date><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1555.004</item></tags><logsource type="dict"><category type="str">file_access</category><product type="str">windows</product><definition type="str">Requirements: Microsoft-Windows-Kernel-File ETW provider</definition></logsource><detection type="dict"><selection type="dict"><key name="FileName|contains" type="list"><item type="str">\Microsoft\Protect\S-1-5-18\</item><item type="str">\Microsoft\Protect\S-1-5-21-</item></key></selection><filter_system_folders type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\</item><item type="str">C:\Program Files (x86)\</item><item type="str">C:\Windows\system32\</item><item type="str">C:\Windows\SysWOW64\</item></key></filter_system_folders><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>