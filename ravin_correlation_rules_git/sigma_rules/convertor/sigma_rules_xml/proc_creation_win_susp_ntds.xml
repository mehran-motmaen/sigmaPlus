<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Process Patterns NTDS.DIT Exfil</title><id type="str">8bc64091-6875-4881-aaf9-7bd25b5dda08</id><status type="str">experimental</status><description type="str">Detects suspicious process patterns used in NTDS.DIT exfiltration</description><references type="list"><item type="str">https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration</item><item type="str">https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/</item><item type="str">https://pentestlab.blog/tag/ntds-dit/</item><item type="str">https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Gather/Copy-VSS.ps1</item><item type="str">https://github.com/zcgonvh/NTDSDumpEx</item><item type="str">https://github.com/rapid7/metasploit-framework/blob/d297adcebb5c1df6fe30b12ca79b161deb71571c/data/post/powershell/NTDSgrab.ps1</item><item type="str">https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2022/03/11</date><modified type="str">2022/11/10</modified><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1003.003</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">process_creation</category></logsource><detection type="dict"><selection_tool type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\NTDSDump.exe</item><item type="str">\NTDSDumpEx.exe</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">ntds.dit</item><item type="str">system.hiv</item></key></item><item type="dict"><key name="CommandLine|contains" type="str">NTDSgrab.ps1</key></item></selection_tool><selection_oneliner_1 type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">ac i ntds</item><item type="str">create full</item></key></selection_oneliner_1><selection_onliner_2 type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">/c copy </item><item type="str">\windows\ntds\ntds.dit</item></key></selection_onliner_2><selection_onliner_3 type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">activate instance ntds</item><item type="str">create full</item></key></selection_onliner_3><selection_powershell type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">powershell</item><item type="str">ntds.dit</item></key></selection_powershell><set1_selection_ntds_dit type="dict"><key name="CommandLine|contains" type="str">ntds.dit</key></set1_selection_ntds_dit><set1_selection_image_folder type="list"><item type="dict"><key name="ParentImage|contains" type="list"><item type="str">\apache</item><item type="str">\tomcat</item><item type="str">\AppData\</item><item type="str">\Temp\</item><item type="str">\Public\</item><item type="str">\PerfLogs\</item></key></item><item type="dict"><key name="Image|contains" type="list"><item type="str">\apache</item><item type="str">\tomcat</item><item type="str">\AppData\</item><item type="str">\Temp\</item><item type="str">\Public\</item><item type="str">\PerfLogs\</item></key></item></set1_selection_image_folder><condition type="str">1 of selection* or all of set1*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>