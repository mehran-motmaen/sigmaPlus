<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Csc.EXE Execution Form Potentially Suspicious Parent</title><id type="str">b730a276-6b63-41b8-bcf8-55930c8fc6ee</id><status type="str">test</status><description type="str">Detects a potentially suspicious parent of &quot;csc.exe&quot;, which could be a sign of payload delivery.</description><references type="list"><item type="str">https://www.uptycs.com/blog/warzonerat-can-now-evade-with-process-hollowing</item><item type="str">https://reaqta.com/2017/11/short-journey-darkvnc/</item></references><author type="str">Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2019/02/11</date><modified type="str">2023/08/02</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.005</item><item type="str">attack.t1059.007</item><item type="str">attack.defense_evasion</item><item type="str">attack.t1218.005</item><item type="str">attack.t1027.004</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\csc.exe</key></item><item type="dict"><OriginalFileName type="str">csc.exe</OriginalFileName></item></selection_img><selection_parent_generic type="dict"><key name="ParentImage|endswith" type="list"><item type="str">\cscript.exe</item><item type="str">\mshta.exe</item><item type="str">\winword.exe</item><item type="str">\wscript.exe</item></key></selection_parent_generic><selection_parent_powershell type="dict"><key name="ParentImage|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key><key name="ParentCommandLine|contains" type="list"><item type="str">-Encoded </item><item type="str">FromBase64String</item></key></selection_parent_powershell><selection_parent_susp_location type="list"><item type="dict"><key name="ParentCommandLine|re" type="str">([Pp]rogram[Dd]ata|%([Ll]ocal)?[Aa]pp[Dd]ata%|\\[Aa]pp[Dd]ata\\([Ll]ocal(Ll]ow)?|[Rr]oaming))\\[^\\]{1,256}$</key></item><item type="dict"><key name="ParentCommandLine|contains" type="list"><item type="str">:\Users\Public\</item><item type="str">:\PerfLogs\</item><item type="str">\Temporary Internet</item></key></item><item type="dict"><key name="ParentCommandLine|contains|all" type="list"><item type="str">:\Users\</item><item type="str">\Favorites\</item></key></item><item type="dict"><key name="ParentCommandLine|contains|all" type="list"><item type="str">:\Users\</item><item type="str">\Favourites\</item></key></item><item type="dict"><key name="ParentCommandLine|contains|all" type="list"><item type="str">:\Users\</item><item type="str">\Contacts\</item></key></item><item type="dict"><key name="ParentCommandLine|contains|all" type="list"><item type="str">:\Users\</item><item type="str">\Pictures\</item></key></item></selection_parent_susp_location><filter_optional_ansible type="dict"><key name="ParentCommandLine|contains" type="list"><item type="str">JwB7ACIAZgBhAGkAbABlAGQAIgA6AHQAcgB1AGUALAAiAG0AcwBnACIAOgAiAEEAbgBzAGkAYgBsAGUAIAByAGUAcQB1AGkAcgBlAHMAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAdgAzAC4AMAAgAG8AcgAgAG4AZQB3AGUAcgAiAH0AJw</item><item type="str">cAewAiAGYAYQBpAGwAZQBkACIAOgB0AHIAdQBlACwAIgBtAHMAZwAiADoAIgBBAG4AcwBpAGIAbABlACAAcgBlAHEAdQBpAHIAZQBzACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHYAMwAuADAAIABvAHIAIABuAGUAdwBlAHIAIgB9ACcA</item><item type="str">nAHsAIgBmAGEAaQBsAGUAZAAiADoAdAByAHUAZQAsACIAbQBzAGcAIgA6ACIAQQBuAHMAaQBiAGwAZQAgAHIAZQBxAHUAaQByAGUAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAB2ADMALgAwACAAbwByACAAbgBlAHcAZQByACIAfQAnA</item></key></filter_optional_ansible><condition type="str">selection_img and 1 of selection_parent_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>