<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Scheduled Task Creation</title><id type="str">3a734d25-df5c-4b99-8034-af1ddb5883a4</id><status type="str">experimental</status><description type="str">Detects suspicious scheduled task creation events. Based on attributes such as paths, commands line flags, etc.</description><references type="list"><item type="str">https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4698</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/12/05</date><modified type="str">2022/12/07</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.privilege_escalation</item><item type="str">attack.persistence</item><item type="str">attack.t1053.005</item></tags><logsource type="dict"><product type="str">windows</product><service type="str">security</service><definition type="str">The Advanced Audit Policy setting Object Access &gt; Audit Other Object Access Events has to be configured to allow this detection. We also recommend extracting the Command field from the embedded XML in the event data.</definition></logsource><detection type="dict"><selection_eid type="dict"><EventID type="int">4698</EventID></selection_eid><selection_paths type="dict"><key name="TaskContent|contains" type="list"><item type="str">\AppData\Local\Temp\</item><item type="str">\AppData\Roaming\</item><item type="str">\Users\Public\</item><item type="str">\WINDOWS\Temp\</item><item type="str">C:\Temp\</item><item type="str">\Desktop\</item><item type="str">\Downloads\</item><item type="str">\Temporary Internet</item><item type="str">C:\ProgramData\</item><item type="str">C:\Perflogs\</item></key></selection_paths><selection_commands type="dict"><key name="TaskContent|contains" type="list"><item type="str">regsvr32</item><item type="str">rundll32</item><item type="str">cmd.exe&lt;/Command&gt;</item><item type="str">cmd&lt;/Command&gt;</item><item type="str">&lt;Arguments&gt;/c </item><item type="str">&lt;Arguments&gt;/k </item><item type="str">&lt;Arguments&gt;/r </item><item type="str">powershell</item><item type="str">pwsh</item><item type="str">mshta</item><item type="str">wscript</item><item type="str">cscript</item><item type="str">certutil</item><item type="str">bitsadmin</item><item type="str">bash.exe</item><item type="str">bash </item><item type="str">scrcons</item><item type="str">wmic </item><item type="str">wmic.exe</item><item type="str">forfiles</item><item type="str">scriptrunner</item><item type="str">hh.exe</item></key></selection_commands><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>