<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Common Autorun Keys Modification</title><id type="str">f59c3faf-50f3-464b-9f4c-1b67ab512d99</id><related type="list"><item type="dict"><id type="str">17f878b8-9968-4578-b814-c4217fc5768c</id><type type="str">obsoletes</type></item></related><status type="str">experimental</status><description type="str">Detects modification of autostart extensibility point (ASEP) in registry.</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md</item><item type="str">https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns</item><item type="str">https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d</item><item type="str">https://persistence-info.github.io/Data/userinitmprlogonscript.html</item></references><author type="str">Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split), wagga (name)</author><date type="str">2019/10/25</date><modified type="str">2023/03/24</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1547.001</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><main_selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains" type="list"><item type="str">\SOFTWARE\Wow6432Node\Microsoft\Windows CE Services\AutoStart</item><item type="str">\Software\Wow6432Node\Microsoft\Command Processor\Autorun</item><item type="str">\SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed Components</item><item type="str">\SOFTWARE\Microsoft\Windows CE Services\AutoStartOnDisconnect</item><item type="str">\SOFTWARE\Microsoft\Windows CE Services\AutoStartOnConnect</item><item type="str">\SYSTEM\Setup\CmdLine</item><item type="str">\Software\Microsoft\Ctf\LangBarAddin</item><item type="str">\Software\Microsoft\Command Processor\Autorun</item><item type="str">\SOFTWARE\Microsoft\Active Setup\Installed Components</item><item type="str">\SOFTWARE\Classes\Protocols\Handler</item><item type="str">\SOFTWARE\Classes\Protocols\Filter</item><item type="str">\SOFTWARE\Classes\Htmlfile\Shell\Open\Command\(Default)</item><item type="str">\Environment\UserInitMprLogonScript</item><item type="str">\SOFTWARE\Policies\Microsoft\Windows\Control Panel\Desktop\Scrnsave.exe</item><item type="str">\Software\Microsoft\Internet Explorer\UrlSearchHooks</item><item type="str">\SOFTWARE\Microsoft\Internet Explorer\Desktop\Components</item><item type="str">\Software\Classes\Clsid\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\Inprocserver32</item><item type="str">\Control Panel\Desktop\Scrnsave.exe</item></key></main_selection><filter_empty type="dict"><Details type="str">(Empty)</Details></filter_empty><filter_msoffice type="list"><item type="dict"><key name="TargetObject|contains" type="list"><item type="str">\Office\ClickToRun\REGISTRY\MACHINE\Software\Classes\PROTOCOLS\Handler\</item><item type="str">\ClickToRunStore\HKMU\SOFTWARE\Classes\PROTOCOLS\Handler\</item></key></item><item type="dict"><Details type="list"><item type="str">{314111c7-a502-11d2-bbca-00c04f8ec294}</item><item type="str">{3459B272-CC19-4448-86C9-DDC3B4B2FAD3}</item><item type="str">{42089D2D-912D-4018-9087-2B87803E93FB}</item><item type="str">{5504BE45-A83B-4808-900A-3A5C36E7F77A}</item><item type="str">{807583E5-5146-11D5-A672-00B0D022E945}</item></Details></item></filter_msoffice><filter_chrome type="dict"><key name="TargetObject|contains" type="str">\SOFTWARE\Microsoft\Active Setup\Installed Components\{8A69D345-D564-463c-AFF1-A69D9E530F96}</key></filter_chrome><filter_edge type="dict"><key name="TargetObject|contains" type="str">\SOFTWARE\Microsoft\Active Setup\Installed Components\{9459C573-B17A-45AE-9F64-1857B5D58CEE}</key></filter_edge><filter_IE type="dict"><key name="TargetObject|contains" type="str">\Software\Microsoft\Active Setup\Installed Components\{89820200-ECBD-11cf-8B85-00AA005B4383}</key></filter_IE><filter_image type="dict"><Image type="list"><item type="str">C:\Windows\System32\poqexec.exe</item><item type="str">C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe</item></Image></filter_image><filter_office type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\</item><item type="str">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\</item></key><key name="Image|endswith" type="str">\OfficeClickToRun.exe</key></filter_office><condition type="str">main_selection and not 1 of filter_*</condition></detection><fields type="list"><item type="str">SecurityID</item><item type="str">ObjectName</item><item type="str">OldValueType</item><item type="str">NewValueType</item></fields><falsepositives type="list"><item type="str">Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason</item><item type="str">Legitimate administrator sets up autorun keys for legitimate reason</item></falsepositives><level type="str">medium</level></root>