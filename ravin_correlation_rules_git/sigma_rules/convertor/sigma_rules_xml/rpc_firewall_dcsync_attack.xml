<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Possible DCSync Attack</title><id type="str">56fda488-113e-4ce9-8076-afc2457922c3</id><status type="str">test</status><description type="str">Detects remote RPC calls to MS-DRSR from non DC hosts, which could indicate DCSync / DCShadow attacks.</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-drsr/f977faaa-673e-4f66-b9bf-48c640241d47?redirectedfrom=MSDN</item><item type="str">https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-DRSR.md</item><item type="str">https://github.com/zeronetworks/rpcfirewall</item><item type="str">https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/</item></references><author type="str">Sagie Dulce, Dekel Paz</author><date type="str">2022/01/01</date><modified type="str">2022/01/01</modified><tags type="list"><item type="str">attack.t1033</item><item type="str">attack.discovery</item></tags><logsource type="dict"><product type="str">rpc_firewall</product><category type="str">application</category><definition type="str">Requirements: install and apply the RPC Firewall to all processes, enable DRSR UUID (e3514235-4b06-11d1-ab04-00c04fc2dcd2) for &quot;dangerous&quot; opcodes (not 0,1 or 12) only from trusted IPs (DCs)</definition></logsource><detection type="dict"><selection type="dict"><EventLog type="str">RPCFW</EventLog><EventID type="int">3</EventID><InterfaceUuid type="str">e3514235-4b06-11d1-ab04-00c04fc2dcd2</InterfaceUuid></selection><filter type="dict"><OpNum type="list"><item type="int">0</item><item type="int">1</item><item type="int">12</item></OpNum></filter><condition type="str">selection and not filter</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>