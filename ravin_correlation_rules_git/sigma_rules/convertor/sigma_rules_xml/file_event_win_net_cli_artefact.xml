<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious DotNET CLR Usage Log Artifact</title><id type="str">e0b06658-7d1d-4cd3-bf15-03467507ff7c</id><related type="list"><item type="dict"><id type="str">4508a70e-97ef-4300-b62b-ff27992990ea</id><type type="str">derived</type></item><item type="dict"><id type="str">e4b63079-6198-405c-abd7-3fe8b0ce3263</id><type type="str">obsoletes</type></item></related><status type="str">experimental</status><description type="str">Detects the creation of Usage Log files by the CLR (clr.dll). These files are named after the executing process once the assembly is finished executing for the first time in the (user) session context.</description><references type="list"><item type="str">https://bohops.com/2021/03/16/investigating-net-clr-usage-log-tampering-techniques-for-edr-evasion/</item><item type="str">https://github.com/olafhartong/sysmon-modular/blob/fa1ae53132403d262be2bbd7f17ceea7e15e8c78/11_file_create/include_dotnet.xml</item><item type="str">https://web.archive.org/web/20221026202428/https://gist.github.com/code-scrap/d7f152ffcdb3e0b02f7f394f5187f008</item><item type="str">https://blog.menasec.net/2019/07/interesting-difr-traces-of-net-clr.html</item></references><author type="str">frack113, omkar72, oscd.community, Wojciech Lesicki</author><date type="str">2022/11/18</date><modified type="str">2023/02/23</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1218</item></tags><logsource type="dict"><category type="str">file_event</category><product type="str">windows</product><definition type="str">Requirements: UsageLogs folder must be monitored by the sysmon configuration</definition></logsource><detection type="dict"><selection type="dict"><key name="TargetFilename|endswith" type="list"><item type="str">\UsageLogs\cmstp.exe.log</item><item type="str">\UsageLogs\cscript.exe.log</item><item type="str">\UsageLogs\mshta.exe.log</item><item type="str">\UsageLogs\msxsl.exe.log</item><item type="str">\UsageLogs\regsvr32.exe.log</item><item type="str">\UsageLogs\rundll32.exe.log</item><item type="str">\UsageLogs\svchost.exe.log</item><item type="str">\UsageLogs\wscript.exe.log</item><item type="str">\UsageLogs\wmic.exe.log</item></key></selection><filter_main_rundll32 type="dict"><key name="ParentImage|endswith" type="str">\MsiExec.exe</key><key name="ParentCommandLine|contains" type="str"> -Embedding</key><key name="Image|endswith" type="str">\rundll32.exe</key><key name="CommandLine|contains|all" type="list"><item type="str">Temp</item><item type="str">zzzzInvokeManagedCustomActionOutOfProc</item></key></filter_main_rundll32><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">Rundll32.exe with zzzzInvokeManagedCustomActionOutOfProc in command line and msiexec.exe as parent process - https://twitter.com/SBousseaden/status/1388064061087260675</item></falsepositives><level type="str">high</level></root>