<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">ClickOnce Trust Prompt Tampering</title><id type="str">ac9159cc-c364-4304-8f0a-d63fc1a0aabb</id><status type="str">experimental</status><description type="str">Detects changes to the ClickOnce trust prompt registry key in order to enable an installation from different locations such as the Internet.</description><references type="list"><item type="str">https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5</item><item type="str">https://learn.microsoft.com/en-us/visualstudio/deployment/how-to-configure-the-clickonce-trust-prompt-behavior</item></references><author type="str">@SerkinValery, Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/06/12</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1112</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains" type="str">\SOFTWARE\MICROSOFT\.NETFramework\Security\TrustManager\PromptingLevel\</key><key name="TargetObject|endswith" type="list"><item type="str">\Internet</item><item type="str">\LocalIntranet</item><item type="str">\MyComputer</item><item type="str">\TrustedSites</item><item type="str">\UntrustedSites</item></key><Details type="str">Enabled</Details></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Legitimate internal requirements.</item></falsepositives><level type="str">medium</level></root>