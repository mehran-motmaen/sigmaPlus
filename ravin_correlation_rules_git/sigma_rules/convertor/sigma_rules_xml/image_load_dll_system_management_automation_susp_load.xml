<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">PowerShell Core DLL Loaded By Non PowerShell Process</title><id type="str">092bc4b9-3d1d-43b4-a6b4-8c8acd83522f</id><related type="list"><item type="dict"><id type="str">867613fb-fa60-4497-a017-a82df74a172c</id><type type="str">obsoletes</type></item><item type="dict"><id type="str">fe6e002f-f244-4278-9263-20e4b593827f</id><type type="str">obsoletes</type></item></related><status type="str">experimental</status><description type="str">Detects loading of essential DLLs used by PowerShell, but not by the process powershell.exe. Detects behaviour similar to meterpreter&apos;s &quot;load powershell&quot; extension.</description><references type="list"><item type="str">https://adsecurity.org/?p=2921</item><item type="str">https://github.com/p3nt4/PowerShdll</item></references><author type="str">Tom Kern, oscd.community, Natalia Shornikova, Tim Shelton, Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)</author><date type="str">2019/11/14</date><modified type="str">2023/05/31</modified><tags type="list"><item type="str">attack.t1059.001</item><item type="str">attack.execution</item></tags><logsource type="dict"><category type="str">image_load</category><product type="str">windows</product></logsource><detection type="dict"><selection type="list"><item type="dict"><Description type="str">System.Management.Automation</Description></item><item type="dict"><OriginalFileName type="str">System.Management.Automation.dll</OriginalFileName></item><item type="dict"><key name="ImageLoaded|endswith" type="list"><item type="str">\System.Management.Automation.dll</item><item type="str">\System.Management.Automation.ni.dll</item></key></item></selection><filter_main_generic type="dict"><key name="Image|endswith" type="list"><item type="str">:\Program Files\PowerShell\7\pwsh.exe</item><item type="str">:\Windows\System32\dsac.exe</item><item type="str">:\WINDOWS\System32\RemoteFXvGPUDisablement.exe</item><item type="str">:\Windows\System32\runscripthelper.exe</item><item type="str">:\WINDOWS\System32\sdiagnhost.exe</item><item type="str">:\Windows\System32\ServerManager.exe</item><item type="str">:\Windows\System32\SyncAppvPublishingServer.exe</item><item type="str">:\Windows\System32\WindowsPowerShell\v1.0\powershell_ise.exe</item><item type="str">:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</item><item type="str">:\Windows\System32\winrshost.exe</item><item type="str">:\Windows\System32\wsmprovhost.exe</item><item type="str">:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell_ise.exe</item><item type="str">:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe</item><item type="str">:\Windows\SysWOW64\winrshost.exe</item><item type="str">:\Windows\SysWOW64\wsmprovhost.exe</item></key></filter_main_generic><filter_main_dotnet type="dict"><key name="Image|contains" type="list"><item type="str">:\Windows\Microsoft.NET\Framework\</item><item type="str">:\Windows\Microsoft.NET\Framework64\</item></key><key name="Image|endswith" type="str">\mscorsvw.exe</key></filter_main_dotnet><filter_optional_sql_server_mgmt type="dict"><key name="Image|contains" type="list"><item type="str">:\Program Files (x86)\Microsoft SQL Server Management Studio</item><item type="str">:\Program Files\Microsoft SQL Server Management Studio</item></key><key name="Image|endswith" type="str">\IDE\Ssms.exe</key></filter_optional_sql_server_mgmt><filter_optional_sql_server_tools type="dict"><key name="Image|contains" type="list"><item type="str">:\Program Files (x86)\Microsoft SQL Server\</item><item type="str">:\Program Files\Microsoft SQL Server\</item></key><key name="Image|endswith" type="str">\Tools\Binn\SQLPS.exe</key></filter_optional_sql_server_tools><filter_optional_citrix type="dict"><key name="Image|endswith" type="str">\Citrix\ConfigSync\ConfigSyncRun.exe</key></filter_optional_citrix><filter_optional_vs type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files (x86)\Microsoft Visual Studio\</item><item type="str">C:\Program Files\Microsoft Visual Studio\</item></key></filter_optional_vs><filter_optional_nextron type="dict"><key name="Image|startswith" type="str">C:\Windows\Temp\asgard2-agent\</key><key name="Image|endswith" type="list"><item type="str">\thor64.exe</item><item type="str">\thor.exe</item></key></filter_optional_nextron><filter_optional_aurora type="dict"><Image type="null"></Image></filter_optional_aurora><condition type="str">selection and not 1 of filter_main_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Used by some .NET binaries, minimal on user workstation.</item><item type="str">Used by Microsoft SQL Server Management Studio</item></falsepositives><level type="str">medium</level></root>