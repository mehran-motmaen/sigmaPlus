<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Non Interactive PowerShell Process Spawned</title><id type="str">f4bbd493-b796-416e-bbf2-121235348529</id><status type="str">test</status><description type="str">Detects non-interactive PowerShell activity by looking at the &quot;powershell&quot; process with a non-user GUI process such as &quot;explorer.exe&quot; as a parent.</description><references type="list"><item type="str">https://web.archive.org/web/20200925032237/https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190410151110.html</item></references><author type="str">Roberto Rodriguez @Cyb3rWard0g (rule), oscd.community (improvements)</author><date type="str">2019/09/12</date><modified type="str">2023/05/12</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">PowerShell.EXE</item><item type="str">pwsh.dll</item></OriginalFileName></item></selection><filter_main_generic type="dict"><key name="ParentImage|endswith" type="list"><item type="str">C:\Windows\explorer.exe</item><item type="str">C:\Windows\System32\CompatTelRunner.exe</item><item type="str">C:\Windows\SysWOW64\explorer.exe</item></key></filter_main_generic><filter_main_windows_update type="dict"><ParentImage type="str">C:\$WINDOWS.~BT\Sources\SetupHost.exe</ParentImage></filter_main_windows_update><filter_optional_vscode type="dict"><key name="ParentImage|startswith" type="str">C:\Users\</key><key name="ParentImage|endswith" type="str">\AppData\Local\Programs\Microsoft VS Code\Code.exe</key><key name="ParentCommandLine|contains" type="str"> --ms-enable-electron-run-as-node </key></filter_optional_vscode><condition type="str">selection and not 1 of filter_main_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Likely. Many admin scripts and tools leverage PowerShell in their BAT or VB scripts which may trigger this rule often. It is best to add additional filters or use this to hunt for anomalies</item></falsepositives><level type="str">low</level></root>