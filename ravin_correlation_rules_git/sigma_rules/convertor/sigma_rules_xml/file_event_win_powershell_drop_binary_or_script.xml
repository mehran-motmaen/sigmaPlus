<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Binary Or Script Dropper Via PowerShell</title><id type="str">7047d730-036f-4f40-b9d8-1c63e36d5e62</id><status type="str">experimental</status><description type="str">Detects PowerShell creating a binary executable or a script file.</description><references type="list"><item type="str">https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution</item></references><author type="str">frack113, Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/03/17</date><modified type="str">2023/05/09</modified><tags type="list"><item type="str">attack.persistence</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">file_event</category></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key><key name="TargetFilename|endswith" type="list"><item type="str">.bat</item><item type="str">.chm</item><item type="str">.cmd</item><item type="str">.com</item><item type="str">.dll</item><item type="str">.exe</item><item type="str">.hta</item><item type="str">.jar</item><item type="str">.js</item><item type="str">.ocx</item><item type="str">.scr</item><item type="str">.sys</item><item type="str">.vbe</item><item type="str">.vbs</item><item type="str">.wsf</item></key></selection><filter_main_user_temp type="dict"><key name="TargetFilename|startswith" type="str">C:\Users\</key><key name="TargetFilename|contains" type="str">\AppData\Local\Temp\</key><key name="TargetFilename|endswith" type="list"><item type="str">.dll</item><item type="str">.exe</item></key></filter_main_user_temp><filter_main_admin_temp type="dict"><key name="TargetFilename|startswith" type="str">C:\Windows\Temp\</key><key name="TargetFilename|endswith" type="list"><item type="str">.dll</item><item type="str">.exe</item></key></filter_main_admin_temp><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">False positives will differ depending on the environement and scripts used. Apply additional filters accordingly.</item></falsepositives><level type="str">medium</level></root>