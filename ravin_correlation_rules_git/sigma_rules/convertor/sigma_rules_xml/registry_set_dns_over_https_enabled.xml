<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">DNS-over-HTTPS Enabled by Registry</title><id type="str">04b45a8a-d11d-49e4-9acc-4a1b524407a5</id><status type="str">test</status><description type="str">Detects when a user enables DNS-over-HTTPS.
This can be used to hide internet activity or be used to hide the process of exfiltrating data.
With this enabled organization will lose visibility into data such as query type, response and originating IP that are used to determine bad actors.
</description><references type="list"><item type="str">https://www.tenforums.com/tutorials/151318-how-enable-disable-dns-over-https-doh-microsoft-edge.html</item><item type="str">https://github.com/elastic/detection-rules/issues/1371</item><item type="str">https://chromeenterprise.google/policies/?policy=DnsOverHttpsMode</item><item type="str">https://admx.help/HKLM/Software/Policies/Mozilla/Firefox/DNSOverHTTPS</item></references><author type="str">Austin Songer</author><date type="str">2021/07/22</date><modified type="str">2022/03/26</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1140</item><item type="str">attack.t1112</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">registry_set</category></logsource><detection type="dict"><selection_edge type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|endswith" type="str">\SOFTWARE\Policies\Microsoft\Edge\BuiltInDnsClientEnabled</key><Details type="str">DWORD (0x00000001)</Details></selection_edge><selection_chrome type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|endswith" type="str">\SOFTWARE\Google\Chrome\DnsOverHttpsMode</key><Details type="str">secure</Details></selection_chrome><selection_firefox type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|endswith" type="str">\SOFTWARE\Policies\Mozilla\Firefox\DNSOverHTTPS\Enabled</key><Details type="str">DWORD (0x00000001)</Details></selection_firefox><condition type="str">1 of selection_*</condition></detection><falsepositives type="list"><item type="str">Unlikely</item></falsepositives><level type="str">medium</level></root>