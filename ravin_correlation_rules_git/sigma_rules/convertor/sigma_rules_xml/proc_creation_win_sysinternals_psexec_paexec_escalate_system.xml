<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">PsExec/PAExec Escalation to LOCAL SYSTEM</title><id type="str">8834e2f7-6b4b-4f09-8906-d2276470ee23</id><related type="list"><item type="dict"><id type="str">207b0396-3689-42d9-8399-4222658efc99</id><type type="str">similar</type></item></related><status type="str">experimental</status><description type="str">Detects suspicious commandline flags used by PsExec and PAExec to escalate a command line to LOCAL_SYSTEM rights</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/sysinternals/downloads/psexec</item><item type="str">https://www.poweradmin.com/paexec/</item><item type="str">https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html</item></references><author type="str">Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2021/11/23</date><modified type="str">2023/02/28</modified><tags type="list"><item type="str">attack.resource_development</item><item type="str">attack.t1587.001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_sys type="dict"><key name="CommandLine|contains" type="list"><item type="str"> -s cmd</item><item type="str"> /s cmd</item><item type="str"> -s -i cmd</item><item type="str"> /s /i cmd</item><item type="str"> /s -i cmd</item><item type="str"> -s /i cmd</item><item type="str"> -i -s cmd</item><item type="str"> /i /s cmd</item><item type="str"> -i /s cmd</item><item type="str"> /i -s cmd</item><item type="str"> -s pwsh</item><item type="str"> /s pwsh</item><item type="str"> -s -i pwsh</item><item type="str"> /s /i pwsh</item><item type="str"> /s -i pwsh</item><item type="str"> -s /i pwsh</item><item type="str"> -i -s pwsh</item><item type="str"> /i /s pwsh</item><item type="str"> -i /s pwsh</item><item type="str"> /i -s pwsh</item><item type="str"> -s powershell</item><item type="str"> /s powershell</item><item type="str"> -s -i powershell</item><item type="str"> /s /i powershell</item><item type="str"> /s -i powershell</item><item type="str"> -s /i powershell</item><item type="str"> -i -s powershell</item><item type="str"> /i /s powershell</item><item type="str"> -i /s powershell</item><item type="str"> /i -s powershell</item></key></selection_sys><selection_other type="dict"><key name="CommandLine|contains" type="list"><item type="str">psexec</item><item type="str">paexec</item><item type="str">accepteula</item></key></selection_other><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Admins that use PsExec or PAExec to escalate to the SYSTEM account for maintenance purposes (rare)</item><item type="str">Users that debug Microsoft Intune issues using the commands mentioned in the official documentation; see https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension</item></falsepositives><level type="str">high</level></root>