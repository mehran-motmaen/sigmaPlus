<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Bpfdoor TCP Ports Redirect</title><id type="str">70b4156e-50fc-4523-aa50-c9dddf1993fc</id><status type="str">experimental</status><description type="str">All TCP traffic on particular port from attacker is routed to different port. ex. &apos;/sbin/iptables -t nat -D PREROUTING -p tcp -s 192.168.1.1 --dport 22 -j REDIRECT --to-ports 42392&apos;
The traffic looks like encrypted SSH communications going to TCP port 22, but in reality is being directed to the shell port once it hits the iptables rule for the attacker host only.
</description><references type="list"><item type="str">https://www.sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/</item><item type="str">https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor</item></references><author type="str">Rafal Piasecki</author><date type="str">2022/08/10</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1562.004</item></tags><logsource type="dict"><product type="str">linux</product><service type="str">auditd</service></logsource><detection type="dict"><cmd type="dict"><type type="str">EXECVE</type><key name="a0|endswith" type="str">iptables</key><a1 type="str">-t</a1><a2 type="str">nat</a2></cmd><keywords type="list"><item type="str">--to-ports 42</item><item type="str">--to-ports 43</item></keywords><condition type="str">cmd and keywords</condition></detection><falsepositives type="list"><item type="str">Legitimate ports redirect</item></falsepositives><level type="str">medium</level></root>