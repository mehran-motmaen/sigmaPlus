<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Remote Printing Abuse for Lateral Movement</title><id type="str">bc3a4b0c-e167-48e1-aa88-b3020950e560</id><status type="str">test</status><description type="str">Detects remote RPC calls to possibly abuse remote printing service via MS-RPRN / MS-PAR</description><references type="list"><item type="str">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527</item><item type="str">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/d42db7d5-f141-4466-8f47-0a4be14e2fc1</item><item type="str">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-pan/e44d984c-07d3-414c-8ffc-f8c8ad8512a8</item><item type="str">https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-RPRN-PAR.md</item><item type="str">https://github.com/zeronetworks/rpcfirewall</item><item type="str">https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/</item></references><author type="str">Sagie Dulce, Dekel Paz</author><date type="str">2022/01/01</date><modified type="str">2022/01/01</modified><tags type="list"><item type="str">attack.lateral_movement</item></tags><logsource type="dict"><product type="str">rpc_firewall</product><category type="str">application</category><definition type="str">Requirements: install and apply the RPC Firewall to all processes with &quot;audit:true action:block uuid:12345678-1234-abcd-ef00-0123456789ab or 76f03f96-cdfd-44fc-a22c-64950a001209 or ae33069b-a2a8-46ee-a235-ddfd339be281 or 0b6edbfa-4a24-4fc6-8a23-942b1eca65d1</definition></logsource><detection type="dict"><selection type="dict"><EventLog type="str">RPCFW</EventLog><EventID type="int">3</EventID><InterfaceUuid type="list"><item type="str">12345678-1234-abcd-ef00-0123456789ab</item><item type="str">76f03f96-cdfd-44fc-a22c-64950a001209</item><item type="str">0b6edbfa-4a24-4fc6-8a23-942b1eca65d1</item><item type="str">ae33069b-a2a8-46ee-a235-ddfd339be281</item></InterfaceUuid></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Actual printing</item></falsepositives><level type="str">high</level></root>