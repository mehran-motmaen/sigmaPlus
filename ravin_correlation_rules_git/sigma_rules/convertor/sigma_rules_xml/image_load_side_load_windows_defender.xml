<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Microsoft Defender Loading DLL from Nondefault Path</title><id type="str">418dc89a-9808-4b87-b1d7-e5ae0cb6effc</id><status type="str">experimental</status><description type="str">Detects loading of Microsoft Defender&apos;s DLLs by its processes (MpCmdRun and NisSrv) from the non-default directory which may be an attempt to sideload arbitrary DLL</description><references type="list"><item type="str">https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool</item></references><author type="str">Bhabesh Raj</author><date type="str">2022/08/02</date><modified type="str">2022/08/17</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1574.002</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">image_load</category></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="list"><item type="str">\MpCmdRun.exe</item><item type="str">\NisSrv.exe</item></key><key name="ImageLoaded|endswith" type="str">\mpclient.dll</key></selection><filter type="dict"><key name="ImageLoaded|startswith" type="list"><item type="str">C:\Program Files\Windows Defender\</item><item type="str">C:\Program Files (x86)\Windows Defender\</item><item type="str">C:\ProgramData\Microsoft\Windows Defender\Platform\</item></key></filter><condition type="str">selection and not filter</condition></detection><falsepositives type="list"><item type="str">Very unlikely</item></falsepositives><level type="str">high</level></root>