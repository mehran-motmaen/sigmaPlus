<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Import New Module Via PowerShell CommandLine</title><id type="str">4ad74d01-f48c-42d0-b88c-b31efa4d2262</id><status type="str">experimental</status><description type="str">Detects usage of the &quot;Import-Module&quot; cmdlet in order to add new Cmdlets to the current PowerShell session</description><references type="list"><item type="str">https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/import-module?view=powershell-7.3</item><item type="str">https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/import-module?view=powershell-5.1</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/05/09</date><tags type="list"><item type="str">attack.execution</item><item type="str">detection.threat_hunting</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">process_creation</category></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">PowerShell.EXE</item><item type="str">pwsh.dll</item></OriginalFileName></item></selection_img><selection_cmdlet type="dict"><key name="CommandLine|contains" type="list"><item type="str">Import-Module </item><item type="str">ipmo </item></key></selection_cmdlet><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Depending on the environement, many legitimate scripts will import modules inline. This rule is targeted for hunting purposes.</item></falsepositives><level type="str">low</level></root>