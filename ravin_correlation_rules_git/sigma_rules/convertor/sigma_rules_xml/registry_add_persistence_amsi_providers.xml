<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Via New AMSI Providers - Registry</title><id type="str">33efc23c-6ea2-4503-8cfe-bdf82ce8f705</id><status type="str">experimental</status><description type="str">Detects when an attacker registers a new AMSI provider in order to achieve persistence</description><references type="list"><item type="str">https://persistence-info.github.io/Data/amsi.html</item><item type="str">https://github.com/gtworek/PSBits/blob/8d767892f3b17eefa4d0668f5d2df78e844f01d8/FakeAMSI/FakeAMSI.c</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/07/21</date><modified type="str">2023/02/07</modified><tags type="list"><item type="str">attack.persistence</item></tags><logsource type="dict"><category type="str">registry_add</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">CreateKey</EventType><key name="TargetObject|contains" type="list"><item type="str">\SOFTWARE\Microsoft\AMSI\Providers\</item><item type="str">\SOFTWARE\WOW6432Node\Microsoft\AMSI\Providers\</item></key></selection><filter type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Windows\System32\</item><item type="str">C:\Program Files\</item><item type="str">C:\Program Files (x86)\</item></key></filter><condition type="str">selection and not filter</condition></detection><falsepositives type="list"><item type="str">Legitimate security products adding their own AMSI providers. Filter these according to your environment</item></falsepositives><level type="str">high</level></root>