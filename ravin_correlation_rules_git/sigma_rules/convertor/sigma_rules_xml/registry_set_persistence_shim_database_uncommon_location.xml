<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Via Shim Database In Uncommon Location</title><id type="str">6b6976a3-b0e6-4723-ac24-ae38a737af41</id><status type="str">experimental</status><description type="str">Detects the installation of a new shim database where the file is located in a non-default location</description><references type="list"><item type="str">https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html</item><item type="str">https://andreafortuna.org/2018/11/12/process-injection-and-persistence-using-application-shimming/</item><item type="str">https://www.blackhat.com/docs/asia-14/materials/Erickson/Asia-14-Erickson-Persist-It-Using-And-Abusing-Microsofts-Fix-It-Patches.pdf</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/08/01</date><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1546.011</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains|all" type="list"><item type="str">\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB\</item><item type="str">\DatabasePath</item></key></selection><filter_main_known_locations type="dict"><key name="Details|contains" type="str">:\Windows\AppPatch\Custom</key></filter_main_known_locations><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>