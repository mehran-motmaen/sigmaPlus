<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Removal of Potential COM Hijacking Registry Keys</title><id type="str">96f697b0-b499-4e5d-9908-a67bec11cdb6</id><status type="str">test</status><description type="str">Detects any deletion of entries in &quot;.*\shell\open\command&quot; registry keys.
These registry keys might have been used for COM hijacking activities by a threat actor or an attacker and the deletion could indicate steps to remove its tracks.
</description><references type="list"><item type="str">https://github.com/OTRF/detection-hackathon-apt29/issues/7</item><item type="str">https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.C.1_22A46621-7A92-48C1-81BF-B3937EB4FDC3.md</item><item type="str">https://docs.microsoft.com/en-us/windows/win32/shell/launch</item><item type="str">https://docs.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexecutecommand</item><item type="str">https://docs.microsoft.com/en-us/windows/win32/shell/shell-and-managed-code</item></references><author type="str">Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)</author><date type="str">2020/05/02</date><modified type="str">2023/01/19</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1112</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">registry_delete</category></logsource><detection type="dict"><selection type="dict"><EventType type="str">DeleteKey</EventType><key name="TargetObject|endswith" type="str">\shell\open\command</key></selection><filter_svchost type="dict"><Image type="str">C:\Windows\system32\svchost.exe</Image></filter_svchost><filter_office type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\</item><item type="str">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\</item></key><key name="Image|endswith" type="str">\OfficeClickToRun.exe</key></filter_office><filter_integrator type="dict"><Image type="str">C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe</Image></filter_integrator><filter_dropbox type="dict"><key name="Image|endswith" type="str">\Dropbox.exe</key><key name="TargetObject|contains" type="str">\Dropbox.</key></filter_dropbox><filter_wireshark type="dict"><key name="Image|endswith" type="str">\AppData\Local\Temp\Wireshark_uninstaller.exe</key><key name="TargetObject|contains" type="str">\wireshark-capture-file\</key></filter_wireshark><filter_opera type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\Opera\</item><item type="str">C:\Program Files (x86)\Opera\</item></key><key name="Image|endswith" type="str">\installer.exe</key></filter_opera><filter_peazip type="dict"><key name="Image|contains" type="str">peazip</key><key name="TargetObject|contains" type="str">\PeaZip.</key></filter_peazip><filter_everything type="dict"><key name="Image|endswith" type="str">\Everything.exe</key><key name="TargetObject|contains" type="str">\Everything.</key></filter_everything><filter_uninstallers type="dict"><key name="Image|startswith" type="str">C:\Windows\Installer\MSI</key></filter_uninstallers><filter_java type="dict"><key name="Image|startswith" type="str">C:\Program Files (x86)\Java\</key><key name="Image|endswith" type="str">\installer.exe</key><key name="TargetObject|contains" type="str">\Classes\WOW6432Node\CLSID\{4299124F-F2C3-41b4-9C73-9236B2AD0E8F}</key></filter_java><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Legitimate software (un)installations are known to cause some false positives. Please add them as a filter when encountered</item></falsepositives><level type="str">medium</level></root>