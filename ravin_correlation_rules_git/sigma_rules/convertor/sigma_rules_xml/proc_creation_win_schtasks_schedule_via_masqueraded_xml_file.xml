<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Scheduled Task Creation via Masqueraded XML File</title><id type="str">dd2a821e-3b07-4d3b-a9ac-929fe4c6ca0c</id><status type="str">experimental</status><description type="str">Detects the creation of a scheduled task using the &quot;-XML&quot; flag with a file without the &apos;.xml&apos; extension. This behavior could be indicative of potential defense evasion attempt during persistence</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/windows/win32/taskschd/daily-trigger-example--xml-</item><item type="str">https://github.com/elastic/protections-artifacts/blob/084067123d3328a823b1c3fdde305b694275c794/behavior/rules/persistence_suspicious_scheduled_task_creation_via_masqueraded_xml_file.toml</item></references><author type="str">Swachchhanda Shrawan Poudel, Elastic (idea)</author><date type="str">2023/04/20</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.persistence</item><item type="str">attack.t1036.005</item><item type="str">attack.t1053.005</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">process_creation</category></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\schtasks.exe</key></item><item type="dict"><OriginalFileName type="str">schtasks.exe</OriginalFileName></item></selection_img><selection_cli_create type="dict"><key name="CommandLine|contains" type="list"><item type="str">/create</item><item type="str">-create</item></key></selection_cli_create><selection_cli_xml type="dict"><key name="CommandLine|contains" type="list"><item type="str">/xml</item><item type="str">-xml</item></key></selection_cli_xml><filter_main_extension_xml type="dict"><key name="CommandLine|contains" type="str">.xml</key></filter_main_extension_xml><filter_main_system_process type="dict"><IntegrityLevel type="str">System</IntegrityLevel></filter_main_system_process><filter_main_rundll32 type="dict"><key name="ParentImage|endswith" type="str">\rundll32.exe</key><key name="ParentCommandLine|contains|all" type="list"><item type="str">:\WINDOWS\Installer\MSI</item><item type="str">.tmp,zzzzInvokeManagedCustomActionOutOfProc</item></key></filter_main_rundll32><filter_optional_third_party type="dict"><key name="ParentImage|endswith" type="list"><item type="str">:\ProgramData\OEM\UpgradeTool\CareCenter_*\BUnzip\Setup_msi.exe</item><item type="str">:\Program Files\Axis Communications\AXIS Camera Station\SetupActions.exe</item><item type="str">:\Program Files\Axis Communications\AXIS Device Manager\AdmSetupActions.exe</item><item type="str">:\Program Files (x86)\Zemana\AntiMalware\AntiMalware.exe</item><item type="str">:\Program Files\Dell\SupportAssist\pcdrcui.exe</item></key></filter_optional_third_party><condition type="str">all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>