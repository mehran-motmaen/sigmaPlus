<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Reverse Shell Command Line</title><id type="str">738d9bcf-6999-4fdb-b4ac-3033037db8ab</id><status type="str">test</status><description type="str">Detects suspicious shell commands or program code that may be executed or used in command line to establish a reverse shell</description><references type="list"><item type="str">https://alamot.github.io/reverse_shells/</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2019/04/02</date><modified type="str">2021/11/27</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.004</item></tags><logsource type="dict"><product type="str">linux</product></logsource><detection type="dict"><keywords type="list"><item type="str">BEGIN {s = &quot;/inet/tcp/0/</item><item type="str">bash -i &gt;&amp; /dev/tcp/</item><item type="str">bash -i &gt;&amp; /dev/udp/</item><item type="str">sh -i &gt;$ /dev/udp/</item><item type="str">sh -i &gt;$ /dev/tcp/</item><item type="str">&amp;&amp; while read line 0&lt;&amp;5; do</item><item type="str">/bin/bash -c exec 5&lt;&gt;/dev/tcp/</item><item type="str">/bin/bash -c exec 5&lt;&gt;/dev/udp/</item><item type="str">nc -e /bin/sh </item><item type="str">/bin/sh | nc</item><item type="str">rm -f backpipe; mknod /tmp/backpipe p &amp;&amp; nc </item><item type="str">;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))</item><item type="str">;STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;</item><item type="str">/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3</item><item type="str">uname -a; w; id; /bin/bash -i</item><item type="str">$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush()};</item><item type="str">;os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);os.putenv(&apos;HISTFILE&apos;,&apos;/dev/null&apos;);</item><item type="str">.to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)</item><item type="str">;while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;){|io|c.print</item><item type="str">socat exec:&apos;bash -li&apos;,pty,stderr,setsid,sigint,sane tcp:</item><item type="str">rm -f /tmp/p; mknod /tmp/p p &amp;&amp;</item><item type="str"> | /bin/bash | telnet </item><item type="str">,echo=0,raw tcp-listen:</item><item type="str">nc -lvvp </item><item type="str">xterm -display 1</item></keywords><condition type="str">keywords</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>