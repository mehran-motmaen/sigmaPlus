<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Data Exfiltration Activity Via CommandLine Tools</title><id type="str">7d1aaf3d-4304-425c-b7c3-162055e0b3ab</id><status type="str">experimental</status><description type="str">Detects the use of various CLI utilities exfiltrating data via web requests</description><references type="list"><item type="str">https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/08/02</date><modified type="str">2023/07/27</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_iwr type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item><item type="str">\cmd.exe</item></key><key name="CommandLine|contains" type="list"><item type="str">Invoke-WebRequest</item><item type="str">iwr </item><item type="str">wget </item><item type="str">curl </item></key><key name="CommandLine|contains|all" type="list"><item type="str"> -ur</item><item type="str"> -me</item><item type="str"> -b</item><item type="str"> POST </item></key></selection_iwr><selection_curl type="dict"><key name="Image|endswith" type="str">\curl.exe</key><key name="CommandLine|contains" type="str">--ur</key></selection_curl><selection_curl_data type="dict"><key name="CommandLine|contains" type="list"><item type="str"> -d </item><item type="str"> --data </item></key></selection_curl_data><selection_wget type="dict"><key name="Image|endswith" type="str">\wget.exe</key><key name="CommandLine|contains" type="list"><item type="str">--post-data</item><item type="str">--post-file</item></key></selection_wget><payloads type="list"><item type="dict"><key name="CommandLine|contains" type="list"><item type="str">Get-Content</item><item type="str">GetBytes</item><item type="str">hostname</item><item type="str">ifconfig</item><item type="str">ipconfig</item><item type="str">net view</item><item type="str">netstat</item><item type="str">nltest</item><item type="str">qprocess</item><item type="str">sc query</item><item type="str">systeminfo</item><item type="str">tasklist</item><item type="str">ToBase64String</item><item type="str">whoami</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">type </item><item type="str"> &gt; </item><item type="str"> C:\</item></key></item></payloads><condition type="str">(selection_iwr or all of selection_curl* or selection_wget) and payloads</condition></detection><falsepositives type="list"><item type="str">Unlikely</item></falsepositives><level type="str">high</level></root>