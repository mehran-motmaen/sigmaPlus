<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential COM Object Hijacking Via TreatAs Subkey - Registry</title><id type="str">9b0f8a61-91b2-464f-aceb-0527e0a45020</id><status type="str">experimental</status><description type="str">Detects COM object hijacking via TreatAs subkey</description><references type="list"><item type="str">https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/</item></references><author type="str">Kutepov Anton, oscd.community</author><date type="str">2019/10/23</date><modified type="str">2023/02/07</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1546.015</item></tags><logsource type="dict"><category type="str">registry_add</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">CreateKey</EventType><key name="TargetObject|contains|all" type="list"><item type="str">HKU\</item><item type="str">Classes\CLSID\</item><item type="str">\TreatAs</item></key></selection><filter_svchost type="dict"><Image type="str">C:\WINDOWS\system32\svchost.exe</Image></filter_svchost><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Maybe some system utilities in rare cases use linking keys for backward compatibility</item></falsepositives><level type="str">medium</level></root>