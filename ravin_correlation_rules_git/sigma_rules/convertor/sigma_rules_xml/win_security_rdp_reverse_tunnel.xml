<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">RDP over Reverse SSH Tunnel WFP</title><id type="str">5bed80b6-b3e8-428e-a3ae-d3c757589e41</id><status type="str">experimental</status><description type="str">Detects svchost hosting RDP termsvcs communicating with the loopback address</description><references type="list"><item type="str">https://twitter.com/SBousseaden/status/1096148422984384514</item><item type="str">https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/44fbe85f72ee91582876b49678f9a26292a155fb/Command%20and%20Control/DE_RDP_Tunnel_5156.evtx</item></references><author type="str">Samir Bousseaden</author><date type="str">2019/02/16</date><modified type="str">2022/09/02</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.command_and_control</item><item type="str">attack.lateral_movement</item><item type="str">attack.t1090.001</item><item type="str">attack.t1090.002</item><item type="str">attack.t1021.001</item><item type="str">car.2013-07-002</item></tags><logsource type="dict"><product type="str">windows</product><service type="str">security</service></logsource><detection type="dict"><selection type="dict"><EventID type="int">5156</EventID></selection><sourceRDP type="dict"><SourcePort type="int">3389</SourcePort><DestAddress type="list"><item type="str">127.*</item><item type="str">::1</item></DestAddress></sourceRDP><destinationRDP type="dict"><DestPort type="int">3389</DestPort><SourceAddress type="list"><item type="str">127.*</item><item type="str">::1</item></SourceAddress></destinationRDP><filter_app_container type="dict"><FilterOrigin type="str">AppContainer Loopback</FilterOrigin></filter_app_container><filter_thor type="dict"><key name="Application|endswith" type="list"><item type="str">\thor.exe</item><item type="str">\thor64.exe</item></key></filter_thor><condition type="str">selection and ( sourceRDP or destinationRDP ) and not 1 of filter*</condition></detection><falsepositives type="list"><item type="str">Programs that connect locally to the RDP port</item></falsepositives><level type="str">high</level></root>