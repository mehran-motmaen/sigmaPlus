<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Remote Thread Creation In Uncommon Target Image</title><id type="str">a1a144b7-5c9b-4853-a559-2172be8d4a03</id><related type="list"><item type="dict"><id type="str">f016c716-754a-467f-a39e-63c06f773987</id><type type="str">obsoletes</type></item></related><status type="str">experimental</status><description type="str">Detects uncommon target processes for remote thread creation</description><references type="list"><item type="str">https://blog.redbluepurple.io/offensive-research/bypassing-injection-detection</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2022/03/16</date><modified type="str">2023/07/13</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.privilege_escalation</item><item type="str">attack.t1055.003</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">create_remote_thread</category></logsource><detection type="dict"><selection type="dict"><key name="TargetImage|endswith" type="list"><item type="str">\calc.exe</item><item type="str">\calculator.exe</item><item type="str">\explorer.exe</item><item type="str">\mspaint.exe</item><item type="str">\notepad.exe</item><item type="str">\ping.exe</item><item type="str">\sethc.exe</item><item type="str">\spoolsv.exe</item><item type="str">\wordpad.exe</item><item type="str">\write.exe</item></key></selection><filter_optional_spoolsv type="dict"><SourceImage type="str">C:\Windows\System32\csrss.exe</SourceImage><TargetImage type="str">C:\Windows\System32\spoolsv.exe</TargetImage></filter_optional_spoolsv><filter_optional_aurora_1 type="dict"><StartFunction type="str">EtwpNotificationThread</StartFunction></filter_optional_aurora_1><filter_optional_aurora_2 type="dict"><key name="SourceImage|contains" type="str">unknown process</key></filter_optional_aurora_2><filter_optional_vmtoolsd type="dict"><SourceImage type="str">C:\Program Files\VMware\VMware Tools\vmtoolsd.exe</SourceImage><StartFunction type="str">GetCommandLineW</StartFunction><TargetImage type="list"><item type="str">C:\Windows\explorer.exe</item><item type="str">C:\Windows\System32\notepad.exe</item><item type="str">C:\Windows\System32\spoolsv.exe</item></TargetImage></filter_optional_vmtoolsd><filter_optional_rundll32 type="dict"><SourceImage type="str">C:\Windows\System32\rundll32.exe</SourceImage><TargetImage type="str">C:\Windows\explorer.exe</TargetImage><StartFunction type="list"><item type="str">LoadLibraryW</item><item type="str">FreeLibrary</item></StartFunction></filter_optional_rundll32><filter_optional_winzip type="dict"><SourceImage type="str">C:\Program Files\WinZip\FAHWindow64.exe</SourceImage><TargetImage type="str">C:\Windows\explorer.exe</TargetImage></filter_optional_winzip><condition type="str">selection and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>