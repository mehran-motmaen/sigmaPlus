<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential PetitPotam Attack Via EFS RPC Calls</title><id type="str">4096842a-8f9f-4d36-92b4-d0b2a62f9b2a</id><status type="str">test</status><description type="str">Detects usage of the windows RPC library Encrypting File System Remote Protocol (MS-EFSRPC). Variations of this RPC are used within the attack refereed to as PetitPotam.
The usage of this RPC function should be rare if ever used at all.
Thus usage of this function is uncommon enough that any usage of this RPC function should warrant further investigation to determine if it is legitimate.
 View surrounding logs (within a few minutes before and after) from the Source IP to. Logs from from the Source IP would include dce_rpc, smb_mapping, smb_files, rdp, ntlm, kerberos, etc..&apos;
</description><references type="list"><item type="str">https://github.com/topotam/PetitPotam/blob/d83ac8f2dd34654628c17490f99106eb128e7d1e/PetitPotam/PetitPotam.cpp</item><item type="str">https://msrc.microsoft.com/update-guide/vulnerability/ADV210003</item><item type="str">https://vx-underground.org/archive/Symantec/windows-vista-network-attack-07-en.pdf</item><item type="str">https://threatpost.com/microsoft-petitpotam-poc/168163/</item></references><author type="str">@neu5ron, @Antonlovesdnb, Mike Remen</author><date type="str">2021/08/17</date><modified type="str">2022/11/28</modified><tags type="list"><item type="str">attack.t1557.001</item><item type="str">attack.t1187</item></tags><logsource type="dict"><product type="str">zeek</product><service type="str">dce_rpc</service></logsource><detection type="dict"><selection type="dict"><key name="operation|startswith" type="str">efs</key></selection><condition type="str">selection</condition></detection><fields type="list"><item type="str">id.orig_h</item><item type="str">id.resp_h</item><item type="str">id.resp_p</item><item type="str">operation</item><item type="str">endpoint</item><item type="str">named_pipe</item><item type="str">uid</item></fields><falsepositives type="list"><item type="str">Uncommon but legitimate windows administrator or software tasks that make use of the Encrypting File System RPC Calls. Verify if this is common activity (see description).</item></falsepositives><level type="str">medium</level></root>