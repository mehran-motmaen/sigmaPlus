<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">PowerShell Script Dropped Via PowerShell.EXE</title><id type="str">576426ad-0131-4001-ae01-be175da0c108</id><status type="str">experimental</status><description type="str">Detects PowerShell creating a PowerShell file (.ps1). While often times this behavior is benign, sometimes it can be a sign of a dropper script trying to achieve persistence.</description><references type="list"><item type="str">https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution</item></references><author type="str">frack113</author><date type="str">2023/05/09</date><tags type="list"><item type="str">attack.persistence</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">file_event</category></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key><key name="TargetFilename|endswith" type="str">.ps1</key></selection><filter_main_psscriptpolicytest type="dict"><key name="TargetFilename|contains" type="str">__PSScriptPolicyTest_</key></filter_main_psscriptpolicytest><filter_main_appdata type="dict"><key name="TargetFilename|startswith" type="str">C:\Users\</key><key name="TargetFilename|contains" type="str">\AppData\Local\Temp\</key></filter_main_appdata><filter_main_windows_temp type="dict"><key name="TargetFilename|startswith" type="str">C:\Windows\Temp\</key></filter_main_windows_temp><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">False positives will differ depending on the environement and scripts used. Apply additional filters accordingly.</item></falsepositives><level type="str">low</level></root>