<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Linux Keylogging with Pam.d</title><id type="str">49aae26c-450e-448b-911d-b3c13d178dfc</id><status type="str">test</status><description type="str">Detect attempt to enable auditing of TTY input</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.001/T1056.001.md</item><item type="str">https://linux.die.net/man/8/pam_tty_audit</item><item type="str">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/sec-configuring_pam_for_auditing</item><item type="str">https://access.redhat.com/articles/4409591#audit-record-types-2</item></references><author type="str">Pawel Mazur</author><date type="str">2021/05/24</date><modified type="str">2022/12/18</modified><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1003</item><item type="str">attack.t1056.001</item></tags><logsource type="dict"><product type="str">linux</product><service type="str">auditd</service></logsource><detection type="dict"><selection_path_events type="dict"><type type="str">PATH</type><name type="list"><item type="str">/etc/pam.d/system-auth</item><item type="str">/etc/pam.d/password-auth</item></name></selection_path_events><selection_tty_events type="dict"><type type="list"><item type="str">TTY</item><item type="str">USER_TTY</item></type></selection_tty_events><condition type="str">1 of selection_*</condition></detection><falsepositives type="list"><item type="str">Administrative work</item></falsepositives><level type="str">high</level></root>