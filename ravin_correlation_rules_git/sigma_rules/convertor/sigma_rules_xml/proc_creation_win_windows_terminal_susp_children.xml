<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious WindowsTerminal Child Processes</title><id type="str">8de89e52-f6e1-4b5b-afd1-41ecfa300d48</id><status type="str">experimental</status><description type="str">Detects suspicious children spawned via the Windows Terminal application which could be a sign of persistence via WindowsTerminal (see references section)</description><references type="list"><item type="str">https://persistence-info.github.io/Data/windowsterminalprofile.html</item><item type="str">https://twitter.com/nas_bench/status/1550836225652686848</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/07/25</date><modified type="str">2023/02/14</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.persistence</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_parent type="dict"><key name="ParentImage|endswith" type="list"><item type="str">\WindowsTerminal.exe</item><item type="str">\wt.exe</item></key></selection_parent><selection_susp type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\rundll32.exe</item><item type="str">\regsvr32.exe</item><item type="str">\certutil.exe</item><item type="str">\cscript.exe</item><item type="str">\wscript.exe</item><item type="str">\csc.exe</item></key></item><item type="dict"><key name="Image|contains" type="list"><item type="str">C:\Users\Public\</item><item type="str">\Downloads\</item><item type="str">\Desktop\</item><item type="str">\AppData\Local\Temp\</item><item type="str">\Windows\TEMP\</item></key></item><item type="dict"><key name="CommandLine|contains" type="list"><item type="str"> iex </item><item type="str"> icm</item><item type="str">Invoke-</item><item type="str">Import-Module </item><item type="str">ipmo </item><item type="str">DownloadString(</item><item type="str"> /c </item><item type="str"> /k </item><item type="str"> /r </item></key></item></selection_susp><filter_builtin_visual_studio_shell type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">Import-Module</item><item type="str">Microsoft.VisualStudio.DevShell.dll</item><item type="str">Enter-VsDevShell</item></key></filter_builtin_visual_studio_shell><filter_open_settings type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">\AppData\Local\Packages\Microsoft.WindowsTerminal_</item><item type="str">\LocalState\settings.json</item></key></filter_open_settings><filter_vsdevcmd type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">C:\Program Files\Microsoft Visual Studio\</item><item type="str">\Common7\Tools\VsDevCmd.bat</item></key></filter_vsdevcmd><condition type="str">all of selection_* and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Other legitimate &quot;Windows Terminal&quot; profiles</item></falsepositives><level type="str">medium</level></root>