<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Svchost DLL Search Order Hijack</title><id type="str">602a1f13-c640-4d73-b053-be9a2fa58b77</id><status type="str">test</status><description type="str">Detects DLL sideloading of DLLs that are loaded by the SCM for some services (IKE, IKEEXT, SessionEnv) which do not exists on a typical modern system
IKEEXT and SessionEnv service, as they call LoadLibrary on files that do not exist within C:\Windows\System32\ by default.
An attacker can place their malicious logic within the PROCESS_ATTACH block of their library and restart the aforementioned services &quot;svchost.exe -k netsvcs&quot; to gain code execution on a remote machine.
</description><references type="list"><item type="str">https://decoded.avast.io/martinchlumecky/png-steganography/</item><item type="str">https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992</item></references><author type="str">SBousseaden</author><date type="str">2019/10/28</date><modified type="str">2021/11/27</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.defense_evasion</item><item type="str">attack.t1574.002</item><item type="str">attack.t1574.001</item></tags><logsource type="dict"><category type="str">image_load</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="str">\svchost.exe</key><key name="ImageLoaded|endswith" type="list"><item type="str">\tsmsisrv.dll</item><item type="str">\tsvipsrv.dll</item><item type="str">\wlbsctrl.dll</item></key></selection><filter type="dict"><key name="ImageLoaded|startswith" type="str">C:\Windows\WinSxS\</key></filter><condition type="str">selection and not filter</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>