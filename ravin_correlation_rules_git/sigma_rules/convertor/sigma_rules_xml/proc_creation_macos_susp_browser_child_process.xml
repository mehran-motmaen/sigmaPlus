<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Browser Child Process - MacOS</title><id type="str">0250638a-2b28-4541-86fc-ea4c558fa0c6</id><status type="str">experimental</status><description type="str">Detects suspicious child processes spawned from browsers. This could be a result of a potential web browser exploitation.</description><references type="list"><item type="str">https://fr.slideshare.net/codeblue_jp/cb19-recent-apt-attack-on-crypto-exchange-employees-by-heungsoo-kang</item><item type="str">https://github.com/elastic/detection-rules/blob/4312d8c9583be524578a14fe6295c3370b9a9307/rules/macos/execution_initial_access_suspicious_browser_childproc.toml</item></references><author type="str">Sohan G (D4rkCiph3r)</author><date type="str">2023/04/05</date><tags type="list"><item type="str">attack.initial_access</item><item type="str">attack.execution</item><item type="str">attack.t1189</item><item type="str">attack.t1203</item><item type="str">attack.t1059</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">macos</product></logsource><detection type="dict"><selection type="dict"><key name="ParentImage|contains" type="list"><item type="str">com.apple.WebKit.WebContent</item><item type="str">firefox</item><item type="str">Google Chrome Helper</item><item type="str">Google Chrome</item><item type="str">Microsoft Edge</item><item type="str">Opera</item><item type="str">Safari</item><item type="str">Tor Browser</item></key><key name="Image|endswith" type="list"><item type="str">/bash</item><item type="str">/curl</item><item type="str">/dash</item><item type="str">/ksh</item><item type="str">/osascript</item><item type="str">/perl</item><item type="str">/php</item><item type="str">/pwsh</item><item type="str">/python</item><item type="str">/sh</item><item type="str">/tcsh</item><item type="str">/wget</item><item type="str">/zsh</item></key></selection><filter_main_generic type="dict"><key name="CommandLine|contains" type="str">--defaults-torrc</key></filter_main_generic><filter_main_ms_autoupdate type="dict"><key name="CommandLine|contains" type="str">/Library/Application Support/Microsoft/MAU*/Microsoft AutoUpdate.app/Contents/MacOS/msupdate</key></filter_main_ms_autoupdate><filter_main_chrome type="dict"><key name="ParentImage|contains" type="list"><item type="str">Google Chrome Helper</item><item type="str">Google Chrome</item></key><key name="CommandLine|contains" type="list"><item type="str">/Volumes/Google Chrome/Google Chrome.app/Contents/Frameworks/*/Resources/install.sh</item><item type="str">/Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/*/Resources/keystone_promote_preflight.sh</item><item type="str">/Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/*/Resources/keystone_promote_postflight.sh</item></key></filter_main_chrome><filter_main_ms_edge type="dict"><key name="ParentImage|contains" type="str">Microsoft Edge</key><key name="CommandLine|contains" type="list"><item type="str">IOPlatformExpertDevice</item><item type="str">hw.model</item></key></filter_main_ms_edge><filter_main_chromerecovery type="dict"><key name="ParentImage|contains" type="list"><item type="str">Google Chrome Helper</item><item type="str">Google Chrome</item></key><key name="CommandLine|contains|all" type="list"><item type="str">/Users/</item><item type="str">/Library/Application Support/Google/Chrome/recovery/</item><item type="str">/ChromeRecovery</item></key></filter_main_chromerecovery><filter_optional_null type="dict"><CommandLine type="null"></CommandLine></filter_optional_null><filter_optional_empty type="dict"><CommandLine type="str"></CommandLine></filter_optional_empty><condition type="str">selection and not 1 of filter_main_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Legitimate browser install, update and recovery scripts</item></falsepositives><level type="str">medium</level></root>