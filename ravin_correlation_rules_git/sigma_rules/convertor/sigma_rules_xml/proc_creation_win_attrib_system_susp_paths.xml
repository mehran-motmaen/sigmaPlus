<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Set Suspicious Files as System Files Using Attrib.EXE</title><id type="str">efec536f-72e8-4656-8960-5e85d091345b</id><related type="list"><item type="dict"><id type="str">bb19e94c-59ae-4c15-8c12-c563d23fe52b</id><type type="str">derived</type></item></related><status type="str">experimental</status><description type="str">Detects the usage of attrib with the &quot;+s&quot; option to set scripts or executables located in suspicious locations as system files to hide them from users and make them unable to be deleted with simple rights. The rule limits the search to specific extensions and directories to avoid FPs
</description><references type="list"><item type="str">https://app.any.run/tasks/c28cabc8-a19f-40f3-a78b-cae506a5c0d4</item><item type="str">https://app.any.run/tasks/cfc8870b-ccd7-4210-88cf-a8087476a6d0</item><item type="str">https://unit42.paloaltonetworks.com/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/06/28</date><modified type="str">2023/03/14</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1564.001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\attrib.exe</key></item><item type="dict"><OriginalFileName type="str">ATTRIB.EXE</OriginalFileName></item></selection_img><selection_cli type="dict"><key name="CommandLine|contains" type="str"> +s</key></selection_cli><selection_paths type="dict"><key name="CommandLine|contains" type="list"><item type="str"> %</item><item type="str">\Users\Public\</item><item type="str">\AppData\Local\</item><item type="str">\ProgramData\</item><item type="str">\Downloads\</item><item type="str">\Windows\Temp\</item></key></selection_paths><selection_ext type="dict"><key name="CommandLine|contains" type="list"><item type="str">.bat</item><item type="str">.dll</item><item type="str">.exe</item><item type="str">.hta</item><item type="str">.ps1</item><item type="str">.vbe</item><item type="str">.vbs</item></key></selection_ext><filter type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">\Windows\TEMP\</item><item type="str">.exe</item></key></filter><condition type="str">all of selection* and not filter</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>