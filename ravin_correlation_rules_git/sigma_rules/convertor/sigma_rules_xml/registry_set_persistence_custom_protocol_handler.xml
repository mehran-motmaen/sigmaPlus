<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Via Custom Protocol Handler</title><id type="str">fdbf0b9d-0182-4c43-893b-a1eaab92d085</id><status type="str">experimental</status><description type="str">Detects potential persistence activity via the registering of a new custom protocole handlers. While legitimate applications register protocole handlers often times during installation. And attacker can abuse this by setting a custom handler to be used as a persistence mechanism.</description><references type="list"><item type="str">https://ladydebug.com/blog/2019/06/21/custom-protocol-handler-cph/</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/05/30</date><modified type="str">2023/05/12</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1112</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="TargetObject|startswith" type="str">HKCR\</key><key name="Details|startswith" type="str">URL:</key></selection><filter_main_ms_trusted type="dict"><key name="Details|startswith" type="str">URL:ms-</key></filter_main_ms_trusted><filter_main_generic_locations type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files (x86)</item><item type="str">C:\Program Files\</item><item type="str">C:\Windows\System32\</item><item type="str">C:\Windows\SysWOW64\</item></key></filter_main_generic_locations><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">Many legitimate applications can register a new custom protocol handler. Additional filters needs to applied according to your environement.</item></falsepositives><level type="str">medium</level></root>