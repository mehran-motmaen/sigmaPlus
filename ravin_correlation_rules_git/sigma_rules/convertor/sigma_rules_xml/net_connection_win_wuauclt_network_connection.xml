<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Wuauclt Network Connection</title><id type="str">c649a6c7-cd8c-4a78-9c04-000fc76df954</id><status type="str">test</status><description type="str">Detects the use of the Windows Update Client binary (wuauclt.exe) to proxy execute code and making a network connections.
One could easily make the DLL spawn a new process and inject to it to proxy the network connection and bypass this rule.
</description><references type="list"><item type="str">https://dtm.uk/wuauclt/</item></references><author type="str">Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)</author><date type="str">2020/10/12</date><modified type="str">2023/01/20</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1218</item></tags><logsource type="dict"><category type="str">network_connection</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="Image|contains" type="str">wuauclt</key></selection><filter_msrange type="dict"><key name="DestinationIp|startswith" type="list"><item type="str">20.184.</item><item type="str">20.185.</item><item type="str">20.186.</item><item type="str">20.187.</item><item type="str">20.188.</item><item type="str">20.189.</item><item type="str">20.190.</item><item type="str">20.191.</item><item type="str">23.79.</item><item type="str">51.10.</item><item type="str">51.103.</item><item type="str">51.104.</item><item type="str">51.105.</item><item type="str">52.239.</item></key></filter_msrange><filter_cmdline type="dict"><key name="CommandLine|contains" type="str">\UpdateDeploy.dll /ClassId </key></filter_cmdline><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Legitimate use of wuauclt.exe over the network.</item></falsepositives><level type="str">medium</level></root>