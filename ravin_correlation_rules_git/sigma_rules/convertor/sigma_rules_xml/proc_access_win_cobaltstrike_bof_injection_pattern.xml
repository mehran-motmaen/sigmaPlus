<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">CobaltStrike BOF Injection Pattern</title><id type="str">09706624-b7f6-455d-9d02-adee024cee1d</id><status type="str">test</status><description type="str">Detects a typical pattern of a CobaltStrike BOF which inject into other processes</description><references type="list"><item type="str">https://github.com/boku7/injectAmsiBypass</item><item type="str">https://github.com/boku7/spawn</item></references><author type="str">Christian Burkard (Nextron Systems)</author><date type="str">2021/08/04</date><modified type="str">2022/12/31</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1106</item><item type="str">attack.defense_evasion</item><item type="str">attack.t1562.001</item></tags><logsource type="dict"><category type="str">process_access</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="CallTrace|re" type="str">^C:\\Windows\\SYSTEM32\\ntdll\.dll\+[a-z0-9]{4,6}\|C:\\Windows\\System32\\KERNELBASE\.dll\+[a-z0-9]{4,6}\|UNKNOWN\([A-Z0-9]{16}\)$</key><GrantedAccess type="list"><item type="str">0x1028</item><item type="str">0x1fffff</item></GrantedAccess></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>