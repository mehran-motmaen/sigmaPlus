<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">COM Hijacking via TreatAs</title><id type="str">dc5c24af-6995-49b2-86eb-a9ff62199e82</id><status type="str">experimental</status><description type="str">Detect modification of TreatAs key to enable &quot;rundll32.exe -sta&quot; command</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1546.015/T1546.015.md</item><item type="str">https://www.youtube.com/watch?v=3gz1QmiMhss&amp;t=1251s</item></references><author type="str">frack113</author><date type="str">2022/08/28</date><modified type="str">2023/01/06</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1546.015</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|endswith" type="str">TreatAs\(Default)</key></selection><filter_office type="dict"><key name="Image|startswith" type="str">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\</key><key name="Image|endswith" type="str">\OfficeClickToRun.exe</key></filter_office><filter_office2 type="dict"><Image type="str">C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe</Image></filter_office2><filter_svchost type="dict"><Image type="str">C:\Windows\system32\svchost.exe</Image></filter_svchost><filter_misexec type="dict"><Image type="list"><item type="str">C:\Windows\system32\msiexec.exe</item><item type="str">C:\Windows\SysWOW64\msiexec.exe</item></Image></filter_misexec><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Legitimate use</item></falsepositives><level type="str">medium</level></root>