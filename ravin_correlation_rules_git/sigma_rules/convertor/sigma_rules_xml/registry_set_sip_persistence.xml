<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Persistence Via New SIP Provider</title><id type="str">5a2b21ee-6aaa-4234-ac9d-59a59edf90a1</id><status type="str">experimental</status><description type="str">Detects when an attacker register a new SIP provider for persistence and defense evasion</description><references type="list"><item type="str">https://persistence-info.github.io/Data/codesigning.html</item><item type="str">https://github.com/gtworek/PSBits/tree/master/SIP</item><item type="str">https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/07/21</date><modified type="str">2022/09/21</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.defense_evasion</item><item type="str">attack.t1553.003</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection_root type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains" type="list"><item type="str">\SOFTWARE\Microsoft\Cryptography\Providers\</item><item type="str">\SOFTWARE\Microsoft\Cryptography\OID\EncodingType</item><item type="str">\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\</item><item type="str">\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID\EncodingType</item></key></selection_root><selection_dll type="dict"><key name="TargetObject|contains" type="list"><item type="str">\Dll</item><item type="str">\$DLL</item></key></selection_dll><filter type="dict"><Details type="list"><item type="str">WINTRUST.DLL</item><item type="str">mso.dll</item></Details></filter><filter_poqexec type="dict"><Image type="str">C:\Windows\System32\poqexec.exe</Image><key name="TargetObject|contains" type="str">\CryptSIPDll</key><Details type="str">C:\Windows\System32\PsfSip.dll</Details></filter_poqexec><condition type="str">all of selection_* and not 1 of filter*</condition></detection><falsepositives type="list"><item type="str">Legitimate SIP being registered by the OS or different software.</item></falsepositives><level type="str">medium</level></root>