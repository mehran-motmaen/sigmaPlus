<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Malicious PowerView PowerShell Commandlets</title><id type="str">dcd74b95-3f36-4ed9-9598-0490951643aa</id><related type="list"><item type="dict"><id type="str">b2317cfa-4a47-4ead-b3ff-297438c0bc2d</id><type type="str">similar</type></item></related><status type="str">test</status><description type="str">Detects Commandlet names from PowerView of PowerSploit exploitation framework.</description><references type="list"><item type="str">https://powersploit.readthedocs.io/en/stable/Recon/README</item><item type="str">https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon</item><item type="str">https://thedfirreport.com/2020/10/08/ryuks-return</item><item type="str">https://adsecurity.org/?p=2277</item></references><author type="str">Bhabesh Raj</author><date type="str">2021/05/18</date><modified type="str">2023/04/20</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><selection type="dict"><key name="ScriptBlockText|contains" type="list"><item type="str">Add-DomainGroupMember</item><item type="str">Add-DomainObjectAcl</item><item type="str">Add-ObjectAcl</item><item type="str">Add-RemoteConnection</item><item type="str">Convert-ADName</item><item type="str">ConvertFrom-UACValue</item><item type="str">Convert-NameToSid</item><item type="str">ConvertTo-SID</item><item type="str">Export-PowerViewCSV</item><item type="str">Find-DomainLocalGroupMember</item><item type="str">Find-DomainObjectPropertyOutlier</item><item type="str">Find-DomainProcess</item><item type="str">Find-DomainShare</item><item type="str">Find-DomainUserEvent</item><item type="str">Find-DomainUserLocation</item><item type="str">Find-ForeignGroup</item><item type="str">Find-ForeignUser</item><item type="str">Find-GPOComputerAdmin</item><item type="str">Find-GPOLocation</item><item type="str">Find-InterestingDomain</item><item type="str">Find-InterestingFile</item><item type="str">Find-LocalAdminAccess</item><item type="str">Find-ManagedSecurityGroups</item><item type="str">Get-CachedRDPConnection</item><item type="str">Get-DFSshare</item><item type="str">Get-DNSRecord</item><item type="str">Get-DNSZone</item><item type="str">Get-DomainComputer</item><item type="str">Get-DomainController</item><item type="str">Get-DomainDFSShare</item><item type="str">Get-DomainDNSRecord</item><item type="str">Get-DomainDNSZone</item><item type="str">Get-DomainFileServer</item><item type="str">Get-DomainGPO</item><item type="str">Get-DomainGroup</item><item type="str">Get-DomainGroupMember</item><item type="str">Get-DomainManagedSecurityGroup</item><item type="str">Get-DomainObject</item><item type="str">Get-DomainObjectAcl</item><item type="str">Get-DomainOU</item><item type="str">Get-DomainPolicy</item><item type="str">Get-DomainSID</item><item type="str">Get-DomainSite</item><item type="str">Get-DomainSPNTicket</item><item type="str">Get-DomainSubnet</item><item type="str">Get-DomainUser</item><item type="str">Get-DomainUserEvent</item><item type="str">Get-Forest</item><item type="str">Get-IPAddress</item><item type="str">Get-LastLoggedOn</item><item type="str">Get-LoggedOnLocal</item><item type="str">Get-NetComputer</item><item type="str">Get-NetDomain</item><item type="str">Get-NetFileServer</item><item type="str">Get-NetForest</item><item type="str">Get-NetGPO</item><item type="str">Get-NetGroup</item><item type="str">Get-NetLocalGroup</item><item type="str">Get-NetLoggedon</item><item type="str">Get-NetOU</item><item type="str">Get-NetProcess</item><item type="str">Get-NetRDPSession</item><item type="str">Get-NetSession</item><item type="str">Get-NetShare</item><item type="str">Get-NetSite</item><item type="str">Get-NetSubnet</item><item type="str">Get-NetUser</item><item type="str">Get-ObjectAcl</item><item type="str">Get-PathAcl</item><item type="str">Get-Proxy</item><item type="str">Get-RegistryMountedDrive</item><item type="str">Get-RegLoggedOn</item><item type="str">Get-SiteName</item><item type="str">Get-UserEvent</item><item type="str">Get-WMIProcess</item><item type="str">Get-WMIReg</item><item type="str">Invoke-ACLScanner</item><item type="str">Invoke-CheckLocalAdminAccess</item><item type="str">Invoke-EnumerateLocalAdmin</item><item type="str">Invoke-EventHunter</item><item type="str">Invoke-FileFinder</item><item type="str">Invoke-Kerberoast</item><item type="str">Invoke-MapDomainTrust</item><item type="str">Invoke-ProcessHunter</item><item type="str">Invoke-RevertToSelf</item><item type="str">Invoke-ShareFinder</item><item type="str">Invoke-UserHunter</item><item type="str">Invoke-UserImpersonation</item><item type="str">New-DomainGroup</item><item type="str">New-DomainUser</item><item type="str">Remove-RemoteConnection</item><item type="str">Request-SPNTicket</item><item type="str">Resolve-IPAddress</item><item type="str">Set-ADObject</item><item type="str">Set-DomainObject</item><item type="str">Set-DomainUserPassword</item><item type="str">Test-AdminAccess</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Should not be any as administrators do not use this tool</item></falsepositives><level type="str">high</level></root>