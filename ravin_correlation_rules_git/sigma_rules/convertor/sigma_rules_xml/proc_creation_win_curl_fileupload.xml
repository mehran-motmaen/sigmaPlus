<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Data Exfiltration Via Curl.EXE</title><id type="str">00bca14a-df4e-4649-9054-3f2aa676bc04</id><status type="str">test</status><description type="str">Detects the execution of the &quot;curl&quot; process with &quot;upload&quot; flags. Which might indicate potential data exfiltration</description><references type="list"><item type="str">https://twitter.com/d1r4c/status/1279042657508081664</item><item type="str">https://medium.com/@petehouston/upload-files-with-curl-93064dcccc76</item><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-19---curl-upload-file</item><item type="str">https://curl.se/docs/manpage.html</item></references><author type="str">Florian Roth (Nextron Systems), Cedric MAURUGEON (Update)</author><date type="str">2020/07/03</date><modified type="str">2023/05/02</modified><tags type="list"><item type="str">attack.exfiltration</item><item type="str">attack.t1567</item><item type="str">attack.t1105</item><item type="str">detection.threat_hunting</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="str">\curl.exe</key></item><item type="dict"><Product type="str">The curl executable</Product></item></selection_img><selection_cli type="list"><item type="dict"><key name="CommandLine|contains" type="list"><item type="str"> --form</item><item type="str"> --upload-file </item><item type="str"> --data </item><item type="str"> --data-</item></key></item><item type="dict"><key name="CommandLine|re" type="str">\s-[FTd]\s</key></item></selection_cli><filter_optional_localhost type="dict"><key name="CommandLine|contains" type="list"><item type="str">://localhost</item><item type="str">://127.0.0.1</item></key></filter_optional_localhost><condition type="str">all of selection_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Scripts created by developers and admins</item></falsepositives><level type="str">medium</level></root>