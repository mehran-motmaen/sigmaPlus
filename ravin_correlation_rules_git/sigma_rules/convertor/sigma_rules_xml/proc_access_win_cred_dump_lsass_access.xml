<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Credential Dumping Tools Accessing LSASS Memory</title><id type="str">32d0d3e2-e58d-4d41-926b-18b520b2b32d</id><status type="str">experimental</status><description type="str">Detects processes requesting access to LSASS memory via suspicious access masks. This is typical for credentials dumping tools</description><references type="list"><item type="str">https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&amp;ithint=file%2cpptx&amp;app=PowerPoint&amp;authkey=!AMvCRTKB_V1J5ow</item><item type="str">https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html</item><item type="str">https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment</item><item type="str">http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf</item></references><author type="str">Florian Roth, Roberto Rodriguez, Dimitrios Slamaris, Mark Russinovich, Thomas Patzke, Teymur Kheirkhabarov, Sherif Eldeeb, James Dickenson, Aleksey Potapov, oscd.community</author><date type="str">2017/02/16</date><modified type="str">2023/03/22</modified><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1003.001</item><item type="str">attack.s0002</item><item type="str">car.2019-04-004</item></tags><logsource type="dict"><category type="str">process_access</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="TargetImage|endswith" type="str">\lsass.exe</key><key name="GrantedAccess|startswith" type="list"><item type="str">0x40</item><item type="str">0x100000</item><item type="str">0x1410</item><item type="str">0x1438</item><item type="str">0x143a</item><item type="str">0x1418</item><item type="str">0x1f0fff</item><item type="str">0x1f1fff</item><item type="str">0x1f2fff</item><item type="str">0x1f3fff</item></key></selection><filter_exact type="dict"><SourceImage type="list"><item type="str">C:\WINDOWS\system32\taskmgr.exe</item><item type="str">C:\Windows\System32\perfmon.exe</item></SourceImage></filter_exact><filter_generic type="dict"><key name="SourceImage|startswith" type="list"><item type="str">C:\Program Files\</item><item type="str">C:\Program Files (x86)\</item></key><GrantedAccess type="list"><item type="str">0x1410</item><item type="str">0x410</item></GrantedAccess></filter_generic><filter_defender type="dict"><key name="SourceImage|startswith" type="list"><item type="str">C:\ProgramData\Microsoft\Windows Defender\</item><item type="str">C:\Program Files\Windows Defender\</item><item type="str">C:\Program Files\Microsoft Security Client\MsMpEng.exe</item></key><key name="SourceImage|endswith" type="str">\MsMpEng.exe</key></filter_defender><filter_defender_updates type="dict"><SourceImage type="str">C:\Windows\System32\svchost.exe</SourceImage><key name="CallTrace|contains|all" type="list"><item type="str">|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{</item><item type="str">}\mpengine.dll+</item></key><GrantedAccess type="str">0x1418</GrantedAccess></filter_defender_updates><filter_defender_calltrace type="dict"><key name="CallTrace|contains" type="list"><item type="str">|c:\program files\windows defender\mprtp.dll</item><item type="str">|c:\program files\windows defender\MpClient.dll</item></key></filter_defender_calltrace><filter_gaming_services type="dict"><key name="SourceImage|startswith" type="str">C:\Program Files\WindowsApps\</key><key name="SourceImage|endswith" type="str">\GamingServices.exe</key><GrantedAccess type="list"><item type="str">0x1410</item><item type="str">0x410</item></GrantedAccess></filter_gaming_services><filter_specific_granted_access_1 type="dict"><key name="SourceImage|endswith" type="list"><item type="str">\PROCEXP64.EXE</item><item type="str">\PROCEXP.EXE</item><item type="str">C:\WINDOWS\system32\taskhostw.exe</item><item type="str">\MBAMInstallerService.exe</item></key><GrantedAccess type="list"><item type="str">0x1410</item><item type="str">0x410</item><item type="str">0x40</item></GrantedAccess></filter_specific_granted_access_1><filter_specific_granted_access_2 type="dict"><SourceImage type="list"><item type="str">C:\WINDOWS\system32\wbem\wmiprvse.exe</item><item type="str">C:\Windows\syswow64\MsiExec.exe</item><item type="str">C:\Windows\System32\msiexec.exe</item></SourceImage><GrantedAccess type="list"><item type="str">0x1410</item><item type="str">0x410</item><item type="str">0x1f1fff</item><item type="str">0x1f3fff</item></GrantedAccess></filter_specific_granted_access_2><filter_specific_granted_access_3 type="dict"><SourceImage type="list"><item type="str">C:\Windows\system32\wininit.exe</item><item type="str">C:\Windows\System32\lsass.exe</item></SourceImage><GrantedAccess type="str">0x1000000</GrantedAccess></filter_specific_granted_access_3><filter_vmwaretools type="dict"><key name="SourceImage|startswith" type="str">C:\ProgramData\VMware\VMware Tools\</key><key name="SourceImage|endswith" type="str">\vmtoolsd.exe</key></filter_vmwaretools><filter_svchost type="dict"><SourceImage type="str">C:\WINDOWS\system32\svchost.exe</SourceImage><GrantedAccess type="list"><item type="str">0x100000</item><item type="str">0x1410</item></GrantedAccess></filter_svchost><filter_nextron type="dict"><key name="SourceImage|endswith" type="list"><item type="str">\thor.exe</item><item type="str">\thor64.exe</item><item type="str">\aurora-agent.exe</item><item type="str">\aurora-agent-64.exe</item></key><GrantedAccess type="list"><item type="str">0x40</item><item type="str">0x1010</item></GrantedAccess></filter_nextron><filter_explorer type="dict"><key name="SourceImage|endswith" type="str">\explorer.exe</key><GrantedAccess type="str">0x401</GrantedAccess></filter_explorer><filter_mrt type="dict"><SourceImage type="str">C:\Windows\system32\MRT.exe</SourceImage><GrantedAccess type="list"><item type="str">0x1410</item><item type="str">0x1418</item></GrantedAccess></filter_mrt><filter_handle type="dict"><GrantedAccess type="str">0x40</GrantedAccess><key name="SourceImage|endswith" type="list"><item type="str">\handle.exe</item><item type="str">\handle64.exe</item></key></filter_handle><filter_edge type="dict"><key name="SourceImage|startswith" type="str">C:\Program Files (x86)\Microsoft\Edge\Application\</key><key name="SourceImage|endswith" type="str">\Installer\setup.exe</key></filter_edge><filter_webex type="dict"><key name="SourceImage|endswith" type="str">\AppData\Local\WebEx\WebexHost.exe</key><GrantedAccess type="str">0x401</GrantedAccess></filter_webex><filter_malwarebytes type="dict"><SourceImage type="str">C:\PROGRAMDATA\MALWAREBYTES\MBAMSERVICE\ctlrupdate\mbupdatr.exe</SourceImage><GrantedAccess type="str">0x1410</GrantedAccess></filter_malwarebytes><filter_dropbox type="dict"><key name="SourceImage|contains" type="list"><item type="str">:\Windows\Temp\</item><item type="str">\AppData\Local\Temp\</item></key><key name="SourceImage|endswith" type="str">.tmp\DropboxUpdate.exe</key><GrantedAccess type="list"><item type="str">0x410</item><item type="str">0x1410</item></GrantedAccess></filter_dropbox><filter_msbuild type="dict"><key name="SourceImage|startswith" type="str">C:\Program Files\Microsoft Visual Studio\</key><key name="SourceImage|endswith" type="str">\MSBuild\Current\Bin\MSBuild.exe</key><GrantedAccess type="str">0x1F3FFF</GrantedAccess></filter_msbuild><filter_games type="dict"><key name="SourceImage|contains" type="str">\SteamLibrary\steamapps\</key></filter_games><condition type="str">selection and not 1 of filter_*</condition></detection><fields type="list"><item type="str">ComputerName</item><item type="str">User</item><item type="str">SourceImage</item></fields><falsepositives type="list"><item type="str">Likely</item></falsepositives><level type="str">high</level></root>