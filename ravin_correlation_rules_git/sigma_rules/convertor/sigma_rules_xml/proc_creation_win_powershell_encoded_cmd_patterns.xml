<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious PowerShell Encoded Command Patterns</title><id type="str">b9d9cc83-380b-4ba3-8d8f-60c0e7e2930c</id><status type="str">experimental</status><description type="str">Detects PowerShell command line patterns in combincation with encoded commands that often appear in malware infection chains</description><references type="list"><item type="str">https://app.any.run/tasks/b9040c63-c140-479b-ad59-f1bb56ce7a97/</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2022/05/24</date><modified type="str">2023/01/05</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.t1059.001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">PowerShell.Exe</item><item type="str">pwsh.dll</item></OriginalFileName></item></selection_img><selection_flags type="dict"><key name="CommandLine|contains" type="list"><item type="str"> -e </item><item type="str"> -en </item><item type="str"> -enc </item><item type="str"> -enco</item></key></selection_flags><selection_encoded type="dict"><key name="CommandLine|contains" type="list"><item type="str"> JAB</item><item type="str"> SUVYI</item><item type="str"> SQBFAFgA</item><item type="str"> aWV4I</item><item type="str"> IAB</item><item type="str"> PAA</item><item type="str"> aQBlAHgA</item></key></selection_encoded><filter_gcworker type="dict"><key name="ParentImage|contains" type="list"><item type="str">C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\</item><item type="str">\gc_worker.exe</item></key></filter_gcworker><condition type="str">all of selection_* and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Other tools that work with encoded scripts in the command line instead of script files</item></falsepositives><level type="str">high</level></root>