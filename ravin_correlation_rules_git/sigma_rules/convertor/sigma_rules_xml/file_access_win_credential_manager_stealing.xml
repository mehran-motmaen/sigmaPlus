<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Credential Manager Access</title><id type="str">407aecb1-e762-4acf-8c7b-d087bcff3bb6</id><status type="str">experimental</status><description type="str">Detects suspicious processes based on name and location that access the windows credential manager and vault.
Which can be a sign of credential stealing. Example case would be usage of mimikatz &quot;dpapi::cred&quot; function
</description><references type="list"><item type="str">https://hunter2.gitbook.io/darthsidious/privilege-escalation/mimikatz</item><item type="str">https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/10/11</date><tags type="list"><item type="str">attack.t1003</item><item type="str">attack.credential_access</item></tags><logsource type="dict"><category type="str">file_access</category><product type="str">windows</product><definition type="str">Requirements: Microsoft-Windows-Kernel-File ETW provider</definition></logsource><detection type="dict"><selection type="dict"><key name="FileName|contains" type="list"><item type="str">\AppData\Local\Microsoft\Credentials\</item><item type="str">\AppData\Roaming\Microsoft\Credentials\</item><item type="str">\AppData\Local\Microsoft\Vault\</item><item type="str">\ProgramData\Microsoft\Vault\</item></key></selection><filter_system_folders type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\</item><item type="str">C:\Program Files (x86)\</item><item type="str">C:\Windows\system32\</item><item type="str">C:\Windows\SysWOW64\</item></key></filter_system_folders><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Legitimate software installed by the users for example in the &quot;AppData&quot; directory may access these files (for any reason).</item></falsepositives><level type="str">medium</level></root>