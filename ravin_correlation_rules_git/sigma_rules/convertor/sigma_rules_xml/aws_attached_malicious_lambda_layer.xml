<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">AWS Attached Malicious Lambda Layer</title><id type="str">97fbabf8-8e1b-47a2-b7d5-a418d2b95e3d</id><status type="str">test</status><description type="str">Detects when an user attached a Lambda layer to an existing function to override a library that is in use by the function, where their malicious code could utilize the function&apos;s IAM role for AWS API calls.
This would give an adversary access to the privileges associated with the Lambda service role that is attached to that function.
</description><references type="list"><item type="str">https://docs.aws.amazon.com/lambda/latest/dg/API_UpdateFunctionConfiguration.html</item></references><author type="str">Austin Songer</author><date type="str">2021/09/23</date><modified type="str">2022/10/09</modified><tags type="list"><item type="str">attack.privilege_escalation</item></tags><logsource type="dict"><product type="str">aws</product><service type="str">cloudtrail</service></logsource><detection type="dict"><selection type="dict"><eventSource type="str">lambda.amazonaws.com</eventSource><key name="eventName|startswith" type="str">UpdateFunctionConfiguration</key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Lambda Layer being attached may be performed by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.</item><item type="str">Lambda Layer being attached from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule.</item></falsepositives><level type="str">medium</level></root>