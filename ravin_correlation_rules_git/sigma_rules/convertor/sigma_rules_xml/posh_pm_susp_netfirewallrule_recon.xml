<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Local Firewall Rules Enumeration Via NetFirewallRule Cmdlet</title><id type="str">ea207a23-b441-4a17-9f76-ad5be47d51d3</id><status type="str">experimental</status><description type="str">Detects execution of &quot;Get-NetFirewallRule&quot; or &quot;Show-NetFirewallRule&quot; to enumerate the local firewall rules on a host.</description><references type="list"><item type="str">https://learn.microsoft.com/en-us/powershell/module/netsecurity/get-netfirewallrule?view=windowsserver2022-ps</item><item type="str">https://learn.microsoft.com/en-us/powershell/module/netsecurity/show-netfirewallrule?view=windowsserver2022-ps</item></references><author type="str">Christopher Peacock @SecurePeacock, SCYTHE @scythe_io</author><date type="str">2023/07/13</date><tags type="list"><item type="str">detection.threat_hunting</item><item type="str">attack.discovery</item><item type="str">attack.t1518.001</item><item type="str">attack.t1016</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_module</category><definition type="str">0ad03ef1-f21b-4a79-8ce8-e6900c54b65b</definition></logsource><detection type="dict"><selection_payload type="dict"><key name="Payload|contains" type="list"><item type="str">Get-NetFirewallRule</item><item type="str">Show-NetFirewallRule</item></key></selection_payload><selection_contextinfo type="dict"><key name="ContextInfo|contains" type="list"><item type="str">Get-NetFirewallRule</item><item type="str">Show-NetFirewallRule</item></key></selection_contextinfo><condition type="str">1 of selection_*</condition></detection><falsepositives type="list"><item type="str">Administration scripts</item></falsepositives><level type="str">low</level></root>