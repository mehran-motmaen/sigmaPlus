<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Suspicious Windows Feature Enabled - ProcCreation</title><id type="str">c740d4cf-a1e9-41de-bb16-8a46a4f57918</id><related type="list"><item type="dict"><id type="str">55c925c1-7195-426b-a136-a9396800e29b</id><type type="str">similar</type></item></related><status type="str">experimental</status><description type="str">Detects usage of the built-in PowerShell cmdlet &quot;Enable-WindowsOptionalFeature&quot; used as a Deployment Image Servicing and Management tool.
Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images
</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/powershell/module/dism/enable-windowsoptionalfeature?view=windowsserver2022-ps</item><item type="str">https://learn.microsoft.com/en-us/windows/win32/projfs/enabling-windows-projected-file-system</item><item type="str">https://learn.microsoft.com/en-us/windows/wsl/install-on-server</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/12/29</date><tags type="list"><item type="str">attack.defense_evasion</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_cmd type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">Enable-WindowsOptionalFeature</item><item type="str">-Online</item><item type="str">-FeatureName</item></key></selection_cmd><selection_feature type="dict"><key name="CommandLine|contains" type="list"><item type="str">TelnetServer</item><item type="str">Internet-Explorer-Optional-amd64</item><item type="str">TFTP</item><item type="str">SMB1Protocol</item><item type="str">Client-ProjFS</item><item type="str">Microsoft-Windows-Subsystem-Linux</item></key></selection_feature><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Legitimate usage of the features listed in the rule.</item></falsepositives><level type="str">medium</level></root>