<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious Child Process Created as System</title><id type="str">590a5f4c-6c8c-4f10-8307-89afe9453a9d</id><status type="str">test</status><description type="str">Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE accounts</description><references type="list"><item type="str">https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment</item><item type="str">https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/</item><item type="str">https://github.com/antonioCoco/RogueWinRM</item><item type="str">https://twitter.com/Cyb3rWard0g/status/1453123054243024897</item></references><author type="str">Teymur Kheirkhabarov, Roberto Rodriguez (@Cyb3rWard0g), Open Threat Research (OTR)</author><date type="str">2019/10/26</date><modified type="str">2022/12/15</modified><tags type="list"><item type="str">attack.privilege_escalation</item><item type="str">attack.t1134.002</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product><definition type="str">Requirements: ParentUser field needs sysmon &gt;= 13.30</definition></logsource><detection type="dict"><selection type="dict"><key name="ParentUser|contains" type="list"><item type="str">AUTHORI</item><item type="str">AUTORI</item></key><key name="ParentUser|endswith" type="list"><item type="str">\NETWORK SERVICE</item><item type="str">\LOCAL SERVICE</item></key><key name="User|contains" type="list"><item type="str">AUTHORI</item><item type="str">AUTORI</item></key><key name="User|endswith" type="list"><item type="str">\SYSTEM</item><item type="str">\Système</item><item type="str">\СИСТЕМА</item></key><IntegrityLevel type="str">System</IntegrityLevel></selection><filter_rundll32 type="dict"><key name="Image|endswith" type="str">\rundll32.exe</key><key name="CommandLine|contains" type="str">DavSetCookie</key></filter_rundll32><condition type="str">selection and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>