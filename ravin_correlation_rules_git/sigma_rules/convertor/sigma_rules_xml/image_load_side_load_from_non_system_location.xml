<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential System DLL Sideloading From Non System Locations</title><id type="str">4fc0deee-0057-4998-ab31-d24e46e0aba4</id><status type="str">experimental</status><description type="str">Detects DLL sideloading of DLLs usually located in system locations (System32, SysWOW64, etc.)</description><references type="list"><item type="str">https://hijacklibs.net/</item><item type="str">https://blog.cyble.com/2022/07/21/qakbot-resurfaces-with-new-playbook/</item><item type="str">https://blog.cyble.com/2022/07/27/targeted-attacks-being-carried-out-via-dll-sideloading/</item><item type="str">https://github.com/XForceIR/SideLoadHunter/blob/cc7ef2e5d8908279b0c4cee4e8b6f85f7b8eed52/SideLoads/README.md</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/08/14</date><modified type="str">2023/05/16</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.persistence</item><item type="str">attack.privilege_escalation</item><item type="str">attack.t1574.001</item><item type="str">attack.t1574.002</item></tags><logsource type="dict"><category type="str">image_load</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="ImageLoaded|endswith" type="list"><item type="str">\shfolder.dll</item><item type="str">\activeds.dll</item><item type="str">\adsldpc.dll</item><item type="str">\aepic.dll</item><item type="str">\apphelp.dll</item><item type="str">\applicationframe.dll</item><item type="str">\appxalluserstore.dll</item><item type="str">\appxdeploymentclient.dll</item><item type="str">\archiveint.dll</item><item type="str">\atl.dll</item><item type="str">\audioses.dll</item><item type="str">\auditpolcore.dll</item><item type="str">\authfwcfg.dll</item><item type="str">\authz.dll</item><item type="str">\avrt.dll</item><item type="str">\bcd.dll</item><item type="str">\bcp47langs.dll</item><item type="str">\bcp47mrm.dll</item><item type="str">\bcrypt.dll</item><item type="str">\cabinet.dll</item><item type="str">\cabview.dll</item><item type="str">\certenroll.dll</item><item type="str">\cldapi.dll</item><item type="str">\clipc.dll</item><item type="str">\clusapi.dll</item><item type="str">\cmpbk32.dll</item><item type="str">\coloradapterclient.dll</item><item type="str">\colorui.dll</item><item type="str">\comdlg32.dll</item><item type="str">\connect.dll</item><item type="str">\coremessaging.dll</item><item type="str">\credui.dll</item><item type="str">\cryptbase.dll</item><item type="str">\cryptdll.dll</item><item type="str">\cryptui.dll</item><item type="str">\cryptxml.dll</item><item type="str">\cscapi.dll</item><item type="str">\cscobj.dll</item><item type="str">\cscui.dll</item><item type="str">\d2d1.dll</item><item type="str">\d3d10.dll</item><item type="str">\d3d10_1.dll</item><item type="str">\d3d10_1core.dll</item><item type="str">\d3d10core.dll</item><item type="str">\d3d10warp.dll</item><item type="str">\d3d11.dll</item><item type="str">\d3d12.dll</item><item type="str">\d3d9.dll</item><item type="str">\dataexchange.dll</item><item type="str">\davclnt.dll</item><item type="str">\dcomp.dll</item><item type="str">\defragproxy.dll</item><item type="str">\desktopshellext.dll</item><item type="str">\deviceassociation.dll</item><item type="str">\devicecredential.dll</item><item type="str">\devicepairing.dll</item><item type="str">\devobj.dll</item><item type="str">\devrtl.dll</item><item type="str">\dhcpcmonitor.dll</item><item type="str">\dhcpcsvc.dll</item><item type="str">\dhcpcsvc6.dll</item><item type="str">\directmanipulation.dll</item><item type="str">\dismapi.dll</item><item type="str">\dismcore.dll</item><item type="str">\dmcfgutils.dll</item><item type="str">\dmcmnutils.dll</item><item type="str">\dmenrollengine.dll</item><item type="str">\dmenterprisediagnostics.dll</item><item type="str">\dmiso8601utils.dll</item><item type="str">\dmoleaututils.dll</item><item type="str">\dmprocessxmlfiltered.dll</item><item type="str">\dmpushproxy.dll</item><item type="str">\dmxmlhelputils.dll</item><item type="str">\dnsapi.dll</item><item type="str">\dot3api.dll</item><item type="str">\dot3cfg.dll</item><item type="str">\drprov.dll</item><item type="str">\dsclient.dll</item><item type="str">\dsparse.dll</item><item type="str">\dsreg.dll</item><item type="str">\dsrole.dll</item><item type="str">\dui70.dll</item><item type="str">\duser.dll</item><item type="str">\dusmapi.dll</item><item type="str">\dwmapi.dll</item><item type="str">\dwrite.dll</item><item type="str">\dxgi.dll</item><item type="str">\dxva2.dll</item><item type="str">\eappcfg.dll</item><item type="str">\eappprxy.dll</item><item type="str">\edputil.dll</item><item type="str">\efsadu.dll</item><item type="str">\efsutil.dll</item><item type="str">\esent.dll</item><item type="str">\execmodelproxy.dll</item><item type="str">\explorerframe.dll</item><item type="str">\fastprox.dll</item><item type="str">\faultrep.dll</item><item type="str">\fddevquery.dll</item><item type="str">\feclient.dll</item><item type="str">\fhcfg.dll</item><item type="str">\firewallapi.dll</item><item type="str">\flightsettings.dll</item><item type="str">\fltlib.dll</item><item type="str">\fveapi.dll</item><item type="str">\fwbase.dll</item><item type="str">\fwcfg.dll</item><item type="str">\fwpolicyiomgr.dll</item><item type="str">\fwpuclnt.dll</item><item type="str">\getuname.dll</item><item type="str">\hid.dll</item><item type="str">\hnetmon.dll</item><item type="str">\httpapi.dll</item><item type="str">\idstore.dll</item><item type="str">\ieadvpack.dll</item><item type="str">\iedkcs32.dll</item><item type="str">\iertutil.dll</item><item type="str">\ifmon.dll</item><item type="str">\iphlpapi.dll</item><item type="str">\iri.dll</item><item type="str">\iscsidsc.dll</item><item type="str">\iscsium.dll</item><item type="str">\isv.exe_rsaenh.dll</item><item type="str">\joinutil.dll</item><item type="str">\ksuser.dll</item><item type="str">\ktmw32.dll</item><item type="str">\licensemanagerapi.dll</item><item type="str">\licensingdiagspp.dll</item><item type="str">\linkinfo.dll</item><item type="str">\loadperf.dll</item><item type="str">\logoncli.dll</item><item type="str">\logoncontroller.dll</item><item type="str">\lpksetupproxyserv.dll</item><item type="str">\magnification.dll</item><item type="str">\mapistub.dll</item><item type="str">\mfcore.dll</item><item type="str">\mfplat.dll</item><item type="str">\mi.dll</item><item type="str">\midimap.dll</item><item type="str">\miutils.dll</item><item type="str">\mlang.dll</item><item type="str">\mmdevapi.dll</item><item type="str">\mobilenetworking.dll</item><item type="str">\mpr.dll</item><item type="str">\mprapi.dll</item><item type="str">\mrmcorer.dll</item><item type="str">\msacm32.dll</item><item type="str">\mscms.dll</item><item type="str">\mscoree.dll</item><item type="str">\msctf.dll</item><item type="str">\msctfmonitor.dll</item><item type="str">\msdrm.dll</item><item type="str">\msftedit.dll</item><item type="str">\msi.dll</item><item type="str">\msutb.dll</item><item type="str">\mswb7.dll</item><item type="str">\mswsock.dll</item><item type="str">\msxml3.dll</item><item type="str">\mtxclu.dll</item><item type="str">\napinsp.dll</item><item type="str">\ncrypt.dll</item><item type="str">\ndfapi.dll</item><item type="str">\netid.dll</item><item type="str">\netiohlp.dll</item><item type="str">\netplwiz.dll</item><item type="str">\netprofm.dll</item><item type="str">\netsetupapi.dll</item><item type="str">\netshell.dll</item><item type="str">\netutils.dll</item><item type="str">\networkexplorer.dll</item><item type="str">\newdev.dll</item><item type="str">\ninput.dll</item><item type="str">\nlaapi.dll</item><item type="str">\nlansp_c.dll</item><item type="str">\npmproxy.dll</item><item type="str">\nshhttp.dll</item><item type="str">\nshipsec.dll</item><item type="str">\nshwfp.dll</item><item type="str">\ntdsapi.dll</item><item type="str">\ntlanman.dll</item><item type="str">\ntlmshared.dll</item><item type="str">\ntmarta.dll</item><item type="str">\ntshrui.dll</item><item type="str">\oleacc.dll</item><item type="str">\omadmapi.dll</item><item type="str">\onex.dll</item><item type="str">\osbaseln.dll</item><item type="str">\osuninst.dll</item><item type="str">\p2p.dll</item><item type="str">\p2pnetsh.dll</item><item type="str">\p9np.dll</item><item type="str">\pcaui.dll</item><item type="str">\pdh.dll</item><item type="str">\peerdistsh.dll</item><item type="str">\pla.dll</item><item type="str">\pnrpnsp.dll</item><item type="str">\policymanager.dll</item><item type="str">\polstore.dll</item><item type="str">\printui.dll</item><item type="str">\propsys.dll</item><item type="str">\prvdmofcomp.dll</item><item type="str">\puiapi.dll</item><item type="str">\radcui.dll</item><item type="str">\rasapi32.dll</item><item type="str">\rasgcw.dll</item><item type="str">\rasman.dll</item><item type="str">\rasmontr.dll</item><item type="str">\reagent.dll</item><item type="str">\regapi.dll</item><item type="str">\resutils.dll</item><item type="str">\rmclient.dll</item><item type="str">\rpcnsh.dll</item><item type="str">\rsaenh.dll</item><item type="str">\rtutils.dll</item><item type="str">\rtworkq.dll</item><item type="str">\samcli.dll</item><item type="str">\samlib.dll</item><item type="str">\sapi_onecore.dll</item><item type="str">\sas.dll</item><item type="str">\scansetting.dll</item><item type="str">\scecli.dll</item><item type="str">\schedcli.dll</item><item type="str">\secur32.dll</item><item type="str">\shell32.dll</item><item type="str">\slc.dll</item><item type="str">\snmpapi.dll</item><item type="str">\spp.dll</item><item type="str">\sppc.dll</item><item type="str">\srclient.dll</item><item type="str">\srpapi.dll</item><item type="str">\srvcli.dll</item><item type="str">\ssp.exe_rsaenh.dll</item><item type="str">\ssp_isv.exe_rsaenh.dll</item><item type="str">\sspicli.dll</item><item type="str">\ssshim.dll</item><item type="str">\staterepository.core.dll</item><item type="str">\structuredquery.dll</item><item type="str">\sxshared.dll</item><item type="str">\tapi32.dll</item><item type="str">\tbs.dll</item><item type="str">\tdh.dll</item><item type="str">\tquery.dll</item><item type="str">\tsworkspace.dll</item><item type="str">\ttdrecord.dll</item><item type="str">\twext.dll</item><item type="str">\twinapi.dll</item><item type="str">\twinui.appcore.dll</item><item type="str">\uianimation.dll</item><item type="str">\uiautomationcore.dll</item><item type="str">\uireng.dll</item><item type="str">\uiribbon.dll</item><item type="str">\updatepolicy.dll</item><item type="str">\userenv.dll</item><item type="str">\utildll.dll</item><item type="str">\uxinit.dll</item><item type="str">\uxtheme.dll</item><item type="str">\vaultcli.dll</item><item type="str">\virtdisk.dll</item><item type="str">\vssapi.dll</item><item type="str">\vsstrace.dll</item><item type="str">\wbemprox.dll</item><item type="str">\wbemsvc.dll</item><item type="str">\wcmapi.dll</item><item type="str">\wcnnetsh.dll</item><item type="str">\wdi.dll</item><item type="str">\wdscore.dll</item><item type="str">\webservices.dll</item><item type="str">\wecapi.dll</item><item type="str">\wer.dll</item><item type="str">\wevtapi.dll</item><item type="str">\whhelper.dll</item><item type="str">\wimgapi.dll</item><item type="str">\winbrand.dll</item><item type="str">\windows.storage.dll</item><item type="str">\windows.storage.search.dll</item><item type="str">\windowscodecs.dll</item><item type="str">\windowscodecsext.dll</item><item type="str">\windowsudk.shellcommon.dll</item><item type="str">\winhttp.dll</item><item type="str">\wininet.dll</item><item type="str">\winipsec.dll</item><item type="str">\winmde.dll</item><item type="str">\winmm.dll</item><item type="str">\winnsi.dll</item><item type="str">\winrnr.dll</item><item type="str">\winsqlite3.dll</item><item type="str">\winsta.dll</item><item type="str">\wkscli.dll</item><item type="str">\wlanapi.dll</item><item type="str">\wlancfg.dll</item><item type="str">\wldp.dll</item><item type="str">\wlidprov.dll</item><item type="str">\wmiclnt.dll</item><item type="str">\wmidcom.dll</item><item type="str">\wmiutils.dll</item><item type="str">\wmsgapi.dll</item><item type="str">\wofutil.dll</item><item type="str">\wpdshext.dll</item><item type="str">\wshbth.dll</item><item type="str">\wshelper.dll</item><item type="str">\wtsapi32.dll</item><item type="str">\wwapi.dll</item><item type="str">\xmllite.dll</item><item type="str">\xolehlp.dll</item><item type="str">\xwizards.dll</item><item type="str">\xwtpw32.dll</item><item type="str">\aclui.dll</item><item type="str">\bderepair.dll</item><item type="str">\bootmenuux.dll</item><item type="str">\dcntel.dll</item><item type="str">\dwmcore.dll</item><item type="str">\dynamoapi.dll</item><item type="str">\fhsvcctl.dll</item><item type="str">\fxsst.dll</item><item type="str">\inproclogger.dll</item><item type="str">\iumbase.dll</item><item type="str">\kdstub.dll</item><item type="str">\maintenanceui.dll</item><item type="str">\mdmdiagnostics.dll</item><item type="str">\mintdh.dll</item><item type="str">\msdtctm.dll</item><item type="str">\nettrace.dll</item><item type="str">\osksupport.dll</item><item type="str">\reseteng.dll</item><item type="str">\resetengine.dll</item><item type="str">\spectrumsyncclient.dll</item><item type="str">\srcore.dll</item><item type="str">\systemsettingsthresholdadminflowui.dll</item><item type="str">\timesync.dll</item><item type="str">\upshared.dll</item><item type="str">\wmpdui.dll</item><item type="str">\wwancfg.dll</item><item type="str">\dpx.dll</item><item type="str">\fxsapi.dll</item><item type="str">\fxstiff.dll</item><item type="str">\xpsservices.dll</item><item type="str">\appvpolicy.dll</item><item type="str">\batmeter.dll</item><item type="str">\bootux.dll</item><item type="str">\cmutil.dll</item><item type="str">\configmanager2.dll</item><item type="str">\coredplus.dll</item><item type="str">\coreuicomponents.dll</item><item type="str">\cryptsp.dll</item><item type="str">\dmcommandlineutils.dll</item><item type="str">\drvstore.dll</item><item type="str">\dsprop.dll</item><item type="str">\dxcore.dll</item><item type="str">\edgeiso.dll</item><item type="str">\framedynos.dll</item><item type="str">\fveskybackup.dll</item><item type="str">\fvewiz.dll</item><item type="str">\gpapi.dll</item><item type="str">\icmp.dll</item><item type="str">\ifsutil.dll</item><item type="str">\iumsdk.dll</item><item type="str">\lockhostingframework.dll</item><item type="str">\lrwizdll.dll</item><item type="str">\mbaexmlparser.dll</item><item type="str">\mfc42u.dll</item><item type="str">\msiso.dll</item><item type="str">\msvcp110_win.dll</item><item type="str">\netapi32.dll</item><item type="str">\netjoin.dll</item><item type="str">\netprovfw.dll</item><item type="str">\opcservices.dll</item><item type="str">\pkeyhelper.dll</item><item type="str">\playsndsrv.dll</item><item type="str">\powrprof.dll</item><item type="str">\prntvpt.dll</item><item type="str">\profapi.dll</item><item type="str">\proximitycommon.dll</item><item type="str">\proximityservicepal.dll</item><item type="str">\rasdlg.dll</item><item type="str">\security.dll</item><item type="str">\sppcext.dll</item><item type="str">\srmtrace.dll</item><item type="str">\tpmcoreprovisioning.dll</item><item type="str">\umpdc.dll</item><item type="str">\unattend.dll</item><item type="str">\urlmon.dll</item><item type="str">\vdsutil.dll</item><item type="str">\version.dll</item><item type="str">\winbio.dll</item><item type="str">\windows.ui.immersive.dll</item><item type="str">\winscard.dll</item><item type="str">\winsync.dll</item><item type="str">\wscapi.dll</item><item type="str">\wsmsvc.dll</item><item type="str">\FxsCompose.dll</item><item type="str">\WfsR.dll</item><item type="str">\rpchttp.dll</item><item type="str">\storageusage.dll</item><item type="str">\amsi.dll</item><item type="str">\PrintIsolationProxy.dll</item><item type="str">\msdtcVSp1res.dll</item><item type="str">\rdpendp.dll</item><item type="str">\dxilconv.dll</item><item type="str">\utcutil.dll</item><item type="str">\appraiser.dll</item><item type="str">\dsound.dll</item><item type="str">\DispBroker.dll</item><item type="str">\FXSRESM.DLL</item><item type="str">\cryptnet.dll</item><item type="str">\COMRES.DLL</item><item type="str">\igdumdim64.dll</item><item type="str">\igd10iumd64.dll</item><item type="str">\igd12umd64.dll</item><item type="str">\igdusc64.dll</item><item type="str">\WLBSCTRL.dll</item><item type="str">\TSMSISrv.dll</item><item type="str">\TSVIPSrv.dll</item><item type="str">\wow64log.dll</item><item type="str">\WptsExtensions.dll</item><item type="str">\wbemcomn.dll</item></key></selection><filter_main_generic type="dict"><key name="ImageLoaded|startswith" type="list"><item type="str">C:\Windows\System32\</item><item type="str">C:\Windows\SysWOW64\</item><item type="str">C:\Windows\WinSxS\</item><item type="str">C:\Windows\SoftwareDistribution\</item><item type="str">C:\Windows\SystemTemp\</item><item type="str">C:\$WINDOWS.~BT\</item></key></filter_main_generic><filter_optional_office_appvpolicy type="dict"><Image type="str">C:\Program Files\Common Files\microsoft shared\ClickToRun\OfficeClickToRun.exe</Image><ImageLoaded type="str">C:\Program Files\Common Files\microsoft shared\ClickToRun\AppVPolicy.dll</ImageLoaded></filter_optional_office_appvpolicy><filter_optional_azure type="dict"><key name="ImageLoaded|startswith" type="str">C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\</key></filter_optional_azure><filter_optional_dell type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs</item><item type="str">C:\Windows\System32\backgroundTaskHost.exe</item></key><key name="ImageLoaded|startswith" type="str">C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs</key></filter_optional_dell><filter_optional_dell_wldp type="dict"><key name="Image|startswith" type="str">C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs</key><key name="Image|endswith" type="str">\wldp.dll</key></filter_optional_dell_wldp><filter_optional_checkpoint type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\CheckPoint\</item><item type="str">C:\Program Files (x86)\CheckPoint\</item></key><key name="Image|endswith" type="str">\SmartConsole.exe</key><key name="ImageLoaded|startswith" type="list"><item type="str">C:\Program Files\CheckPoint\</item><item type="str">C:\Program Files (x86)\CheckPoint\</item></key><key name="ImageLoaded|endswith" type="str">\PolicyManager.dll</key></filter_optional_checkpoint><condition type="str">selection and not 1 of filter_main_* and not 1 of filter_optional_*</condition></detection><falsepositives type="list"><item type="str">Legitimate applications loading their own versions of the DLLs mentioned in this rule</item></falsepositives><level type="str">high</level></root>