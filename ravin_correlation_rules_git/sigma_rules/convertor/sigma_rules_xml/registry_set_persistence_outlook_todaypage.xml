<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Via Outlook Today Pages</title><id type="str">487bb375-12ef-41f6-baae-c6a1572b4dd1</id><status type="str">experimental</status><description type="str">Detects potential persistence activity via outlook today pages. An attacker can set a custom page to execute arbitrary code and link to it via the registry key &quot;UserDefinedUrl&quot;.</description><references type="list"><item type="str">https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=74</item></references><author type="str">Tobias Michalski (Nextron Systems)</author><date type="str">2021/06/10</date><modified type="str">2023/02/08</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1112</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">registry_set</category></logsource><detection type="dict"><selection_main type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains|all" type="list"><item type="str">Software\Microsoft\Office\</item><item type="str">\Outlook\Today\</item></key></selection_main><selection_value_stamp type="dict"><key name="TargetObject|endswith" type="str">Stamp</key><Details type="str">DWORD (0x00000001)</Details></selection_value_stamp><selection_value_user_defined type="dict"><key name="TargetObject|endswith" type="str">UserDefinedUrl</key></selection_value_user_defined><filter_office type="dict"><key name="Image|startswith" type="list"><item type="str">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\</item><item type="str">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\</item></key><key name="Image|endswith" type="str">\OfficeClickToRun.exe</key></filter_office><condition type="str">selection_main and 1 of selection_value_* and not 1 of filter_*</condition></detection><fields type="list"><item type="str">Details</item></fields><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>