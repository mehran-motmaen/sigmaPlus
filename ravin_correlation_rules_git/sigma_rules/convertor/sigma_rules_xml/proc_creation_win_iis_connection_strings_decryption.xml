<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Microsoft IIS Connection Strings Decryption</title><id type="str">97dbf6e2-e436-44d8-abee-4261b24d3e41</id><status type="str">experimental</status><description type="str">Detects use of aspnet_regiis to decrypt Microsoft IIS connection strings. An attacker with Microsoft IIS web server access via a webshell or alike can decrypt and dump any hardcoded connection strings, such as the MSSQL service account password using aspnet_regiis command.</description><references type="list"><item type="str">https://www.elastic.co/guide/en/security/current/microsoft-iis-connection-strings-decryption.html</item></references><author type="str">Tim Rauch</author><date type="str">2022/09/28</date><modified type="str">2022/12/30</modified><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1003</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_name type="list"><item type="dict"><key name="Image|endswith" type="str">\aspnet_regiis.exe</key></item><item type="dict"><OriginalFileName type="str">aspnet_regiis.exe</OriginalFileName></item></selection_name><selection_args type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">connectionStrings</item><item type="str"> -pdf</item></key></selection_args><condition type="str">all of selection*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>