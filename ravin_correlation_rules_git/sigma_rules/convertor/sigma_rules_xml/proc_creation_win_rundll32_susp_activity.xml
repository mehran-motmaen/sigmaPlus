<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potentially Suspicious Rundll32 Activity</title><id type="str">e593cf51-88db-4ee1-b920-37e89012a3c9</id><status type="str">test</status><description type="str">Detects suspicious execution of rundll32, with specific calls to some DLLs with known LOLBIN functionalities</description><references type="list"><item type="str">http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/</item><item type="str">https://twitter.com/Hexacorn/status/885258886428725250</item><item type="str">https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52</item><item type="str">https://twitter.com/nas_bench/status/1433344116071583746</item><item type="str">https://twitter.com/eral4m/status/1479106975967240209</item><item type="str">https://twitter.com/eral4m/status/1479080793003671557</item></references><author type="str">juju4, Jonhnathan Ribeiro, oscd.community, Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2019/01/16</date><modified type="str">2023/05/17</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1218.011</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="list"><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">javascript:</item><item type="str">.RegisterXLL</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">url.dll</item><item type="str">OpenURL</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">url.dll</item><item type="str">OpenURLA</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">url.dll</item><item type="str">FileProtocolHandler</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">zipfldr.dll</item><item type="str">RouteTheCall</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">shell32.dll</item><item type="str">Control_RunDLL</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">shell32.dll</item><item type="str">ShellExec_RunDLL</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">mshtml.dll</item><item type="str">PrintHTML</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">advpack.dll</item><item type="str">LaunchINFSection</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">advpack.dll</item><item type="str">RegisterOCX</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">ieadvpack.dll</item><item type="str">LaunchINFSection</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">ieadvpack.dll</item><item type="str">RegisterOCX</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">ieframe.dll</item><item type="str">OpenURL</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">shdocvw.dll</item><item type="str">OpenURL</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">syssetup.dll</item><item type="str">SetupInfObjectInstallAction</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">setupapi.dll</item><item type="str">InstallHinfSection</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">pcwutl.dll</item><item type="str">LaunchApplication</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">dfshim.dll</item><item type="str">ShOpenVerbApplication</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">dfshim.dll</item><item type="str">ShOpenVerbShortcut</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">scrobj.dll</item><item type="str">GenerateTypeLib</item><item type="str">http</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">shimgvw.dll</item><item type="str">ImageView_Fullscreen</item><item type="str">http</item></key></item><item type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">comsvcs.dll</item><item type="str">MiniDump</item></key></item></selection><filter_main_screensaver type="dict"><key name="CommandLine|contains" type="str">shell32.dll,Control_RunDLL desk.cpl,screensaver,@screensaver</key></filter_main_screensaver><filter_main_parent_cpl type="dict"><ParentImage type="str">C:\Windows\System32\control.exe</ParentImage><key name="ParentCommandLine|contains" type="str">.cpl</key><key name="CommandLine|contains|all" type="list"><item type="str">Shell32.dll</item><item type="str">Control_RunDLL</item><item type="str">.cpl</item></key></filter_main_parent_cpl><filter_main_startmenu type="dict"><ParentImage type="str">C:\Windows\System32\control.exe</ParentImage><key name="CommandLine|startswith" type="str">&quot;C:\Windows\system32\rundll32.exe&quot; Shell32.dll,Control_RunDLL &quot;C:\Windows\System32\</key><key name="CommandLine|endswith" type="str">.cpl&quot;,</key></filter_main_startmenu><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">False positives depend on scripts and administrative tools used in the monitored environment</item></falsepositives><level type="str">medium</level></root>