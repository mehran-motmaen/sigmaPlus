<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution</title><id type="str">02b18447-ea83-4b1b-8805-714a8a34546a</id><status type="str">test</status><description type="str">Detects execution of Windows Defender &quot;OfflineScannerShell.exe&quot; from its non standard directory.
The &quot;OfflineScannerShell.exe&quot; binary is vulnerable to DLL side loading and will load any DLL named &quot;mpclient.dll&quot; from the current working directory.
</description><references type="list"><item type="str">https://lolbas-project.github.io/lolbas/Binaries/OfflineScannerShell/</item></references><author type="str">frack113</author><date type="str">2022/03/06</date><modified type="str">2023/08/03</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1218</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="list"><item type="dict"><key name="Image|endswith" type="str">\OfflineScannerShell.exe</key></item><item type="dict"><OriginalFileName type="str">OfflineScannerShell.exe</OriginalFileName></item></selection><filter_main_legit_dir type="dict"><CurrentDirectory type="str">C:\Program Files\Windows Defender\Offline\</CurrentDirectory></filter_main_legit_dir><filter_main_empty type="dict"><CurrentDirectory type="str"></CurrentDirectory></filter_main_empty><filter_main_null type="dict"><CurrentDirectory type="null"></CurrentDirectory></filter_main_null><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">medium</level></root>