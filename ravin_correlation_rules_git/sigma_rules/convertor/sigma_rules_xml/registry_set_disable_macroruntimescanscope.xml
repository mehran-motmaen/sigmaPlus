<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Disable Macro Runtime Scan Scope</title><id type="str">ab871450-37dc-4a3a-997f-6662aa8ae0f1</id><description type="str">Detects tampering with the MacroRuntimeScanScope registry key to disable runtime scanning of enabled macros</description><status type="str">experimental</status><date type="str">2022/10/25</date><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><references type="list"><item type="str">https://www.microsoft.com/en-us/security/blog/2018/09/12/office-vba-amsi-parting-the-veil-on-malicious-macros/</item><item type="str">https://admx.help/?Category=Office2016&amp;Policy=office16.Office.Microsoft.Policies.Windows::L_MacroRuntimeScanScope</item><item type="str">https://github.com/S3cur3Th1sSh1t/OffensiveVBA/blob/28cc6a2802d8176195ac19b3c8e9a749009a82a3/src/AMSIbypasses.vba</item></references><tags type="list"><item type="str">attack.defense_evasion</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">registry_set</category></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains|all" type="list"><item type="str">\SOFTWARE\</item><item type="str">\Microsoft\Office\</item><item type="str">\Common\Security</item></key><key name="TargetObject|endswith" type="str">\MacroRuntimeScanScope</key><Details type="str">DWORD (0x00000000)</Details></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>