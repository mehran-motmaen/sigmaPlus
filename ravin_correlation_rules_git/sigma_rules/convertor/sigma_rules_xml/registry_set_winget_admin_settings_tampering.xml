<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Winget Admin Settings Modification</title><id type="str">6db5eaf9-88f7-4ed9-af7d-9ef2ad12f236</id><status type="str">experimental</status><description type="str">Detects changes to the AppInstaller (winget) admin settings. Such as enabling local manifest installations or disabling installer hash checks</description><references type="list"><item type="str">https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget</item><item type="str">https://github.com/microsoft/winget-cli/blob/02d2f93807c9851d73eaacb4d8811a76b64b7b01/src/AppInstallerCommonCore/Public/winget/AdminSettings.h#L13</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/04/17</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.persistence</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">registry_set</category></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="Image|endswith" type="str">\winget.exe</key><key name="TargetObject|startswith" type="str">\REGISTRY\A\</key><key name="TargetObject|endswith" type="str">\LocalState\admin_settings</key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">The event doesn&apos;t contain information about the type of change. False positives are expected with legitimate changes</item></falsepositives><level type="str">low</level></root>