<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Weak Encryption Enabled and Kerberoast</title><id type="str">f6de9536-0441-4b3f-a646-f4e00f300ffd</id><status type="str">test</status><description type="str">Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.</description><references type="list"><item type="str">https://adsecurity.org/?p=2053</item><item type="str">https://blog.harmj0y.net/redteaming/another-word-on-delegation/</item></references><author type="str">@neu5ron</author><date type="str">2017/07/30</date><modified type="str">2021/11/27</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1562.001</item></tags><logsource type="dict"><product type="str">windows</product><service type="str">security</service><definition type="str">Requirements: Audit Policy : Account Management &gt; Audit User Account Management, Group Policy : Computer Configuration\Windows Settings\Security Settings\Advanced Audit Policy Configuration\Audit Policies\Account Management\Audit User Account Management</definition></logsource><detection type="dict"><selection type="dict"><EventID type="int">4738</EventID></selection><olduac_des type="dict"><key name="OldUacValue|endswith" type="list"><item type="str">8???</item><item type="str">9???</item><item type="str">A???</item><item type="str">B???</item><item type="str">C???</item><item type="str">D???</item><item type="str">E???</item><item type="str">F???</item></key></olduac_des><newuac_des type="dict"><key name="NewUacValue|endswith" type="list"><item type="str">8???</item><item type="str">9???</item><item type="str">A???</item><item type="str">B???</item><item type="str">C???</item><item type="str">D???</item><item type="str">E???</item><item type="str">F???</item></key></newuac_des><olduac_preauth type="dict"><key name="OldUacValue|endswith" type="list"><item type="str">1????</item><item type="str">3????</item><item type="str">5????</item><item type="str">7????</item><item type="str">9????</item><item type="str">B????</item><item type="str">D????</item><item type="str">F????</item></key></olduac_preauth><newuac_preauth type="dict"><key name="NewUacValue|endswith" type="list"><item type="str">1????</item><item type="str">3????</item><item type="str">5????</item><item type="str">7????</item><item type="str">9????</item><item type="str">B????</item><item type="str">D????</item><item type="str">F????</item></key></newuac_preauth><olduac_encrypted type="dict"><key name="OldUacValue|endswith" type="list"><item type="str">8??</item><item type="str">9??</item><item type="str">A??</item><item type="str">B??</item><item type="str">C??</item><item type="str">D??</item><item type="str">E??</item><item type="str">F??</item></key></olduac_encrypted><newuac_encrypted type="dict"><key name="NewUacValue|endswith" type="list"><item type="str">8??</item><item type="str">9??</item><item type="str">A??</item><item type="str">B??</item><item type="str">C??</item><item type="str">D??</item><item type="str">E??</item><item type="str">F??</item></key></newuac_encrypted><condition type="str">selection and ((newuac_des and not olduac_des) or (newuac_preauth and not olduac_preauth) or (newuac_encrypted and not olduac_encrypted))</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>