<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Use of Squirrel.exe</title><id type="str">45239e6a-b035-4aaf-b339-8ad379fcb67e</id><related type="list"><item type="dict"><id type="str">fa4b21c9-0057-4493-b289-2556416ae4d7</id><type type="str">obsoletes</type></item></related><status type="str">experimental</status><description type="str">Detects the usage of the &quot;Squirrel.exe&quot; binary as a LOLBIN. This binary is part of multiple software installations (Slack, Teams, Discord, etc.)</description><references type="list"><item type="str">https://lolbas-project.github.io/lolbas/OtherMSBinaries/Squirrel/</item><item type="str">http://www.hexacorn.com/blog/2019/03/30/sqirrel-packages-manager-as-a-lolbin-a-k-a-many-electron-apps-are-lolbins-by-default/</item><item type="str">http://www.hexacorn.com/blog/2018/08/16/squirrel-as-a-lolbin/</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems), Karneades / Markus Neis, Jonhnathan Ribeiro, oscd.community</author><date type="str">2022/06/09</date><modified type="str">2023/03/22</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.execution</item><item type="str">attack.t1218</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_img type="dict"><key name="Image|endswith" type="list"><item type="str">\squirrel.exe</item><item type="str">\update.exe</item></key></selection_img><selection_download_cli type="dict"><key name="CommandLine|contains" type="list"><item type="str"> --download </item><item type="str"> --update </item><item type="str"> --updateRollback=</item></key></selection_download_cli><selection_download_http_keyword type="dict"><key name="CommandLine|contains" type="str">http</key></selection_download_http_keyword><selection_exec type="dict"><key name="CommandLine|contains" type="list"><item type="str">--processStart</item><item type="str">--processStartAndWait</item><item type="str">--createShortcut</item></key></selection_exec><filter_discord type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">C:\Users\</item><item type="str">\AppData\Local\Discord\Update.exe</item><item type="str"> --processStart</item><item type="str">Discord.exe</item></key></filter_discord><filter_github_desktop type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">C:\Users\</item><item type="str">\AppData\Local\GitHubDesktop\Update.exe</item><item type="str">GitHubDesktop.exe</item></key><key name="CommandLine|contains" type="list"><item type="str">--createShortcut</item><item type="str">--processStartAndWait</item></key></filter_github_desktop><filter_teams type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">C:\Users\</item><item type="str">\AppData\Local\Microsoft\Teams\Update.exe</item><item type="str">Teams.exe</item></key><key name="CommandLine|contains" type="list"><item type="str">--processStart</item><item type="str">--createShortcut</item></key></filter_teams><filter_yammer type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">C:\Users\</item><item type="str">\AppData\Local\yammerdesktop\Update.exe</item><item type="str">Yammer.exe</item></key><key name="CommandLine|contains" type="list"><item type="str">--processStart</item><item type="str">--createShortcut</item></key></filter_yammer><condition type="str">selection_img and (all of selection_download_* or selection_exec) and not 1 of filter_*</condition></detection><falsepositives type="list"><item type="str">Expected FP with some electron based applications such as (1Clipboard, Beaker Browser, Caret, Discord, GitHub Desktop,...Etc)</item></falsepositives><level type="str">medium</level></root>