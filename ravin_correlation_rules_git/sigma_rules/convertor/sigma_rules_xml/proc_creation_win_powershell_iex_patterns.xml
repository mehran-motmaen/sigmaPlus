<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Suspicious PowerShell IEX Execution Patterns</title><id type="str">09576804-7a05-458e-a817-eb718ca91f54</id><status type="str">experimental</status><description type="str">Detects suspicious ways to run Invoke-Execution using IEX alias</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.2</item></references><author type="str">Florian Roth (Nextron Systems)</author><date type="str">2022/03/24</date><modified type="str">2022/11/28</modified><logsource type="dict"><product type="str">windows</product><category type="str">process_creation</category></logsource><detection type="dict"><selection_combined_1 type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key><key name="CommandLine|contains" type="list"><item type="str"> | iex;</item><item type="str"> | iex </item><item type="str"> | iex}</item><item type="str"> | IEX ;</item><item type="str"> | IEX -Error</item><item type="str"> | IEX (new</item><item type="str">);IEX </item></key></selection_combined_1><selection_combined_2 type="dict"><key name="CommandLine|contains" type="list"><item type="str">::FromBase64String</item><item type="str">.GetString([System.Convert]::</item></key></selection_combined_2><selection_standalone type="dict"><key name="CommandLine|contains" type="list"><item type="str">)|iex;$</item><item type="str">);iex($</item><item type="str">);iex $</item><item type="str"> | IEX | </item></key></selection_standalone><condition type="str">all of selection_combined* or selection_standalone</condition></detection><falsepositives type="list"><item type="str">Legitimate scripts that use IEX</item></falsepositives><level type="str">high</level></root>