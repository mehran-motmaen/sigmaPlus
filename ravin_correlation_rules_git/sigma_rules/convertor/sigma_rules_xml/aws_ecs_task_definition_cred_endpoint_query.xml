<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">AWS ECS Task Definition That Queries The Credential Endpoint</title><id type="str">b94bf91e-c2bf-4047-9c43-c6810f43baad</id><status type="str">experimental</status><description type="str">Detects when an Elastic Container Service (ECS) Task Definition includes a command to query the credential endpoint.
This can indicate a potential adversary adding a backdoor to establish persistence or escalate privileges.
</description><references type="list"><item type="str">https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/ecs__backdoor_task_def/main.py</item><item type="str">https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_RegisterTaskDefinition.html</item><item type="str">https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-iam-roles.html</item></references><author type="str">Darin Smith</author><date type="str">2022/06/07</date><modified type="str">2023/04/24</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1525</item></tags><logsource type="dict"><product type="str">aws</product><service type="str">cloudtrail</service></logsource><detection type="dict"><selection type="dict"><eventSource type="str">ecs.amazonaws.com</eventSource><eventName type="list"><item type="str">DescribeTaskDefinition</item><item type="str">RegisterTaskDefinition</item><item type="str">RunTask</item></eventName><key name="requestParameters.containerDefinitions.command|contains" type="str">$AWS_CONTAINER_CREDENTIALS_RELATIVE_URI</key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Task Definition being modified to request credentials from the Task Metadata Service for valid reasons</item></falsepositives><level type="str">medium</level></root>