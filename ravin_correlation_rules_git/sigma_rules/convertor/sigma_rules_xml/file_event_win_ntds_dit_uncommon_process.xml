<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">NTDS.DIT Creation By Uncommon Process</title><id type="str">11b1ed55-154d-4e82-8ad7-83739298f720</id><related type="list"><item type="dict"><id type="str">4e7050dd-e548-483f-b7d6-527ab4fa784d</id><type type="str">similar</type></item></related><status type="str">test</status><description type="str">Detects creation of a file named &quot;ntds.dit&quot; (Active Directory Database) by an uncommon process or a process located in a suspicious directory</description><references type="list"><item type="str">https://stealthbits.com/blog/extracting-password-hashes-from-the-ntds-dit-file/</item><item type="str">https://adsecurity.org/?p=2398</item></references><author type="str">Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/01/11</date><modified type="str">2022/07/14</modified><tags type="list"><item type="str">attack.credential_access</item><item type="str">attack.t1003.002</item><item type="str">attack.t1003.003</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">file_event</category></logsource><detection type="dict"><selection_ntds type="dict"><key name="TargetFilename|endswith" type="str">\ntds.dit</key></selection_ntds><selection_process_img type="dict"><key name="Image|endswith" type="list"><item type="str">\cmd.exe</item><item type="str">\cscript.exe</item><item type="str">\mshta.exe</item><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item><item type="str">\regsvr32.exe</item><item type="str">\rundll32.exe</item><item type="str">\wscript.exe</item><item type="str">\wsl.exe</item><item type="str">\wt.exe</item></key></selection_process_img><selection_process_paths type="dict"><key name="Image|contains" type="list"><item type="str">\AppData\</item><item type="str">\Temp\</item><item type="str">\Public\</item><item type="str">\PerfLogs\</item></key></selection_process_paths><condition type="str">selection_ntds and 1 of selection_process_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>