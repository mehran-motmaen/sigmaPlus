<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Recon Activity Via Nltest.EXE</title><id type="str">5cc90652-4cbd-4241-aa3b-4b462fa5a248</id><related type="list"><item type="dict"><id type="str">410ad193-a728-4107-bc79-4419789fcbf8</id><type type="str">similar</type></item><item type="dict"><id type="str">903076ff-f442-475a-b667-4f246bcc203b</id><type type="str">similar</type></item><item type="dict"><id type="str">77815820-246c-47b8-9741-e0def3f57308</id><type type="str">obsoletes</type></item></related><status type="str">experimental</status><description type="str">Detects nltest commands that can be used for information discovery</description><references type="list"><item type="str">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731935(v=ws.11)</item><item type="str">https://thedfirreport.com/2021/08/16/trickbot-leads-up-to-fake-1password-installation/</item><item type="str">https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/</item><item type="str">https://book.hacktricks.xyz/windows/basic-cmd-for-pentesters</item><item type="str">https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/</item><item type="str">https://eqllib.readthedocs.io/en/latest/analytics/03e231a6-74bc-467a-acb1-e5676b0fb55e.html</item><item type="str">https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/</item><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/5360c9d9ffa3b25f6495f7a16e267b719eba2c37/atomics/T1482/T1482.md#atomic-test-2---windows---discover-domain-trusts-with-nltest</item></references><author type="str">Craig Young, oscd.community, Georg Lauenstein</author><date type="str">2021/07/24</date><modified type="str">2023/02/04</modified><tags type="list"><item type="str">attack.discovery</item><item type="str">attack.t1016</item><item type="str">attack.t1482</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_nltest type="list"><item type="dict"><key name="Image|endswith" type="str">\nltest.exe</key></item><item type="dict"><OriginalFileName type="str">nltestrk.exe</OriginalFileName></item></selection_nltest><selection_recon1 type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">/server</item><item type="str">/query</item></key></selection_recon1><selection_recon2 type="dict"><key name="CommandLine|contains" type="list"><item type="str">/dclist:</item><item type="str">/parentdomain</item><item type="str">/domain_trusts</item><item type="str">/all_trusts</item><item type="str">/trusted_domains</item><item type="str">/user</item></key></selection_recon2><condition type="str">selection_nltest and 1 of selection_recon*</condition></detection><fields type="list"><item type="str">Image</item><item type="str">User</item><item type="str">CommandLine</item><item type="str">ParentCommandLine</item></fields><falsepositives type="list"><item type="str">Legitimate administration use but user and host must be investigated</item></falsepositives><level type="str">high</level></root>