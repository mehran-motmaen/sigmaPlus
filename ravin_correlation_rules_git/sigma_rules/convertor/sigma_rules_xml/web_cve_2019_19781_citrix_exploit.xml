<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Citrix Netscaler Attack CVE-2019-19781</title><id type="str">ac5a6409-8c89-44c2-8d64-668c29a2d756</id><status type="str">test</status><description type="str">Detects CVE-2019-19781 exploitation attempt against Citrix Netscaler, Application Delivery Controller and Citrix Gateway Attack</description><references type="list"><item type="str">https://support.citrix.com/article/CTX267679</item><item type="str">https://support.citrix.com/article/CTX267027</item><item type="str">https://isc.sans.edu/diary/25686</item><item type="str">https://twitter.com/mpgn_x64/status/1216787131210829826</item><item type="str">https://github.com/x1sec/CVE-2019-19781/blob/25f7ab97275b2d41800bb3414dac8ca3a78af7e5/CVE-2019-19781-DFIR.md</item></references><author type="str">Arnim Rupp, Florian Roth</author><date type="str">2020/01/02</date><modified type="str">2023/01/02</modified><tags type="list"><item type="str">attack.initial_access</item><item type="str">attack.t1190</item><item type="str">cve.2019.19781</item><item type="str">detection.emerging_threats</item></tags><logsource type="dict"><category type="str">webserver</category><definition type="str">Make sure that your Netscaler appliance logs all kinds of attacks (test with http://your-citrix-gw.net/robots.txt). The directory traversal with ../ might not be needed on certain cloud instances or for authenticated users, so we also check for direct paths. All scripts in portal/scripts are exploitable except logout.pl.</definition></logsource><detection type="dict"><selection_cs type="list"><item type="dict"><key name="cs-uri-query|contains" type="str">/../vpns/</key></item><item type="dict"><key name="cs-uri-query|endswith" type="str">/vpns/cfg/smb.conf</key></item></selection_cs><selection_csall type="dict"><key name="cs-uri-query|contains|all" type="list"><item type="str">/vpns/portal/scripts/</item><item type="str">.pl</item></key></selection_csall><condition type="str">1 of selection_*</condition></detection><fields type="list"><item type="str">client_ip</item><item type="str">vhost</item><item type="str">url</item><item type="str">response</item></fields><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">critical</level></root>