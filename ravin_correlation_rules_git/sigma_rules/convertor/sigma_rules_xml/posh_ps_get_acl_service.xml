<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Service Registry Permissions Weakness Check</title><id type="str">95afc12e-3cbb-40c3-9340-84a032e596a3</id><status type="str">test</status><description type="str">Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services.
Adversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start.
Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services
</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.011/T1574.011.md#atomic-test-1---service-registry-permissions-weakness</item><item type="str">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-acl?view=powershell-7.2</item></references><author type="str">frack113</author><date type="str">2021/12/30</date><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1574.011</item></tags><logsource type="dict"><product type="str">windows</product><category type="str">ps_script</category><definition type="str">Requirements: Script Block Logging must be enabled</definition></logsource><detection type="dict"><selection type="dict"><key name="ScriptBlockText|contains|all" type="list"><item type="str">get-acl</item><item type="str">REGISTRY::HKLM\SYSTEM\CurrentControlSet\Services\</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Legitimate administrative script</item></falsepositives><level type="str">medium</level></root>