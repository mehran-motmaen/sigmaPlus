<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">ADCS Certificate Template Configuration Vulnerability</title><id type="str">5ee3a654-372f-11ec-8d3d-0242ac130003</id><status type="str">test</status><description type="str">Detects certificate creation with template allowing risk permission subject</description><references type="list"><item type="str">https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf</item></references><author type="str">Orlinum , BlueDefenZer</author><date type="str">2021/11/17</date><modified type="str">2022/12/25</modified><tags type="list"><item type="str">attack.privilege_escalation</item><item type="str">attack.credential_access</item></tags><logsource type="dict"><product type="str">windows</product><service type="str">security</service><definition type="str">Certificate services loaded a template would trigger event ID 4898 and certificate Services template was updated would trigger event ID 4899. A risk permission seems to be coming if template contain specific flag.</definition></logsource><detection type="dict"><selection1 type="dict"><EventID type="int">4898</EventID><key name="TemplateContent|contains" type="str">CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT</key></selection1><selection2 type="dict"><EventID type="int">4899</EventID><key name="NewTemplateContent|contains" type="str">CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT</key></selection2><condition type="str">selection1 or selection2</condition></detection><falsepositives type="list"><item type="str">Administrator activity</item><item type="str">Proxy SSL certificate with subject modification</item><item type="str">Smart card enrollement</item></falsepositives><level type="str">low</level></root>