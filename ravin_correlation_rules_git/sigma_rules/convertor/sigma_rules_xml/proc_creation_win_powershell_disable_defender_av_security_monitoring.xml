<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Disable Windows Defender AV Security Monitoring</title><id type="str">a7ee1722-c3c5-aeff-3212-c777e4733217</id><status type="str">experimental</status><description type="str">Detects attackers attempting to disable Windows Defender using Powershell</description><references type="list"><item type="str">https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/</item><item type="str">https://rvsec0n.wordpress.com/2020/01/24/malwares-that-bypass-windows-defender/</item><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md</item></references><author type="str">ok @securonix invrep-de, oscd.community, frack113</author><date type="str">2020/10/12</date><modified type="str">2022/11/18</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1562.001</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection_pwsh_binary type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item></key></item><item type="dict"><OriginalFileName type="list"><item type="str">PowerShell.EXE</item><item type="str">pwsh.dll</item></OriginalFileName></item></selection_pwsh_binary><selection_pwsh_cli type="dict"><key name="CommandLine|contains" type="list"><item type="str">-DisableBehaviorMonitoring $true</item><item type="str">-DisableRuntimeMonitoring $true</item></key></selection_pwsh_cli><selection_sc_binary type="list"><item type="dict"><key name="Image|endswith" type="str">\sc.exe</key></item><item type="dict"><OriginalFileName type="str">sc.exe</OriginalFileName></item></selection_sc_binary><selection_sc_tamper_cmd_stop type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">stop</item><item type="str">WinDefend</item></key></selection_sc_tamper_cmd_stop><selection_sc_tamper_cmd_delete type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">delete</item><item type="str">WinDefend</item></key></selection_sc_tamper_cmd_delete><selection_sc_tamper_cmd_disabled type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">config</item><item type="str">WinDefend</item><item type="str">start=disabled</item></key></selection_sc_tamper_cmd_disabled><condition type="str">all of selection_pwsh_* or (selection_sc_binary and 1 of selection_sc_tamper_*)</condition></detection><falsepositives type="list"><item type="str">Minimal, for some older versions of dev tools, such as pycharm, developers were known to sometimes disable Windows Defender to improve performance, but this generally is not considered a good security practice.</item></falsepositives><level type="str">high</level></root>