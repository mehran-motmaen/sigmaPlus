<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential PendingFileRenameOperations Tamper</title><id type="str">4eec988f-7bf0-49f1-8675-1e6a510b3a2a</id><status type="str">experimental</status><description type="str">Detect changes to the &quot;PendingFileRenameOperations&quot; registry key from uncommon or suspicious images lcoations to stage currently used files for rename after reboot.</description><references type="list"><item type="str">https://any.run/report/3ecd4763ffc944fdc67a9027e459cd4f448b1a8d1b36147977afaf86bbf2a261/64b0ba45-e7ce-423b-9a1d-5b4ea59521e6</item><item type="str">https://devblogs.microsoft.com/scripting/determine-pending-reboot-statuspowershell-style-part-1/</item><item type="str">https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc960241(v=technet.10)?redirectedfrom=MSDN</item><item type="str">https://www.trendmicro.com/en_us/research/21/j/purplefox-adds-new-backdoor-that-uses-websockets.html</item><item type="str">https://www.trendmicro.com/en_us/research/19/i/purple-fox-fileless-malware-with-rookit-component-delivered-by-rig-exploit-kit-now-abuses-powershell.html</item></references><author type="str">frack113</author><date type="str">2023/01/27</date><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1036.003</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection_main type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains" type="str">\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations</key></selection_main><selection_susp_paths type="dict"><key name="Image|contains" type="list"><item type="str">\AppData\Local\Temp\</item><item type="str">\Users\Public\</item></key></selection_susp_paths><selection_susp_images type="dict"><key name="Image|endswith" type="list"><item type="str">\reg.exe</item><item type="str">\regedit.exe</item></key></selection_susp_images><condition type="str">selection_main and 1 of selection_susp_*</condition></detection><falsepositives type="list"><item type="str">Installers and updaters may set currently in use files for rename after a reboot.</item></falsepositives><level type="str">medium</level></root>