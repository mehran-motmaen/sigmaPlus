<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Arbitrary Code Execution Via Node.EXE</title><id type="str">6640f31c-01ad-49b5-beb5-83498a5cd8bd</id><status type="str">experimental</status><description type="str">Detects the execution node.exe which is shipped with multiple software such as VMware, Adobe...etc. In order to execute arbitrary code. For example to establish reverse shell as seen in Log4j attacks...etc</description><references type="list"><item type="str">http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html</item><item type="str">https://www.sprocketsecurity.com/resources/crossing-the-log4j-horizon-a-vulnerability-with-no-return</item><item type="str">https://www.rapid7.com/blog/post/2022/01/18/active-exploitation-of-vmware-horizon-servers/</item><item type="str">https://nodejs.org/api/cli.html</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/09/09</date><modified type="str">2023/02/03</modified><tags type="list"><item type="str">attack.defense_evasion</item><item type="str">attack.t1127</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="Image|endswith" type="str">\node.exe</key><key name="CommandLine|contains" type="list"><item type="str"> -e </item><item type="str"> --eval </item></key></selection><action_reverse_shell type="dict"><key name="CommandLine|contains|all" type="list"><item type="str">.exec(</item><item type="str">net.socket</item><item type="str">.connect</item><item type="str">child_process</item></key></action_reverse_shell><condition type="str">selection and 1 of action_*</condition></detection><falsepositives type="list"><item type="str">Unlikely</item></falsepositives><level type="str">high</level></root>