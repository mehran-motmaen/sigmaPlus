<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Windows Shell/Scripting Processes Spawning Suspicious Programs</title><id type="str">3a6586ad-127a-4d3b-a677-1e6eacdf8fde</id><status type="str">test</status><description type="str">Detects suspicious child processes of a Windows shell and scripting processes such as wscript, rundll32, powershell, mshta...etc.</description><references type="list"><item type="str">https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html</item></references><author type="str">Florian Roth (Nextron Systems), Tim Shelton</author><date type="str">2018/04/06</date><modified type="str">2023/05/23</modified><tags type="list"><item type="str">attack.execution</item><item type="str">attack.defense_evasion</item><item type="str">attack.t1059.005</item><item type="str">attack.t1059.001</item><item type="str">attack.t1218</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="ParentImage|endswith" type="list"><item type="str">\mshta.exe</item><item type="str">\powershell.exe</item><item type="str">\pwsh.exe</item><item type="str">\rundll32.exe</item><item type="str">\cscript.exe</item><item type="str">\wscript.exe</item><item type="str">\wmiprvse.exe</item><item type="str">\regsvr32.exe</item></key><key name="Image|endswith" type="list"><item type="str">\schtasks.exe</item><item type="str">\nslookup.exe</item><item type="str">\certutil.exe</item><item type="str">\bitsadmin.exe</item><item type="str">\mshta.exe</item></key></selection><filter_ccmcache type="dict"><key name="CurrentDirectory|contains" type="str">\ccmcache\</key></filter_ccmcache><filter_amazon type="dict"><key name="ParentCommandLine|contains" type="list"><item type="str">\Program Files\Amazon\WorkSpacesConfig\Scripts\setup-scheduledtask.ps1</item><item type="str">\Program Files\Amazon\WorkSpacesConfig\Scripts\set-selfhealing.ps1</item><item type="str">\Program Files\Amazon\WorkSpacesConfig\Scripts\check-workspacehealth.ps1</item><item type="str">\nessus_</item></key></filter_amazon><filter_nessus type="dict"><key name="CommandLine|contains" type="str">\nessus_</key></filter_nessus><filter_sccm_install type="dict"><key name="ParentImage|endswith" type="str">\mshta.exe</key><key name="Image|endswith" type="str">\mshta.exe</key><key name="ParentCommandLine|contains|all" type="list"><item type="str">C:\MEM_Configmgr_</item><item type="str">\splash.hta</item><item type="str">{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}</item></key><key name="CommandLine|contains|all" type="list"><item type="str">C:\MEM_Configmgr_</item><item type="str">\SMSSETUP\BIN\</item><item type="str">\autorun.hta</item><item type="str">{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}</item></key></filter_sccm_install><condition type="str">selection and not 1 of filter_*</condition></detection><fields type="list"><item type="str">CommandLine</item><item type="str">ParentCommandLine</item><item type="str">CurrentDirectory</item><item type="str">Image</item><item type="str">ParentImage</item></fields><falsepositives type="list"><item type="str">Administrative scripts</item><item type="str">Microsoft SCCM</item></falsepositives><level type="str">high</level></root>