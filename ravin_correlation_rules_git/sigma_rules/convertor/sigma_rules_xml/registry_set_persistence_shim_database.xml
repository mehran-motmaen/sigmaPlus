<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Potential Persistence Via Shim Database Modification</title><id type="str">dfb5b4e8-91d0-4291-b40a-e3b0d3942c45</id><status type="str">experimental</status><description type="str">Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims.
The Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time
</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.011/T1546.011.md#atomic-test-3---registry-key-creation-andor-modification-events-for-sdb</item><item type="str">https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html</item><item type="str">https://andreafortuna.org/2018/11/12/process-injection-and-persistence-using-application-shimming/</item></references><author type="str">frack113</author><date type="str">2021/12/30</date><modified type="str">2023/08/01</modified><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.t1546.011</item></tags><logsource type="dict"><category type="str">registry_set</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><EventType type="str">SetValue</EventType><key name="TargetObject|contains" type="list"><item type="str">\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB\</item><item type="str">\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom\</item></key></selection><filter_main_empty type="dict"><Details type="str"></Details></filter_main_empty><condition type="str">selection and not 1 of filter_main_*</condition></detection><falsepositives type="list"><item type="str">Legitimate custom SHIM installations will also trigger this rule</item></falsepositives><level type="str">medium</level></root>