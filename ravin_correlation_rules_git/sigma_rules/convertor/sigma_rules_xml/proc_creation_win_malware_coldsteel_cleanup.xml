<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">COLDSTEEL RAT Cleanup Command Execution</title><id type="str">88516f06-ebe0-47ad-858e-ae9fd060ddea</id><status type="str">experimental</status><description type="str">Detects the creation of a &quot;rundll32&quot; process from the ColdSteel persistence service to initiate the cleanup command by calling one of its own exports. This functionality is not present in &quot;MileStone2017&quot; and some &quot;MileStone2016&quot; samples</description><references type="list"><item type="str">https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf</item></references><author type="str">Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2023/04/30</date><tags type="list"><item type="str">attack.persistence</item><item type="str">attack.defense_evasion</item><item type="str">detection.emerging_threats</item></tags><logsource type="dict"><category type="str">process_creation</category><product type="str">windows</product></logsource><detection type="dict"><selection type="dict"><key name="ParentImage|endswith" type="str">\svchost.exe</key><key name="ParentCommandLine|contains" type="list"><item type="str"> -k msupdate</item><item type="str"> -k msupdate2</item><item type="str"> -k alg</item></key><key name="Image|endswith" type="str">\rundll32.exe</key><key name="CommandLine|contains" type="list"><item type="str">UpdateDriverForPlugAndPlayDevicesW</item><item type="str">ServiceMain</item><item type="str">DiUninstallDevice</item></key></selection><condition type="str">selection</condition></detection><falsepositives type="list"><item type="str">Unlikely</item></falsepositives><level type="str">critical</level></root>