<?xml version="1.0" encoding="UTF-8" ?><root><title type="str">Office Macro File Creation From Suspicious Process</title><id type="str">b1c50487-1967-4315-a026-6491686d860e</id><status type="str">experimental</status><description type="str">Detects the creation of a office macro file from a a suspicious process</description><references type="list"><item type="str">https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md</item><item type="str">https://docs.microsoft.com/en-us/deployoffice/compat/office-file-format-reference</item></references><author type="str">frack113, Nasreddine Bencherchali (Nextron Systems)</author><date type="str">2022/01/23</date><modified type="str">2023/02/22</modified><tags type="list"><item type="str">attack.initial_access</item><item type="str">attack.t1566.001</item></tags><logsource type="dict"><category type="str">file_event</category><product type="str">windows</product><definition type="str">Requirements: The &quot;ParentImage&quot; field is not available by default on EID 11 of Sysmon logs. To be able to use this rule to the full extent you need to enriche the log with additional ParentImage data</definition></logsource><detection type="dict"><selection_cmd type="list"><item type="dict"><key name="Image|endswith" type="list"><item type="str">\cscript.exe</item><item type="str">\mshta.exe</item><item type="str">\regsvr32.exe</item><item type="str">\rundll32.exe</item><item type="str">\wscript.exe</item></key></item><item type="dict"><key name="ParentImage|endswith" type="list"><item type="str">\cscript.exe</item><item type="str">\mshta.exe</item><item type="str">\regsvr32.exe</item><item type="str">\rundll32.exe</item><item type="str">\wscript.exe</item></key></item></selection_cmd><selection_ext type="dict"><key name="TargetFilename|endswith" type="list"><item type="str">.docm</item><item type="str">.dotm</item><item type="str">.xlsm</item><item type="str">.xltm</item><item type="str">.potm</item><item type="str">.pptm</item></key></selection_ext><condition type="str">all of selection_*</condition></detection><falsepositives type="list"><item type="str">Unknown</item></falsepositives><level type="str">high</level></root>