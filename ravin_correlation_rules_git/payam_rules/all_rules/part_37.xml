<rule id="19000" owner="system" kbid="19000_1" enable="t" ver="1" file_name="">
        <filter_list>
            <filter id="1" name="Too many OSPF adjacency changes" weight="1">
                <source>
                    <ip location="ANY" />
                    <port>0-65535</port>
                </source>
                <target>
                    <ip location="ANY" />
                    <port>0-65535</port>
                </target>
                <event_list>
                    <event event_type="ROUTING-OSPF-5-ADJCHG" sensor_type="300" class_type="" />
                    <event event_type="ROUTING-OSPFv3-5-ADJCHG" sensor_type="300" class_type="" />
                </event_list>
            </filter>
            <filter id="2" name="Too many OSPF adjacency changes(5)" occurrence="5" weight="10" timeout="10">
                <source>
                    <ip reference_id="1" reference_type="source" />
                    <port>0-65535</port>
                </source>
                <target>
                    <ip location="ANY" />
                    <port>0-65535</port>
                </target>
                <event_list>
                    <event event_type="ROUTING-OSPF-5-ADJCHG" sensor_type="300" class_type="" />
                    <event event_type="ROUTING-OSPFv3-5-ADJCHG" sensor_type="300" class_type="" />
                </event_list>
            </filter>
            <filter id="3" name="Too many OSPF adjacency changes(10)" occurrence="10" weight="10" timeout="30">
                <source>
                    <ip reference_id="1" reference_type="source" />
                    <port>0-65535</port>
                </source>
                <target>
                    <ip location="ANY" />
                    <port>0-65535</port>
                </target>
                <event_list>
                    <event event_type="ROUTING-OSPF-5-ADJCHG" sensor_type="300" class_type="" />
                    <event event_type="ROUTING-OSPFv3-5-ADJCHG" sensor_type="300" class_type="" />
                </event_list>
            </filter>
            <filter id="4" name="Too many OSPF adjacency changes(25)" occurrence="25" weight="10" timeout="60">
                <source>
                    <ip reference_id="1" reference_type="source" />
                    <port>0-65535</port>
                </source>
                <target>
                    <ip location="ANY" />
                    <port>0-65535</port>
                </target>
                <event_list>
                    <event event_type="ROUTING-OSPF-5-ADJCHG" sensor_type="300" class_type="" />
                    <event event_type="ROUTING-OSPFv3-5-ADJCHG" sensor_type="300" class_type="" />
                </event_list>
            </filter>
            <filter id="5" name="Too many OSPF adjacency changes(50)" occurrence="50" weight="10" timeout="120">
                <source>
                    <ip reference_id="1" reference_type="source" />
                    <port>0-65535</port>
                </source>
                <target>
                    <ip location="ANY" />
                    <port>0-65535</port>
                </target>
                <event_list>
                    <event event_type="ROUTING-OSPF-5-ADJCHG" sensor_type="300" class_type="" />
                    <event event_type="ROUTING-OSPFv3-5-ADJCHG" sensor_type="300" class_type="" />
                </event_list>
            </filter>
        </filter_list>
        <action>
            <alert priority="medium" category="AbnormalActivity">
                <message>Possible network attack, too many OSPF adjacency changes</message>
                <source>
                    <ip reference_id="1" reference_type="source" />
                </source>
                <target>
                    <ip reference_id="1" reference_type="target" />
                </target>
            </alert>
            <prerequisite />
            <consequence />
        </action>
        <regulation>
            <sequence>
                <filter id="1" />
                <filter id="2" />
                <filter id="3" />
                <filter id="4" />
                <filter id="5" />
            </sequence>
        </regulation>
    </rule>
    